const t={},e={},i={},s=[],n={},r=[],o={},a={},l=[],h={},c={},u=[],d={},f={},p={},m={},g=[],y={},b={DEFAULTS:{defaults:!0},b:{weight:"bold"},"/b":{weight:"normal"},strong:{weight:"bold"},"/strong":{weight:"normal"},BOLD:{weight:"bold"},"/BOLD":{weight:"normal"},i:{style:"italic"},"/i":{style:"normal"},em:{style:"italic"},"/em":{style:"normal"},ITALIC:{style:"italic"},"/ITALIC":{style:"normal"},u:{underline:!0},"/u":{underline:!1},UNDERLINE:{underline:!0},"/UNDERLINE":{underline:!1},OVERLINE:{overline:!0},"/OVERLINE":{overline:!1},"SMALL-CAPS":{variant:"small-caps"},"/SMALL-CAPS":{variant:"normal"},HIGHLIGHT:{highlight:!0},"/HIGHLIGHT":{highlight:!1}},S={},k={},A=[],w={},v={},C=Math.PI/180,O=new Set(["all","background","backgroundAttachment","backgroundBlendMode","backgroundClip","backgroundColor","backgroundOrigin","backgroundPosition","backgroundRepeat","border","borderBottom","borderBottomColor","borderBottomStyle","borderBottomWidth","borderCollapse","borderColor","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderSpacing","borderStyle","borderTop","borderTopColor","borderTopStyle","borderTopWidth","borderWidth","clear","color","columns","content","counterIncrement","counterReset","cursor","direction","display","emptyCells","float","font","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontSynthesis","fontVariant","fontVariantAlternates","fontVariantCaps","fontVariantEastAsian","fontVariantLigatures","fontVariantNumeric","fontVariantPosition","fontWeight","grid","gridArea","gridAutoColumns","gridAutoFlow","gridAutoPosition","gridAutoRows","gridColumn","gridColumnStart","gridColumnEnd","gridRow","gridRowStart","gridRowEnd","gridTemplate","gridTemplateAreas","gridTemplateRows","gridTemplateColumns","imageResolution","imeMode","inherit","inlineSize","isolation","letterSpacing","lineBreak","lineHeight","listStyle","listStyleImage","listStylePosition","listStyleType","margin","marginBlockStart","marginBlockEnd","marginInlineStart","marginInlineEnd","marginBottom","marginLeft","marginRight","marginTop","marks","mask","maskType","maxWidth","maxHeight","maxBlockSize","maxInlineSize","maxZoom","minWidth","minHeight","minBlockSize","minInlineSize","minZoom","mixBlendMode","objectFit","objectPosition","offsetBlockStart","offsetBlockEnd","offsetInlineStart","offsetInlineEnd","orphans","overflow","overflowWrap","overflowX","overflowY","pad","padding","paddingBlockStart","paddingBlockEnd","paddingInlineStart","paddingInlineEnd","paddingBottom","paddingLeft","paddingRight","paddingTop","pageBreakAfter","pageBreakBefore","pageBreakInside","pointerEvents","position","prefix","quotes","rubyAlign","rubyMerge","rubyPosition","scrollBehavior","scrollSnapCoordinate","scrollSnapDestination","scrollSnapPointsX","scrollSnapPointsY","scrollSnapType","scrollSnapTypeX","scrollSnapTypeY","shapeImageThreshold","shapeMargin","shapeOutside","tableLayout","textAlign","textDecoration","textIndent","textOrientation","textOverflow","textRendering","textShadow","textTransform","textUnderlinePosition","unicodeRange","unset","verticalAlign","widows","willChange","wordBreak","wordSpacing","wordWrap","zIndex"]),P=new Set(["alignContent","alignItems","alignSelf","animation","animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimingFunction","backfaceVisibility","backgroundImage","backgroundSize","borderBottomLeftRadius","borderBottomRightRadius","borderImage","borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth","borderRadius","borderTopLeftRadius","borderTopRightRadius","boxDecorationBreak","boxShadow","boxSizing","columnCount","columnFill","columnGap","columnRule","columnRuleColor","columnRuleStyle","columnRuleWidth","columnSpan","columnWidth","filter","flex","flexBasis","flexDirection","flexFlow","flexGrow","flexShrink","flexWrap","fontFeatureSettings","fontKerning","fontLanguageOverride","hyphens","imageRendering","imageOrientation","initial","justifyContent","linearGradient","opacity","order","orientation","outline","outlineColor","outlineOffset","outlineStyle","outlineWidth","resize","tabSize","textAlignLast","textCombineUpright","textDecorationColor","textDecorationLine","textDecorationStyle","touchAction","transformStyle","transition","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction","unicodeBidi","whiteSpace","writingMode"]);var x=Object.freeze({__proto__:null,version:"8.8.2",anchor:{},anchornames:[],animation:t,animationnames:[],animationtickers:e,animationtickersnames:[],artefact:i,artefactnames:s,asset:n,assetnames:r,canvas:o,canvasnames:[],cell:a,cellnames:l,element:{},elementnames:[],entity:h,entitynames:[],filter:c,filternames:u,fontattribute:{},fontattributenames:[],group:d,groupnames:[],palette:{},palettenames:[],particle:f,particlenames:[],force:p,forcenames:[],spring:m,springnames:g,world:y,worldnames:[],sectionClasses:b,stack:{},stacknames:[],tween:S,tweennames:[],styles:k,stylesnames:A,unstackedelement:w,unstackedelementnames:[],constructors:v,radian:C,css:O,xcss:P});let D=!1,R=!0,F=[],E=[];const I=function(){R=!0},M=function(){let e,i;for(R&&function(){if(R){R=!1;let e,i,s,n,r,o=Math.floor,a=[];for(s=0,n=E.length;s<n;s++)r=E[s],e=t[r],e&&(i=o(e.order)||0,a[i]||(a[i]=[]),a[i].push(e));F=a.reduce(((t,e)=>t.concat(e)),[])}}(),e=0,i=F.length;e<i;e++)F[e].fn();D&&window.requestAnimationFrame((()=>M()))},T=function(){D=!0,M()},H=function(){D=!1},B=(t,e)=>{if(!nt(e))throw new Error(`core/utilities addStrings() error - no delta argument supplied ${t}, ${e}`);if(null!=e){let i=!(!t.substring&&!e.substring);return Q(t)?t+=Q(e)?e:parseFloat(e):t=parseFloat(t)+(Q(e)?e:parseFloat(e)),i?t+"%":t}return t},L=t=>{let e,i,s;if(!nt(t))throw new Error("core/utilities convertTime() error - no argument supplied");if(Q(t))return["ms",t];if(!t.substring)throw new Error(`core/utilities convertTime() error - invalid argument: ${t}`);if(e=t.match(/^\d+\.?\d*(\D*)/),i=e[1].toLowerCase?e[1].toLowerCase():"ms",s=parseFloat(t),!Q(s))throw new Error(`core/base error - convertTime() argument converts to NaN: ${t}`);switch(i){case"s":s*=1e3;break;case"%":break;default:i="ms"}return[i,s]},$=t=>{if(!t.toFixed||isNaN(t))return console.log(`${t} is not a valid number`),t;if(t>=0&&t<360)return t;for(;t<0||t>=360;)t<0?t+=360:t-=360;return t},j=t=>t.toFixed?0==t?t:isNaN(t)?0:t<-1e-6||t>1e-6?t:0:t,Y=()=>{},X=function(t){return t},N=function(){return this},G=()=>Promise.resolve(!0),z={},W=()=>performance.now().toString(36)+Math.random().toString(36).substr(2),V=function(t,e,i){return e+t*(i-e)},Z=t=>"boolean"==typeof t,U=t=>"[object HTMLCanvasElement]"===Object.prototype.toString.call(t),_=t=>!!(t&&t.querySelector&&t.dispatchEvent),q=t=>"function"==typeof t,Q=t=>!(null==t||!t.toFixed||Number.isNaN(t)),K=t=>"[object Object]"===Object.prototype.toString.call(t),J=t=>!(!t||!t.type||"Quaternion"!==t.type),tt=(t,e)=>{if(!K(t)||!K(e))throw new Error(`core/utilities mergeOver() error - insufficient arguments supplied ${t}, ${e}`);for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},et=(t,e)=>{if(!K(t)||!K(e))throw new Error(`core/utilities mergeDiscard() error - insufficient arguments supplied ${t}, ${e}`);return Object.entries(e).forEach((([i,s])=>{null===s?delete t[i]:t[i]=e[i]})),t},it=(t,e)=>{if(!rt(t,e))throw new Error(`core/utilities pushUnique() error - insufficient arguments supplied ${t}, ${e}`);if(!Array.isArray(t))throw new Error(`core/utilities pushUnique() error - argument not an array ${t}`);return Array.isArray(e)?e.forEach((e=>it(t,e))):t.indexOf(e)<0&&t.push(e),t},st=(t,e)=>{if(!rt(t,e))throw new Error(`core/utilities removeItem() error - insufficient arguments supplied ${t}, ${e}`);if(!Array.isArray(t))throw new Error(`core/utilities removeItem() error - argument not an array ${t}`);let i=t.indexOf(e);return i>=0&&t.splice(i,1),t},nt=t=>void 0!==t,rt=(...t)=>t.every((t=>void 0!==t)),ot=(...t)=>t.find((t=>void 0!==t)),at=(...t)=>!!t.find((t=>void 0!==t)),lt={out:t=>1-Math.cos(t*Math.PI/2),in:t=>Math.sin(t*Math.PI/2),easeIn:t=>{let e=1-t;return 1-e*e},easeIn3:t=>{let e=1-t;return 1-e*e*e},easeIn4:t=>{let e=1-t;return 1-e*e*e*e},easeIn5:t=>{let e=1-t;return 1-e*e*e*e*e},easeOutIn:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeOutIn3:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeOutIn4:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeOutIn5:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInOut:t=>{const e=.5-t,i=t-.5;return t<.5?.5+-2*e*e:.5+Math.pow(2*i,2)/2},easeInOut3:t=>{const e=.5-t,i=t-.5;return t<.5?.5+-4*e*e*e:.5+Math.pow(2*i,3)/2},easeInOut4:t=>{const e=.5-t,i=t-.5;return t<.5?.5+-8*e*e*e*e:.5+Math.pow(2*i,4)/2},easeInOut5:t=>{const e=.5-t,i=t-.5;return t<.5?.5+-16*e*e*e*e*e:.5+Math.pow(2*i,5)/2},easeOut:t=>t*t,easeOut3:t=>t*t*t,easeOut4:t=>t*t*t*t,easeOut5:t=>t*t*t*t*t,none:t=>t,linear:t=>t,cosine:t=>.5*(1+Math.cos((1-t)*Math.PI)),hermite:t=>t*t*(2*-t+3),quintic:t=>t*t*t*(t*(6*t-15)+10),easeOutSine:t=>1-Math.cos(t*Math.PI/2),easeInSine:t=>Math.sin(t*Math.PI/2),easeOutInSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeOutQuad:t=>t*t,easeInQuad:t=>1-(1-t)*(1-t),easeOutInQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeOutCubic:t=>t*t*t,easeInCubic:t=>1-Math.pow(1-t,3),easeOutInCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeOutQuart:t=>t*t*t*t,easeInQuart:t=>1-Math.pow(1-t,4),easeOutInQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeOutQuint:t=>t*t*t*t*t,easeInQuint:t=>1-Math.pow(1-t,5),easeOutInQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeOutExpo:t=>0===t?0:Math.pow(2,10*t-10),easeInExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeOutInExpo:t=>0===t||1===t?t:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeOutCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeInCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeOutInCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeOutBack:t=>2.70158*t*t*t-1.70158*t*t,easeInBack:t=>1+2.70158*Math.pow(t-1,3)+1.70158*Math.pow(t-1,2),easeOutInBack:t=>{const e=2.5949095;return t<.5?Math.pow(2*t,2)*(7.189819*t-e)/2:(Math.pow(2*t-2,2)*((e+1)*(2*t-2)+e)+2)/2},easeOutElastic:t=>{const e=2*Math.PI/3;return 0===t||1===t?t:-Math.pow(2,10*t-10)*Math.sin((10*t-10.75)*e)},easeInElastic:t=>{const e=2*Math.PI/3;return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((10*t-.75)*e)+1},easeOutInElastic:t=>{const e=2*Math.PI/4.5;return 0===t||1===t?t:t<.5?-Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*e)/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*e)/2+1},easeOutBounce:t=>{const e=7.5625,i=2.75;return(t=1-t)<1/i?1-e*t*t:t<2/i?1-(e*(t-=1.5/i)*t+.75):t<2.5/i?1-(e*(t-=2.25/i)*t+.9375):1-(e*(t-=2.625/i)*t+.984375)},easeInBounce:t=>{const e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375},easeOutInBounce:t=>{const e=7.5625,i=2.75;let s;return t<.5?(s=(t=1-2*t)<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375,(1-s)/2):(s=(t=2*t-1)<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375,(1+s)/2)}},ht=function(t,e,i=z){if("function"==typeof window.IntersectionObserver&&t&&t.run){let s=new IntersectionObserver(((e,i)=>{let s,n,r;for(s=0,n=e.length;s<n;s++)r=e[s],r.isIntersecting?!t.isRunning()&&t.run():r.isIntersecting||t.isRunning()&&t.halt()}),i);return e&&e.domElement&&s.observe(e.domElement),function(){s.disconnect()}}return Y},ct=function(t,e,i){if(!q(e))throw new Error(`core/document addListener() error - no function supplied: ${t}, ${i}`);return dt(t,e,i,"removeEventListener"),dt(t,e,i,"addEventListener"),function(){ut(t,e,i)}},ut=function(t,e,i){if(!q(e))throw new Error(`core/document removeListener() error - no function supplied: ${t}, ${i}`);dt(t,e,i,"removeEventListener")},dt=function(t,e,i,s){let n,r=[].concat(t);n=i.substring?document.body.querySelectorAll(i):Array.isArray(i)?i:[i],navigator.pointerEnabled||navigator.msPointerEnabled?pt(r,e,n,s):ft(r,e,n,s)},ft=function(t,e,i,s){let n,r,o,a,l,h;for(n=0,r=t.length;n<r;n++)for(l=t[n],o=0,a=i.length;o<a;o++){if(h=i[o],!(_(h)||h.document||h.characterSet))throw new Error(`core/document actionMouseListener() error - bad target: ${l}, ${h}`);switch(l){case"move":h[s]("mousemove",e,!1),h[s]("touchmove",e,{passive:!1}),h[s]("touchfollow",e,{passive:!1});break;case"up":h[s]("mouseup",e,!1),h[s]("touchend",e,{passive:!1});break;case"down":h[s]("mousedown",e,!1),h[s]("touchstart",e,{passive:!1});break;case"leave":h[s]("mouseleave",e,!1),h[s]("touchleave",e,{passive:!1});break;case"enter":h[s]("mouseenter",e,!1),h[s]("touchenter",e,{passive:!1})}}},pt=function(t,e,i,s){let n,r,o,a,l,h;for(n=0,r=t.length;n<r;n++)for(l=t[n],o=0,a=i.length;o<a;o++)if(h=i[o],_(h)||h.document||h.characterSet)switch(l){case"move":h[s]("pointermove",e,!1);break;case"up":h[s]("pointerup",e,!1);break;case"down":h[s]("pointerdown",e,!1);break;case"leave":h[s]("pointerleave",e,!1);break;case"enter":h[s]("pointerenter",e,!1)}},mt=function(t,e,i){if(!q(e))throw new Error(`core/document addNativeListener() error - no function supplied: ${t}, ${i}`);return yt(t,e,i,"removeEventListener"),yt(t,e,i,"addEventListener"),function(){gt(t,e,i)}},gt=function(t,e,i){if(!q(e))throw new Error(`core/document removeNativeListener() error - no function supplied: ${t}, ${i}`);yt(t,e,i,"removeEventListener")},yt=function(t,e,i,s){let n,r,o,a,l,h,c,u=[].concat(t);for(n=i.substring?document.body.querySelectorAll(i):Array.isArray(i)?i:[i],r=0,o=u.length;r<o;r++)for(h=u[r],a=0,l=n.length;a<l;a++){if(c=n[a],!(_(c)||c.document||c.characterSet))throw new Error(`core/document actionNativeListener() error - bad target: ${h}, ${c}`);c[s](h,e,!1)}};let bt=Y;const St=t=>bt=t,kt=function(){let t=[];return(window.opr&&opr.addons||window.opera||navigator.userAgent.indexOf(" OPR/")>=0)&&t.push("old-opera"),"undefined"!=typeof InstallTrigger?t.push("firefox"):(/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString())&&t.push("safari"),document.documentMode&&t.push("internet-explorer"),t.indexOf("internet-explorer")<0&&window.StyleMedia&&t.push("edge"),window.chrome&&t.push("chrome"),(t.indexOf("chrome")>=0||t.indexOf("old-opera")>=0)&&window.CSS&&t.push("blink"),t}();window.scrawlEnvironmentBrowserDetection=kt;let At=0;const wt=()=>At;let vt=!0;const Ct=()=>vt,Ot=t=>vt=t,Pt=()=>{if(kt.indexOf("safari")>=0)console.log("safari browser detected. Switching off DPR functionality, and filter memoization"),vt=!0,At=1;else{At=window.devicePixelRatio;for(const[t,e]of Object.entries(o))e.dirtyDimensions=!0;for(const[t,e]of Object.entries(a))e.dirtyDimensions=!0;for(const[t,e]of Object.entries(h))e.dirtyHost=!0;vt||bt()}matchMedia(`(resolution: ${At}dppx)`).addEventListener("change",Pt,{once:!0})};function xt(t=z){t.defs={},t.getters={},t.setters={},t.deltaSetters={},t.get=function(t){if(nt(t)){let e=this.getters[t];if(e)return e.call(this);{let e=this.defs[t];if(void 0!==e){let i=this[t];return void 0!==i?i:e}}}return null},t.set=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.setters,n=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&"name"!==a&&null!=l&&(r=s[a],r?r.call(this,l):void 0!==n[a]&&(this[a]=l))}return this},t.setDelta=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.deltaSetters,n=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&"name"!==a&&null!=l&&(r=s[a],r?r.call(this,l):void 0!==n[a]&&(this[a]=B(this[a],l)))}return this};t.defs=tt(t.defs,{name:""});let e=t.getters;return e.type=function(){return this.type},e.isArtefact=function(){return this.isArtefact},e.isAsset=function(){return this.isAsset},t.packetExclusions=[],t.packetExclusionsByRegex=[],t.packetCoordinates=[],t.packetObjects=[],t.packetFunctions=[],t.saveAsPacket=function(t=z){Z(t)&&t&&(t={includeDefaults:!0});let e=this.defs,i=Object.keys(e),s=this.packetExclusions,n=this.packetExclusionsByRegex,r=this.packetCoordinates,o=this.packetObjects,a=this.packetFunctions,l=t.includeDefaults||!1,h={};return l&&!Array.isArray(l)?l=Object.keys(e):l||(l=[]),Object.entries(this).forEach((([t,e])=>{let c,u=!0;if(i.indexOf(t)<0&&(u=!1),u&&s.indexOf(t)>=0&&(u=!1),u&&(c=n.some((e=>new RegExp(e).test(t))),c&&(u=!1)),u)if(a.indexOf(t)>=0){if(nt(e)&&null!==e){let i=this.stringifyFunction(e);i&&i.length&&(h[t]=i)}}else o.indexOf(t)>=0&&this[t]&&this[t].name?h[t]=this[t].name:r.indexOf(t)>=0?(l.indexOf(t)>=0||e[0]||e[1])&&(h[t]=e):(c=this.processPacketOut(t,e,l),c&&(h[t]=e))}),this),h=this.finalizePacketOut(h,t),JSON.stringify([this.name,this.type,this.lib,h])},t.stringifyFunction=function(t){let e=t.toString().match(/\(([\s\S]*?)\)[\s\S]*?\{([\s\S]*)\}/),i=e[1],s=e[2];return!!rt(i,s)&&`${i}~~~${s}`},t.processPacketOut=function(t,e,i){let s=!0;return i.indexOf(t)<0&&e===this.defs[t]&&(s=!1),s},t.finalizePacketOut=function(t,e){return t},t.importPacket=function(t){let e=this;const i=function(t){return new Promise(((i,s)=>{let n;t.substring||s(new Error("Packet url supplied for import is not a string")),"["===t[0]?(n=e.actionPacket(t),n&&n.lib?i(n):s(n)):t.indexOf('"name":')>=0?s(new Error("Bad packet supplied for import")):fetch(t).then((t=>{if(!t.ok)throw new Error(`Packet import from server failed - ${t.status}: ${t.statusText} - ${t.url}`);return t.text()})).then((t=>{if(n=e.actionPacket(t),!n||!n.lib)throw n;i(n)})).catch((t=>s(t)))}))};if(Array.isArray(t)){let e=[];return t.forEach((t=>e.push(i(t)))),new Promise(((t,i)=>{Promise.all(e).then((e=>t(e))).catch((t=>i(t)))}))}if(t.substring)return i(t);Promise.reject(new Error("Argument supplied for packet import is not a string or array of strings"))},t.actionPacketExclusions=["Image","Sprite","Video","Canvas","Stack"],t.actionPacket=function(t){try{if(t&&t.substring){if("["===t[0]){let e,i,s,n;try{[e,i,s,n]=JSON.parse(t)}catch(t){throw new Error(`Failed to process packet due to JSON parsing error - ${t.message}`)}if(rt(e,i,s,n)){if(this.actionPacketExclusions.indexOf(i)>=0)throw new Error("Failed to process packet - Stacks, Canvases and visual assets are excluded from the packet system");let t=x[s][e];if(t)t.set(n);else{if(n.outerHTML&&n.host){let t=document.querySelector(`#${n.host}`);if(t){let i=document.createElement("div");i.innerHTML=n.outerHTML;let s=i.firstElementChild;s&&(s.id=e,t.appendChild(s),n.domElement=s)}}if(t=new v[i](n),!t)throw new Error("Failed to create Scrawl-canvas object from supplied packet")}if(t.packetFunctions.forEach((e=>this.actionPacketFunctions(t,e))),n.anchor&&t.anchor&&t.anchor.packetFunctions.forEach((e=>{t.anchor[e]=n.anchor[e],this.actionPacketFunctions(t.anchor,e),t.anchor.build()})),n.glyphStyles&&t.glyphStyles&&n.glyphStyles.forEach(((e,i)=>{K(e)&&t.setGlyphStyles(e,i)})),t)return t;throw new Error("Failed to process supplied packet")}throw new Error("Failed to process packet - JSON string holds incomplete data")}throw new Error("Failed to process packet - JSON string does not represent an array")}throw new Error("Failed to process packet - not a JSON string")}catch(t){return console.log(t),t}},t.actionPacketFunctions=function(t,e){let i=t[e];if(nt(i)&&null!==i&&i.substring)if("~~~"===i)t[e]=Y;else{let s,n,r;[s,n]=i.split("~~~"),s=s.split(","),s=s.map((t=>t.trim())),n.indexOf("[native code]")<0?(r=new Function(...s,n),t[e]=r.bind(t)):t[e]=Y}},t.clone=function(t=z){let e,i,s=this.name;this.name=t.name||"",t.useNewTicker?(i=this.ticker,this.ticker=null,e=this.saveAsPacket(),this.ticker=i):e=this.saveAsPacket(),this.name=s;let n=this.actionPacket(e);return this.packetFunctions.forEach((t=>{this[t]&&(n[t]=this[t])})),n=this.postCloneAction(n,t),n.set(t),n},t.postCloneAction=function(t,e){return t},t.kill=function(){return this.deregister()},t.makeName=function(t){return t&&t.substring&&x[`${this.lib}names`].indexOf(t)<0?this.name=t:this.name=W(),this},t.register=function(){if(!nt(this.name))throw new Error(`core/base error - register() name not set: ${this}`);let t=x[`${this.lib}names`],e=x[this.lib];return this.isArtefact&&(it(s,this.name),i[this.name]=this),this.isAsset&&(it(r,this.name),n[this.name]=this),it(t,this.name),e[this.name]=this,this},t.deregister=function(){if(!nt(this.name))throw new Error(`core/base error - deregister() name not set: ${this}`);let t=x[`${this.lib}names`],e=x[this.lib];return this.isArtefact&&(st(s,this.name),delete i[this.name]),this.isAsset&&(st(r,this.name),delete n[this.name]),st(t,this.name),delete e[this.name],this},t}Pt();const Animation=function(t=z){return this.makeName(t.name),this.order=nt(t.order)?t.order:this.defs.order,this.fn=t.fn||G,this.onRun=t.onRun||Y,this.onHalt=t.onHalt||Y,this.onKill=t.onKill||Y,this.register(),t.delay||this.run(),this};let Dt=Animation.prototype=Object.create(Object.prototype);Dt.type="Animation",Dt.lib="animation",Dt.isArtefact=!1,Dt.isAsset=!1,Dt=xt(Dt);Dt.defs=tt(Dt.defs,{order:1,fn:null,onRun:null,onHalt:null,onKill:null}),Dt.stringifyFunction=Y,Dt.processPacketOut=Y,Dt.finalizePacketOut=Y,Dt.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Dt.clone=N,Dt.run=function(){return this.onRun(),it(E,this.name),I(),setTimeout((()=>oe()),20),this},Dt.isRunning=function(){return E.indexOf(this.name)>=0},Dt.halt=function(){return this.onHalt(),st(E,this.name),I(),this},Dt.kill=function(){return this.onKill(),st(E,this.name),I(),this.deregister(),!0};const Rt=function(t){return!!t&&new Animation(t)};v.Animation=Animation;const Ft=[];let Et=!1,It=!1,Mt=!1,Tt=!1,Ht=!1,Bt=!1,Lt=!1,$t=!1;const jt={x:0,y:0,scrollX:0,scrollY:0,w:0,h:0,type:"mouse",prefersReducedMotion:!1,prefersDarkColorScheme:!1,prefersReduceTransparency:!1,prefersContrast:!1,prefersReduceData:!1,rawTouches:[]},Yt=window.matchMedia("(prefers-contrast: more)");Yt.addEventListener("change",(()=>{let t=Yt.matches;jt.prefersContrast!==t&&(jt.prefersContrast=t,Tt=!0)})),jt.prefersContrast=Yt.matches;const Xt=window.matchMedia("(prefers-reduced-motion: reduce)");Xt.addEventListener("change",(()=>{let t=Xt.matches;jt.prefersReducedMotion!==t&&(jt.prefersReducedMotion=t,Ht=!0)})),jt.prefersReducedMotion=Xt.matches;const Nt=window.matchMedia("(prefers-color-scheme: dark)");Nt.addEventListener("change",(()=>{let t=Nt.matches;jt.prefersDarkColorScheme!==t&&(jt.prefersDarkColorScheme=t,Bt=!0)})),jt.prefersDarkColorScheme=Nt.matches;const Gt=window.matchMedia("(prefers-reduced-transparency: reduce)");Gt.addEventListener("change",(()=>{let t=Gt.matches;jt.prefersReduceTransparency!==t&&(jt.prefersReduceTransparency=t,Lt=!0)})),jt.prefersReduceTransparency=Gt.matches;const zt=window.matchMedia("(prefers-reduced-data: reduce)");zt.addEventListener("change",(()=>{let t=zt.matches;jt.prefersReduceData!==t&&(jt.prefersReduceData=t,$t=!0)})),jt.prefersReduceData=zt.matches;const Wt=function(t){let e=document.documentElement.clientWidth,i=document.documentElement.clientHeight;jt.w===e&&jt.h===i||(jt.w=e,jt.h=i,It=!0,Mt=!0)},Vt=function(t){let e=window.pageXOffset,i=window.pageYOffset;jt.scrollX===e&&jt.scrollY===i||(jt.x+=e-jt.scrollX,jt.y+=i-jt.scrollY,jt.scrollX=e,jt.scrollY=i,It=!0)},Zt=function(t){let e=Math.round(t.pageX),i=Math.round(t.pageY);jt.x===e&&jt.y===i||(jt.type=navigator.pointerEnabled?"pointer":"mouse",jt.x=e,jt.y=i,It=!0)};let Ut=0,_t=16;const qt=function(){return _t},Qt=function(t){t&&t.toFixed&&!isNaN(t)&&(_t=t)},Kt=function(t,e=!0){if(jt.rawTouches.length=0,t.touches&&t.touches.length){jt.rawTouches.push(...t.touches);const e=t.touches[0],i=Math.round(e.pageX),s=Math.round(e.pageY);jt.x===i&&jt.y===s||(jt.type="touch",jt.x=i,jt.y=s)}else jt.type="touch",e&&(jt.x=0,jt.y=0);const i=Date.now();i>Ut+_t&&(Ut=i,Jt())},Jt=function(){for(let t=0,e=Ft.length;t<e;t++)te(Ft[t])},te=function(t){const e=i[t];if(e){e.here||(e.here={});const{here:t,domElement:i}=e;if(t.prefersContrast=jt.prefersContrast,t.prefersReducedMotion=jt.prefersReducedMotion,t.prefersDarkColorScheme=jt.prefersDarkColorScheme,t.prefersReduceTransparency=jt.prefersReduceTransparency,t.prefersReduceData=jt.prefersReduceData,Tt&&e.contrastActions(),Ht&&e.reducedMotionActions(),Bt&&e.colorSchemeActions(),Lt&&e.reducedTransparencyActions(),$t&&e.reducedDataActions(),i){const s=i.getBoundingClientRect(),n=Math.round(s.left+window.pageXOffset),r=Math.round(s.top+window.pageYOffset),o=s.top,a=s.height,l=window.innerHeight;t.w=Math.round(s.width),t.h=Math.round(a),t.type=jt.type;const h=o/l,c=(o+a)/l,u=(h+c)/2;t.inViewportTop=h,t.inViewportBase=c,t.inViewportCenter=u,e.localMouseListener?(t.localListener=!0,t.active=!1,t.normX=!!t.originalWidth&&t.x/t.originalWidth,t.normY=!!t.originalHeight&&t.y/t.originalHeight,t.offsetX=n,t.offsetY=r,t.x>e.activePadding&&t.x<t.originalWidth-e.activePadding&&t.y>0+e.activePadding&&t.y<t.originalHeight-e.activePadding&&(t.active=!0)):(t.localListener=!1,t.active=!0,t.x=Math.round(jt.x-n),t.y=Math.round(jt.y-r),t.normX=!!t.w&&t.x/t.w,t.normY=!!t.h&&t.y/t.h,t.offsetX=n,t.offsetY=r,(t.normX<0||t.normX>1||t.normY<0||t.normY>1)&&(t.active=!1));const d=jt.rawTouches;if(d.length){t.touches||(t.touches=[]),t.touches.length=0;for(let e=0,i=d.length;e<i;e++){const i=d[e];t.touches.push([Math.round(i.pageX-n),Math.round(i.pageY-r)])}}if("Canvas"===e.type&&e.updateBaseHere(t,e.fit),e.checkForResize&&!e.dirtyDimensions&&!e.dirtyDomDimensions){let[i,s]=e.currentDimensions;if("Canvas"===e.type){e.computedStyles||(e.computedStyles=window.getComputedStyle(e.domElement));let n=e.computedStyles,r=Math.floor(t.w-parseFloat(n.borderLeftWidth)-parseFloat(n.borderRightWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)),o=Math.floor(t.h-parseFloat(n.borderTopWidth)-parseFloat(n.borderBottomWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom));i===r&&s===o||e.set({dimensions:[r,o]})}else i===t.w&&s===t.h||e.set({dimensions:[t.w,t.h]})}}}},ee=Rt({name:"coreListenersTracker",order:0,delay:!0,fn:function(){if(!Ft.length)return!1;(Et&&It||Ht||Bt||Lt||$t)&&(Jt(),Et&&It&&(It=!1),(Ht||Bt||Lt||$t)&&(Ht=!1,Bt=!1,Lt=!1,$t=!1)),Mt&&(Mt=!1,function(){for(const[t,e]of Object.entries(h))"Phrase"===e.type&&(e.dirtyDimensions=!0,e.dirtyFont=!0)}())}}),ie=function(){ne("removeEventListener"),ne("addEventListener"),Et=!0,It=!0,ee.run()},se=function(){Et=!1,It=!1,ee.halt(),ne("removeEventListener")},ne=function(t){navigator.pointerEnabled||navigator.msPointerEnabled?(window[t]("pointermove",Zt,!1),window[t]("pointerup",Zt,!1),window[t]("pointerdown",Zt,!1),window[t]("pointerleave",Zt,!1),window[t]("pointerenter",Zt,!1)):(window[t]("mousemove",Zt,!1),window[t]("mouseup",Zt,!1),window[t]("mousedown",Zt,!1),window[t]("mouseleave",Zt,!1),window[t]("mouseenter",Zt,!1),window[t]("touchmove",Kt,{passive:!0}),window[t]("touchstart",Kt,{passive:!0}),window[t]("touchend",Kt,{passive:!0}),window[t]("touchcancel",Kt,{passive:!0})),window[t]("scroll",Vt,{passive:!0}),window[t]("resize",Wt,!1)},re=function(){Wt(),It=!0,Mt=!0},oe=function(){It=!0,Mt=!0},ae=function(t=Ωempty){if(!rt(t.event,t.origin,t.updates))return!1;let e=t.target.substring&&t.targetLibrarySection?x[t.targetLibrarySection][t.target]:t.target;if(!e)return!1;let i=t.event,s=t.origin,n=t.useNativeListener?mt:ct,r=t.useNativeListener?gt:ut,o=Y;t.preventDefault&&(o=t=>{t.preventDefault(),t.returnValue=!1});let a=q(t.setup)?t.setup:Y,l=q(t.callback)?t.callback:Y,h=function(i){o(i);let s=!(!i||!i.target)&&i.target.id;if(s){let n=t.updates[s];if(n){a();let t,s=n[0],r=n[1],o=i.target.value,h=!0;switch(r){case"float":t=parseFloat(o);break;case"int":t=parseInt(o,10);break;case"round":t=Math.round(o);break;case"roundDown":t=Math.floor(o);break;case"roundUp":t=Math.ceil(o);break;case"raw":t=o;break;case"string":t=`${o}`;break;case"boolean":t=!!nt(o)&&(o.substring?"true"===o.toLowerCase()||"false"!==o.toLowerCase()&&!!parseFloat(o):!!o);break;default:r.substring?t=`${parseFloat(o)}${r}`:h=!1}h&&("Group"===e.type?e.setArtefacts({[s]:t}):e.set({[s]:t}),l())}}};return n(i,h,s),function(){r(i,h,s)}},le=function(t=Ωempty){let{zone:e,coordinateSource:i,collisionGroup:s,startOn:n,endOn:r,updateOnStart:o,updateOnEnd:a,updateWhileMoving:l,exposeCurrentArtefact:h,preventTouchDefaultWhenDragging:c,resetCoordsToZeroOnTouchEnd:u}=t;if(!e)return new Error("dragZone constructor - no zone supplied");if(e.substring&&(e=artefact[e]),!e||["Canvas","Stack"].indexOf(e.type)<0)return new Error("dragZone constructor - zone object is not a Stack or Canvas wrapper");let f=e.domElement;if(!f)return new Error("dragZone constructor - zone does not contain a target DOM element");if(s?s.substring&&(s=d[s]):s="Canvas"===e.type?d[e.base.name]:d[e.name],!s||"Group"!==s.type)return new Error("dragZone constructor - unable to recover collisionGroup group");if(i?i.here?i=i.here:rt(i.x,i.y)||(i=!1):i="Canvas"===e.type?e.base.here:e.here,!i)return new Error("dragZone constructor - unable to discover a usable coordinateSource object");Array.isArray(n)||(n=["down"]),Array.isArray(r)||(r=["up"]),null==h&&(h=!1),null==c&&(c=!1),null==u&&(u=!0);let p=!1;K(o)&&(o=function(){p.artefact.set(t.updateOnStart)}),q(o)||(o=Y),K(a)&&(a=function(){p.artefact.set(t.updateOnEnd)}),q(a)||(a=Y),q(l)||(l=Y),Z(h)||(h=!1);const m=function(t){t&&t.cancelable&&(c&&p?(t.preventDefault(),t.returnValue=!1):c||(t.preventDefault(),t.returnValue=!1))},g=function(t={}){m(t);let e=t.type;"touchstart"!==e&&"touchcancel"!==e||Kt(t,u),p=s.getArtefactAt(i),p&&(p.artefact.pickupArtefact(i),o())},y=function(t={}){m(t),"touchmove"===t.type&&Kt(t),l()},b=function(t={}){m(t),"touchend"===t.type&&Kt(t,u),p&&(p.artefact.dropArtefact(),a(),p=!1)},S=function(){ut(n,g,f),ut("move",y,f),ut(r,b,f)};return ct(n,g,f),ct("move",y,f),ct(r,b,f),h?function(t=!1){if(Z(t)&&t)S();else{if(!t.substring)return p;"drop"===t&&b(),"kill"===t&&S()}}:S};var he=function(){var t=4022871197;return function(e){if(e){e=e.toString();for(var i=0;i<e.length;i++){var s=.02519603282416938*(t+=e.charCodeAt(i));s-=t=s>>>0,t=(s*=t)>>>0,t+=4294967296*(s-=t)}return 2.3283064365386963e-10*(t>>>0)}t=4022871197}},ce=function(t){return function(){var e,i,s=48,n=1,r=s,o=new Array(s),a=0,l=new he;for(e=0;e<s;e++)o[e]=l(Math.random());var h=function(){++r>=s&&(r=0);var t=1768863*o[r]+2.3283064365386963e-10*n;return o[r]=t-(n=0|t)},c=function(t){return Math.floor(t*(h()+11102230246251565e-32*(2097152*h()|0)))};c.string=function(t){var e,i="";for(e=0;e<t;e++)i+=String.fromCharCode(33+c(94));return i};var u=function(){var t=Array.prototype.slice.call(arguments);for(e=0;e<t.length;e++)for(i=0;i<s;i++)o[i]-=l(t[e]),o[i]<0&&(o[i]+=1)};return c.cleanString=function(t){return t=(t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[\x00-\x1F]/gi,"")).replace(/\n /,"\n")},c.hashString=function(t){for(t=c.cleanString(t),l(t),e=0;e<t.length;e++)for(a=t.charCodeAt(e),i=0;i<s;i++)o[i]-=l(a),o[i]<0&&(o[i]+=1)},c.seed=function(t){var e,i,s,n;null==t&&(t=Math.random()),"string"!=typeof t&&(e=t,i=function(t,e){return"function"==typeof e?e.toString():e},t=JSON.stringify(e,function(t,e){var i=[],s=[];return null==e&&(e=function(t,e){return i[0]===e?"[Circular ~]":"[Circular ~."+s.slice(0,i.indexOf(e)).join(".")+"]"}),function(n,r){if(i.length>0){var o=i.indexOf(this);~o?i.splice(o+1):i.push(this),~o?s.splice(o,1/0,n):s.push(n),~i.indexOf(r)&&(r=e.call(this,n,r))}else i.push(r);return null==t?r:t.call(this,n,r)}}(i,n),s)),c.initState(),c.hashString(t)},c.addEntropy=function(){var t=[];for(e=0;e<arguments.length;e++)t.push(arguments[e]);u(a+++(new Date).getTime()+t.join("")+Math.random())},c.initState=function(){for(l(),e=0;e<s;e++)o[e]=l(" ");n=1,r=s},c.done=function(){l=null},void 0!==t&&c.seed(t),c.range=function(t){return c(t)},c.random=function(){return c(Number.MAX_VALUE-1)/Number.MAX_VALUE},c.floatBetween=function(t,e){return c.random()*(e-t)+t},c.intBetween=function(t,e){return Math.floor(c.random()*(e-t+1))+t},c}()};const ue=function(t){return new ce(t)},State=function(t=z){return this.set(this.defs),this.lineDash=[],this};let de=State.prototype=Object.create(Object.prototype);de.type="State",de=xt(de),de.defs={fillStyle:"rgba(0,0,0,1)",strokeStyle:"rgba(0,0,0,1)",globalAlpha:1,globalCompositeOperation:"source-over",lineWidth:1,lineCap:"butt",lineJoin:"miter",lineDash:null,lineDashOffset:0,miterLimit:10,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"rgba(0,0,0,0)",font:"12px sans-serif",textAlign:"left",textBaseline:"top",filter:"none",imageSmoothingEnabled:!0,imageSmoothingQuality:"high"},de.processPacketOut=function(t,e,i){let s=!0;if("lineDash"===t)e.length||(s=i.indexOf("lineDash")>=0);else i.indexOf(t)<0&&e===this.defs[t]&&(s=!1);return s},de.finalizePacketOut=function(t,e){let i=t.fillStyle,s=t.strokeStyle;return i&&!i.substring&&(t.fillStyle=i.name),s&&!s.substring&&(t.strokeStyle=s.name),t},de.set=function(t=z){let e,i,s=Object.keys(t),n=s.length,r=this.defs;for(i=0;i<n;i++)e=s[i],"name"!=e&&void 0!==r[e]&&(this[e]=t[e],this.dirtyFilterIdentifier=!0);return this},de.get=function(t){let e,i;return e=this.defs[t],void 0!==e?(i=this[t],void 0!==i?i:e):void 0},de.getters;let fe=de.setters;de.deltaSetters,fe.fillStyle=function(t){let e;K(t)&&"styles"===t.lib?this.fillStyle=t:(e=k[t],e?this.fillStyle=e:t.includes("rgb")||t.includes("hsl")||t.includes("#")?this.fillStyle=t:this.fillStyle=window.scrawlEnvironmentColorChecker.checkColor(t))},fe.strokeStyle=function(t){let e;K(t)&&"styles"===t.lib?this.strokeStyle=t:(e=k[t],e?this.strokeStyle=e:t.includes("rgb")||t.includes("hsl")||t.includes("#")?this.strokeStyle=t:this.strokeStyle=window.scrawlEnvironmentColorChecker.checkColor(t))},fe.shadowColor=function(t){t.includes("rgb")||t.includes("hsl")||t.includes("#")?this.shadowColor=t:this.shadowColor=window.scrawlEnvironmentColorChecker.checkColor(t)},de.allKeys=Object.keys(de.defs),de.mainKeys=["filter","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality","shadowBlur","shadowOffsetX","shadowOffsetY"],de.lineKeys=["lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit"],de.styleKeys=["fillStyle","shadowColor","strokeStyle"],de.textKeys=["font"],de.getChanges=function(t,e){let i,s,n,r,o,a,l,c,u,d=this.mainKeys,f=this.lineKeys,p=this.styleKeys,m=this.textKeys,g=this.defs,y={},b=function(t,e){return void 0!==t[e]?t[e]:g[e]};for(t.substring&&(t=h[t]),n=0,r=d.length;n<r;n++)i=d[n],c=b(this,i),u=b(e,i),u!==c&&(y[i]=c);if(this.lineWidth||e.lineWidth)for(n=0,r=f.length;n<r;n++)if(i=f[n],c=b(this,i),u=b(e,i),"lineDash"==i){if(c.length||u.length)if(c.length!=u.length)y.lineDash=c;else{for(l=!1,o=0,a=c.length;o<a;o++)if(c[o]!=u[o]){l=!0;break}l&&(y.lineDash=c)}}else"lineWidth"==i?t.scaleOutline?(s=(c||1)*(t.scale||1),s!==u&&(y.lineWidth=s)):c!==u&&(y.lineWidth=c):u!==c&&(y[i]=c);for(n=0,r=p.length;n<r;n++)i=p[n],u=b(e,i),c=b(this,i),c.substring&&u!==c?y[i]=c:"Color"===c.type?(c=c.getData(),u!==c&&(y[i]=c)):y[i]=c;if("Phrase"===t.type)for(n=0,r=m.length;n<r;n++)i=m[n],c=b(this,i),u=b(e,i),u!==c&&(y[i]=c);return y},de.setStateFromEngine=function(t){let e,i=this.allKeys;for(let s=0,n=i.length;s<n;s++)e=i[s],this[e]=t[e];return this.lineDash=nt(t.lineDash)?t.lineDash:[],this.lineDashOffset=ot(t.lineDashOffset,0),t.textAlign=this.textAlign="left",t.textBaseline=this.textBaseline="top",this};const pe=function(t){return!!t&&new State(t)},me=["fillStyle","filter","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle"];v.State=State;const Coordinate=function(t,e){let i=[0,0];return Object.setPrototypeOf(i,Coordinate.prototype),t&&i.set(t,e),i};let ge=Coordinate.prototype=Object.create(Array.prototype);ge.constructor=Coordinate,ge.type="Coordinate",ge.set=function(t,e){return nt(t)&&("Coordinate"===t.type?this.setFromArray(t):"Vector"===t.type?this.setFromVector(t):"Quaternion"===t.type?this.setFromVector(t.v):Array.isArray(t)?this.setFromArray(t):nt(e)&&this.setFromArray([t,e])),this},ge.setFromArray=function(t){return this[0]=t[0],this[1]=t[1],this},ge.setFromVector=function(t){return this[0]=t.x,this[1]=t.y,this},ge.zero=function(){return this[0]=0,this[1]=0,this},ge.vectorAdd=function(t){return this[0]+=t.x,this[1]+=t.y,this},ge.vectorSubtract=function(t){return this[0]-=t.x,this[1]-=t.y,this},ge.add=function(t){return this[0]+=t[0],this[1]+=t[1],this},ge.subtract=function(t){return this[0]-=t[0],this[1]-=t[1],this},ge.multiply=function(t){return this[0]*=t[0],this[1]*=t[1],this},ge.divide=function(t){let[e,i]=t;return e&&i&&(this[0]/=e,this[1]/=i),this},ge.scalarMultiply=function(t){return this[0]*=t,this[1]*=t,this},ge.scalarDivide=function(t){return t&&t.toFixed&&(this[0]/=t,this[1]/=t),this},ge.getMagnitude=function(){return Math.hypot(this[0],this[1])},ge.rotate=function(t){let e,i,s=this[0],n=this[1];return e=Math.atan2(n,s),e+=.01745329251*t,i=Math.hypot(s,n),this[0]=i*Math.cos(e),this[1]=i*Math.sin(e),this},ge.reverse=function(){return this[0]=-this[0],this[1]=-this[1],this},ge.getDotProduct=function(t){return this[0]*t[0]+this[1]*t[1]},ge.normalize=function(){let t=this.getMagnitude();return t>0&&(this[0]/=t,this[1]/=t),this};const ye=[],be=function(t,e){ye.length||ye.push(new Coordinate);let i=ye.shift();return i.set(t,e),i},Se=function(t){t&&"Coordinate"===t.type&&ye.push(t.zero())},ke=function(t,e){return new Coordinate(t,e)};function Ae(t=z){t.defs=tt(t.defs,{sourceLoaded:!1,source:null,subscribers:null}),t.packetExclusions=it(t.packetExclusions,["sourceLoaded","source","subscribers"]),t.finalizePacketOut=function(t,e){return this.subscribers&&this.subscribers.length&&(t.subscribers=this.subscribers.map((t=>t.name))),t},t.kill=function(t=!1){return t&&this.source&&this.source.remove(),this.deregister()},t.getters;let e=t.setters;return t.deltaSetters,e.source=function(t){t&&this.sourceLoaded&&this.notifySubscribers()},e.subscribers=Y,t.assetConstructor=function(t){return this.makeName(t.name),this.register(),this.subscribers=[],this.set(this.defs),this.set(t),t.subscribe&&this.subscribers.push(t.subscribe),this},t.subscribe=function(t){if(t&&t.name){let e=t.name;this.subscribers.every((t=>t.name!==e))&&this.subscribeAction(t)}},t.subscribeAction=function(t){t&&(this.subscribers.push(t),t.asset=this,t.source=this.source,this.notifySubscriber(t))},t.unsubscribe=function(t){if(t&&t.name){let e=t.name,i=this.subscribers.findIndex((t=>t.name===e));i>=0&&(t.source=null,t.asset=null,t.sourceNaturalHeight=0,t.sourceNaturalWidth=0,t.sourceLoaded=!1,this.subscribers.splice(i,1))}},t.notifySubscribers=function(){this.subscribers.forEach((t=>this.notifySubscriber(t)),this)},t.notifySubscriber=function(t){t.sourceNaturalWidth=this.sourceNaturalWidth,t.sourceNaturalHeight=this.sourceNaturalHeight,t.sourceLoaded=this.sourceLoaded,t.source=this.source,t.dirtyImage=!0,t.dirtyCopyStart=!0,t.dirtyCopyDimensions=!0,t.dirtyImageSubscribers=!0,t.dirtyFilterIdentifier=!0},t}v.Coordinate=Coordinate;const ImageAsset=function(t=z){return this.assetConstructor(t)};let we=ImageAsset.prototype=Object.create(Object.prototype);we.type="Image",we.lib="asset",we.isArtefact=!1,we.isAsset=!0,we=xt(we),we=Ae(we);we.defs=tt(we.defs,{intrinsicDimensions:null}),we.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},we.stringifyFunction=Y,we.processPacketOut=Y,we.finalizePacketOut=Y,we.clone=N;let ve=we.getters,Ce=we.setters;we.deltaSetters,ve.width=function(){return this.sourceNaturalWidth||this.source.naturalWidth||0},ve.height=function(){return this.sourceNaturalHeight||this.source.naturalHeight||0},Ce.source=function(t){t&&(["IMG","PICTURE"].indexOf(t.tagName.toUpperCase())>=0&&(this.source=t,this.sourceNaturalWidth=t.naturalWidth,this.sourceNaturalHeight=t.naturalHeight,this.sourceLoaded=t.complete),this.sourceLoaded&&this.notifySubscribers())},Ce.currentSrc=function(t){this.currentSrc=t,this.currentFile=this.currentSrc.split("/").pop()},we.checkSource=function(t,e){let i=this.source,s="element";if(this.sourceLoaded){let n=this.intrinsicDimensions[this.currentFile];switch(this.currentSrc!==i.currentSrc?(this.set({currentSrc:i.currentSrc}),n=this.intrinsicDimensions[this.currentFile],s=n?"intrinsic":"zero"):n&&(s="intrinsic"),s){case"zero":this.sourceNaturalWidth=0,this.sourceNaturalHeight=0,this.notifySubscribers();break;case"intrinsic":this.sourceNaturalWidth===n[0]&&this.sourceNaturalHeight===n[1]||(this.sourceNaturalWidth=n[0],this.sourceNaturalHeight=n[1],this.notifySubscribers());break;default:this.sourceNaturalWidth===i.naturalWidth&&this.sourceNaturalHeight===i.naturalHeight&&this.sourceNaturalWidth===t&&this.sourceNaturalHeight===e||(this.sourceNaturalWidth=i.naturalWidth,this.sourceNaturalHeight=i.naturalHeight,this.notifySubscribers())}}};const Oe=[],Pe=[],xe=function(...t){let e=/.*\/(.*?)\./,i=[];return t.forEach((t=>{let s,n,r,o,a=!1,l=!1;if(t.substring){let i=e.exec(t);s=i&&i[1]?i[1]:"",n=t,r="",o=!1,l=!0}else(t=!!K(t)&&t)&&t.src&&(s=t.name||"",n=t.src,r=t.className||"",o=t.visibility||!1,t.parent&&(a=document.querySelector(t.parent)),l=!0);if(l){let t=Ie({name:s,intrinsicDimensions:{}}),e=document.createElement("img");e.name=s,e.className=r,e.crossorigin="anonymous",e.style.display=o?"block":"none",a&&a.appendChild(e),e.onload=()=>{t.set({source:e})},e.src=n,t.set({source:e}),i.push(s)}else i.push(!1)})),i},De=function(t){let e=/.*\/(.*?)\./;document.querySelectorAll(t).forEach((t=>{let i;if(["IMG","PICTURE"].indexOf(t.tagName.toUpperCase())>=0){if(t.id||t.name)i=t.id||t.name;else{let s=e.exec(t.src);i=s&&s[1]?s[1]:""}let s=t.dataset.dimensions||{};s.substring&&(s=JSON.parse(s));let n=Ie({name:i,source:t,intrinsicDimensions:s,currentSrc:t.currentSrc});t.onload=()=>{n.set({source:t})}}}))},Re=function(t,e=!1){let i=t.substring?a[t]||o[t]:t;"Canvas"===i.type&&(i=i.base),"Cell"===i.type&&(i.stashOutput=!0,e&&(i.stashOutputAsAsset=!0))},Fe=function(t,e=!1){let i;t&&!t.substring?"Group"===t.type?i=t:"Cell"===t.type?i=d[t.name]:"Canvas"===t.type&&(i=d[t.base.name]):t&&t.substring&&(i=d[t]),i&&(i.stashOutput=!0,e&&(i.stashOutputAsAsset=!0))},Ee=function(t,e=!1){let s=t.substring?i[t]:t;s.isArtefact&&(s.stashOutput=!0,e&&(s.stashOutputAsAsset=!0))},Ie=function(t){return!!t&&new ImageAsset(t)};function Me(t=z){t.defs=tt(t.defs,{group:null,visibility:!0,order:0,start:null,handle:null,offset:null,dimensions:null,pivoted:null,mimicked:null,particle:null,lockTo:null,bringToFrontOnDrag:!0,ignoreDragForX:!1,ignoreDragForY:!1,scale:1,roll:0,noUserInteraction:!1,noPositionDependencies:!1,noCanvasEngineUpdates:!1,noFilters:!1,noPathUpdates:!1,purge:null}),t.packetExclusions=it(t.packetExclusions,["pathObject","mimicked","pivoted"]),t.packetExclusionsByRegex=it(t.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),t.packetCoordinates=it(t.packetCoordinates,["start","handle","offset"]),t.packetObjects=it(t.packetObjects,["group"]),t.packetFunctions=it(t.packetFunctions,[]),t.processPacketOut=function(t,e,i){let s=!0;if("lockTo"===t)"start"===e[0]&&"start"===e[1]&&(s=i.indexOf("lockTo")>=0);else"entity"===this.lib?s=this.processEntityPacketOut(t,e,i):this.isArtefact&&(s=this.processDOMPacketOut(t,e,i));return s},t.handlePacketAnchor=function(t,e){if(this.anchor){let i=JSON.parse(this.anchor.saveAsPacket(e))[3];t.anchor=i}return t},t.kill=function(t=!1,e=!1){let s=this.name;return Object.entries(d).forEach((([t,e])=>{e.artefacts.indexOf(s)>=0&&e.removeArtefacts(s)})),this.anchor&&this.demolishAnchor(),Object.entries(i).forEach((([t,e])=>{e.name!==s&&(e.pivot&&e.pivot.name===s&&e.set({pivot:!1}),e.mimic&&e.mimic.name===s&&e.set({mimic:!1}),e.path&&e.path.name===s&&e.set({path:!1}),e.generateAlongPath&&e.generateAlongPath.name===s&&e.set({generateAlongPath:!1}),e.generateInArea&&e.generateInArea.name===s&&e.set({generateInArea:!1}),e.artefact&&e.artefact.name===s&&e.set({artefact:!1}),Array.isArray(e.pins)&&e.pins.forEach(((t,i)=>{K(t)&&t.name===s&&e.removePinAt(i)})))})),Object.entries(S).forEach((([t,e])=>{e.checkForTarget(s)&&e.removeFromTargets(this)})),this.factoryKill(t,e),this.deregister(),this},t.factoryKill=Y;let e=t.getters,s=t.setters,n=t.deltaSetters;return e.positionX=function(){return this.currentStampPosition[0]},e.positionY=function(){return this.currentStampPosition[1]},e.position=function(){return[].concat(this.currentStampPosition)},e.startX=function(){return this.currentStart[0]},e.startY=function(){return this.currentStart[1]},e.start=function(){return[].concat(this.currentStart)},s.startX=function(t){null!=t&&(this.start[0]=t,this.dirtyStart=!0)},s.startY=function(t){null!=t&&(this.start[1]=t,this.dirtyStart=!0)},s.start=function(t,e){this.setCoordinateHelper("start",t,e),this.dirtyStart=!0},n.startX=function(t){let e=this.start;e[0]=B(e[0],t),this.dirtyStart=!0},n.startY=function(t){let e=this.start;e[1]=B(e[1],t),this.dirtyStart=!0},n.start=function(t,e){this.setDeltaCoordinateHelper("start",t,e),this.dirtyStart=!0},e.handleX=function(){return this.currentHandle[0]},e.handleY=function(){return this.currentHandle[1]},e.handle=function(){return[].concat(this.currentHandle)},s.handleX=function(t){null!=t&&(this.handle[0]=t,this.dirtyHandle=!0)},s.handleY=function(t){null!=t&&(this.handle[1]=t,this.dirtyHandle=!0)},s.handle=function(t,e){this.setCoordinateHelper("handle",t,e),this.dirtyHandle=!0},n.handleX=function(t){let e=this.handle;e[0]=B(e[0],t),this.dirtyHandle=!0},n.handleY=function(t){let e=this.handle;e[1]=B(e[1],t),this.dirtyHandle=!0},n.handle=function(t,e){this.setDeltaCoordinateHelper("handle",t,e),this.dirtyHandle=!0},e.offsetX=function(){return this.currentOffset[0]},e.offsetY=function(){return this.currentOffset[1]},e.offset=function(){return[].concat(this.currentOffset)},s.offsetX=function(t){null!=t&&(this.offset[0]=t,this.dirtyOffset=!0)},s.offsetY=function(t){null!=t&&(this.offset[1]=t,this.dirtyOffset=!0)},s.offset=function(t,e){this.setCoordinateHelper("offset",t,e),this.dirtyOffset=!0},n.offsetX=function(t){let e=this.offset;e[0]=B(e[0],t),this.dirtyOffset=!0},n.offsetY=function(t){let e=this.offset;e[1]=B(e[1],t),this.dirtyOffset=!0},n.offset=function(t,e){this.setDeltaCoordinateHelper("offset",t,e),this.dirtyOffset=!0},e.width=function(){return this.currentDimensions[0]},e.height=function(){return this.currentDimensions[1]},e.dimensions=function(){return[].concat(this.currentDimensions)},s.width=function(t){null!=t&&(this.dimensions[0]=t,this.dirtyDimensions=!0)},s.height=function(t){null!=t&&(this.dimensions[1]=t,this.dirtyDimensions=!0)},s.dimensions=function(t,e){this.setCoordinateHelper("dimensions",t,e),this.dirtyDimensions=!0},n.width=function(t){let e=this.dimensions;e[0]=B(e[0],t),this.dirtyDimensions=!0},n.height=function(t){let e=this.dimensions;e[1]=B(e[1],t),this.dirtyDimensions=!0},n.dimensions=function(t,e){this.setDeltaCoordinateHelper("dimensions",t,e),this.dirtyDimensions=!0},s.particle=function(t){Z(t)&&!t?(this.particle=null,"particle"===this.lockTo[0]&&(this.lockTo[0]="start"),"particle"===this.lockTo[1]&&(this.lockTo[1]="start"),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0):(this.particle=t,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)},s.lockTo=function(t){Array.isArray(t)?(this.lockTo[0]=t[0],this.lockTo[1]=t[1]):(this.lockTo[0]=t,this.lockTo[1]=t),this.dirtyLock=!0,this.dirtyStampPositions=!0},s.lockXTo=function(t){this.lockTo[0]=t,this.dirtyLock=!0,this.dirtyStampPositions=!0},s.lockYTo=function(t){this.lockTo[1]=t,this.dirtyLock=!0,this.dirtyStampPositions=!0},e.roll=function(){return this.currentRotation},s.roll=function(t){this.roll=t,this.dirtyRotation=!0},n.roll=function(t){this.roll+=t,this.dirtyRotation=!0},e.scale=function(){return this.currentScale},s.scale=function(t){this.scale=t,this.dirtyScale=!0},n.scale=function(t){this.scale+=t,this.dirtyScale=!0},s.host=function(t){if(t){let e=i[t];e&&e.here?this.host=e.name:this.host=t}else this.host="";this.dirtyDimensions=!0,this.dirtyHandle=!0,this.dirtyStart=!0,this.dirtyOffset=!0},s.group=function(t){let e;t&&(this.group&&"Group"===this.group.type&&this.group.removeArtefacts(this.name),t.substring?(e=d[t],this.group=e||t):this.group=t),this.group&&"Group"===this.group.type&&this.group.addArtefacts(this.name)},t.purgeArtefact=function(t){return t.substring&&(t="all"===t?["pivot","mimic","path","filter"]:[t]),Array.isArray(t)&&t.forEach((t=>function(t,e){switch(e){case"pivot":delete t.pivot,delete t.pivotCorner,delete t.pivotPin,delete t.addPivotHandle,delete t.addPivotOffset,delete t.addPivotRotation;break;case"mimic":delete t.mimic,delete t.useMimicDimensions,delete t.useMimicScale,delete t.useMimicStart,delete t.useMimicHandle,delete t.useMimicOffset,delete t.useMimicRotation,delete t.useMimicFlip,delete t.addOwnDimensionsToMimic,delete t.addOwnScaleToMimic,delete t.addOwnStartToMimic,delete t.addOwnHandleToMimic,delete t.addOwnOffsetToMimic,delete t.addOwnRotationToMimic;break;case"path":delete t.path,delete t.pathPosition,delete t.addPathHandle,delete t.addPathOffset,delete t.addPathRotation,delete t.constantPathSpeed;break;case"filter":delete t.filter,delete t.filters,delete t.isStencil}}(this,t))),this},t.initializePositions=function(){this.dimensions=ke(),this.start=ke(),this.handle=ke(),this.offset=ke(),this.currentDimensions=ke(),this.currentStart=ke(),this.currentHandle=ke(),this.currentOffset=ke(),this.currentDragOffset=ke(),this.currentDragCache=ke(),this.currentStartCache=ke(),this.currentStampPosition=ke(),this.currentStampHandlePosition=ke(),this.delta={},this.deltaConstraints={},this.lockTo=["start","start"],this.pivoted=[],this.mimicked=[],this.dirtyScale=!0,this.dirtyDimensions=!0,this.dirtyLock=!0,this.dirtyStart=!0,this.dirtyOffset=!0,this.dirtyHandle=!0,this.dirtyRotation=!0,this.isBeingDragged=!1,this.initializeDomPositions()},t.initializeDomPositions=Y,t.setCoordinateHelper=function(t,e,i){let s=this[t];Array.isArray(e)?(s[0]=e[0],s[1]=e[1]):K(e)?at(e.x,e.y)?(s[0]=ot(e.x,s[0]),s[1]=ot(e.y,s[1])):(s[0]=ot(e.width,e.w,s[0]),s[1]=ot(e.height,e.h,s[1])):(s[0]=e,s[1]=i)},t.setDeltaCoordinateHelper=function(t,e,i){let s=this[t],n=s[0],r=s[1];Array.isArray(e)?(s[0]=B(n,e[0]),s[1]=B(r,e[1])):K(e)?at(e.x,e.y)?(s[0]=B(n,ot(e.x,0)),s[1]=B(r,ot(e.y,0))):(s[0]=B(n,ot(e.width,e.w,0)),s[1]=B(r,ot(e.height,e.h,0))):(s[0]=B(n,e),s[1]=B(r,i))},t.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){let t=i[this.host];if(t)return this.currentHost=t,this.dirtyHost=!0,this.currentHost}return jt},t.getHere=function(){let t=this.getHost();if(t){if(t.here&&Object.keys(t.here))return t.here;if(t.currentDimensions){let e=t.currentDimensions;if(e)return{w:e[0],h:e[1]}}}return jt},t.cleanPosition=function(t,e,i){let s,n;for(let r=0;r<2;r++)s=e[r],n=i[r],s.toFixed?t[r]=s:t[r]="left"===s||"top"===s?0:"right"===s||"bottom"===s?n:"center"===s?n/2:parseFloat(s)/100*n;this.dirtyFilterIdentifier=!0},t.cleanScale=function(){this.dirtyScale=!1;let t,e=this.scale,i=this.mimic,s=this.currentScale;i&&this.useMimicScale?i.currentScale?(t=i.currentScale,this.addOwnScaleToMimic&&(t+=e)):(t=e,this.dirtyMimicScale=!0):t=e,this.currentScale=t,this.dirtyDimensions=!0,this.dirtyHandle=!0,s!==this.currentScale&&(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicScale=!0),this.dirtyFilterIdentifier=!0},t.cleanDimensions=function(){this.dirtyDimensions=!1;let t=this.getHost(),e=this.dimensions,i=this.currentDimensions;if(t){let s=t.currentDimensions?t.currentDimensions:[t.w,t.h],[n,r]=e,o=i[0],a=i[1];n.substring&&(n=parseFloat(n)/100*s[0]),r.substring&&(r="auto"===r?0:parseFloat(r)/100*s[1]);let l,h=this.mimic;h&&h.name&&this.useMimicDimensions&&(l=h.currentDimensions),l?(i[0]=this.addOwnDimensionsToMimic?l[0]+n:l[0],i[1]=this.addOwnDimensionsToMimic?l[1]+r:l[1]):(i[0]=n,i[1]=r),this.cleanDimensionsAdditionalActions(),this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0,o===i[0]&&a===i[1]||(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicDimensions=!0),this.dirtyFilterIdentifier=!0}else this.dirtyDimensions=!0},t.cleanDimensionsAdditionalActions=Y,t.cleanLock=function(){this.dirtyLock=!1,this.dirtyStart=!0,this.dirtyHandle=!0},t.cleanStart=function(){let t,e,i=this.getHost();i&&(this.dirtyStart=!1,rt(i.w,i.h)?(t=i.w,e=i.h):i.currentDimensions?[t,e]=i.currentDimensions:this.dirtyStart=!0),this.dirtyStart||(this.cleanPosition(this.currentStart,this.start,[t,e]),this.dirtyStampPositions=!0)},t.cleanOffset=function(){let t,e,i=this.getHost();i&&(this.dirtyOffset=!1,rt(i.w,i.h)?(t=i.w,e=i.h):i.currentDimensions?[t,e]=i.currentDimensions:this.dirtyOffset=!0),this.dirtyStart||(this.cleanPosition(this.currentOffset,this.offset,[t,e]),this.dirtyStampPositions=!0,this.mimicked&&this.mimicked.length&&(this.dirtyMimicOffset=!0))},t.cleanHandle=function(){this.dirtyHandle=!1;let t=this.currentHandle;this.cleanPosition(t,this.handle,this.currentDimensions),this.dirtyStampHandlePositions=!0,this.mimicked&&this.mimicked.length&&(this.dirtyMimicHandle=!0)},t.cleanRotation=function(){this.dirtyRotation=!1;let t,e=this.roll,i=this.currentRotation,s=this.path,n=this.mimic,r=this.pivot,o=this.lockTo;if(s&&o.indexOf("path")>=0){if(t=e,this.addPathRotation){let e=this.getPathData();e&&(t+=e.angle)}}else n&&this.useMimicRotation&&o.indexOf("mimic")>=0?nt(n.currentRotation)?(t=n.currentRotation,this.addOwnRotationToMimic&&(t+=e)):this.dirtyMimicRotation=!0:(t=e,r&&this.addPivotRotation&&o.indexOf("pivot")>=0&&(nt(r.currentRotation)?t+=r.currentRotation:this.dirtyPivotRotation=!0));this.currentRotation=t,t!==i&&(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicRotation=!0),this.dirtyFilterIdentifier=!0},t.cleanStampPositions=function(){this.dirtyStampPositions=!1;let{currentStampPosition:t,currentStart:e,currentOffset:i,currentStartCache:s,currentDragOffset:n}=this,[r,o]=t;if(this.noPositionDependencies)t[0]=e[0],t[1]=e[1];else{let{isBeingDragged:r,lockTo:o,pivot:a,pivotCorner:l,pivotPin:h,addPivotOffset:c,path:u,addPathOffset:d,mimic:p,useMimicStart:m,useMimicOffset:g,addOwnStartToMimic:y,addOwnOffsetToMimic:b,particle:S,ignoreDragForX:k,ignoreDragForY:A}=this;const w=function(t){return("pivot"!==t||a)&&("path"!==t||u)&&("mimic"!==t||p)&&("particle"!==t||f)?t:"start"},v={start:function(t){t.setFromArray(e).add(i)},path:function(t){x?(t.setFromVector(x),d||t.subtract(u.currentOffset)):t.setFromArray(e).add(i)},pivot:function(t){l&&a.getCornerCoordinate?t.setFromArray(a.getCornerCoordinate(l)):"Polyline"==a.type?t.setFromArray(a.getPinAt(h)):t.setFromArray(a.currentStampPosition),c||t.subtract(a.currentOffset),t.add(i)},mimic:function(t){m||g?(t.setFromArray(p.currentStampPosition),m&&y&&t.add(e),g&&b&&t.add(i),m||t.subtract(p.currentStart).add(e),g||t.subtract(p.currentOffset).add(i)):t.setFromArray(e).add(i)},particle:function(t){S.substring&&(S=f[S]),S?t.setFromVector(S.position):t.setFromArray(e).add(i)},mouse:function(t){t.setFromVector(P),r&&(s.setFromArray(t),t.add(n)),t.add(i)}};let C,O,P,x,D=be(),R=!1;if(D.length=0,r)D.push(k?w(o[0]):"mouse"),D.push(A?w(o[1]):"mouse"),R=!0,this.getCornerCoordinate&&this.cleanPathObject();else for(C=0;C<2;C++)O=w(o[C]),"mouse"===O&&(R=!0),"start"!==O&&(this.dirtyFilterIdentifier=!0),D.push(O);R&&(P=this.getHere()),D.indexOf("path")>=0&&(x=this.getPathData());let[F,E]=D,I=be(),M=be();v[F](I),F==E?M.setFromArray(I):v[E](M),t[0]=I[0],t[1]=M[1],Se(D)}r===t[0]&&o===t[1]||(this.dirtyPositionSubscribers=!0)},t.cleanStampHandlePositions=function(){this.dirtyStampHandlePositions=!1;let t=this.currentStampHandlePosition,e=this.currentHandle,i=t[0],s=t[1];if(this.noPositionDependencies)t[0]=e[0],t[1]=e[1];else{let i,s,n,r=this.lockTo,o=this.pivot,a=this.path,l=this.mimic;for(s=0;s<2;s++){switch(i=r[s],"pivot"!==i||o||(i="start"),"path"!==i||a||(i="start"),"mimic"!==i||l||(i="start"),n=e[s],"start"!==i&&(this.dirtyFilterIdentifier=!0),i){case"pivot":this.addPivotHandle&&(n+=o.currentHandle[s]);break;case"path":this.addPathHandle&&(n+=a.currentHandle[s]);break;case"mimic":this.useMimicHandle&&(n=l.currentHandle[s],this.addOwnHandleToMimic&&(n+=e[s]))}t[s]=n}}this.cleanStampHandlePositionsAdditionalActions(),i===t[0]&&s===t[1]||(this.dirtyPositionSubscribers=!0)},t.cleanStampHandlePositionsAdditionalActions=Y,t.checkHit=function(t=[],e){if(this.noUserInteraction)return!1;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();let i=Array.isArray(t)?t:[t],s=!1;e||(e=qe(),s=!0);let n,r,o=e.engine,a=this.currentStampPosition,l=a[0],h=a[1];if(i.some((t=>{if(Array.isArray(t))n=t[0],r=t[1];else{if(!rt(t,t.x,t.y))return!1;n=t.x,r=t.y}return!(!n.toFixed||!r.toFixed||isNaN(n)||isNaN(r))&&(e.rotateDestination(o,l,h,this),o.isPointInPath(this.pathObject,n,r,this.winding))}),this)){let t=this.checkHitReturn(n,r,e);return s&&Qe(e),t}return s&&Qe(e),!1},t.checkHitReturn=function(t,e,i){return{x:t,y:e,artefact:this}},t.pickupArtefact=function(t=z){let{x:e,y:i}=t;return rt(e,i)&&(this.isBeingDragged=!0,this.currentDragCache.set(this.currentDragOffset),"start"===this.lockTo[0]?this.currentDragOffset[0]=this.currentStart[0]-e:"pivot"===this.lockTo[0]&&this.pivot?this.currentDragOffset[0]=this.pivot.get("startX")-e:"mimic"===this.lockTo[0]&&this.mimic&&(this.currentDragOffset[0]=this.mimic.get("startX")-e),"start"===this.lockTo[1]?this.currentDragOffset[1]=this.currentStart[1]-i:"pivot"===this.lockTo[1]&&this.pivot?this.currentDragOffset[1]=this.pivot.get("startY")-i:"mimic"===this.lockTo[1]&&this.mimic&&(this.currentDragOffset[1]=this.mimic.get("startY")-i),this.bringToFrontOnDrag&&(this.order+=9999,this.group.batchResort=!0),nt(this.dirtyPathObject)&&(this.dirtyPathObject=!0)),this},t.dropArtefact=function(){return this.start.set(this.currentStartCache).add(this.currentDragOffset),this.dirtyStart=!0,this.currentDragOffset.set(this.currentDragCache),this.bringToFrontOnDrag&&(this.order-=9999,this.order<0&&(this.order=0),this.group.batchResort=!0),nt(this.dirtyPathObject)&&(this.dirtyPathObject=!0),this.isBeingDragged=!1,this},t.updatePositionSubscribers=function(){this.dirtyPositionSubscribers=!1,this.pivoted&&this.pivoted.length&&this.updatePivotSubscribers(),this.mimicked&&this.mimicked.length&&this.updateMimicSubscribers(),this.pathed&&this.pathed.length&&this.updatePathSubscribers()},t.updatePivotSubscribers=Y,t.updateMimicSubscribers=Y,t.updatePathSubscribers=Y,t.updateImageSubscribers=Y,t}function Te(t=z){let e={delta:null,noDeltaUpdates:!1,deltaConstraints:null,checkDeltaConstraints:!1,performDeltaChecks:!1};t.defs=tt(t.defs,e),tt(t,e);let i=t.setters;return t.deltaSetters,i.delta=function(t=z){t&&(this.delta=et(this.delta,t))},i.deltaConstraints=function(t=z){t&&(this.deltaConstraints=et(this.deltaConstraints,t))},t.updateByDelta=function(){return this.setDelta(this.delta),this.checkDeltaConstraints&&this.performDeltaConstraintsChecks(),this},t.reverseByDelta=function(){let t={};const e=this.delta,i=Object.keys(e),s=i.length;for(let n,r,o=0;o<s;o++)n=i[o],r=e[n],r=r.substring?-parseFloat(r)+"%":-r,t[n]=r;return this.setDelta(t),this.checkDeltaConstraints&&this.performDeltaConstraintsChecks(),this},t.performDeltaConstraintsChecks=function(){const{delta:t,deltaConstraints:e}=this;if(this.performDeltaChecks){const i=Object.keys(e),s=i.length;let n,r,o,a,l,h,c,u,d,f,p,m,g,y,b,S;for(m=0;m<s;m++)if(n=i[m],o=e[n],Array.isArray(o)&&3===o.length)if([a,l,h]=e[n],g=!!a.substring,g){if(r=["startX","startY","handleX","handleY","offsetX","offsetY","width","height"].indexOf(n),d=!1,f=0,r>=0?(r<2?d=this.start:r<4?d=this.handle:r<6?d=this.offset:r<8&&(d=this.dimensions),["startY","handleY","offsetY","height"].indexOf(n)>=0&&(f=1),p=d[f]):p=this.get(n),y=parseFloat(a),b=parseFloat(l),S=parseFloat(p),c="",S<y?(c=h,u=0):S>b&&(c=h,u=1),c)switch(c){case"reverse":t[n]=-parseFloat(t[n])+"%",this.set({[n]:S+parseFloat(t[n])+"%"});break;case"loop":u?this.set({[n]:S-(b-y)+"%"}):this.set({[n]:S+(b-y)+"%"})}}else if(p=this.get(n),c="",p<a?(c=h,u=0):p>l&&(c=h,u=1),c)switch(c){case"reverse":t[n]=-t[n],this.set({[n]:p+t[n]});break;case"loop":u?this.set({[n]:p-(l-a)}):this.set({[n]:p+(l-a)})}}else this.performDeltaChecks=!0},t.setDeltaValues=function(t=z){const e=this.delta,i=Object.keys(t),s=i.length;for(let n,r,o,a,l,h=0;h<s;h++)switch(n=i[h],r=t[n],l=e[n],r.indexOf(":")<0?(o=r,a=!1):[o,a]=r.split(":"),o){case"newString":null!=a&&(e[n]=a);break;case"newNumber":null!=a&&(e[n]=parseFloat(a));break;case"remove":delete e[n];break;case"update":null!=a&&(e[n]=l.substring?a:parseFloat(a));break;case"reverse":a=l.substring?-parseFloat(l)+"%":-l,e[n]=a;break;case"add":l.substring?a=parseFloat(l)+parseFloat(a)+"%":a+=l,e[n]=a;break;case"multiply":l.substring?a=parseFloat(l)*parseFloat(a)+"%":a*=l,e[n]=a}return this},t}function He(t=z){let e={pivot:"",pivotCorner:"",pivotPin:0,addPivotHandle:!1,addPivotOffset:!0,addPivotRotation:!1};t.defs=tt(t.defs,e),tt(t,e),t.packetObjects=it(t.packetObjects,["pivot"]),t.getters;let s=t.setters;return t.deltaSetters,s.pivot=function(t){if(Z(t)&&!t)this.pivot=null,"pivot"===this.lockTo[0]&&(this.lockTo[0]="start"),"pivot"===this.lockTo[1]&&(this.lockTo[1]="start"),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{let e=this.pivot,s=this.name,r=t.substring?i[t]:t;r||(r=n[t],r&&"Cell"!==r.type&&(r=!1)),r&&r.name&&(e&&e.name!==r.name&&st(e.pivoted,s),it(r.pivoted,s),this.pivot=r,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)}},t.pivotCorners=["topLeft","topRight","bottomRight","bottomLeft"],s.pivotCorner=function(t){this.pivotCorners.indexOf(t)>=0&&(this.pivotCorner=t)},s.addPivotHandle=function(t){this.addPivotHandle=t,this.dirtyHandle=!0},s.addPivotOffset=function(t){this.addPivotOffset=t,this.dirtyOffset=!0},s.addPivotRotation=function(t){this.addPivotRotation=t,this.dirtyRotation=!0},t.updatePivotSubscribers=function(){this.pivoted.forEach((t=>{let e=i[t];e||(e=n[t],e&&"Cell"===e.type||(e=!1)),e&&(e.dirtyStart=!0,e.addPivotHandle&&(e.dirtyHandle=!0),e.addPivotOffset&&(e.dirtyOffset=!0),e.addPivotRotation&&(e.dirtyRotation=!0),"Polyline"===e.type?e.dirtyPins=!0:"Line"!==e.type&&"Quadratic"!==e.type&&"Bezier"!==e.type||e.dirtyPins.push(this.name))}),this)},t}function Be(t=z){let e={mimic:"",useMimicDimensions:!1,useMimicScale:!1,useMimicStart:!1,useMimicHandle:!1,useMimicOffset:!1,useMimicRotation:!1,useMimicFlip:!1,addOwnDimensionsToMimic:!1,addOwnScaleToMimic:!1,addOwnStartToMimic:!1,addOwnHandleToMimic:!1,addOwnOffsetToMimic:!1,addOwnRotationToMimic:!1};t.defs=tt(t.defs,e),tt(t,e),t.packetObjects=it(t.packetObjects,["mimic"]),t.getters;let s=t.setters;return t.deltaSetters,s.mimic=function(t){if(Z(t)&&!t)this.mimic=null,"mimic"===this.lockTo[0]&&(this.lockTo[0]="start"),"mimic"===this.lockTo[1]&&(this.lockTo[1]="start"),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{let e=this.mimic,s=this.name,r=t.substring?i[t]:t;r||(r=n[t],r&&"Cell"!==r.type&&(r=!1)),r&&r.name&&(e&&e.name!==r.name&&st(e.mimicked,s),it(r.mimicked,s),this.mimic=r,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)}},s.useMimicDimensions=function(t){this.useMimicDimensions=t,this.dirtyDimensions=!0},s.useMimicScale=function(t){this.useMimicScale=t,this.dirtyScale=!0},s.useMimicStart=function(t){this.useMimicStart=t,this.dirtyStart=!0},s.useMimicHandle=function(t){this.useMimicHandle=t,this.dirtyHandle=!0},s.useMimicOffset=function(t){this.useMimicOffset=t,this.dirtyOffset=!0},s.useMimicRotation=function(t){this.useMimicRotation=t,this.dirtyRotation=!0},s.addOwnDimensionsToMimic=function(t){this.addOwnDimensionsToMimic=t,this.dirtyDimensions=!0},s.addOwnScaleToMimic=function(t){this.addOwnScaleToMimic=t,this.dirtyScale=!0},s.addOwnStartToMimic=function(t){this.addOwnStartToMimic=t,this.dirtyStart=!0},s.addOwnHandleToMimic=function(t){this.addOwnHandleToMimic=t,this.dirtyHandle=!0},s.addOwnOffsetToMimic=function(t){this.addOwnOffsetToMimic=t,this.dirtyOffset=!0},s.addOwnRotationToMimic=function(t){this.addOwnRotationToMimic=t,this.dirtyRotation=!0},t.updateMimicSubscribers=function(){let t=this.dirtyMimicHandle,e=this.dirtyMimicOffset,s=this.dirtyMimicRotation,r=this.dirtyMimicScale,o=this.dirtyMimicDimensions;this.mimicked.forEach((a=>{let l=i[a];l||(l=n[a],l&&"Cell"===l.type||(l=!1)),l&&(l.useMimicStart&&(l.dirtyStart=!0),t&&l.useMimicHandle&&(l.dirtyHandle=!0),e&&l.useMimicOffset&&(l.dirtyOffset=!0),s&&l.useMimicRotation&&(l.dirtyRotation=!0),r&&l.useMimicScale&&(l.dirtyScale=!0),o&&l.useMimicDimensions&&(l.dirtyDimensions=!0))})),this.dirtyMimicHandle=!1,this.dirtyMimicOffset=!1,this.dirtyMimicRotation=!1,this.dirtyMimicScale=!1,this.dirtyMimicDimensions=!1},t}function Le(t=z){let e={path:"",pathPosition:0,addPathHandle:!1,addPathOffset:!0,addPathRotation:!1,constantSpeedAlongPath:!1};t.defs=tt(t.defs,e),tt(t,e),t.packetObjects=it(t.packetObjects,["path"]);let s=t.setters,n=t.deltaSetters;return s.path=function(t){if(Z(t)&&!t)this.path=null,"path"===this.lockTo[0]&&(this.lockTo[0]="start"),"path"===this.lockTo[1]&&(this.lockTo[1]="start"),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{let e=this.path,s=t.substring?i[t]:t,n=this.name;s&&s.name&&s.useAsPath&&(e&&e.name!==s.name&&st(e.pathed,n),it(s.pathed,n),this.path=s,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)}},s.pathPosition=function(t){t<0&&(t=Math.abs(t)),t>1&&(t%=1),this.pathPosition=parseFloat(t.toFixed(6)),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0,this.currentPathData=!1},n.pathPosition=function(t){let e=this.pathPosition+t;e<0&&(e+=1),e>1&&(e%=1),this.pathPosition=parseFloat(e.toFixed(6)),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0,this.currentPathData=!1},s.addPathHandle=function(t){this.addPathHandle=t,this.dirtyHandle=!0},s.addPathOffset=function(t){this.addPathOffset=t,this.dirtyOffset=!0},s.addPathRotation=function(t){this.addPathRotation=t,this.dirtyRotation=!0},t.getPathData=function(){if(this.currentPathData)return this.currentPathData;let t,e=this.pathPosition,i=this.path;if(i){let s=this.constantSpeedAlongPath||this.constantPathSpeed||!1;return t=i.getPathPositionData(e,s),this.addPathRotation&&(this.dirtyRotation=!0),this.currentPathData=t,t}return!1},t}v.ImageAsset=ImageAsset;const Anchor=function(t=z){return this.makeName(t.name),this.register(),this.set(this.defs),this.set(t),this.build(),this};let $e=Anchor.prototype=Object.create(Object.prototype);$e.type="Anchor",$e.lib="anchor",$e.isArtefact=!1,$e.isAsset=!1,$e=xt($e);$e.defs=tt($e.defs,{host:null,description:"",download:"",href:"",hreflang:"",ping:"",referrerpolicy:"",rel:"noreferrer",target:"_blank",anchorType:"",clickAction:null,focusAction:!1,blurAction:!1}),$e.packetExclusions=it($e.packetExclusions,["domElement"]),$e.packetObjects=it($e.packetExclusions,["host"]),$e.packetFunctions=it($e.packetFunctions,["clickAction"]),$e.demolish=function(){this.domElement&&this.hold&&this.hold.removeChild(this.domElement),this.deregister()};let je=$e.setters;je.host=function(t){let e=t.substring?i[t]:t;e&&e.name&&(this.host=e)},je.hold=function(t){_(t)&&(this.domElement&&this.hold&&this.hold.removeChild(this.domElement),this.hold=t,this.domElement&&this.hold.appendChild(this.domElement))},je.download=function(t){this.download=t,this.domElement&&this.update("download")},je.href=function(t){this.href=t,this.domElement&&this.update("href")},je.hreflang=function(t){this.hreflang=t,this.domElement&&this.update("hreflang")},je.ping=function(t){this.ping=t,this.domElement&&this.update("ping")},je.referrerpolicy=function(t){this.referrerpolicy=t,this.domElement&&this.update("referrerpolicy")},je.rel=function(t){this.rel=t,this.domElement&&this.update("rel")},je.target=function(t){this.target=t,this.domElement&&this.update("target")},je.anchorType=function(t){this.anchorType=t,this.domElement&&this.update("type")},je.description=function(t){this.description=t,this.domElement&&(this.domElement.textContent=t)},je.clickAction=function(t){q(t)&&(this.clickAction=t,this.domElement&&this.domElement.setAttribute("onclick",t()))},$e.build=function(){this.domElement&&this.hold&&this.hold.removeChild(this.domElement);let t=document.createElement("a");t.id=this.name,this.download&&t.setAttribute("download",this.download),this.href&&t.setAttribute("href",this.href),this.hreflang&&t.setAttribute("hreflang",this.hreflang),this.ping&&t.setAttribute("ping",this.ping),this.referrerpolicy&&t.setAttribute("referrerpolicy",this.referrerpolicy),this.rel&&t.setAttribute("rel",this.rel),this.target&&t.setAttribute("target",this.target),this.anchorType&&t.setAttribute("type",this.anchorType),this.clickAction&&q(this.clickAction)&&t.setAttribute("onclick",this.clickAction()),this.description&&(t.textContent=this.description),this.focusAction&&t.addEventListener("focus",(t=>this.host.onEnter()),!1),this.blurAction&&t.addEventListener("blur",(t=>this.host.onLeave()),!1),this.domElement=t,this.hold&&this.hold.appendChild(t)},$e.update=function(t){this.domElement&&this.domElement.setAttribute(t,this[t])},$e.click=function(){if(this.hasBeenRecentlyClicked)return!1;{let t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.hasBeenRecentlyClicked=!0;let e=this;return setTimeout((()=>e.hasBeenRecentlyClicked=!1),200),this.domElement.dispatchEvent(t)}};function Ye(t=z){t.defs=tt(t.defs,{anchor:null}),t.demolishAnchor=function(){this.anchor&&this.anchor.demolish()};let e=t.getters,i=t.setters;return t.deltaSetters,e.anchorDescription=function(){return this.anchor?this.anchor.get("description"):""},i.anchorDescription=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.description(t)},e.anchorType=function(){return this.anchor?this.anchor.get("type"):""},i.anchorType=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.anchorType(t)},e.anchorTarget=function(){return this.anchor?this.anchor.get("target"):""},i.anchorTarget=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.target(t)},e.anchorRel=function(){return this.anchor?this.anchor.get("rel"):""},i.anchorRel=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.rel(t)},e.anchorReferrerPolicy=function(){return this.anchor?this.anchor.get("referrerpolicy"):""},i.anchorReferrerPolicy=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.referrerpolicy(t)},e.anchorPing=function(){return this.anchor?this.anchor.get("ping"):""},i.anchorPing=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.ping(t)},e.anchorHreflang=function(){return this.anchor?this.anchor.get("hreflang"):""},i.anchorHreflang=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.hreflang(t)},e.anchorHref=function(){return this.anchor?this.anchor.get("href"):""},i.anchorHref=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.href(t)},e.anchorDownload=function(){return this.anchor?this.anchor.get("download"):""},i.anchorDownload=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.download(t)},i.anchorFocusAction=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.focusAction(t)},i.anchorBlurAction=function(t){this.anchor||this.buildAnchor(),this.anchor&&this.anchor.setters.blurAction(t)},i.anchor=function(t){this.anchor?this.anchor.set(t):this.buildAnchor(t)},t.buildAnchor=function(t){K(t)&&(this.anchor&&this.anchor.demolish(),t.name||(t.name=`${this.name}-anchor`),t.description||(t.description=`Anchor link for ${this.name} ${this.type}`),t.host=this,t.hold=this.getAnchorHold(),this.anchor=function(t){return!!t&&new Anchor(t)}(t))},t.getAnchorHold=function(){let t=this.currentHost;if(t){if("Canvas"===t.type)return t.navigation;if("Cell"===t.type){let e=t.currentHost?t.currentHost:o[t.host];if(e&&"Canvas"===e.type)return e.navigation}}return this.dirtyAnchorHold=!0,us},t.rebuildAnchor=function(){this.anchor&&this.anchor.build()},t.clickAnchor=function(){this.anchor&&this.anchor.click()},t}function Xe(t=z){t.defs=tt(t.defs,{groups:null,groupBuckets:null,batchResort:!0});let e=t.getters,i=t.setters;return e.groups=function(){return[].concat(this.groups)},i.groups=function(t){this.groups=[],this.addGroups(t)},t.sortGroups=function(t=!1){if(this.batchResort){this.batchResort=!1;let t,e,i=Math.floor,s=this.groups,n=[];s.forEach((s=>{t=d[s],e=t?i(t.order):0,n[e]||(n[e]=[]),n[e].push(t)})),this.groupBuckets=n.reduce(((t,e)=>t.concat(e)),[])}},t.initializeCascade=function(){this.groups=[],this.groupBuckets=[]},t.addGroups=function(...t){return t.forEach((t=>{t&&t.substring?it(this.groups,t):d[t]&&it(this.groups,t.name)}),this),this.batchResort=!0,this},t.removeGroups=function(...t){return t.forEach((t=>{t&&t.substring?st(this.groups,t):d[t]&&st(this.groups,t.name)}),this),this.batchResort=!0,this},t.cascadeAction=function(t,e){let i;return console.log("cascadeAction"),this.groups.forEach((s=>{i=d[s],i&&i[e](t)}),this),this},t.updateArtefacts=function(t){return this.cascadeAction(t,"updateArtefacts"),this},t.setArtefacts=function(t){return this.cascadeAction(t,"setArtefacts"),this},t.addArtefactClasses=function(t){return this.cascadeAction(t,"addArtefactClasses"),this},t.removeArtefactClasses=function(t){return this.cascadeAction(t,"removeArtefactClasses"),this},t.updateByDelta=function(){return this.cascadeAction(!1,"updateByDelta"),this},t.reverseByDelta=function(){return this.cascadeAction(!1,"reverseByDelta"),this},t.getArtefactAt=function(t){if(t=ot(t,this.here,!1)){let e,i;for(let s=this.groups.length-1;s>=0;s--)if(e=d[this.groups[s]],e&&(i=e.getArtefactAt(t),i))return i}return!1},t.getAllArtefactsAt=function(t){if(t=ot(t,this.here,!1)){let e,i,s=[];for(let n=this.groups.length-1;n>=0;n--)e=d[this.groups[n]],e&&(i=e.getAllArtefactsAt(t),i&&(s=s.concat(i)));return s}return[]},t}function Ne(t=z){t.defs=tt(t.defs,{repeat:"repeat",patternMatrix:null});let e=t.setters;return t.repeatValues=["repeat","repeat-x","repeat-y","no-repeat"],e.repeat=function(t){this.repeatValues.indexOf(t)>=0?this.repeat=t:this.repeat=this.defs.repeat},t.matrixNumberPosCheck=["a","b","c","d","e","f"],t.updateMatrixNumber=function(t,e){this.patternMatrix||(this.patternMatrix=new DOMMatrix),t=t.substring?parseFloat(t):t;let i=this.matrixNumberPosCheck.indexOf(e);Q(t)&&i>=0&&(this.patternMatrix[e]=t)},e.matrixA=function(t){this.updateMatrixNumber(t,"a")},e.matrixB=function(t){this.updateMatrixNumber(t,"b")},e.matrixC=function(t){this.updateMatrixNumber(t,"c")},e.matrixD=function(t){this.updateMatrixNumber(t,"d")},e.matrixE=function(t){this.updateMatrixNumber(t,"e")},e.matrixF=function(t){this.updateMatrixNumber(t,"f")},e.stretchX=function(t){this.updateMatrixNumber(t,"a")},e.skewY=function(t){this.updateMatrixNumber(t,"b")},e.skewX=function(t){this.updateMatrixNumber(t,"c")},e.stretchY=function(t){this.updateMatrixNumber(t,"d")},e.shiftX=function(t){this.updateMatrixNumber(t,"e")},e.shiftY=function(t){this.updateMatrixNumber(t,"f")},e.patternMatrix=function(t){if(Array.isArray(t)){let e=this.updateMatrixNumber;e(t[0],"a"),e(t[1],"b"),e(t[2],"c"),e(t[3],"d"),e(t[4],"e"),e(t[5],"f")}},t.buildStyle=function(t){if(t){t.substring&&(t=a[t]);let e=this.source,i=this.sourceLoaded,s=this.repeat,n=t.engine;if("Cell"!==this.type&&"Noise"!==this.type||(e=this.element,i=!0),n&&i){let t=n.createPattern(e,s);return t.setTransform(this.patternMatrix),t}}return"rgba(0,0,0,0)"},t}function Ge(t=z){t.defs=tt(t.defs,{filters:null,isStencil:!1,memoizeFilterOutput:!1});let e=t.setters;return e.filters=function(t){Array.isArray(this.filters)||(this.filters=[]),t&&(Array.isArray(t)?(this.filters=t,this.dirtyFilters=!0,this.dirtyImageSubscribers=!0):t.substring&&(it(this.filters,t),this.dirtyFilters=!0,this.dirtyImageSubscribers=!0),this.dirtyFilterIdentifier=!0)},e.memoizeFilterOutput=function(t){this.memoizeFilterOutput=t,this.updateFilterIdentifier(!!t)},t.updateFilterIdentifier=function(t){this.dirtyFilterIdentifier=!1,this.state&&(this.state.dirtyFilterIdentifier=!1),this.memoizeFilterOutput&&t?this.filterIdentifier=(()=>{function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return`${t()}${t()}-${t()}-${t()}-${t()}-${t()}${t()}${t()}`})():this.filterIdentifier=""},t.cleanFilters=function(){this.dirtyFilters=!1,this.dirtyFiltersCache=!0,this.filters||(this.filters=[]);let t,e,i=this.filters,s=Math.floor,n=[];i.forEach((i=>{t=c[i],t&&(e=s(t.order)||0,n[e]||(n[e]=[]),n[e].push(t))})),this.currentFilters=n.reduce(((t,e)=>t.concat(e)),[])},t.addFilters=function(...t){return Array.isArray(this.filters)||(this.filters=[]),t.forEach((t=>{t&&"Filter"===t.type&&(t=t.name),it(this.filters,t)}),this),this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0,this},t.removeFilters=function(...t){return Array.isArray(this.filters)||(this.filters=[]),t.forEach((t=>{t&&"Filter"===t.type&&(t=t.name),st(this.filters,t)}),this),this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0,this},t.clearFilters=function(){return Array.isArray(this.filters)||(this.filters=[]),this.filters.length=0,this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0,this},t.preprocessFilters=function(t){for(let e,i=0,s=t.length;i<s;i++){e=t[i];for(let t,i=0,s=e.actions.length;i<s;i++)if(t=e.actions[i],"process-image"==t.action){let e=!0,i=n[t.asset];if(i){"Image"!==i.type&&(i.checkSource(),this.dirtyFilterIdentifier=!0),"Video"!==i.type&&"Sprite"!==i.type&&"Noise"!==i.type&&"Cell"!==i.type&&"RawAsset"!==i.type&&"RdAsset"!==i.type||i.checkSource();let s=i.sourceNaturalWidth,n=i.sourceNaturalHeight,r=i.sourceNaturalDimensions,o=i.currentDimensions;if(s&&n||(r&&r[0]&&r[1]?(s=s||r[0],n=n||r[1]):o&&o[0]&&o[1]&&(s=s||o[0],n=n||o[1])),s&&n){e=!1;let r=t.copyX||0,o=t.copyY||0,a=t.copyWidth||1,l=t.copyHeight||1,h=t.width||1,c=t.height||1;r.substring&&(r=parseFloat(r)/100*s),o.substring&&(o=parseFloat(o)/100*n),a.substring&&(a=parseFloat(a)/100*s),l.substring&&(l=parseFloat(l)/100*n),r=Math.abs(r),o=Math.abs(o),a=Math.abs(a),l=Math.abs(l),r>s&&(r=s-2,a=1),o>n&&(o=n-2,l=1),a>s&&(a=s-1,r=0),l>n&&(l=n-1,o=0),r+a>s&&(r=s-a-1),o+l>n&&(o=n-l-1);let u=qe(),d=u.engine,f=u.element;f.width=h,f.height=c,d.setTransform(1,0,0,1,0,0),d.globalCompositeOperation="source-over",d.globalAlpha=1;let p=i.source||i.element;d.drawImage(p,r,o,a,l,0,0,h,c),t.assetData=d.getImageData(0,0,h,c),Qe(u)}}e&&(t.assetData={width:1,height:1,data:new Uint8ClampedArray(4)})}e.dirtyFilterIdentifier&&(this.dirtyFilterIdentifier=!0)}const e=this.state;if(e)if(e.dirtyFilterIdentifier)this.dirtyFilterIdentifier=!0;else{let{fillStyle:t,strokeStyle:i}=e;(k[t]&&k[t].dirtyFilterIdentifier||k[i]&&k[i].dirtyFilterIdentifier)&&(this.dirtyFilterIdentifier=!0)}(this.dirtyFilterIdentifier||this.state&&this.state.dirtyFilterIdentifier)&&this.updateFilterIdentifier(!0)},t}v.Anchor=Anchor;const Cell=function(t=z){if(this.makeName(t.name),t.isPool||this.register(),this.initializePositions(),this.initializeCascade(),!U(t.element)){let e=document.createElement("canvas");e.id=this.name,e.width=300,e.height=150,t.element=e}return this.installElement(t.element),t.isPool?this.set(this.poolDefs):this.set(this.defs),this.set(t),this.state.setStateFromEngine(this.engine),t.isPool||fi({name:this.name,host:this.name}),this.subscribers=[],this.sourceNaturalDimensions=ke(),this.dirtyDimensionsOverride=!0,this.sourceLoaded=!0,this.here={},this};let ze=Cell.prototype=Object.create(Object.prototype);ze.type="Cell",ze.lib="cell",ze.isArtefact=!1,ze.isAsset=!0,ze=xt(ze),ze=Ae(ze),ze=Me(ze),ze=Te(ze),ze=He(ze),ze=Be(ze),ze=Le(ze),ze=Ye(ze),ze=Xe(ze),ze=Ne(ze),ze=Ge(ze);ze.defs=tt(ze.defs,{cleared:!0,compiled:!0,shown:!0,compileOrder:0,showOrder:0,backgroundColor:"",clearAlpha:0,alpha:1,composite:"source-over",scale:1,flipReverse:!1,flipUpend:!1,filter:"none",isBase:!1,useAsPattern:!1,controller:null}),delete ze.defs.source,delete ze.defs.sourceLoaded,ze.stringifyFunction=Y,ze.processPacketOut=Y,ze.finalizePacketOut=Y,ze.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},ze.clone=N,ze.factoryKill=function(){let t=this.name;Object.entries(o).forEach((([e,i])=>{i.cells.indexOf(t)>=0&&i.removeCell(t),i.base&&i.base.name===t&&i.set({visibility:!1})})),Object.entries(i).forEach((([e,i])=>{if(i.name!==t){let e=i.state;if(e){let i=e.fillStyle,s=e.strokeStyle;i.name&&i.name===t&&(e.fillStyle=e.defs.fillStyle),s.name&&s.name===t&&(e.strokeStyle=e.defs.strokeStyle)}}})),d[t]&&d[t].kill()};let We=ze.getters,Ve=ze.setters,Ze=ze.deltaSetters;ze.get=function(t){let e=this.getters[t];if(e)return e.call(this);{let e,i=this.defs[t],s=this.state;return void 0!==i?(e=this[t],void 0!==e?e:i):(i=s.defs[t],void 0!==i?(e=s[t],void 0!==e?e:i):undef)}},We.width=function(){return this.currentDimensions[0]||this.element.getAttribute("width")},Ve.width=function(t){null!=t&&(this.dimensions[0]=t,this.dirtyDimensions=!0,this.dirtyDimensionsOverride=!0)},We.height=function(){return this.currentDimensions[1]||this.element.getAttribute("height")},Ve.height=function(t){null!=t&&(this.dimensions[1]=t,this.dirtyDimensions=!0,this.dirtyDimensionsOverride=!0)},We.dimensions=function(){return[this.currentDimensions[0]||this.element.getAttribute("width"),this.currentDimensions[1]||this.element.getAttribute("height")]},Ve.dimensions=function(t,e){this.setCoordinateHelper("dimensions",t,e),this.dirtyDimensions=!0,this.dirtyDimensionsOverride=!0},Ve.source=function(){},Ve.engine=function(t){},Ve.state=function(t){},Ve.element=function(t){U(t)&&this.installElement(t)},Ve.backgroundColor=function(t){"rgba(0, 0, 0, 0)"!==t&&"transparent"!==t&&"#00000000"!==t&&"#0000"!==t||(t=""),this.backgroundColor=t},Ve.cleared=function(t){this.cleared=t,this.updateControllerCells()},Ve.compiled=function(t){this.compiled=t,this.updateControllerCells()},Ve.shown=function(t){this.shown=t,this.updateControllerCells()},Ve.compileOrder=function(t){this.compileOrder=t,this.updateControllerCells()},Ve.showOrder=function(t){this.showOrder=t,this.updateControllerCells()},Ve.stashX=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]),this.stashCoordinates[0]=t},Ve.stashY=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]),this.stashCoordinates[1]=t},Ve.stashWidth=function(t){if(!this.stashDimensions){let t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}this.stashDimensions[0]=t},Ve.stashHeight=function(t){if(!this.stashDimensions){let t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}this.stashDimensions[1]=t},Ze.stashX=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]);let e=this.stashCoordinates;e[0]=addStrings(e[0],t)},Ze.stashY=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]);let e=this.stashCoordinates;e[1]=addStrings(e[1],t)},Ze.stashWidth=function(t){if(!this.stashDimensions){let t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}let e=this.stashDimensions;e[0]=addStrings(e[0],t)},Ze.stashHeight=function(t){if(!this.stashDimensions){let t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}let e=this.stashDimensions;e[1]=addStrings(e[1],t)},Ve.clearAlpha=function(t){t.toFixed&&(t>1?t=1:t<0&&(t=0),this.clearAlpha=t)},Ze.clearAlpha=function(t){t.toFixed&&((t+=this.clearAlpha)>1?t=1:t<0&&(t=0),this.clearAlpha=t)},Ve.smoothFont=function(t){const{element:e}=this;if(e){const{style:i}=e;i&&(t?(i.webkitFontSmoothing="auto",i.mozOsxFontSmoothing="auto",i.smoothFont="auto"):(i.webkitFontSmoothing="none",i.mozOsxFontSmoothing="grayscale",i.smoothFont="never"))}},ze.checkSource=function(t,e){this.currentDimensions[0]===t&&this.currentDimensions[1]===e||this.notifySubscribers()},ze.getData=function(t,e){return this.checkSource(this.sourceNaturalDimensions[0],this.sourceNaturalDimensions[1]),this.buildStyle(e)},ze.updateArtefacts=function(t=z){const e=this.groupBuckets;let i,s,n,r,o,a;for(n=0,r=e.length;n<r;n++)for(s=e[n].artefactBuckets,o=0,a=s.length;o<a;o++)i=s[o],t.dirtyScale&&(i.dirtyScale=!0),t.dirtyDimensions&&(i.dirtyDimensions=!0),t.dirtyLock&&(i.dirtyLock=!0),t.dirtyStart&&(i.dirtyStart=!0),t.dirtyOffset&&(i.dirtyOffset=!0),t.dirtyHandle&&(i.dirtyHandle=!0),t.dirtyRotation&&(i.dirtyRotation=!0),t.dirtyPathObject&&(i.dirtyPathObject=!0)},ze.cleanDimensionsAdditionalActions=function(){let t=this.element;if(t){let e=this.controller,i=this.currentDimensions,s=this.isBase,n=Ct(),r=wt();if(this.cleared||this.dirtyDimensionsOverride){if(this.dirtyDimensionsOverride=!1,n){if(s&&e&&(e.baseMatchesCanvasDimensions||e.isComponent)){let t=this.controller.currentDimensions,e=this.dimensions;e[0]=i[0]=t[0],e[1]=i[1]=t[1]}let[n,r]=i;t.width=n,t.height=r}else{if(s&&e&&(e.baseMatchesCanvasDimensions||e.isComponent)){let t=this.controller.currentDimensions,e=this.dimensions;e[0]=i[0]=t[0],e[1]=i[1]=t[1]}let[o,a]=i;n?(t.width=o,t.height=a):(t.width=o*r,t.height=a*r)}this.setEngineFromState(this.engine),s&&e&&e.updateBaseHere(),this.groupBuckets&&this.updateArtefacts({dirtyDimensions:!0})}}},ze.notifySubscriber=function(t){t.sourceNaturalDimensions||(t.sourceNaturalDimensions=[]),t.sourceNaturalWidth=this.currentDimensions[0],t.sourceNaturalHeight=this.currentDimensions[1],t.sourceLoaded=!0,t.dirtyImage=!0,t.dirtyCopyStart=!0,t.dirtyCopyDimensions=!0},ze.subscribeAction=function(t={}){this.subscribers.push(t),t.asset=this,t.source=this.element,this.notifySubscriber(t)},ze.installElement=function(t){return this.element=t,this.engine=this.element.getContext("2d"),this.state=pe({engine:this.engine}),this},ze.updateControllerCells=function(){const{controller:t,currentHost:e}=this;if(t)t.dirtyCells=!0;else if(e){let t=e.getHost();t&&(t.dirtyCells=!0)}},ze.setEngineFromState=function(t){const e=this.state,i=e.allKeys,s=i.length;let n,r,o,a;for(n=0;n<s;n++)r=i[n],o=t[r],a=e[r],"lineDash"===r?(t.lineDash=a,t.setLineDash(t.lineDash)):o!==a&&(t[r]=a);return"left"!==t.textAlign&&(t.textAlign="left"),"top"!==t.textBaseline&&(t.textBaseline="top"),this},ze.setToDefaults=function(){let t=this.state.defs,e=this.state,i=this.engine,s=Array.isArray;return Object.entries(t).forEach((([t,n])=>{"lineDash"===t?(s(i.lineDash)?i.lineDash.length=0:i.lineDash=[],s(e.lineDash)?e.lineDash.length=0:e.lineDash=[]):(i[t]=n,e[t]=n)})),i.textAlign=e.textAlign="left",i.textBaseline=e.textBaseline="top",this},ze.stylesArray=["Gradient","RadialGradient","Pattern"],ze.setEngine=function(t){const e=this.state,i=t.state;if(i){let s,n,r=i.getChanges(t,e),o=this.setEngineActions,a=this.stylesArray;if(Object.keys(r).length)for(n in s=this.engine,r)o[n](r[n],s,a,t,this),e[n]=r[n]}return t},ze.setEngineActions={fillStyle:function(t,e,i,s,n){if(t.substring){let i=!1;A.indexOf(t)>=0?i=k[t]:l.indexOf(t)>=0&&(i=a[t]),i?(s.state.fillStyle=i,e.fillStyle=i.getData(s,n)):e.fillStyle=t}else e.fillStyle=t.getData(s,n)},filter:function(t,e){e.filter=t},font:function(t,e){e.font=t},globalAlpha:function(t,e){e.globalAlpha=t},globalCompositeOperation:function(t,e){e.globalCompositeOperation=t},imageSmoothingEnabled:function(t,e){e.imageSmoothingEnabled=t},imageSmoothingQuality:function(t,e){e.imageSmoothingQuality=t},lineCap:function(t,e){e.lineCap=t},lineDash:function(t,e){e.lineDash=t,e.setLineDash&&e.setLineDash(t)},lineDashOffset:function(t,e){e.lineDashOffset=t},lineJoin:function(t,e){e.lineJoin=t},lineWidth:function(t,e){e.lineWidth=t},miterLimit:function(t,e){e.miterLimit=t},shadowBlur:function(t,e){e.shadowBlur=t},shadowColor:function(t,e){e.shadowColor=t},shadowOffsetX:function(t,e){e.shadowOffsetX=t},shadowOffsetY:function(t,e){e.shadowOffsetY=t},strokeStyle:function(t,e,i,s,n){if(t.substring){let i=!1;A.indexOf(t)>=0?i=k[t]:l.indexOf(t)>=0&&(i=a[t]),i?(s.state.strokeStyle=i,e.strokeStyle=i.getData(s,n)):e.strokeStyle=t}else e.strokeStyle=t.getData(s,n)}},ze.clearShadow=function(){return this.engine.shadowOffsetX=0,this.engine.shadowOffsetY=0,this.engine.shadowBlur=0,this.state.shadowOffsetX=0,this.state.shadowOffsetY=0,this.state.shadowBlur=0,this},ze.restoreShadow=function(t){let e=t.state;return this.engine.shadowOffsetX=e.shadowOffsetX,this.engine.shadowOffsetY=e.shadowOffsetY,this.engine.shadowBlur=e.shadowBlur,this.state.shadowOffsetX=e.shadowOffsetX,this.state.shadowOffsetY=e.shadowOffsetY,this.state.shadowBlur=e.shadowBlur,this},ze.setToClearShape=function(){return this.engine.fillStyle="rgba(0,0,0,0)",this.engine.strokeStyle="rgba(0,0,0,0)",this.engine.shadowColor="rgba(0,0,0,0)",this.state.fillStyle="rgba(0,0,0,0)",this.state.strokeStyle="rgba(0,0,0,0)",this.state.shadowColor="rgba(0,0,0,0)",this},ze.saveEngine=function(){return this.engine.save(),this},ze.restoreEngine=function(){return this.engine.restore(),this},ze.getComputedFontSizes=function(){let t=this.getHost();if(t&&t.domElement){let e=window.getComputedStyle(t.domElement),i=window.getComputedStyle(document.documentElement);return[parseFloat(e.fontSize),parseFloat(i.fontSize),window.innerWidth,window.innerHeight]}return!1};const Ue=function(t){if(t){if(t.setTransform(1,0,0,1,0,0),!Ct()){let e=wt();return t.scale(e,e),e}t.scale(1,1)}return 1};ze.clear=function(){const{element:t,engine:e,backgroundColor:i,clearAlpha:s,currentDimensions:n}=this,[r,o]=n;this.prepareStamp();let a=Ue(e),l=r*a,h=o*a;if(this.useAsPattern&&(t.width=r,t.height=o),i)e.save(),e.fillStyle=i,e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillRect(0,0,r,o),e.restore();else if(s){e.save();let i=qe(),{engine:n,element:a}=i;this.useAsPattern?(a.width=r,a.height=o,n.drawImage(t,0,0,r,o,0,0,r,o),e.clearRect(0,0,r,o),e.globalAlpha=s,e.drawImage(a,0,0,r,o,0,0,r,o)):(a.width=l,a.height=h,n.drawImage(t,0,0,r,o,0,0,r,o),e.clearRect(0,0,r,o),e.globalAlpha=s,e.drawImage(a,0,0,l,h,0,0,r,o)),e.restore(),Qe(i)}else e.clearRect(0,0,r,o)},ze.compile=function(){this.stashOutput,this.sortGroups(),this.prepareStamp(),!this.dirtyFilters&&this.currentFilters||this.cleanFilters(),Ue(this.engine);const t=this.groupBuckets,e=t.length;for(let i,s=0;s<e;s++)i=t[s],i&&i.stamp&&i.stamp();!this.noFilters&&this.filters&&this.filters.length&&this.applyFilters(),this.stashOutputAction()},ze.show=function(){let t=this.getHost(),e=!(!t||!t.engine)&&t.engine;if(e){let i=Math.floor,s=t.currentDimensions,n=i(s[0]),r=i(s[1]);if(!n||!r)return!1;let o,{currentScale:a,currentDimensions:l,composite:h,alpha:c,controller:u,element:d,isBase:f,currentStampHandlePosition:p,currentStampPosition:m}=this,g=i(l[0]),y=i(l[1]);if(e.save(),Ue(e),e.filter=this.filter,f){let t,s;switch(this.basePaste||(this.basePaste=[]),o=this.basePaste,this.prepareStamp(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.clearRect(0,0,n,r),e.globalCompositeOperation=h,e.globalAlpha=c,u?u.fit:"none"){case"contain":t=n/(g||1),s=r/(y||1),t>s?(o[0]=i((n-g*s)/2),o[1]=0,o[2]=i(g*s),o[3]=i(y*s)):(o[0]=0,o[1]=i((r-y*t)/2),o[2]=i(g*t),o[3]=i(y*t));break;case"cover":t=n/(g||1),s=r/(y||1),t<s?(o[0]=i((n-g*s)/2),o[1]=0,o[2]=i(g*s),o[3]=i(y*s)):(o[0]=0,o[1]=i((r-y*t)/2),o[2]=i(g*t),o[3]=i(y*t));break;case"fill":o[0]=0,o[1]=0,o[2]=i(n),o[3]=i(r);break;default:o[0]=i((n-g)/2),o[1]=i((r-y)/2),o[2]=g,o[3]=y}}else a>0&&(this.paste||(this.paste=[]),o=this.paste,this.noDeltaUpdates||this.setDelta(this.delta),this.prepareStamp(),e.globalCompositeOperation=h,e.globalAlpha=c,o[0]=i(-p[0]*a),o[1]=i(-p[1]*a),o[2]=i(g*a),o[3]=i(y*a),this.rotateDestination(e,...m));e.drawImage(d,0,0,g,y,...o),e.restore()}},ze.applyFilters=function(){let t=this.engine,e=t.getImageData(0,0,this.currentDimensions[0],this.currentDimensions[1]);this.preprocessFilters(this.currentFilters);let i=hi.action({identifier:this.filterIdentifier,image:e,filters:this.currentFilters});i&&t.putImageData(i,0,0)},ze.stashOutputAction=function(){if(this.stashOutput){this.stashOutput=!1;let{currentDimensions:t,stashCoordinates:e,stashDimensions:i,engine:s}=this,[n,r]=t,o=e?e[0]:0,a=e?e[1]:0,l=i?i[0]:n,h=i?i[1]:r;if((l.substring||h.substring||o.substring||a.substring||o||a||l!==n||h!==r)&&(l.substring&&(l=parseFloat(l)/100*n),(isNaN(l)||l<=0)&&(l=1),l>n&&(l=n),h.substring&&(h=parseFloat(h)/100*r),(isNaN(h)||h<=0)&&(h=1),h>r&&(h=r),o.substring&&(o=parseFloat(o)/100*n),(isNaN(o)||o<0)&&(o=0),o+l>n&&(o=n-l),a.substring&&(a=parseFloat(a)/100*r),(isNaN(a)||a<0)&&(a=0),a+h>r&&(a=r-h)),s.save(),s.setTransform(1,0,0,1,0,0),this.stashedImageData=s.getImageData(o,a,l,h),s.restore(),this.stashOutputAsAsset){let t,e;if(this.stashOutputAsAsset=!1,e=qe(),t=e.element,t.width=l,t.height=h,e.engine.putImageData(this.stashedImageData,0,0),this.stashedImage)this.stashedImage.src=t.toDataURL();else{let e=this.stashedImage=document.createElement("img");e.id=`${this.name}-image`,e.onload=function(){cs.appendChild(e),De(`#${e.id}`)},e.src=t.toDataURL()}Qe(e)}}},ze.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){let t=n[this.host]||i[this.host];return t&&(this.currentHost=t),!!t&&this.currentHost}return!1},ze.updateBaseHere=function(t,e){if(this.isBase){this.here||(this.here={});let i=this.here,s=this.currentDimensions,n=t.active,r=t.localListener?t.originalWidth:t.w,o=t.localListener?t.originalHeight:t.h;if(s[0]!==r||s[1]!==o){this.basePaste||(this.basePaste=[]);let a,l,h=this.basePaste[0],c=s[0],u=s[1],d=r,f=o,p=t.x,m=t.y,g=c/d||1,y=u/f||1,b=Math.round;switch(i.w=c,i.h=u,e){case"contain":case"cover":h?(a=(d-c/y)/2,i.x=b((p-a)*y),i.y=b(m*y)):(l=(f-u/g)/2,i.x=b(p*g),i.y=b((m-l)*g));break;case"fill":i.x=b(p*g),i.y=b(m*y);break;default:a=(d-c)/2,l=(f-u)/2,i.x=b(p-a),i.y=b(m-l)}(i.x<0||i.x>c)&&(n=!1),(i.y<0||i.y>u)&&(n=!1),i.active=n}else i.x=t.x,i.y=t.y,i.w=r,i.h=o,i.active=n;t.baseActive=n}},ze.prepareStamp=function(){(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&(this.cleanDimensions(),this.dirtyAssetSubscribers=!0),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.indexOf("mouse")>=0)&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.dirtyAssetSubscribers&&(this.dirtyAssetSubscribers=!1,this.notifySubscribers())},ze.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){let t=this.pathObject=new Path2D,e=this.currentStampHandlePosition,i=this.currentScale,s=this.currentDimensions,n=-e[0]*i,r=-e[1]*i,o=s[0]*i,a=s[1]*i;t.rect(n,r,o,a)}},ze.updateHere=function(){this.here||(this.here={});let t=this.here,[e,i]=this.currentDimensions;t.w=e,t.h=i,t.x=-1e4,t.y=-1e4,t.active=!1;let s=this.currentHost;if(s){let e=s.here;if(e&&e.active){let{x:i,y:s,w:n,h:r}=e;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();let o=qe(),a=o.engine,[l,h]=this.currentStampPosition;o.rotateDestination(a,l,h,this);let c=a.isPointInPath(this.pathObject,i,s);if(Qe(o),t.active=c,c){let[e,n]=this.currentStampHandlePosition,{flipUpend:r,flipReverse:o,roll:a,scale:c}=this;if(c){let u=(i-l)/c,d=(s-h)/c;if(o&&(u=-u),r&&(d=-d),a){(o&&!r||!o&&r)&&(a=-a);let t=be(u,d);t.rotate(-a),[u,d]=t,Se(t)}u+=e,d+=n,t.x=u,t.y=d}}}}},ze.getEntityHits=function(){let t=[],e=[],i=[];return this.groupBuckets&&this.groupBuckets.forEach((t=>{t.visibility&&e.push(t.getAllArtefactsAt(this.here))}),this),e.length&&(e=e.reduce(((t,e)=>t.concat(e)),[]),e.forEach((e=>{let s=e.artefact;s.visibility&&i.indexOf(s.name)<0&&(i.push(s.name),t.push(s))}))),t},ze.rotateDestination=function(t,e,i,s){let n,r,o=s||this,a=o.mimic,l=o.pivot,h=o.currentRotation;if(a&&a.name&&o.useMimicFlip?(n=a.flipReverse?-1:1,r=a.flipUpend?-1:1):(n=o.flipReverse?-1:1,r=o.flipUpend?-1:1),a&&a.name&&o.useMimicRotation?h=a.currentRotation:l&&l.name&&o.addPivotRotation&&(h=l.currentRotation),h){h*=C;let s=Math.cos(h),o=Math.sin(h);t.setTransform(s*n,o*n,-o*r,s*r,e,i)}else t.setTransform(n,0,0,r,e,i);return this};const _e=[];ze.poolDefs={element:null,engine:null,state:null,width:300,height:100,alpha:1,composite:"source-over"};const qe=function(){_e.length||_e.push(Ke({name:`pool_${W()}`,isPool:!0}));let t=_e.shift();return t.engine.save(),t},Qe=function(t){t&&"Cell"===t.type&&(t.engine.restore(),_e.push(t))},Ke=function(t){return!!t&&new Cell(t)};v.Cell=Cell;const Color=function(t=z){return this.makeName(t.name),this.register(),this.set(this.defs),this.rgb=[],this.rgb_max=[],this.rgb_min=[],this.hsl=[],this.hsl_max=[],this.hsl_min=[],this.hwb=[],this.hwb_max=[],this.hwb_min=[],this.xyz=[],this.xyz_max=[],this.xyz_min=[],this.lab=[],this.lab_max=[],this.lab_min=[],this.lch=[],this.lch_max=[],this.lch_min=[],this.easingFunction=X,this.convert("transparent"),this.convert("black","_min"),this.convert("white","_max"),this.set(t),this};let Je=Color.prototype=Object.create(Object.prototype);Je.type="Color",Je.lib="styles",Je.isArtefact=!1,Je.isAsset=!1,Je=xt(Je);Je.defs=tt(Je.defs,{rgb:null,rgb_max:null,rgb_min:null,hsl:null,hsl_max:null,hsl_min:null,hwb:null,hwb_max:null,hwb_min:null,xyz:null,xyz_max:null,xyz_min:null,lab:null,lab_max:null,lab_min:null,lch:null,lch_max:null,lch_min:null,easing:"linear",easingFunction:null,colorSpace:"RGB",returnColorAs:"RGB"}),Je.packetFunctions=it(Je.packetFunctions,["easingFunction"]),Je.kill=function(){let t=this.name;return Object.entries(h).forEach((([e,i])=>{let s=i.state;if(s){let e=s.fillStyle,i=s.strokeStyle,n=s.shadowColor;K(e)&&e.name===t&&(s.fillStyle=s.defs.fillStyle),K(i)&&i.name===t&&(s.strokeStyle=s.defs.strokeStyle),K(n)&&n.name===t&&(s.shadowColor=s.defs.shadowColor)}})),this.deregister(),this},Je.get=function(t){if(nt(t)){if(t.toFixed)return this.getRangeColor(t);if("min"===t)return this.getMinimumColor();if("max"===t)return this.getMaximumColor();if("random"===t)return this.generateRandomColor(),this.getCurrentColor();{let e=this.getters[t];if(e)return e.call(this);{let e=this.defs[t];if(void 0!==e){let i=this[t];return void 0!==i?i:e}return undef}}}return this.getCurrentColor()},Je.set=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.setters,n=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&"name"!==a&&null!=l&&(r=s[a],r?r.call(this,l):void 0!==n[a]&&(this[a]=l));t.random&&this.generateRandomColor()}return this};let ti=Je.setters;ti.color=function(t){this.convert(t)},Je.setColor=function(t){return this.convert(t),this},ti.minimumColor=function(t){this.convert(t,"_min")},Je.setMinimumColor=function(t){return this.convert(t,"_min"),this},ti.maximumColor=function(t){this.convert(t,"_max")},Je.setMaximumColor=function(t){return this.convert(t,"_max"),this},ti.easing=function(t){this.setEasingHelper(t)},ti.easingFunction=ti.easing,Je.setEasing=function(t){return this.setEasingHelper(t),this},Je.setEasingFunction=Je.setEasing,Je.setEasingHelper=function(t){q(t)?(this.easing="function",this.easingFunction=t):t.substring&&lt[t]?(this.easing=t,this.easingFunction=X):(this.easing="linear",this.easingFunction=X)},Je.internalColorSpaces=["RGB","HSL","HWB","XYZ","LAB","LCH"],ti.colorSpace=function(t){this.setColorSpaceHelper(t)},Je.setColorSpace=function(t){return this.setColorSpaceHelper(t),this},Je.setColorSpaceHelper=function(t){if(t.substring&&(t=t.toUpperCase(),this.internalColorSpaces.includes(t))){const e=this.getCurrentColor(),i=this.getMinimumColor(),s=this.getMaximumColor();this.colorSpace=t.toUpperCase(),this.updateColorConversions(e,i,s)}},Je.returnedColorSpaces=["RGB","HSL","HWB","LAB","LCH"],ti.returnColorAs=function(t){this.setReturnColorAsHelper(t)},Je.setReturnColorAs=function(t){return this.setReturnColorAsHelper(t),this},Je.setReturnColorAsHelper=function(t){if(t.substring&&(t=t.toUpperCase(),this.returnedColorSpaces.includes(t))){const e=this.getCurrentColor(),i=this.getMinimumColor(),s=this.getMaximumColor();this.returnColorAs=t.toUpperCase(),this.updateColorConversions(e,i,s)}},Je.updateColorConversions=function(t,e,i){this.convert(t),this.convert(e,"_min"),this.convert(i,"_max")},Je.getData=function(){return this.getCurrentColor()},Je.getCurrentColor=function(){const{rgb:t,hsl:e,hwb:i,lab:s,lch:n}=this;return this.returnColor(t,e,i,s,n)},Je.getMinimumColor=function(){const{rgb_min:t,hsl_min:e,hwb_min:i,lab_min:s,lch_min:n}=this;return this.returnColor(t,e,i,s,n)},Je.getMaximumColor=function(){const{rgb_max:t,hsl_max:e,hwb_max:i,lab_max:s,lch_max:n}=this;return this.returnColor(t,e,i,s,n)},Je.returnColor=function(t,e,i,s,n){null==t&&({rgb:t,hsl:e,hwb:i,lab:s,lch:n}=this);const{buildColorString:r,returnColorAs:o}=this;switch(o){case"RGB":return r(...t,"RGB");case"HSL":return r(...e,"HSL");case"HWB":return ei?r(...i,"HWB"):r(...t,"RGB");case"LAB":return ii?r(...s,"LAB"):r(...t,"RGB");case"LCH":return si?r(...n,"LCH"):r(...t,"RGB");default:return"rgba(0 0 0 / 0)"}},Je.returnColorFromValues=function(t,e,i,s){const{colorSpace:n,returnColorAs:r}=this;let o=this.buildColorString(t,e,i,s,n),a=!1;return"XYZ"===n||n!==r?a=!0:("HWB"!==r||ei)&&("LAB"!==r||ii)&&("LCH"!==r||si)||(a=!0),a?(this.setColor(o),this.returnColor()):o},Je.buildColorString=function(t,e,i,s,n){switch(n||(n=this.returnColorAs),n){case"RGB":return`rgba(${Math.round(t)} ${Math.round(e)} ${Math.round(i)} / ${s})`;case"HSL":return`hsl(${t} ${e}% ${i}% / ${s})`;case"HWB":return`hwb(${t} ${e}% ${i}% / ${s})`;case"LAB":return`lab(${t}% ${e} ${i} / ${s})`;case"LCH":return`lch(${t}% ${e} ${i} / ${s})`;case"XYZ":return`xyz(${t}% ${e} ${i} / ${s})`;default:return"rgba(0 0 0 / 0)"}},Je.generateRandomColor=function(){let t=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),i=Math.floor(256*Math.random());t>255&&(t=255),e>255&&(e=255),i>255&&(i=255),this.setColor(`rgb(${t} ${e} ${i})`)},Je.checkColor=function(t){if(t.substring){let e="RGB";return t.includes("hsl")?e="HSL":t.includes("hwb")?e="HWB":t.includes("lab")?e="LAB":t.includes("lch")?e="LCH":t.includes("xyz")&&(e="XYZ"),"RGB"===e||"HSL"===e?t:(this.colorSpace=e,this.returnColorAs=e,this.convert(t),this.returnColor())}return"rgba(0 0 0 / 0)"},Je.getRangeColor=function(t,e=!1){if(nt(t)&&t.toFixed){let i=this.colorSpace;e&&["HSL","HWB"].includes(i)?i="RGB":e&&"LCH"===i&&(i="LAB");const s=this.calculateRangeColorValues(t,e),n=this.buildColorString(...s,i);this.setColor(n)}return this.getCurrentColor()},Je.calculateRangeColorValues=function(t,e=!1){const{colorSpace:i,easing:s,easingFunction:n}=this;let r,o,a,l,h,c=i.toLowerCase();e&&["HSL","HWB"].includes(i)?c="rgb":e&&"LCH"===i&&(c="lab");const[u,d,f,p]=this[`${c}_min`],[m,g,y,b]=this[`${c}_max`];let S=n;!e&&"function"!==s&&lt[s]&&(S=lt[s]);const k=e?t:S(t);switch(c){case"hsl":case"hwb":return h=m-u,o=u===m?u:V(k,h>180||h<-180?h>0?u+360:u-360:u,m),r=p===b?p:V(k,p,b),a=d===g?d:V(k,d,g),l=f===y?f:V(k,f,y),[o,a,l,r];case"lch":return h=y-f,l=f===y?f:V(k,h>180||h<-180?h>0?f+360:f-360:f,y),r=p===b?p:V(k,p,b),a=d===g?d:V(k,d,g),o=u===m?u:V(k,u,m),[o,a,l,r];default:return r=p===b?p:V(k,p,b),o=u===m?u:V(k,u,m),a=d===g?d:V(k,d,g),l=f===y?f:V(k,f,y),[o,a,l,r]}},Je.convert=function(t,e=""){t=t.toLowerCase();const i=this[`rgb${e}`],s=this[`hsl${e}`],n=this[`hwb${e}`],r=this[`xyz${e}`],o=this[`lab${e}`],a=this[`lch${e}`];if(!i)return this;i.length=0,s.length=0,n.length=0,r.length=0,o.length=0,a.length=0;let l=0,h=0,c=0,u=0;if(t.indexOf("hwb")>=0&&!ei){const e=(t=(t=(t=(t=t.replace("hwb","")).replace("(","")).replace(")","")).replace("/","")).split(" ").filter((t=>null!=t&&""!==t));let l=e[0];l=l.indexOf("deg")>=0?parseFloat(l):l.indexOf("rad")>=0?parseFloat(l)/C:l.indexOf("grad")>=0?parseFloat(l)/400*360:l.indexOf("turn")>=0?360*parseFloat(l):parseFloat(l),l=$(l);let h=parseFloat(e[1]),c=parseFloat(e[2]),d=e[3];u=null!=d?d.indexOf("%")>=0?parseFloat(d)/100:parseFloat(d):1;let[f,p,m]=this.convertHWBtoRGB(l,h,c);f=Math.floor(255*f),f>255&&(f=255),f<0&&(f=0),p=Math.floor(255*p),p>255&&(p=255),p<0&&(p=0),m=Math.floor(255*m),m>255&&(m=255),m<0&&(m=0),i.push(f,p,m,u),s.push(...this.convertRGBtoHSL(f,p,m),u),n.push(l,h,c,u),r.push(...this.convertRGBtoXYZ(f,p,m),u),o.push(...this.convertXYZtoLAB(r[0],r[1],r[2]),u),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),u)}else if(t.indexOf("xyz")>=0){const e=(t=(t=(t=(t=t.replace("xyz","")).replace("(","")).replace(")","")).replace("/","")).split(" ").filter((t=>null!=t&&""!==t)),l=parseFloat(e[0]),h=parseFloat(e[1]),c=parseFloat(e[2]),d=e[3];u=null!=d?parseFloat(d):1,i.push(...this.convertXYZtoRGB(l,h,c),u),s.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),u),n.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],s[0]),u),r.push(l,h,c,u),o.push(...this.convertXYZtoLAB(l,h,c),u),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),u)}else if(t.indexOf("lab")>=0&&!ii){const e=(t=(t=(t=(t=t.replace("lab","")).replace("(","")).replace(")","")).replace("/","")).split(" ").filter((t=>null!=t&&""!==t)),l=parseFloat(e[0]),h=parseFloat(e[1]),c=parseFloat(e[2]),d=e[3];u=null!=d?parseFloat(d):1,o.push(l,h,c,u),r.push(...this.convertLABtoXYZ(l,h,c),u),i.push(...this.convertXYZtoRGB(r[0],r[1],r[2]),u),s.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),u),n.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],s[0]),u),a.push(...this.convertLABtoLCH(l,h,c),u)}else if(t.indexOf("lch")>=0&&!si){const e=(t=(t=(t=(t=t.replace("lch","")).replace("(","")).replace(")","")).replace("/","")).split(" ").filter((t=>null!=t&&""!==t)),l=parseFloat(e[0]),h=parseFloat(e[1]),c=parseFloat(e[2]),d=e[3];u=null!=d?parseFloat(d):1,a.push(l,h,c,u),o.push(...this.convertLCHtoLAB(l,h,c),u),r.push(...this.convertLABtoXYZ(o[0],o[1],o[2]),u),i.push(...this.convertXYZtoRGB(r[0],r[1],r[2]),u),s.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),u),n.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],s[0]),u)}else[l,h,c,u]=this.getColorFromCanvas(t),i.push(l,h,c,u),s.push(...this.convertRGBtoHSL(l,h,c),u),n.push(...this.convertRGBHtoHWB(l,h,c,s[0]),u),r.push(...this.convertRGBtoXYZ(l,h,c),u),o.push(...this.convertXYZtoLAB(r[0],r[1],r[2]),u),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),u);return this},Je.extractRGBfromColor=function(t){let e,i,s,n,r,o,a,l,h;if((t=t.toLowerCase()).includes("hwb")&&!ei){const r=(t=(t=(t=(t=t.replace("hwb","")).replace("(","")).replace(")","")).replace("/","")).split(" ").filter((t=>null!=t&&""!==t));return a=r[0],a=a.indexOf("deg")>=0?parseFloat(a):a.indexOf("rad")>=0?parseFloat(a)/C:a.indexOf("grad")>=0?parseFloat(a)/400*360:a.indexOf("turn")>=0?360*parseFloat(a):parseFloat(a),a=$(a),l=parseFloat(r[1]),h=parseFloat(r[2]),o=r[3],n=null!=o?o.indexOf("%")>=0?parseFloat(o)/100:parseFloat(o):1,[e,i,s]=this.convertHWBtoRGB(a,l,h),e=Math.floor(256*e),e>255&&(e=255),e<0&&(e=0),i=Math.floor(256*i),i>255&&(i=255),i<0&&(i=0),s=Math.floor(256*s),s>255&&(s=255),s<0&&(s=0),[e,i,s,n]}return t.includes("xyz")?(r=(t=(t=(t=(t=t.replace("xyz","")).replace("(","")).replace(")","")).replace("/","")).split(" ").filter((t=>null!=t&&""!==t)),e=parseFloat(r[0]),i=parseFloat(r[1]),s=parseFloat(r[2]),o=r[3],n=null!=o?parseFloat(o):1,[...this.convertXYZtoRGB(e,i,s),n]):t.includes("lab")&&!ii?(r=(t=(t=(t=(t=t.replace("lab","")).replace("(","")).replace(")","")).replace("/","")).split(" ").filter((t=>null!=t&&""!==t)),e=parseFloat(r[0]),i=parseFloat(r[1]),s=parseFloat(r[2]),o=r[3],n=null!=o?parseFloat(o):1,[...this.convertXYZtoRGB(...this.convertLABtoXYZ(e,i,s)),n]):t.indexOf("lch")>=0&&!si?(r=(t=(t=(t=(t=t.replace("lch","")).replace("(","")).replace(")","")).replace("/","")).split(" ").filter((t=>null!=t&&""!==t)),e=parseFloat(r[0]),i=parseFloat(r[1]),s=parseFloat(r[2]),o=r[3],n=null!=o?parseFloat(o):1,[...this.convertXYZtoRGB(...this.convertLABtoXYZ(...this.convertLCHtoLAB(e,i,s))),n]):this.getColorFromCanvas(t)},Je.convertRGBtoHex=function(t,e,i){if(t.substring&&(t=parseInt(t,10)),e.substring&&(e=parseInt(e,10)),i.substring&&(i=parseInt(i,10)),!isNaN(t)&&!isNaN(e)&&!isNaN(i)){return`#${("0"+t.toString(16)).slice(-2)}${("0"+e.toString(16)).slice(-2)}${("0"+i.toString(16)).slice(-2)}`}return"#000000"},Je.getColorFromCanvas=function(t){let e=0,i=0,s=0,n=0;const r=qe(),{element:o,engine:a}=r;o.width=1,o.height=1,a.save(),a.globalAlpha=1,a.globalCompositeOperation="source-over",a.fillStyle=t,a.fillRect(0,0,1,1);const l=a.getImageData(0,0,1,1);return l&&l.data&&([e,i,s,n]=l.data,n/=255),a.restore(),Qe(r),[e,i,s,n]},Je.convertRGBtoHSL=function(t,e,i){t/=256,e/=256,i/=256;let s=Math.max(t,e,i),n=Math.min(t,e,i),[r,o,a]=[0,0,(n+s)/2],l=s-n;if(0!==l){switch(o=0===a||1===a?0:(s-a)/Math.min(a,1-a),s){case t:r=(e-i)/l+(e<i?6:0);break;case e:r=(i-t)/l+2;break;case i:r=(t-e)/l+4}r*=60}return[r,100*o,100*a]},Je.convertHSLtoRGB=function(t,e,i){(t%=360)<0&&(t+=360),e/=100,i/=100;const s=function(s){let n=(s+t/30)%12,r=e*Math.min(i,1-i);return i-r*Math.max(-1,Math.min(n-3,9-n,1))};return[s(0),s(8),s(4)]},Je.convertRGBtoHWB=function(t,e,i){let s=this.convertRGBtoHSL(t,e,i,suffix);t/=256,e/=256,i/=256;let n=Math.min(t,e,i),r=1-Math.max(t,e,i);return[s[0],100*n,100*r]},Je.convertRGBHtoHWB=function(t,e,i,s){return t/=256,e/=256,i/=256,[s,100*Math.min(t,e,i),100*(1-Math.max(t,e,i))]},Je.convertHWBtoRGB=function(t,e,i){if((e/=100)+(i/=100)>=1){let t=e/(e+i);return[t,t,t]}let s=this.convertHSLtoRGB(t,100,50);for(let t=0;t<3;t++)s[t]*=1-e-i,s[t]+=e;return s},Je.convertRGBtoXYZ=function(t,e,i){const s=function(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)};e/=255,i/=255;const n=s(t/=255),r=s(e),o=s(i);return[100*(.4124*n+.3576*r+.1805*o)+0,100*(.2126*n+.7152*r+.0722*o)+0,100*(.0193*n+.1192*r+.9505*o)+0]},Je.convertXYZtoRGB=function(t,e,i){const s=function(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055},n=-.9689307147293197*(t/=100)+1.8757560608852415*(e/=100)+.041517523842953964*(i/=100),r=.055710120445510616*t+-.2040210505984867*e+1.0569959422543882*i,o=s(3.2406254773200533*t-1.5372079722103187*e-.4986285986982479*i),a=s(n),l=s(r);return[Math.round(255*o)+0,Math.round(255*a)+0,Math.round(255*l)+0]},Je.convertXYZtoLAB=function(t,e,i){const s=null!=Math.cbrt?Math.cbrt:t=>Math.pow(t,1/3),n=t=>t>.008856451679035631?s(t):(903.2962962962963*t+16)/116;e/=100,i/=108.9;const r=n(t/=95.05),o=n(e);return[116*o-16+0,500*(r-o)+0,200*(o-n(i))+0]},Je.convertLABtoXYZ=function(t,e,i){const s=216/24389,n=24389/27,r=(t+16)/116,o=r-i/200,a=e/500+r;return[95.05*(Math.pow(a,3)>s?Math.pow(a,3):(116*a-16)/n)+0,100*(t>8?Math.pow((t+16)/116,3):t/n)+0,108.9*(Math.pow(o,3)>s?Math.pow(o,3):(116*o-16)/n)]},Je.convertLABtoLCH=function(t,e,i){i=Math.abs(i)<Color.maxZeroTolerance?0:i;return[t+0,Math.sqrt(e*e+i*i)+0,(Math.atan2(i,e)>=0?Math.atan2(i,e)/Math.PI*180:Math.atan2(i,e)/Math.PI*180+360)+0]},Je.convertLCHtoLAB=function(t,e,i){return[t+0,e*Math.cos(i/180*Math.PI)+0,e*Math.sin(i/180*Math.PI)+0]},Je.calculateColorBlend=function(t,e,i,s,n,r){const[o,a,l]=this.convertRGBtoHSL(t,e,i),[h,c,u]=this.convertRGBtoHSL(s,n,r),[d,f,p]=this.convertHSLtoRGB(o,a,u);return[Math.round(255*d),Math.round(255*f),Math.round(255*p)]},Je.calculateHueBlend=function(t,e,i,s,n,r){const[o,a,l]=this.convertRGBtoHSL(t,e,i),[h,c,u]=this.convertRGBtoHSL(s,n,r),[d,f,p]=this.convertHSLtoRGB(o,c,u);return[Math.round(255*d),Math.round(255*f),Math.round(255*p)]},Je.calculateSaturationBlend=function(t,e,i,s,n,r){const[o,a,l]=this.convertRGBtoHSL(t,e,i),[h,c,u]=this.convertRGBtoHSL(s,n,r),[d,f,p]=this.convertHSLtoRGB(h,a,u);return[Math.round(255*d),Math.round(255*f),Math.round(255*p)]},Je.calculateLuminosityBlend=function(t,e,i,s,n,r){const[o,a,l]=this.convertRGBtoHSL(t,e,i),[h,c,u]=this.convertRGBtoHSL(s,n,r),[d,f,p]=this.convertHSLtoRGB(h,c,l);return[Math.round(255*d),Math.round(255*f),Math.round(255*p)]};let ei=!1,ii=!1,si=!1;!function(){let t,e=0,i=0,s=0,n=0,r="#ffffff00";const o=qe(),{element:a,engine:l}=o;a.width=1,a.height=1,l.save(),l.globalAlpha=1,l.globalCompositeOperation="source-over",l.fillStyle="hwb(90 10% 10%)",l.fillRect(0,0,1,1),t=l.getImageData(0,0,1,1),t&&t.data&&([e,i,s,n]=t.data),(e||i||s)&&(ei=!0),ei&&r===l.fillStyle?ei=!1:r=l.fillStyle,l.fillStyle="lab(29.2345% 39.3825 20.0664)",l.clearRect(0,0,1,1),l.fillRect(0,0,1,1),t=l.getImageData(0,0,1,1),t&&t.data&&([e,i,s,n]=t.data),(e||i||s)&&(ii=!0),ii&&r===l.fillStyle?ii=!1:r=l.fillStyle,l.fillStyle="lch(52.2345% 72.2 56.2)",l.clearRect(0,0,1,1),l.fillRect(0,0,1,1),t=l.getImageData(0,0,1,1),t&&t.data&&([e,i,s,n]=t.data),(e||i||s)&&(si=!0),si&&r===l.fillStyle?si=!1:r=l.fillStyle,l.restore(),Qe(o)}();const ni=function(t){return!!t&&new Color(t)};v.Color=Color;const ri=[.372549,.686275,.615686,.776471,.058824,.843137,.266667,.137255,.462745,1,.580392,.282353,.619608,.803922,.301961,.698039,.92549,.529412,.760784,.239216,.145098,.505882,.788235,.278431,.988235,.156863,.223529,.447059,.027451,.72549,.341176,.960784,.501961,.301961,.066667,.839216,.509804,.27451,.886275,.796078,.658824,.247059,.537255,.937255,.078431,.658824,.360784,.854902,.694118,.933333,.258824,.788235,.678431,.364706,.227451,.501961,.831373,.337255,.635294,.913725,.729412,.803922,.945098,.592157,.101961,.756863,.823529,.031373,.619608,.47451,.094118,.552941,.32549,.223529,.45098,.039216,.760784,.521569,.686275,.239216,.776471,.121569,.592157,.372549,.027451,.815686,.933333,.686275,.419608,.337255,.894118,.615686,.27451,.996078,.52549,.090196,.380392,.705882,.133333,.521569,.188235,.658824,.329412,.419608,.627451,.282353,.364706,.611765,.729412,.058824,.560784,.968627,.352941,.717647,.909804,.301961,.976471,.52549,.2,.082353,.498039,.223529,.866667,.933333,.078431,.443137,.909804,.564706,.121569,.992157,.007843,.490196,.368627,.678431,.890196,.545098,.301961,.839216,.172549,.67451,.101961,.478431,.890196,.231373,.47451,.062745,.294118,.611765,.67451,.909804,.196078,.470588,.643137,.054902,.768627,.937255,.619608,.090196,.576471,.121569,.768627,.466667,.933333,.392157,.733333,.090196,.466667,.576471,.14902,.392157,.019608,.635294,.321569,.768627,.976471,.027451,.282353,.443137,.109804,.011765,.729412,.439216,.882353,.023529,.760784,.529412,.411765,.05098,.25098,.360784,.019608,.313725,.517647,.388235,.278431,.572549,.905882,.698039,.980392,0,.756863,.941176,.662745,.85098,.32549,.176471,.882353,.011765,.988235,.462745,.694118,.937255,.321569,.505882,.45098,.07451,.552941,.223529,.113725,.8,.423529,.168627,.870588,.470588,.811765,.227451,.878431,.427451,.6,.109804,.752941,.058824,.882353,.721569,.47451,.921569,.133333,.305882,.843137,.466667,.27451,.156863,.498039,.094118,.780392,.439216,.337255,.564706,.945098,.690196,.360784,.133333,.639216,.294118,.035294,.870588,.411765,.529412,.305882,.866667,.223529,.6,.090196,.768627,.215686,.717647,.4,.882353,.372549,.74902,.062745,.580392,.647059,.858824,.988235,.423529,.372549,.584314,.039216,.741176,.345098,.572549,.831373,.392157,.501961,.909804,.419608,.27451,.686275,.023529,.803922,.219608,.631373,.972549,.039216,.341176,.690196,.968627,.505882,.827451,.454902,.243137,.556863,.490196,.639216,.811765,.992157,.552941,.305882,.168627,.615686,.101961,.694118,.14902,.862745,.203922,.521569,.670588,.768627,.192157,.701961,.854902,.45098,.184314,.121569,.4,.301961,.823529,.372549,.52549,.066667,.27451,.560784,.635294,.439216,.341176,.556863,.247059,.203922,.078431,.756863,.635294,.145098,.780392,.952941,.717647,.870588,.505882,.356863,.023529,.741176,.298039,.07451,.635294,.341176,0,.823529,.278431,.968627,.219608,.501961,.807843,.019608,.254902,.411765,.694118,.2,.027451,.760784,.423529,.690196,.854902,.592157,.141176,.909804,.760784,.278431,.062745,.611765,.470588,.729412,.8,.545098,.254902,.611765,.815686,.192157,.721569,.133333,.976471,.411765,.031373,.635294,.960784,.121569,.517647,.266667,.172549,.968627,.419608,.129412,.345098,.2,.784314,.109804,.858824,.823529,.243137,.945098,.490196,.137255,.247059,.172549,.686275,.854902,.211765,.945098,.584314,.352941,.14902,.439216,.286275,.776471,.835294,.2,.282353,.882353,.094118,.203922,.921569,.129412,.74902,.168627,.368627,.227451,.521569,.890196,.815686,.470588,1,.392157,.294118,.745098,.588235,.964706,.141176,.423529,.921569,.631373,.035294,1,.67451,.776471,.501961,.243137,.611765,.168627,.713725,.921569,.411765,.113725,.960784,.741176,.066667,.831373,.658824,.886275,.4,.85098,.227451,.552941,.360784,.27451,.192157,.039216,.67451,.937255,.580392,.627451,.203922,.968627,.752941,.54902,.921569,.717647,.462745,.545098,.686275,.337255,.168627,.67451,.564706,.878431,.964706,.521569,.615686,.941176,.882353,.211765,.035294,.372549,.247059,.721569,.019608,.811765,.164706,.913725,.396078,.211765,.996078,.160784,.698039,.937255,.101961,.784314,.552941,.447059,.698039,.505882,.862745,.286275,.482353,.054902,.92549,.592157,.811765,.717647,.294118,.831373,.588235,.72549,.003922,.490196,.301961,.643137,.388235,.105882,.713725,.321569,.968627,.776471,.337255,.054902,.368627,.494118,.117647,.898039,.678431,.556863,.921569,.494118,.137255,.54902,.756863,.603922,.337255,.717647,.635294,.4,.027451,.878431,.6,.713725,.133333,.654902,.05098,.270588,.560784,.215686,.937255,.470588,.090196,.32549,.843137,.470588,.270588,.094118,.572549,.227451,.337255,.07451,.952941,.560784,.866667,.113725,.462745,.203922,.772549,.866667,.501961,.184314,.294118,.788235,.141176,.607843,.505882,.294118,.992157,.007843,.905882,.647059,.470588,.580392,.298039,.231373,.133333,.831373,.4,.490196,.145098,.25098,.356863,.172549,.843137,.133333,.411765,.07451,.996078,.439216,.772549,.094118,.345098,.72549,.298039,.109804,.341176,.572549,.47451,.933333,.627451,.411765,.533333,.490196,.321569,.858824,.545098,.023529,.843137,.505882,.341176,.258824,.035294,.392157,.921569,.333333,.247059,.839216,.168627,.345098,.796078,.427451,.666667,.309804,.031373,.509804,.47451,.082353,.941176,.254902,.545098,.905882,.705882,.14902,.454902,.580392,.894118,.666667,.023529,.470588,.572549,.619608,.823529,.733333,.533333,.270588,.807843,.07451,.188235,.654902,.4,.921569,0,.435294,.156863,1,.533333,.803922,.333333,.960784,.286275,.07451,.443137,.937255,.341176,.741176,.843137,.670588,0,.835294,.643137,.713725,.035294,.552941,.886275,.388235,.721569,.52549,.823529,.419608,.647059,.023529,.360784,.941176,.294118,.631373,.003922,.368627,.247059,.67451,.92549,.505882,.372549,.035294,.741176,.117647,.678431,.439216,.807843,.109804,.384314,.776471,.988235,.447059,.713725,.890196,.329412,.592157,.909804,.686275,.509804,.054902,.643137,.266667,.890196,.607843,.835294,.305882,.239216,.498039,.039216,.184314,.435294,.796078,.658824,.141176,.745098,.823529,.105882,.176471,.988235,.647059,.117647,.768627,.247059,.615686,.321569,.090196,.74902,.654902,.466667,.576471,.164706,.05098,.647059,.078431,.937255,.564706,.729412,.247059,.843137,.141176,.380392,.870588,.639216,.160784,.780392,.4,.643137,.203922,.333333,.992157,.023529,.858824,.203922,.529412,.415686,.858824,.101961,.937255,.137255,.231373,.988235,.027451,.396078,.878431,.721569,.239216,.066667,.803922,.321569,.686275,.831373,.039216,.25098,.678431,.223529,.478431,.552941,.760784,.862745,.392157,.172549,.52549,.086275,.423529,.337255,.498039,.258824,.227451,.996078,.184314,.772549,.305882,.941176,.145098,.878431,.294118,.729412,.211765,.8,.690196,.529412,.94902,.756863,.564706,.105882,.603922,.05098,.439216,.227451,.964706,.815686,.564706,.345098,.211765,.717647,.521569,.882353,.160784,.823529,.082353,.521569,.266667,.796078,.101961,.023529,.843137,.298039,.784314,.980392,.427451,.72549,.188235,.521569,.141176,.890196,.654902,.788235,.6,.921569,.521569,.066667,.980392,.266667,.505882,.301961,.784314,.882353,.227451,.423529,.698039,.101961,.905882,.772549,.427451,.960784,.219608,.870588,.705882,.796078,.94902,.552941,.756863,.447059,.145098,.023529,.988235,.537255,.2,.72549,.964706,.239216,.545098,.360784,.05098,.945098,.129412,.752941,.545098,.768627,.25098,.360784,.129412,.796078,.188235,.294118,.705882,.356863,.447059,.647059,.333333,.611765,.509804,.368627,1,.560784,.462745,.886275,.231373,.501961,.396078,.913725,.576471,.066667,.831373,.654902,.121569,.25098,.607843,.788235,.137255,.972549,.627451,.776471,.117647,.894118,.427451,.380392,.607843,.686275,0,.45098,.192157,.6,.023529,.917647,.501961,.419608,.086275,.243137,.423529,.156863,.886275,.478431,.988235,.760784,.662745,.870588,.270588,.447059,.164706,.615686,.890196,.254902,.039216,.333333,.223529,.619608,.372549,.003922,.67451,.184314,.45098,.752941,.615686,.419608,.184314,.572549,.007843,.356863,.803922,.047059,.678431,.396078,1,.270588,.862745,.4,.215686,.372549,.827451,.439216,.678431,.05098,.564706,.352941,.058824,.592157,.941176,.490196,.380392,.580392,.164706,.52549,.133333,.286275,.356863,.505882,.196078,.258824,.360784,.894118,.686275,.305882,.415686,.631373,.909804,.498039,.039216,.309804,.85098,.721569,.47451,.831373,.607843,.364706,.482353,.07451,.92549,.635294,.721569,.996078,.603922,.494118,.890196,.537255,.082353,.756863,.921569,.156863,.094118,.815686,.294118,.137255,.607843,.184314,.745098,.647059,.105882,.294118,.776471,.14902,.415686,.364706,.988235,.007843,.494118,.686275,.309804,.886275,.25098,.184314,.941176,.576471,.698039,.854902,.090196,.498039,.223529,.85098,.690196,.392157,.333333,.776471,.145098,.580392,.85098,.039216,.721569,.345098,.835294,.282353,.4,.160784,.32549,.564706,.011765,.694118,.960784,.062745,.47451,.831373,.564706,.694118,.92549,.537255,.741176,.941176,.858824,.52549,.980392,.380392,.239216,.94902,.109804,.670588,.858824,.509804,.298039,.960784,.462745,.572549,.337255,.047059,.145098,.713725,.313725,.768627,.027451,.6,.2,.937255,.717647,.45098,.815686,.168627,.309804,.8,.2,.05098,.686275,.843137,.760784,.007843,1,.094118,.843137,.443137,.615686,.105882,.223529,.501961,.811765,.05098,.294118,.447059,.772549,.678431,.090196,.913725,.2,.278431,0,.886275,.176471,.690196,.321569,.505882,.439216,.027451,.345098,.247059,.670588,.027451,.835294,.196078,.560784,.462745,.894118,.231373,.694118,.784314,.945098,.372549,.090196,.545098,.870588,.435294,.733333,.945098,.521569,.815686,.231373,.72549,.905882,.435294,.039216,.552941,.462745,.72549,.411765,.027451,.313725,.137255,.784314,.360784,.968627,.556863,.8,.105882,.992157,.521569,.27451,.909804,.639216,.952941,.494118,.188235,.662745,.027451,.552941,.85098,.129412,.619608,.796078,.411765,.286275,.752941,.388235,.133333,.992157,.447059,.05098,.27451,.470588,.121569,.407843,.631373,.286275,.145098,.843137,.537255,.321569,.741176,.219608,.129412,.639216,.85098,.082353,.164706,.752941,.509804,.466667,.643137,.952941,.576471,.141176,.913725,.505882,.388235,.129412,.247059,.968627,.694118,.007843,.556863,.866667,.278431,.92549,.384314,.615686,.435294,.670588,.572549,.701961,.007843,.796078,.976471,.6,.886275,.733333,.164706,.705882,.121569,.592157,.360784,.537255,.14902,.572549,.666667,.45098,.254902,.94902,.827451,.105882,.215686,.843137,.090196,.772549,.917647,.164706,.407843,.964706,.345098,.247059,.745098,.654902,0,.439216,.529412,.062745,.282353,.827451,.988235,.227451,0,.588235,.243137,.047059,.631373,.282353,.545098,.364706,.164706,.827451,.721569,.313725,.078431,.662745,.811765,.529412,.215686,.898039,.619608,.282353,.054902,.447059,.643137,.215686,.713725,.066667,.345098,.45098,.305882,.101961,.772549,.603922,.952941,.239216,.72549,.494118,.988235,.223529,.101961,.545098,.913725,.631373,.243137,.741176,.411765,.788235,.156863,.807843,.32549,.219608,.039216,.807843,.670588,.482353,.035294,.803922,.443137,.988235,.411765,.784314,.25098,.6,.937255,.282353,.823529,.913725,.196078,.105882,.443137,.733333,.337255,.788235,.062745,.85098,.631373,.505882,.419608,.898039,.733333,.439216,.643137,.05098,.490196,.239216,.898039,.2,.32549,.933333,.14902,.478431,.337255,.192157,0,.447059,.341176,.972549,.835294,.211765,.94902,.258824,.411765,.815686,.980392,.721569,.537255,.341176,.619608,.392157,.572549,.933333,.694118,.52549,.439216,.8,.639216,.529412,.705882,.105882,.941176,.368627,.584314,.870588,.2,.729412,.47451,.419608,.666667,.341176,.490196,.909804,.384314,.717647,.133333,.894118,.772549,.082353,.960784,.635294,.188235,1,.854902,.470588,.254902,.964706,.705882,.470588,.117647,.756863,.164706,.905882,.301961,.509804,.854902,.8,.145098,.745098,.54902,.890196,.364706,.462745,.07451,.894118,.427451,.039216,.356863,.870588,.478431,.854902,.172549,.019608,.517647,.313725,.086275,.870588,.639216,.968627,.584314,.705882,.905882,.509804,.101961,.898039,.592157,.266667,.160784,.619608,.572549,.011765,.490196,.380392,.729412,.423529,0,.603922,.384314,.862745,.278431,.643137,.239216,.996078,.564706,.298039,.760784,.184314,.101961,.345098,.231373,.137255,.976471,.313725,.803922,.717647,.14902,.835294,.52549,.254902,.4,.733333,.85098,.552941,.666667,.905882,.247059,.54902,.509804,.027451,.690196,.878431,.74902,.031373,.337255,.094118,.160784,.784314,.047059,.745098,.882353,.282353,.196078,.368627,.129412,.301961,.223529,.035294,.866667,.443137,.537255,.14902,.254902,.996078,.321569,.639216,.933333,.25098,.133333,.643137,.8,.164706,.54902,.968627,.411765,.482353,.239216,.607843,.4,.266667,.529412,.117647,.364706,.164706,.603922,.364706,.05098,.4,.580392,.823529,.372549,.686275,.945098,0,.564706,.388235,.658824,.227451,.003922,.811765,.176471,.690196,.321569,.803922,.282353,.670588,.615686,.258824,.729412,.584314,.27451,.67451,.827451,.937255,.545098,.203922,.364706,.498039,.082353,.839216,.419608,.345098,.203922,.741176,.384314,.92549,.705882,.082353,.301961,.968627,.827451,.188235,.882353,.145098,.670588,.243137,.796078,.07451,.509804,.835294,.019608,.176471,.686275,.447059,.039216,.913725,.580392,.8,.470588,.705882,.6,.078431,.556863,.407843,.039216,.356863,.768627,.094118,.898039,.576471,.05098,.305882,.388235,.086275,.752941,.627451,.305882,.823529,.45098,.117647,.611765,.509804,.215686,.627451,.933333,.505882,.2,.47451,.321569,.062745,.662745,.592157,.968627,.898039,.690196,.576471,.164706,.313725,.815686,.062745,.760784,.407843,.101961,.823529,.019608,.584314,.890196,.054902,.282353,.835294,.078431,.301961,.768627,.023529,.670588,.333333,.811765,.019608,.67451,.74902,.572549,.905882,.8,.090196,.85098,.67451,.992157,.247059,.509804,.129412,.45098,.254902,.117647,.878431,.462745,.952941,.603922,.282353,.980392,.490196,.156863,.572549,.184314,.94902,.807843,.156863,.039216,.980392,.435294,.352941,.768627,.039216,.607843,.698039,.286275,.007843,.67451,.164706,.270588,.988235,.631373,.466667,0,.203922,.827451,.466667,.882353,.129412,.662745,.537255,.078431,.980392,.501961,.321569,.560784,.972549,.694118,.4,.607843,.478431,.937255,.368627,.831373,.603922,.286275,.941176,.031373,.866667,.368627,.164706,.913725,.654902,.494118,.972549,.45098,.635294,.67451,.223529,.133333,1,.843137,.490196,.164706,.941176,.066667,.415686,.192157,.278431,.937255,.356863,.886275,.462745,.831373,.286275,.698039,.913725,.137255,.423529,.803922,.733333,.066667,.47451,.752941,.380392,.968627,.627451,.686275,.909804,.47451,.686275,.560784,.137255,.466667,.756863,.521569,.968627,.443137,.74902,.498039,.639216,.192157,.843137,.992157,.133333,.498039,.913725,.862745,.321569,.05098,.231373,.423529,.517647,.298039,.168627,.333333,.035294,.894118,.607843,.733333,.337255,.933333,.74902,.14902,.313725,.701961,.411765,.07451,.643137,.839216,.745098,.407843,.082353,.478431,.321569,.392157,.701961,.109804,.870588,.141176,.466667,.266667,.945098,.772549,.466667,.933333,.619608,.533333,.768627,.121569,.309804,.960784,.666667,.494118,.380392,.729412,.239216,.4,.329412,.6,.780392,.388235,.85098,.145098,.439216,.196078,.113725,.890196,.776471,.086275,.243137,.733333,.141176,.447059,.67451,.215686,.533333,.831373,.266667,.752941,.301961,.2,.854902,.003922,.282353,.827451,.372549,.521569,.776471,.713725,.603922,.215686,.368627,.894118,.658824,.776471,.572549,.031373,.678431,.741176,.168627,.380392,.027451,.588235,.807843,.631373,.980392,.521569,.215686,.345098,.270588,.117647,.85098,.007843,.247059,.352941,.192157,.6,.301961,.917647,.796078,.345098,.298039,.172549,.364706,.701961,.227451,.101961,.878431,.380392,.552941,.282353,.721569,.572549,.172549,.384314,.470588,.980392,.721569,.631373,.886275,.74902,.552941,.933333,.639216,.082353,.780392,.823529,.188235,.615686,.52549,.368627,.054902,.839216,.490196,.937255,.231373,.345098,.007843,.992157,.533333,.662745,.756863,.945098,.572549,.231373,.639216,.313725,.890196,.396078,.121569,.858824,.164706,.407843,.313725,.807843,.027451,.858824,.556863,.807843,.25098,.105882,.580392,.192157,.796078,.933333,.05098,.835294,.254902,.105882,.72549,.023529,.666667,.933333,.356863,.552941,.309804,.662745,.196078,.509804,.407843,.858824,.058824,.32549,.627451,.415686,.011765,.976471,.592157,.101961,.701961,.572549,.184314,.439216,.921569,.643137,.270588,.423529,.039216,.811765,.537255,.713725,.254902,.988235,.490196,.823529,.105882,.247059,.545098,.658824,.952941,.117647,.239216,.380392,.031373,.282353,.878431,.572549,.917647,.419608,.529412,.588235,.772549,.443137,.117647,.878431,.023529,.243137,.701961,.090196,.862745,.670588,.031373,.933333,.576471,.329412,.952941,.603922,.062745,.439216,.898039,.078431,.239216,.631373,.141176,.788235,.282353,.164706,.023529,.392157,.117647,.796078,.439216,.364706,.282353,.490196,.415686,.019608,.239216,.905882,.662745,.129412,.588235,.196078,.729412,.470588,.6,.301961,.211765,.894118,.258824,.066667,.482353,.788235,.011765,.945098,.521569,.658824,.07451,.545098,.733333,.886275,.07451,.203922,.494118,.380392,.607843,.168627,.4,.776471,.972549,.011765,.619608,.482353,.686275,.215686,.470588,.972549,.592157,.517647,.803922,.258824,.721569,.05098,.415686,.886275,.803922,.027451,.996078,.760784,.172549,.933333,.780392,.086275,.694118,.454902,.886275,.388235,.815686,.337255,.976471,.74902,.101961,.035294,.341176,.172549,.898039,.321569,.113725,.490196,.047059,.14902,.32549,.384314,.607843,.968627,.066667,.854902,.341176,.439216,.768627,.537255,.729412,.168627,.686275,.796078,.05098,.647059,.192157,.933333,.090196,.827451,.505882,.972549,.364706,.533333,.427451,.619608,.972549,.505882,.807843,.156863,.454902,.027451,.745098,.270588,.164706,.796078,.345098,.666667,.768627,.854902,.533333,.105882,.564706,.356863,.960784,.6,.243137,.478431,.690196,.231373,.913725,.117647,1,.690196,.796078,.552941,.439216,.980392,.309804,.803922,.078431,.890196,.690196,.843137,.388235,.121569,.615686,.176471,.878431,.305882,.701961,.564706,.196078,.784314,.345098,.615686,.243137,.576471,.968627,.654902,.698039,.94902,.039216,.494118,.909804,.32549,.678431,.466667,.286275,.384314,.94902,.156863,.666667,.368627,.294118,.192157,.886275,.490196,.607843,.160784,.945098,.564706,.478431,.27451,.615686,.341176,.556863,.478431,.282353,.921569,.545098,.145098,.768627,.054902,.627451,.239216,.121569,.494118,.588235,.839216,.968627,.52549,.745098,.643137,.968627,.439216,.858824,.615686,.913725,.219608,.788235,.443137,.309804,.717647,.517647,.192157,.92549,.086275,.878431,.490196,.411765,.109804,.976471,.305882,.721569,.278431,.407843,.576471,.301961,.741176,.662745,.14902,.835294,.054902,.2,.411765,.266667,.619608,.866667,.815686,.52549,.67451,.470588,.858824,.580392,.039216,.419608,.937255,.32549,.686275,.882353,.45098,.827451,.670588,.05098,.862745,.980392,.011765,.662745,.572549,.301961,.854902,.047059,.219608,.270588,.713725,.027451,.372549,.529412,.270588,.164706,.027451,.572549,.690196,.815686,.415686,.52549,.992157,.360784,.090196,.827451,.282353,.980392,.023529,.462745,.145098,.32549,.427451,.184314,.278431,.745098,.243137,.815686,.078431,.215686,.890196,.85098,.129412,.760784,.580392,.066667,.890196,.768627,.066667,.415686,.035294,.831373,.219608,.701961,.341176,.129412,.898039,.698039,.062745,.247059,.741176,.113725,.831373,.345098,.25098,.521569,.427451,.937255,.529412,.862745,.721569,.309804,.203922,.698039,.564706,.360784,.266667,.203922,.580392,.360784,.741176,.101961,.501961,.690196,.156863,.92549,.035294,.784314,.603922,.278431,.647059,.341176,.960784,.227451,.615686,.360784,.466667,.878431,.062745,.717647,.952941,.211765,.039216,.788235,.270588,.909804,.592157,.329412,.768627,.101961,.694118,.309804,.211765,.360784,.117647,.94902,.309804,.2,.996078,.282353,.482353,.027451,.243137,.756863,.07451,.188235,.337255,.756863,.14902,.32549,.54902,.388235,.756863,.164706,.482353,.372549,.937255,.505882,.839216,.615686,.917647,.666667,.423529,.941176,.788235,.454902,.972549,.364706,.027451,.752941,.129412,.239216,.462745,.72549,.137255,.396078,.85098,.686275,.501961,.827451,.760784,.086275,.894118,.447059,.678431,.556863,.396078,.639216,.517647,.047059,.231373,.529412,.337255,.811765,.435294,.243137,.670588,.556863,.980392,.368627,.517647,.784314,.019608,.4,.211765,.811765,.447059,.870588,.592157,.396078,.196078,.658824,1,.078431,.294118,.196078,.67451,.011765,.392157,.270588,.788235,.45098,.090196,.003922,.776471,.937255,.066667,.803922,.282353,.658824,.019608,.878431,.388235,.580392,.231373,.419608,.905882,.133333,.384314,.815686,.031373,.556863,.768627,.156863,.815686,.537255,.164706,.611765,.333333,.121569,.631373,.435294,.372549,.478431,.733333,0,.905882,.556863,1,.435294,.07451,.917647,.631373,.003922,.768627,.521569,.117647,.796078,.176471,.588235,.4,.988235,.294118,.564706,.521569,.937255,.415686,.615686,.835294,.078431,.945098,.25098,.603922,.741176,.647059,.105882,.156863,.454902,.211765,.058824,.760784,.321569,.494118,.176471,.07451,.662745,.27451,.607843,.858824,.662745,.905882,.482353,.611765,.894118,.192157,.752941,.286275,.035294,.909804,.537255,.603922,.337255,.007843,.992157,.137255,.309804,.721569,.807843,.411765,.988235,.619608,.047059,.490196,.964706,.729412,.333333,.129412,.666667,.27451,.882353,.588235,.941176,.647059,.156863,.368627,.988235,.047059,.811765,.52549,0,.729412,.603922,.85098,.803922,.356863,.47451,.090196,.941176,.643137,.129412,.913725,.835294,.470588,.666667,.52549,.223529,.423529,.960784,.552941,.341176,.756863,.121569,.478431,.694118,.035294,.74902,.52549,.466667,.203922,.713725,.898039,.258824,.003922,.67451,.85098,.423529,.909804,.784314,.54902,.870588,.188235,.105882,.968627,.662745,.372549,.482353,.160784,.647059,.8,.556863,.27451,.721569,.396078,.607843,.470588,.705882,.921569,.67451,.827451,.145098,.635294,.921569,.047059,.470588,.117647,.282353,.72549,.196078,.509804,.823529,.419608,.003922,.321569,.772549,.556863,.294118,.8,.976471,.588235,.109804,.631373,.270588,.866667,.537255,.921569,.192157,.419608,.019608,.796078,.184314,.066667,.533333,.321569,.129412,.988235,.631373,.384314,.243137,.145098,.843137,.772549,.184314,.854902,.494118,.92549,.592157,.164706,.690196,.27451,.843137,.121569,.588235,.184314,.894118,.454902,.831373,.188235,.443137,.105882,.74902,.498039,.556863,.090196,.305882,.647059,.254902,.921569,.443137,.345098,.698039,.133333,.552941,.972549,.760784,.592157,.862745,.545098,.356863,.247059,.615686,.172549,.321569,.109804,.607843,.85098,.133333,.454902,.231373,.643137,.839216,.988235,.341176,.858824,.294118,.976471,.776471,.090196,.631373,.313725,.501961,.996078,.384314,.219608,.078431,.494118,.258824,.023529,.992157,.705882,.592157,.305882,.215686,.129412,.843137,.239216,.035294,.345098,.843137,.443137,.172549,.886275,.05098,.858824,.380392,.247059,.07451,.529412,.454902,.364706,.247059,.701961,.796078,.658824,.909804,.498039,.360784,.058824,.686275,.890196,.2,.823529,.996078,.392157,.701961,.090196,.364706,.188235,.905882,.721569,.372549,.780392,.156863,.470588,.807843,.341176,.564706,.294118,.94902,.368627,.8,.670588,.439216,.584314,.196078,.490196,.713725,.960784,.286275,.494118,.713725,.435294,.25098,.105882,.337255,.011765,.462745,.913725,.219608,.372549,.545098,.278431,.011765,.788235,.588235,.05098,.976471,.356863,.286275,.231373,.854902,.776471,.713725,.47451,.105882,.760784,.870588,.215686,.964706,.388235,.278431,.090196,.231373,.172549,.309804,.047059,.462745,1,.690196,.392157,.882353,.772549,.980392,.356863,.047059,.729412,.937255,.062745,.184314,.439216,.572549,.101961,.168627,.592157,.25098,.345098,.941176,.423529,.078431,.592157,.741176,.32549,.945098,.607843,.807843,.407843,.333333,.078431,.517647,.788235,.447059,.905882,.721569,.580392,.94902,.745098,.490196,.168627,.988235,.333333,.227451,.654902,.14902,.54902,.309804,.839216,0,.756863,.870588,.172549,.380392,.219608,.003922,.866667,.992157,.627451,.301961,.113725,.537255,.498039,.05098,.243137,.858824,.521569,.643137,.47451,.4,.003922,.996078,.607843,.333333,.690196,.082353,.976471,.521569,.117647,.705882,.427451,.247059,.917647,.023529,.862745,.345098,.784314,.05098,.654902,.407843,.101961,.627451,.05098,.768627,.647059,.960784,.4,.807843,.658824,.086275,.776471,.713725,.862745,.419608,.345098,.215686,.721569,.521569,.858824,.713725,.035294,.968627,.396078,.188235,.952941,.14902,.372549,.572549,.058824,.788235,.462745,.654902,.721569,.509804,.933333,.694118,.815686,.741176,.066667,.572549,.278431,.031373,.427451,.721569,.564706,.301961,.807843,.517647,.4,.698039,.282353,.807843,.658824,.415686,.913725,.670588,.121569,.823529,.552941,.870588,.184314,.454902,.772549,.090196,.690196,.160784,.768627,.647059,.243137,.917647,.392157,.643137,.082353,.505882,.321569,.411765,.227451,.090196,.698039,.580392,.803922,.494118,.101961,.788235,.964706,.717647,.203922,.952941,.529412,.090196,.611765,.976471,.521569,.329412,.537255,.14902,.776471,.392157,.941176,.729412,.172549,.662745,.6,.117647,.921569,.768627,.27451,.831373,.572549,.105882,.231373,.427451,.031373,.866667,.247059,.752941,.631373,.843137,.078431,.607843,.756863,.145098,.52549,.941176,.27451,.082353,.905882,.529412,.223529,.941176,.356863,.898039,.498039,.211765,.556863,.156863,.564706,.337255,.968627,.490196,.101961,.619608,.67451,.92549,.494118,.137255,.615686,.196078,.584314,.121569,.341176,.627451,.54902,.843137,.678431,.301961,.505882,.196078,.909804,.023529,.890196,.384314,.45098,.133333,.27451,.411765,.184314,.788235,.941176,.517647,.105882,.254902,.188235,.662745,.890196,.137255,.588235,.882353,.023529,.490196,.211765,.776471,.509804,0,.466667,.752941,.211765,.027451,.698039,.835294,.266667,.537255,.380392,.215686,.913725,.560784,.843137,.019608,.733333,.184314,.278431,.827451,.019608,.921569,.643137,.878431,.294118,.039216,.435294,.74902,.92549,.447059,.392157,.607843,.105882,.666667,.423529,.278431,.47451,.815686,.062745,.74902,.690196,.427451,.227451,.035294,.580392,.329412,.45098,.960784,.321569,.411765,.215686,.05098,.321569,.160784,.913725,.490196,.811765,.94902,.647059,.54902,.380392,.211765,.470588,.172549,.996078,.305882,.490196,.219608,.694118,.423529,.686275,.556863,.843137,.341176,.733333,.815686,.564706,.133333,.298039,.835294,.733333,.886275,.294118,.435294,.031373,.239216,.917647,.211765,.839216,.062745,.282353,.380392,.811765,.423529,.937255,.482353,.815686,.270588,.011765,.435294,.231373,.937255,.054902,.556863,.333333,.619608,.298039,.054902,.796078,.980392,.611765,.509804,.862745,.137255,.356863,.619608,.811765,.937255,.478431,.082353,.4,.219608,.313725,.952941,.729412,.352941,.992157,.058824,.301961,.870588,.619608,.372549,.27451,.921569,.356863,.121569,.639216,.019608,.878431,.470588,.294118,.129412,.443137,.356863,.882353,.490196,.992157,.6,.698039,.121569,.466667,.803922,.356863,.94902,.654902,.278431,.188235,.019608,.27451,.862745,.490196,.27451,.772549,.917647,.14902,.631373,.427451,.286275,.121569,.843137,.937255,.482353,.803922,.862745,.058824,.768627,.368627,.576471,.803922,.976471,.619608,.745098,.678431,.27451,.184314,.345098,.729412,.141176,.898039,.803922,.011765,.345098,.556863,.886275,.364706,.078431,.839216,.301961,.121569,.211765,.443137,.160784,0,.294118,.466667,.172549,.705882,.039216,.270588,.062745,.941176,.619608,.827451,.686275,.52549,.364706,.14902,.564706,.768627,.968627,.003922,.247059,.752941,.086275,.67451,.760784,.886275,.090196,.721569,.592157,.827451,.690196,.227451,.835294,.156863,.721569,.556863,.333333,0,.25098,.909804,.670588,.470588,.215686,.741176,.384314,.588235,.960784,.701961,.772549,.545098,.105882,.619608,.137255,.815686,.580392,.27451,.717647,.14902,.976471,.580392,.67451,.517647,.427451,.992157,.572549,.760784,.952941,.027451,.607843,.780392,.184314,.580392,.090196,.231373,.415686,.356863,.196078,.545098,.254902,.6,.184314,.129412,.54902,.835294,.631373,.698039,.058824,.184314,.843137,.345098,.035294,.698039,.203922,.878431,.968627,.364706,.615686,.078431,.639216,.192157,.27451,.101961,.631373,.890196,.007843,.705882,.52549,.466667,.039216,.396078,.580392,.784314,.509804,.078431,.258824,.678431,.490196,.6,.827451,.698039,.109804,.666667,.572549,.968627,.639216,.756863,.482353,1,.603922,.760784,.662745,.882353,.992157,.607843,.396078,.47451,.690196,.509804,.172549,.133333,.321569,.584314,.780392,.996078,.45098,.329412,.592157,.878431,.517647,.305882,1,.368627,.137255,.592157,.964706,.415686,.321569,.121569,.992157,.423529,.537255,.94902,.490196,.184314,.831373,.635294,.72549,.372549,.094118,.839216,.027451,.298039,.160784,.843137,.341176,.011765,.843137,.172549,.443137,.286275,.537255,.388235,.662745,.894118,.427451,.113725,.827451,.062745,.784314,.203922,.878431,.298039,.14902,.411765,.333333,.729412,.505882,.972549,.670588,.305882,.921569,.647059,.752941,.839216,.976471,.741176,0,.898039,.490196,.772549,.360784,.894118,.4,.521569,.964706,.745098,.423529,.576471,.996078,.501961,.333333,.011765,.670588,.184314,.52549,.329412,.701961,.388235,.545098,.933333,.223529,.509804,.14902,.282353,.352941,.231373,.886275,.129412,.964706,.003922,.882353,.439216,.988235,.329412,.094118,.94902,.278431,.211765,.45098,.784314,.164706,.32549,.003922,.905882,.356863,.815686,.082353,.396078,.52549,.090196,.352941,.52549,.776471,.92549,.337255,.843137,.760784,.427451,.866667,.082353,.266667,.019608,.658824,.215686,.694118,.101961,.164706,.643137,.54902,.219608,.466667,.305882,.505882,.184314,.776471,.462745,.086275,.8,.027451,.67451,.258824,.396078,.882353,.117647,.447059,.278431,.576471,.968627,.478431,.788235,.647059,.105882,.501961,.266667,.47451,.937255,.666667,.862745,.941176,.192157,.058824,.796078,.2,.533333,.329412,.466667,.407843,.090196,.713725,.811765,.227451,.705882,.101961,.831373,.25098,.141176,.372549,.807843,.031373,.509804,.113725,.32549,.058824,.423529,.823529,.309804,.690196,.996078,.082353,.254902,.121569,.807843,.329412,.094118,.647059,.239216,.094118,.752941,.858824,.576471,.470588,.780392,.270588,.894118,.058824,1,.466667,.788235,.678431,.423529,.858824,.94902,.062745,.831373,.772549,.545098,.313725,.231373,.67451,.627451,.803922,.196078,.729412,.407843,.647059,.039216,.976471,.835294,.270588,.466667,.533333,.094118,.243137,.690196,.305882,.937255,.203922,.243137,.85098,.027451,.160784,.223529,.101961,.380392,.007843,.662745,.94902,.478431,.72549,.882353,.4,.121569,.894118,.454902,.796078,.4,.854902,.031373,.894118,.8,.662745,.011765,.882353,.254902,.584314,.184314,.360784,.74902,.909804,.078431,.517647,.760784,.972549,.184314,.752941,.239216,.423529,.54902,1,.219608,.768627,.627451,.384314,.047059,.580392,.231373,.023529,.745098,.482353,.352941,.592157,.92549,.741176,.239216,.964706,.615686,.019608,.521569,.462745,.882353,.215686,.564706,.423529,.054902,.858824,.580392,.45098,.184314,.878431,.270588,.631373,.576471,.411765,.094118,.211765,.443137,.580392,.733333,.47451,.2,.921569,.560784,.372549,.909804,.462745,.168627,.258824,.380392,.945098,.086275,.831373,.423529,.741176,.145098,.603922,.305882,.035294,.333333,.729412,.560784,.462745,.662745,.176471,.435294,.729412,.482353,.164706,.384314,.505882,.031373,.592157,.133333,.882353,.521569,.352941,.141176,.615686,.94902,.8,.72549,.435294,.572549,.145098,.756863,.588235,.72549,.439216,.776471,.894118,.658824,.6,.996078,.27451,.545098,.219608,.364706,.160784,.529412,.627451,.835294,.352941,.282353,.94902,.054902,.701961,.607843,.129412,.698039,.247059,.945098,.545098,.690196,.921569,.494118,.858824,.141176,.309804,.580392,.219608,.32549,.035294,.54902,.678431,.117647,.882353,.062745,.352941,.454902,.92549,.827451,.14902,.701961,.321569,.768627,.415686,.694118,.980392,.117647,.862745,.003922,.662745,.164706,.823529,.439216,.329412,.933333,.584314,.047059,.992157,.639216,.745098,.92549,.258824,.713725,.341176,1,.686275,.505882,.917647,.701961,.164706,.945098,.635294,.807843,.019608,.862745,.678431,.592157,.282353,.023529,.843137,.694118,.313725,.815686,.627451,.058824,.690196,.156863,.560784,.631373,.356863,.215686,.866667,.086275,.968627,.184314,.615686,.105882,.321569,1,.023529,.635294,.941176,.843137,.109804,.909804,.223529,.843137,.933333,.454902,.733333,.309804,.580392,.713725,.05098,.380392,.286275,.188235,.972549,.870588,.003922,.462745,.92549,.113725,.388235,.572549,.278431,.490196,.733333,.454902,.803922,.062745,.721569,.843137,.784314,.305882,.921569,.047059,.572549,.733333,.52549,.239216,.329412,.976471,.494118,.411765,.341176,.058824,.435294,.313725,.713725,.066667,.635294,.435294,.811765,.701961,.94902,.654902,.415686,.909804,.811765,.329412,.619608,.160784,.721569,.588235,.282353,.086275,.505882,.968627,.882353,.117647,.52549,.278431,.607843,.247059,.4,.517647,.298039,.576471,.886275,.215686,.760784,.176471,.380392,.701961,.286275,.364706,.470588,.176471,.545098,.113725,.223529,.8,.392157,.141176,.054902,.239216,.858824,.533333,.329412,.505882,.27451,.372549,.105882,.976471,.4,.752941,.137255,.494118,.019608,.917647,.537255,.729412,.305882,.960784,.454902,.019608,.843137,.490196,.666667,.439216,.529412,.835294,.894118,.247059,.517647,.796078,.388235,.254902,.062745,.768627,.294118,.67451,.607843,.415686,.337255,.25098,.8,.07451,.184314,.913725,.490196,.870588,.666667,.117647,.615686,.329412,.517647,.811765,.321569,.662745,.188235,.960784,.058824,.352941,.082353,.196078,.898039,.639216,.482353,.129412,.05098,.443137,.215686,.498039,.176471,.654902,.133333,.447059,.784314,.156863,.247059,.760784,.917647,.627451,.843137,.145098,.384314,.215686,.980392,.266667,.529412,.011765,.160784,.788235,.615686,.270588,.062745,.411765,.533333,.937255,.258824,.031373,.870588,.415686,.239216,.6,.352941,.211765,.831373,.560784,.035294,.784314,.701961,.968627,.066667,.372549,.113725,.533333,.654902,.078431,.85098,.498039,.121569,.803922,.007843,.866667,.411765,.74902,.631373,.011765,.564706,.772549,.360784,.45098,.803922,.035294,.690196,.141176,.945098,.443137,.827451,.156863,.529412,.666667,.243137,.988235,.611765,.407843,.227451,.121569,.380392,.776471,.211765,.298039,.921569,.109804,.796078,.270588,.717647,.372549,.45098,.035294,.733333,.866667,.156863,.603922,.509804,.341176,.556863,.023529,.756863,.121569,.694118,0,.627451,1,.415686,.768627,.239216,.556863,.019608,.462745,.835294,.266667,.694118,.07451,.227451,.843137,.478431,.760784,.678431,.85098,.941176,.529412,.160784,.309804,.384314,.976471,.603922,.670588,.756863,.960784,.078431,.878431,.380392,.945098,.670588,.556863,.866667,.058824,.203922,.521569,.113725,.772549,.470588,.552941,.686275,.094118,.913725,.392157,.482353,.239216,.133333,.454902,.913725,.188235,.843137,.74902,.478431,.784314,.545098,.662745,.745098,.023529,.443137,.647059,.960784,.164706,.909804,.337255,.454902,.192157,.839216,.698039,.784314,.407843,.278431,.933333,.423529,.741176,.239216,.913725,.603922,.678431,.309804,.839216,.952941,.482353,.294118,.862745,.937255,.611765,.294118,.407843,.721569,.870588,.2,.576471,.768627,.301961,.047059,.882353,.439216,.352941,.188235,.772549,.964706,.494118,.905882,.619608,.52549,.701961,.384314,.576471,.305882,.945098,.058824,.156863,.654902,.933333,.211765,.415686,.666667,.94902,.211765,.886275,.462745,.968627,.270588,.494118,.94902,.878431,.168627,.509804,.364706,.843137,.160784,.309804,.701961,.964706,.196078,.745098,.423529,.14902,.976471,.54902,.007843,.305882,.215686,.415686,.6,.25098,.760784,.435294,.886275,.227451,.54902,.160784,.329412,.85098,.278431,.705882,.592157,.031373,.301961,.090196,.631373,.337255,.576471,.698039,.231373,.964706,.003922,.32549,.815686,.176471,.741176,.309804,.866667,.980392,.556863,.768627,.698039,.576471,.062745,.298039,.117647,.980392,.188235,.129412,.952941,.305882,.803922,.090196,.494118,.392157,.760784,.078431,.545098,.278431,.619608,.462745,1,.129412,.843137,.572549,.031373,.635294,.341176,.521569,.090196,.219608,.462745,.156863,.066667,.243137,.662745,.184314,.117647,.698039,.211765,.992157,.07451,.341176,.619608,.039216,.72549,.384314,.941176,.619608,.811765,.090196,.694118,.066667,.658824,.266667,0,.831373,.094118,.988235,.658824,.047059,.192157,.74902,.611765,.498039,.784314,.309804,.560784,.082353,.482353,.333333,.815686,.117647,.713725,.160784,.862745,.203922,.364706,.552941,.45098,.278431,.686275,.090196,.607843,.937255,.780392,.368627,.533333,.05098,.898039,.572549,.705882,.360784,.882353,.631373,.090196,.478431,.815686,.019608,.717647,.666667,.105882,.741176,.835294,.4,0,.619608,.470588,.356863,.196078,.815686,.490196,.917647,.411765,.823529,1,.447059,.305882,.878431,.658824,.137255,.937255,.447059,.580392,.643137,.07451,.690196,.368627,.019608,.329412,.964706,.427451,.666667,.564706,.352941,.396078,.839216,.498039,.564706,.713725,.898039,.258824,.67451,.227451,.643137,.823529,.92549,.039216,.227451,.341176,.07451,.490196,.309804,.964706,.172549,.827451,.388235,.733333,.988235,.8,.364706,.545098,.917647,.733333,.443137,.533333,.019608,.85098,.564706,.47451,.788235,.258824,.968627,.490196,.223529,.117647,.572549,.278431,.380392,.866667,.529412,.843137,.435294,.572549,.352941,.243137,.141176,.768627,.47451,.913725,.411765,.247059,1,.345098,.129412,.72549,.964706,.607843,0,.733333,.239216,.588235,.419608,.615686,.752941,.078431,.815686,.101961,.741176,.960784,.007843,.501961,.419608,.168627,.094118,.298039,.631373,.454902,.811765,.278431,.105882,.443137,.768627,1,.705882,.356863,.184314,.964706,.494118,.031373,.294118,.933333,.517647,.698039,.894118,.129412,.537255,.992157,.756863,.133333,.694118,.247059,.168627,.003922,.772549,.094118,.592157,.545098,.419608,.713725,.239216,.054902,.92549,.192157,.443137,.823529,.137255,.505882,.231373,.823529,.164706,.913725,.607843,.035294,.698039,.239216,.054902,.168627,.341176,.545098,.027451,.980392,.498039,.133333,.388235,.713725,.572549,.909804,.643137,.745098,.211765,.698039,.109804,.45098,.921569,.258824,.039216,.505882,.631373,.866667,.023529,.329412,.8,.92549,.388235,.309804,.654902,.14902,.427451,.866667,.105882,.670588,.345098,.854902,.717647,.007843,.94902,.454902,.309804,.129412,.188235,.745098,.678431,.862745,.435294,.258824,.584314,.858824,.090196,.552941,.831373,.019608,.882353,.52549,.384314,.160784,.898039,.529412,.368627,.952941,.086275,.298039,.54902,.670588,.32549,.231373,.862745,.396078,.615686,.247059,.85098,.576471,.662745,.980392,.862745,.117647,.188235,.662745,.937255,.2,.533333,.156863,.058824,.576471,.870588,.329412,.537255,.858824,.356863,.172549,.105882,.447059,.231373,.788235,.07451,.415686,.27451,.478431,.364706,.878431,.545098,.658824,.396078,.223529,.835294,.176471,.294118,.870588,.498039,.333333,.780392,.509804,.27451,.945098,.619608,.882353,.094118,.4,.768627,.27451,.470588,.796078,.913725,.321569,.639216,.980392,.411765,.839216,.776471,.423529,.305882,.882353,.101961,.772549,.427451,.184314,.854902,.545098,.392157,.878431,.780392,.560784,.145098,.643137,.301961,.752941,.184314,.694118,.419608,.211765,.603922,.145098,.741176,.247059,.886275,.047059,.713725,.301961,.556863,.921569,.439216,.784314,.203922,.501961,.686275,.223529,.639216,1,.380392,.92549,.05098,.533333,.952941,.352941,.019608,.690196,.32549,.14902,.67451,.454902,.270588,.807843,.231373,.843137,.305882,.662745,.05098,.827451,.494118,.886275,.011765,.443137,.996078,.6,.478431,.141176,.909804,.321569,.741176,.031373,.447059,.239216,.721569,.345098,.407843,.505882,.039216,.741176,.333333,.843137,.27451,.74902,.443137,.243137,.156863,.607843,.760784,.643137,.992157,.752941,.313725,.941176,.647059,.854902,.047059,.635294,.964706,.07451,.321569,.572549,.921569,.494118,.917647,.698039,.05098,.988235,.109804,.603922,.878431,.039216,.717647,.113725,.466667,.74902,.639216,.529412,0,.713725,.219608,.082353,.529412,.427451,.760784,.501961,.129412,.611765,.058824,.184314,.584314,.67451,.25098,.533333,.301961,.807843,.019608,.113725,.427451,.294118,.035294,.341176,.85098,.6,.435294,.905882,.117647,.27451,.501961,.992157,.062745,.686275,.45098,.521569,.941176,.611765,.788235,.388235,.192157,.011765,.607843,.07451,.392157,.964706,.156863,.756863,.039216,.603922,.784314,.278431,.494118,.113725,.639216,.211765,.803922,.498039,.960784,.388235,.772549,.619608,.082353,.423529,.678431,.105882,.494118,.423529,.776471,.188235,.713725,.231373,.933333,.803922,.184314,.701961,.05098,.54902,.772549,.2,.952941,.356863,.823529,.490196,.023529,.941176,.572549,.882353,.835294,.592157,.407843,.92549,.498039,.631373,.023529,.8,.894118,.392157,.466667,.278431,.552941,.031373,.6,.380392,.164706,.537255,.313725,.717647,.188235,.788235,.843137,.266667,.74902,.062745,.337255,.807843,.564706,.372549,.74902,.188235,.454902,.388235,.854902,.588235,.219608,.360784,.27451,.937255,.337255,.972549,.592157,.862745,.172549,.972549,.031373,.219608,.882353,.294118,.698039,.94902,.815686,.341176,.917647,.062745,.968627,.490196,.337255,.92549,.768627,.639216,.964706,.509804,.211765,.815686,.023529,.992157,.352941,.560784,.882353,.760784,.364706,.266667,.870588,0,.345098,.121569,.219608,.670588,1,.811765,.258824,.654902,.894118,.294118,.533333,.356863,.862745,.454902,.082353,.223529,.666667,.827451,.396078,.72549,.909804,.231373,.117647,.576471,.894118,.203922,.996078,.54902,.760784,.937255,.592157,.14902,1,.627451,.345098,.572549,.129412,.282353,.411765,.870588,.243137,.345098,.690196,.066667,.501961,.113725,.894118,.603922,.211765,.698039,.078431,.301961,.145098,.258824,.035294,.666667,.129412,.388235,.976471,.701961,.086275,.666667,.054902,.886275,.145098,.843137,.478431,.705882,.117647,.768627,.945098,.572549,.027451,.443137,.580392,.117647,.168627,.427451,.627451,.113725,.215686,.662745,.309804,.937255,.694118,.239216,.333333,.94902,.054902,.776471,.129412,.85098,.176471,.494118,.415686,.298039,.658824,.368627,.588235,.780392,.678431,.360784,.517647,.243137,.027451,.454902,.14902,.592157,.654902,.211765,.701961,.592157,.14902,.227451,.67451,.078431,.364706,.698039,.231373,.470588,.627451,.729412,.035294,.168627,.533333,.643137,.803922,.192157,.439216,.831373,.572549,.462745,.321569,.498039,.745098,.113725,.466667,.803922,.027451,.698039,.247059,.905882,.505882,.733333,.968627,.329412,.05098,.556863,.082353,.423529,.776471,.270588,.019608,.494118,.301961,.141176,.333333,.031373,.882353,.25098,.321569,.003922,.454902,.74902,.643137,.505882,.090196,.643137,.964706,.45098,.839216,.603922,.419608,.662745,.160784,.278431,.776471,.427451,.843137,.635294,.470588,.733333,.964706,.223529,.827451,.294118,.168627,.521569,.337255,.219608,.964706,.309804,.780392,.356863,.219608,.960784,.278431,.435294,.223529,.67451,.4,.976471,.482353,.670588,.862745,.968627,.509804,.858824,.945098,.45098,.545098,.078431,.788235,.145098,.552941,.670588,.501961,.909804,.592157,.447059,.658824,.094118,.811765,.729412,.133333,.843137,.266667,.078431,.462745,.905882,.117647,.639216,.54902,.752941,.831373,.4,.870588,.270588,.082353,.964706,.32549,.827451,.427451,.909804,.776471,.137255,.521569,.839216,.094118,.215686,.427451,.839216,.968627,.090196,.309804,.729412,.988235,.662745,.027451,.870588,.082353,.164706,.945098,.345098,.219608,.580392,.780392,.415686,.188235,.647059,.329412,.160784,.423529,.584314,.176471,.94902,.345098,.662745,.615686,.85098,.364706,.74902,.917647,.835294,.639216,.466667,.384314,.741176,.545098,.890196,.807843,.156863,.976471,.380392,.780392,.572549,.105882,.305882,.188235,.870588,.254902,.976471,.733333,.388235,.54902,.109804,.988235,.176471,.380392,.894118,.52549,.447059,.756863,.584314,.870588,.462745,.780392,.580392,.729412,.501961,.419608,.67451,.078431,.631373,.866667,.501961,.086275,.909804,.141176,.286275,.211765,.364706,.772549,.239216,.298039,.741176,.145098,.027451,.831373,.27451,.631373,.992157,0,.411765,.258824,.729412,.035294,.247059,.560784,.898039,.003922,.223529,.552941,.478431,.941176,.635294,.329412,.168627,.831373,.4,.988235,.211765,.32549,.109804,.729412,.529412,.427451,.780392,.482353,.094118,.54902,.305882,.592157,.94902,.309804,.745098,.4,.917647,.666667,.333333,.243137,.427451,.607843,.52549,.14902,.407843,.278431,.937255,.713725,.611765,.384314,.831373,.701961,.090196,.976471,.505882,.109804,.937255,.8,.031373,.866667,.270588,.752941,.862745,.482353,.145098,.988235,.066667,.439216,.678431,.105882,.560784,.215686,.858824,.184314,.639216,.8,.082353,.392157,.270588,.05098,.839216,.227451,.909804,.733333,.498039,.007843,.760784,.333333,.090196,.462745,.023529,.905882,.266667,.494118,.733333,.011765,.564706,.090196,.313725,.701961,.019608,.239216,.101961,.933333,.388235,.011765,.615686,.109804,.894118,.54902,.72549,.023529,.811765,.352941,.768627,.619608,.831373,.72549,.007843,.54902,.058824,.380392,.478431,.67451,.345098,.886275,.423529,.494118,.333333,.768627,.878431,.176471,.462745,.976471,.380392,.760784,.286275,.627451,.996078,.396078,.760784,.196078,.011765,.980392,.576471,.768627,.047059,.298039,.678431,.498039,0,.937255,.188235,.647059,.05098,.878431,.372549,.733333,0,.184314,.470588,.07451,.647059,.27451,.862745,.129412,.509804,.705882,.870588,.027451,.917647,.239216,.768627,.494118,.337255,.2,.780392,.023529,.494118,.909804,.164706,.321569,.752941,.588235,.278431,.392157,.54902,.945098,.647059,.462745,0,.701961,.305882,.227451,.8,.2,.52549,.254902,.388235,.003922,.505882,.94902,.109804,.223529,.498039,.937255,.615686,.694118,.47451,.329412,.156863,.407843,.964706,.635294,.537255,.913725,.588235,.8,.694118,.866667,.615686,.305882,.670588,.796078,.282353,.85098,.145098,.478431,1,.603922,.662745,.294118,.145098,.858824,.196078,.992157,.266667,.333333,.156863,.4,.658824,.192157,.576471,.07451,.537255,.937255,.45098,.631373,.811765,.588235,.039216,.25098,.572549,.756863,.082353,.184314,.588235,.796078,.094118,.294118,.635294,.811765,.14902,.52549,.862745,.447059,.321569,.05098,.890196,.662745,.419608,.721569,.243137,.478431,.352941,.882353,.607843,.807843,.454902,.576471,.835294,.360784,.254902,.627451,.219608,.992157,.662745,.839216,.360784,.913725,.564706,.14902,.454902,.592157,.019608,.788235,.196078,.47451,.368627,.815686,.592157,.058824,.858824,.439216,.560784,.313725,.52549,.25098,.619608,.443137,.011765,.823529,.203922,.686275,.482353,.094118,.372549,.211765,.823529,.415686,.898039,.576471,.454902,.933333,.643137,.866667,.976471,.752941,.701961,.294118,.439216,.576471,.305882,.717647,.184314,.54902,.882353,0,.607843,.270588,.815686,.192157,.380392,.129412,.270588,.447059,.192157,.337255,.14902,.078431,.4,.964706,.231373,.639216,.905882,.411765,.203922,.811765,.415686,.917647,.745098,.490196,.352941,.752941,.521569,.454902,.886275,.960784,.286275,.454902,.937255,.239216,.32549,.133333,.270588,.988235,.188235,.898039,.788235,.964706,.223529,.705882,.858824,.937255,.243137,.447059,.690196,.905882,.580392,.333333,.066667,.694118,.184314,.117647,.705882,.592157,.141176,.521569,.301961,.827451,.14902,.858824,.615686,.090196,.160784,.972549,.231373,.286275,.909804,.117647,.780392,.937255,.435294,.145098,.52549,.8,.239216,.717647,.05098,.960784,.807843,.286275,.372549,.996078,.639216,.270588,.07451,.686275,.14902,.972549,.643137,.105882,.803922,.980392,.066667,.878431,.729412,.372549,.890196,.552941,1,.058824,.772549,.14902,.882353,.545098,.07451,.631373,.109804,.341176,.745098,.054902,.333333,.121569,.462745,.360784,.05098,.615686,.823529,.968627,.027451,.866667,.105882,.278431,.419608,.776471,.92549,.701961,.062745,.454902,.67451,.898039,.627451,.066667,.972549,.529412,.772549,.917647,.478431,.117647,.360784,.529412,.796078,.039216,.701961,.337255,.062745,.533333,.231373,.658824,.592157,.078431,.815686,.686275,.047059,.54902,.094118,.858824,.686275,.427451,.776471,.858824,.701961,.380392,.137255,.32549,.627451,.517647,.4,.133333,.313725,.666667,.039216,.388235,.521569,.211765,.019608,.74902,.917647,.611765,.423529,.945098,.8,.25098,.858824,.337255,.941176,.054902,.447059,.694118,.219608,.745098,.435294,.380392,.713725,.05098,.662745,.462745,.52549,.698039,.027451,.572549,.294118,.109804,.607843,.419608,.517647,.188235,.694118,.917647,.07451,.545098,.854902,.407843,.94902,.788235,.45098,.298039,.396078,.239216,.694118,.14902,.423529,.788235,.2,.109804,.670588,.137255,.282353,.419608,.607843,.313725,.686275,.976471,.298039,.756863,.937255,.521569,.854902,.094118,.588235,.698039,.188235,.572549,.913725,.231373,.14902,.745098,.372549,.47451,.788235,.988235,.619608,.094118,.498039,.360784,.564706,.858824,.007843,.247059,.74902,.392157,.811765,.647059,.215686,.580392,.870588,.717647,.023529,.615686,.439216,.282353,.921569,.501961,.121569,.85098,.333333,.039216,.937255,.396078,.137255,.227451,.603922,.8,.239216,.733333,.019608,.160784,.6,.498039,.035294,.545098,.721569,.435294,.066667,.862745,0,.603922,.470588,.537255,.835294,.952941,.141176,.858824,.411765,.478431,.239216,.294118,.537255,.011765,.654902,.478431,.090196,.741176,.2,.607843,.372549,1,.309804,.905882,.54902,.058824,.858824,.584314,.396078,.211765,.090196,.313725,.823529,.396078,.870588,.490196,.933333,.760784,.32549,.105882,.443137,.635294,.223529,.137255,.733333,.321569,.121569,.576471,.501961,.011765,.862745,.933333,.509804,.364706,.6,.301961,.556863,.945098,.337255,.478431,.854902,.72549,.917647,.243137,.807843,.411765,.572549,.14902,.215686,.678431,.270588,.407843,.784314,.945098,.286275,.835294,.678431,.490196,.407843,.090196,.647059,.580392,.243137,.054902,.380392,.839216,.231373,.133333,.972549,.301961,.768627,.505882,.960784,.305882,.101961,.462745,.027451,.392157,.294118,.184314,.815686,.968627,.298039,.168627,.666667,.760784,.6,.988235,.439216,.803922,.258824,.890196,.309804,.72549,.380392,.917647,.341176,.517647,.388235,.992157,.298039,.909804,.227451,.670588,.941176,.282353,.172549,.729412,.360784,1,.772549,.270588,.066667,.745098,.282353,.611765,.988235,.796078,.105882,.839216,.913725,.364706,.215686,.976471,.384314,.678431,.560784,.784314,.105882,.533333,0,.662745,.254902,.760784,.172549,.494118,.992157,.807843,.894118,.603922,.247059,.94902,.745098,.047059,.168627,.270588,.835294,.564706,.882353,.352941,.839216,.45098,.517647,.619608,.203922,.858824,.266667,.733333,.592157,.172549,.752941,.054902,.921569,.705882,.086275,.509804,.74902,.627451,.090196,.364706,.019608,.498039,.129412,.035294,.490196,.866667,.380392,.019608,.988235,.537255,.227451,.498039,.388235,.019608,.129412,.796078,.27451,.898039,.505882,.192157,.854902,.690196,.537255,.172549,.756863,.643137,.427451,.603922,.176471,.45098,.129412,.576471,.913725,.270588,.8,.988235,.67451,.505882,.721569,.078431,.882353,.556863,.078431,.392157,.282353,.196078,.701961,.086275,.556863,.639216,.505882,1,.082353,.478431,.133333,.627451,.870588,.537255,.094118,.803922,.345098,.101961,.584314,.807843,.478431,.921569,.572549,.215686,.14902,.898039,.415686,.478431,.678431,.090196,.356863,.172549,.643137,.576471,.72549,.160784,.776471,.54902,.286275,.031373,.933333,.27451,.85098,.721569,.172549,.811765,.45098,.921569,.313725,.635294,0,.278431,.717647,.160784,.533333,.082353,.360784,.686275,.588235,1,.011765,.490196,.156863,.760784,.058824,.27451,.94902,.023529,.988235,.678431,.356863,.113725,.666667,.078431,.466667,.807843,.258824,.443137,.858824,.019608,.25098,.909804,.192157,.564706,.835294,.647059,.952941,.729412,.305882,.8,.619608,.454902,.717647,.156863,.870588,.086275,.756863,.607843,.992157,.337255,.713725,.94902,.027451,.729412,.298039,.423529,.941176,.584314,.882353,.32549,.090196,.937255,.854902,.341176,.658824,.866667,.176471,.721569,.615686,.156863,.078431,.415686,.243137,.341176,.47451,.694118,.85098,.964706,.019608,.501961,.890196,.360784,.168627,.745098,.007843,.823529,.196078,.67451,.960784,.039216,.745098,.266667,.14902,.631373,.466667,.886275,.388235,.227451,.647059,.352941,.831373,.039216,.662745,.788235,.321569,.184314,.552941,.768627,.25098,.52549,.392157,.054902,.329412,.45098,.094118,.619608,.886275,.482353,.141176,.435294,.32549,.952941,.407843,.603922,.345098,.113725,.698039,.219608,.843137,.380392,.47451,.439216,.658824,.815686,.219608,.454902,.537255,.384314,.862745,.686275,.282353,.952941,.552941,.678431,.811765,.388235,.164706,.772549,.423529,.909804,.839216,.415686,.321569,.643137,.129412,.192157,.980392,.611765,.388235,.803922,.690196,.301961,.462745,.258824,.372549,.603922,.219608,.952941,.054902,.309804,.894118,.592157,.360784,.658824,.882353,.427451,.215686,.564706,.45098,.172549,.611765,.337255,.913725,.121569,.07451,.239216,.470588,.803922,.556863,.054902,.690196,.227451,.062745,.533333,.396078,.478431,.356863,.843137,.560784,.913725,.639216,.968627,.133333,.2,.427451,.239216,.788235,.615686,.721569,.4,.968627,.470588,.239216,.576471,.419608,.301961,.807843,.223529,.447059,.686275,.364706,.839216,.713725,.145098,1,.019608,.521569,.109804,.294118,.427451,.494118,.109804,.611765,.945098,.862745,.011765,.921569,.705882,.878431,.972549,.270588,.686275,.933333,.835294,.172549,.352941,.776471,.654902,.05098,.505882,.141176,.882353,.035294,.733333,.960784,.427451,.576471,.129412,.960784,.039216,.862745,.305882,.941176,.141176,.772549,.227451,.086275,.643137,.203922,.470588,.372549,.121569,.603922,.309804,.494118,.094118,.564706,.301961,.219608,.517647,.968627,.870588,.556863,.741176,.380392,.282353,.117647,.529412,.980392,.137255,.74902,.094118,.870588,.172549,.54902,.694118,.121569,.521569,.796078,.192157,.05098,.286275,.509804,.145098,.72549,.031373,.862745,.384314,.113725,.8,.47451,.658824,.768627,.411765,.007843,.713725,.184314,.266667,.494118,.788235,1,.752941,.247059,0,.952941,.2,.760784,.329412,.031373,.8,.592157,.752941,.54902,.341176,.894118,.145098,.552941,.223529,.066667,.780392,.333333,.937255,.717647,.588235,.352941,.545098,.854902,.031373,.976471,.501961,.054902,.309804,.6,.760784,.184314,.694118,.882353,.745098,.972549,.239216,.705882,.368627,.137255,.427451,.321569,.6,.121569,.215686,.745098,.498039,.019608,.243137,.435294,.698039,.560784,.894118,.211765,.690196,.756863,.278431,.615686,.219608,.529412,.07451,.815686,.666667,.254902,.74902,.588235,.4,.494118,.909804,.717647,.321569,.423529,.937255,.796078,.023529,.905882,.713725,.203922,.839216,.905882,.631373,.027451,1,.796078,.058824,.160784,.717647,.007843,.478431,.776471,.662745,.886275,.427451,.027451,.356863,.933333,.666667,.811765,.007843,.443137,.917647,.239216,.654902,.396078,.47451,.741176,.964706,.231373,.8,.917647,.321569,.647059,.25098,.576471,.968627,.192157,.278431,.607843,.858824,.992157,.356863,.611765,.937255,.407843,.580392,.309804,.145098,.945098,.678431,.439216,.094118,.478431,.717647,.156863,.4,.294118,.905882,.027451,.67451,.470588,.066667,.301961,.905882,.678431,.603922,.854902,.117647,.05098,.772549,.082353,.933333,.294118,.133333,.572549,.203922,.74902,.258824,.435294,.85098,.952941,.407843,.627451,.145098,.545098,.843137,.035294,.462745,.74902,.529412,.827451,.05098,.470588,.560784,.823529,.360784,.592157,.74902,.129412,.952941,.082353,.282353,.85098,.552941,.082353,.988235,.478431,.878431,.372549,.74902,.301961,.905882,.196078,.356863,.066667,.639216,.172549,.011765,.615686,.854902,.552941,.14902,.584314,.337255,.854902,.439216,.066667,.552941,.258824,.72549,.380392,.6,.45098,.666667,.368627,.266667,.427451,.101961,.937255,.188235,.07451,.733333,.627451,.211765,.529412,.580392,.298039,.478431,.768627,.372549,.839216,.14902,.960784,.078431,.886275,.690196,.368627,.572549,.07451,.482353,.776471,.878431,.701961,.427451,.054902,.937255,.552941,.141176,.219608,.501961,.756863,.109804,.882353,.035294,.462745,.643137,.52549,.823529,.294118,.607843,.905882,.243137,.835294,.517647,.647059,.105882,.94902,.188235,.564706,.992157,.831373,.423529,.023529,.521569,.188235,.392157,.509804,.839216,.14902,.470588,.615686,.796078,.419608,.890196,.654902,.945098,.368627,.082353,.223529,.482353,.011765,.27451,.364706,.192157,.643137,.282353,1,.176471,.239216,.666667,.960784,.360784,.062745,.156863,.968627,.313725,.521569,.784314,.380392,.482353,.164706,.396078,.827451,.356863,.192157,.654902,.121569,.184314,.447059,.607843,.501961,.952941,.823529,.227451,.776471,.454902,.266667,.054902,.964706,.392157,.686275,.231373,.533333,.172549,.768627,.976471,.356863,.141176,.839216,.2,.117647,.733333,.584314,.988235,.807843,.619608,.321569,.239216,.560784,.811765,.270588,.870588,.407843,.054902,.917647,.25098,.619608,.082353,.756863,.564706,.333333,.615686,.423529,.003922,.160784,.631373,.392157,.972549,.192157,.160784,.027451,.529412,.333333,.741176,.388235,.686275,.086275,.835294,.439216,.168627,.670588,.733333,.2,.356863,.094118,.890196,.160784,.686275,.368627,.058824,.580392,.968627,.239216,.360784,.796078,.396078,.258824,.772549,.364706,.160784,.745098,.305882,.980392,.647059,.266667,.972549,.407843,.678431,.247059,.733333,.321569,.117647,.509804,.019608,.721569,.584314,.878431,.815686,.666667,.933333,.419608,.909804,.796078,.105882,.580392,.890196,.380392,.760784,.305882,.705882,.917647,.643137,.439216,.843137,.203922,.619608,.023529,.992157,.721569,.639216,.454902,.027451,.713725,.796078,.603922,.996078,.023529,.721569,.090196,.423529,.705882,.321569,.980392,.882353,.368627,.729412,.184314,.505882,.772549,.031373,1,.615686,.411765,0,.67451,.47451,.941176,.517647,.321569,.886275,.482353,.227451,.141176,.886275,.521569,.776471,.388235,1,.494118,.121569,.772549,.176471,.678431,.133333,.996078,.2,.517647,.05098,.270588,.784314,.223529,.537255,.815686,.921569,.105882,.266667,.533333,.368627,.772549,.890196,.239216,.854902,.031373,.466667,.305882,.960784,.572549,.254902,.341176,.972549,.85098,.27451,.756863,.588235,.031373,.501961,.992157,.741176,.439216,.003922,.729412,.470588,.603922,.705882,.011765,.494118,.658824,.588235,.254902,.882353,.45098,.101961,.705882,.211765,.54902,0,.898039,.086275,1,.482353,.184314,.823529,.631373,.286275,.341176,.105882,.52549,.752941,.05098,.701961,.490196,.333333,.686275,0,.843137,.439216,.094118,.192157,.501961,.270588,.039216,.690196,.14902,.498039,.662745,.32549,.239216,.117647,.909804,.556863,.258824,.415686,.909804,.509804,.301961,.380392,.886275,.164706,.537255,.019608,.411765,.584314,.662745,.113725,.811765,.282353,.882353,.129412,.658824,.823529,.294118,.870588,.572549,.094118,.768627,.258824,.027451,.92549,.094118,.407843,.658824,.023529,.466667,.670588,.054902,.156863,.305882,.717647,.960784,.607843,.356863,.839216,.54902,.419608,.670588,.92549,.894118,.701961,.133333,1,.345098,.470588,.678431,.745098,.6,.941176,.447059,.631373,.164706,.580392,.784314,.898039,.627451,.729412,.027451,.811765,.52549,.588235,.027451,.490196,.976471,.407843,.231373,.803922,.337255,.156863,.815686,.196078,.933333,.301961,.141176,.862745,.94902,.211765,.113725,.941176,.776471,.062745,.545098,.811765,.356863,.898039,.741176,.372549,.827451,.282353,.588235,.694118,.247059,.921569,.4,.172549,.654902,1,.176471,.592157,.294118,.137255,.576471,.968627,.266667,.509804,.145098,.584314,.94902,.627451,.407843,.882353,.772549,.341176,.921569,.419608,.811765,.878431,.588235,.788235,.305882,.964706,.14902,.062745,.352941,.227451,.862745,.666667,.784314,.25098,.631373,.839216,.105882,.211765,.505882,.968627,.588235,.443137,.196078,.380392,.478431,.337255,.133333,.521569,.203922,.886275,.392157,.627451,.701961,.54902,.184314,.729412,.858824,.298039,.960784,.211765,.886275,.443137,.643137,.552941,.023529,.466667,.247059,.729412,.047059,.803922,.345098,.176471,.47451,.380392,.509804,.741176,.266667,.066667,.862745,.313725,.023529,.827451,.090196,.278431,.976471,.109804,.407843,.192157,.258824,.133333,.388235,.890196,.219608,.419608,.117647,.670588,.321569,.721569,.109804,.913725,.639216,.27451,.384314,.662745,.505882,.803922,.054902,.341176,.447059,.545098,.854902,.32549,.4,.168627,.701961,.588235,.133333,.086275,.627451,.160784,.509804,.423529,.027451,.760784,.388235,.521569,.054902,.784314,.447059,.231373,.388235,.85098,.466667,.223529,.870588,.086275,.360784,.772549,.705882,.329412,.011765,.803922,.545098,.109804,.580392,.996078,.05098,.266667,.188235,.090196,.521569,.05098,.690196,.47451,.823529,.713725,.627451,.74902,.556863,.035294,.211765,.988235,.47451,.309804,.745098,.8,.266667,.329412,.003922,.717647,.905882,.564706,.933333,.054902,.741176,.964706,.301961,.717647,.07451,.356863,.972549,.419608,.796078,.345098,.588235,.505882,.129412,.352941,.603922,.807843,.082353,.254902,.831373,.333333,.898039,.509804,.286275,.101961,.882353,.588235,.027451,.839216,.07451,.619608,.415686,.784314,.14902,.52549,.239216,.392157,.67451,.482353,.705882,.356863,.666667,.533333,.866667,.501961,.670588,.094118,.619608,.933333,.796078,.870588,.196078,.615686,.470588,.839216,.533333,.066667,.588235,.882353,.117647,.266667,.580392,.933333,.670588,.27451,.027451,.701961,.482353,.905882,.278431,.960784,.423529,.494118,.309804,.972549,.784314,.635294,.215686,.854902,.121569,.972549,.713725,.533333,.870588,.733333,.039216,.921569,.67451,.780392,.415686,.627451,.2,.905882,.435294,1,.215686,.760784,.341176,.254902,.160784,.45098,.627451,.545098,.752941,.364706,.952941,.415686,.219608,.356863,.886275,.521569,.066667,.952941,.129412,.470588,.356863,.584314,.07451,.898039,.678431,.054902,.909804,.423529,.145098,.635294,.082353,.776471,.188235,.686275,.603922,.396078,.796078,.52549,.168627,.827451,.219608,.054902,.643137,.27451,.976471,.07451,.72549,.776471,.517647,.933333,.313725,.745098,.960784,.168627,.105882,.635294,.972549,.4,.713725,.254902,.662745,.309804,.945098,.215686,.917647,.54902,.643137,.976471,.768627,.898039,.172549,.027451,.831373,.243137,.941176,.023529,.788235,.337255,1,.768627,.286275,.066667,.356863,.54902,.086275,.898039,.360784,0,.211765,.788235,.443137,.937255,.364706,.717647,.635294,.411765,.14902,.784314,.890196,.572549,.121569,.627451,.019608,.231373,.768627,.878431,.701961,.25098,.101961,.937255,.341176,.560784,.647059,.309804,.223529,.082353,.321569,.627451,.129412,.54902,.282353,0,.94902,.72549,.509804,.054902,.266667,.658824,.470588,.086275,.941176,.654902,.729412,.831373,.313725,.917647,.686275,.121569,.835294,.627451,.729412,.094118,.247059,.388235,.196078,.435294,.298039,.905882,.815686,.752941,.156863,.447059,.372549,.607843,.533333,.752941,.870588,.498039,.333333,.282353,.419608,.843137,.227451,.121569,.027451,.45098,.92549,.592157,.501961,.882353,.113725,.545098,.156863,.831373,.411765,.247059,.164706,.019608,.380392,.588235,.490196,.678431,.415686,.803922,.556863,.188235,.768627,.968627,.529412,.160784,.768627,.478431,.019608,.305882,.380392,.117647,.443137,.592157,.341176,.960784,.580392,.470588,.741176,.105882,.6,.219608,.447059,.164706,.576471,.705882,.247059,.454902,.772549,.282353,.560784,.741176,.996078,.686275,.329412,.027451,.172549,.47451,.992157,.203922,.090196,.505882,.364706,.223529,.760784,.858824,.509804,.372549,.658824,.2,.027451,.454902,.372549,.678431,.062745,.886275,.462745,.396078,.8,.933333,.490196,.690196,.192157,.8,.356863,.490196,.156863,.337255,.823529,.611765,.117647,.862745,.556863,.380392,.898039,.490196,.031373,.384314,.086275,.203922,.572549,.466667,.266667,.14902,.917647,.572549,.996078,.760784,.6,.843137,.701961,.639216,.078431,.321569,.545098,.968627,.215686,.141176,.282353,.996078,.2,.67451,.831373,.976471,0,.552941,.478431,.878431,.643137,.27451,.760784,.129412,.321569,.4,.713725,.894118,.470588,.678431,.572549,.968627,.662745,.843137,.713725,.121569,.219608,.862745,.007843,.278431,.329412,.137255,.490196,.078431,.439216,.870588,.356863,.588235,.823529,.713725,.945098,.047059,.254902,.615686,.117647,.780392,.219608,.133333,.419608,.305882,.705882,.858824,.039216,.388235,.898039,.482353,.968627,.643137,.047059,.94902,.184314,.423529,.282353,.137255,.862745,.631373,.756863,.839216,.011765,.866667,.756863,.654902,.968627,.054902,.435294,.313725,1,.101961,.827451,.556863,.913725,.588235,.843137,.545098,.266667,.160784,.752941,.003922,.576471,.14902,.368627,.913725,.419608,.980392,.647059,.870588,.584314,.101961,.419608,.980392,.352941,.756863,.184314,.690196,.137255,.309804,.603922,.94902,.780392,.419608,.003922,.988235,.807843,.301961,.490196,.035294,.45098,.14902,.298039,.023529,.494118,.227451,.396078,.690196,.85098,0,.67451,.827451,.482353,.082353,.388235,.113725,.454902,.576471,.14902,.788235,.341176,.705882,.996078,.384314,.2,.67451,.964706,.784314,.27451,.203922,.372549,.003922,.294118,.094118,.341176,.552941,.447059,1,.360784,.6,.756863,.917647,.686275,.882353,.643137,.372549,.807843,.211765,.690196,.113725,.396078,.176471,.501961,.67451,.858824,.741176,.501961,.364706,.694118,.870588,.654902,.976471,.176471,.521569,.94902,.658824,.803922,.196078,.113725,.827451,.329412,.690196,.501961,.862745,.654902,.552941,.388235,.227451,.501961,.270588,.388235,.54902,.329412,.25098,.47451,.823529,.196078,.611765,.705882,.160784,.301961,.72549,.341176,.141176,.2,.760784,.992157,.619608,.247059,.94902,.670588,.266667,.047059,.780392,.090196,.298039,.047059,.239216,.701961,.921569,.215686,.686275,.494118,.027451,.313725,.796078,.439216,.854902,.203922,.705882,.505882,.866667,.337255,.67451,.07451,.396078,.870588,.713725,.823529,.670588,.945098,.54902,.776471,.121569,1,.188235,.490196,.776471,.278431,.937255,.72549,.556863,.796078,.25098,.360784,.72549,.662745,.909804,.294118,.168627,.039216,.811765,.580392,.082353,.462745,.027451,.552941,.870588,.74902,.94902,.8,.498039,.858824,.2,.039216,.776471,.309804,.082353,.505882,.184314,.439216,.835294,.031373,.27451,.666667,.054902,.996078,.258824,.898039,.858824,.341176,.223529,.972549,.415686,.062745,.921569,.27451,.023529,.772549,.494118,.258824,.572549,.101961,.298039,.003922,.588235,.27451,.411765,.537255,.211765,.815686,.113725,.023529,.478431,.780392,.917647,.066667,.607843,.701961,.109804,.921569,.588235,.14902,.721569,.898039,.054902,.580392,.478431,.423529,.062745,.972549,.643137,.439216,.023529,.368627,.509804,.831373,.129412,.537255,.831373,.223529,.560784,.627451,.745098,.462745,.807843,.545098,.396078,.129412,.854902,.247059,.917647,.619608,.952941,.078431,.556863,.364706,.121569,.254902,.592157,.172549,.745098,.529412,.611765,.117647,.368627,.286275,.215686,.07451,.882353,.352941,.584314,.890196,.027451,.560784,.384314,.105882,.447059,.329412,.027451,.643137,.952941,.843137,.027451,.211765,.419608,.062745,.607843,.521569,.427451,.866667,.32549,.894118,.635294,.137255,.415686,.086275,.6,.2,.396078,.741176,.917647,.278431,.635294,.827451,.913725,.392157,.129412,.592157,.25098,.533333,.933333,.788235,.572549,.447059,.505882,.647059,.082353,.611765,.572549,.160784,.294118,.823529,.164706,.552941,.611765,.352941,.062745,.843137,.423529,.694118,.341176,.756863,.517647,.854902,.909804,.023529,.74902,.380392,.6,.305882,.94902,.113725,.666667,.352941,.968627,.45098,.192157,.854902,.031373,.384314,.545098,.282353,.352941,.937255,.752941,.886275,.254902,.494118,.803922,.305882,.905882,.713725,.058824,.423529,.352941,.741176,.45098,.862745,.968627,.521569,.188235,.137255,.976471,.313725,.047059,.772549,.466667,.572549,.062745,.411765,.509804,.247059,.909804,.639216,.796078,.078431,.447059,.937255,.843137,.239216,.933333,.196078,.960784,.517647,.588235,.407843,.184314,.462745,.27451,.745098,.654902,.305882,.94902,.615686,.184314,.74902,.890196,.478431,.14902,.52549,.305882,.945098,.564706,.756863,.937255,.698039,.129412,.227451,.729412,.529412,.247059,.972549,.690196,.309804,.505882,.654902,.156863,.05098,.588235,.533333,.129412,.223529,.670588,.556863,.788235,.988235,.090196,.745098,.172549,.392157,.117647,.329412,.772549,.031373,.729412,.396078,.803922,.007843,.721569,.466667,.666667,1,.447059,.886275,.156863,.760784,.921569,.196078,.815686,.94902,.447059,.086275,.670588,.47451,.968627,.25098,.890196,.72549,.192157,.427451,.741176,.168627,.858824,.243137,.733333,.490196,.772549,.996078,.654902,.078431,.788235,.231373,.137255,.619608,.003922,.588235,.729412,.086275,.227451,.54902,.870588,.184314,.588235,.92549,.133333,.4,.329412,.282353,.686275,.411765,.839216,.627451,.25098,.945098,.670588,.352941,.752941,.2,.67451,.760784,.003922,.478431,.992157,.729412,.301961,.141176,.372549,.047059,.470588,.780392,.654902,0,.756863,.952941,.721569,.839216,.094118,.509804,.427451,.141176,.866667,.521569,.811765,.219608,.313725,.109804,.419608,.760784,.631373,.090196,.490196,.239216,.352941,.776471,.294118,.941176,.039216,.8,.384314,.192157,.752941,.878431,.113725,.980392,.784314,.380392,.694118,.972549,.427451,.466667,.031373,.341176,.27451,.662745,.435294,.321569,.482353,.698039,.886275,.196078,.964706,.435294,.227451,.921569,.443137,.878431,.643137,.352941,.243137,.117647,.698039,.211765,.52549,.380392,.027451,.643137,.466667,.160784,.25098,.713725,.313725,.176471,.588235,.141176,.45098,.52549,.835294,.286275,.572549,.011765,.517647,.635294,.086275,.372549,.282353,.211765,.882353,.439216,.509804,.690196,.384314,.839216,.952941,.337255,.164706,.854902,.639216,.466667,.760784,.964706,.301961,.639216,.023529,.772549,.07451,.823529,.945098,.007843,.572549,.176471,.729412,.427451,.090196,.164706,.992157,.839216,.121569,.372549,.321569,.184314,.407843,.870588,.521569,.698039,.643137,.560784,.270588,.407843,.101961,.329412,.85098,.482353,.039216,.627451,.2,.972549,.796078,.247059,.701961,.007843,.470588,.992157,.678431,.584314,.890196,.243137,.392157,.776471,.866667,.129412,.4,0,.552941,.639216,.45098,.113725,.603922,.478431,.027451,.537255,.337255,.435294,.266667,.870588,.313725,0,.815686,.745098,.937255,.878431,.196078,.784314,.019608,.921569,.854902,.078431,.592157,.815686,.101961,.670588,.294118,.109804,.509804,.192157,.094118,.94902,.784314,.396078,.07451,.807843,.952941,.678431,.305882,.54902,.066667,.882353,.372549,.552941,.090196,.784314,.85098,.407843,.066667,.694118,.047059,1,.392157,.788235,.313725,.807843,.921569,.690196,.580392,.121569,.627451,.160784,.952941,.047059,.294118,.466667,.176471,.533333,.419608,.980392,.372549,.133333,.321569,.066667,.215686,.494118,.705882,.172549,.556863,.654902,.462745,.345098,.886275,.078431,.505882,.866667,.807843,.537255,.294118,.466667,.917647,.588235,.870588,.67451,.556863,.039216,.215686,.941176,.086275,.815686,.976471,.721569,.890196,.576471,.14902,.258824,.313725,.545098,.886275,.352941,.039216,.592157,.933333,.384314,.094118,.556863,.356863,.023529,.717647,.964706,.054902,.690196,.188235,.976471,.580392,.815686,.886275,.203922,.72549,.309804,.917647,.854902,.278431,.945098,.215686,.811765,.635294,.094118,.545098,.184314,.360784,.258824,.603922,.133333,.717647,.47451,.545098,.631373,.219608,.278431,.521569,.345098,.717647,.533333,.882353,.588235,.980392,.694118,.286275,.552941,.894118,.517647,.305882,.607843,.462745,.254902,.121569,1,.745098,.266667,.666667,.894118,.988235,.521569,.298039,.639216,.933333,.321569,.2,.607843,.894118,.470588,.227451,.129412,.419608,.054902,.858824,.752941,.411765,.321569,.721569,.909804,.592157,.752941,.109804,.690196,.784314,.266667,.019608,.505882,.733333,.803922,.572549,.921569,.447059,.282353,.996078,.113725,.215686,.784314,.278431,.670588,.392157,.243137,0,.364706,.654902,.086275,.529412,.039216,.796078,.266667,.168627,.619608,.337255,.772549,.423529,.305882,.14902,.658824,.203922,.447059,.980392,.701961,.392157,.772549,.133333,.670588,.47451,.164706,.329412,.67451,.282353,.756863,.843137,.203922,.478431,.137255,.564706,.352941,.509804,.67451,.286275,.47451,.090196,.380392,1,.560784,.054902,.643137,.423529,.698039,.584314,.054902,.713725,.501961,.92549,.772549,.643137,.109804,.533333,.396078,.047059,.94902,.356863,.141176,.690196,.992157,.411765,.003922,.466667,.172549,.788235,.023529,.345098,.74902,.443137,.141176,.023529,.733333,.196078,.854902,.090196,.760784,.913725,.396078,.494118,.788235,.023529,.45098,.341176,.192157,0,.717647,.878431,.478431,.772549,.258824,.082353,.713725,.588235,.992157,.545098,.266667,.490196,.941176,0,.807843,.266667,.564706,.160784,.807843,.239216,.909804,.078431,.615686,.835294,.933333,.678431,.427451,.062745,.368627,.835294,.231373,.870588,.435294,.729412,.529412,.164706,1,.760784,.6,.94902,.713725,.827451,.239216,.729412,.333333,.447059,.921569,.713725,.815686,.482353,.101961,.921569,.545098,.003922,.501961,.341176,.058824,.784314,.529412,.027451,.945098,.427451,.278431,.945098,.54902,.784314,.890196,.611765,.172549,.427451,.941176,.32549,.807843,.219608,.447059,.909804,.086275,.741176,.160784,.686275,.258824,.827451,.509804,.14902,.227451,.784314,.137255,.360784,.894118,.156863,.411765,.215686,.878431,.435294,1,.839216,.67451,.247059,.85098,.294118,.788235,.443137,.160784,.768627,.862745,.964706,.270588,.392157,.827451,.054902,.247059,.843137,.498039,.627451,.980392,.360784,.643137,.419608,.576471,.188235,.678431,.337255,.215686,.619608,.164706,.756863,.678431,.423529,.25098,.564706,.129412,.372549,.533333,.921569,.047059,.356863,.843137,.721569,.168627,.352941,.564706,.196078,.639216,.494118,.078431,.345098,.988235,.407843,.47451,.309804,.666667,.211765,.329412,.14902,.266667,.976471,.117647,.643137,.027451,.584314,.372549,.05098,.913725,.639216,.435294,.113725,.329412,.184314,.482353,.423529,.145098,.988235,.172549,.509804,.086275,.392157,1,.270588,.2,.72549,.611765,.270588,.94902,.843137,.635294,.282353,.898039,.662745,.14902,.835294,.603922,.729412,.035294,.215686,.133333,.498039,.972549,.078431,.521569,.666667,.611765,.858824,.72549,.027451,.4,.843137,.937255,.627451,.423529,.05098,.760784,.301961,.870588,.52549,.023529,.466667,.992157,.298039,.686275,.027451,.572549,.294118,.07451,.329412,.160784,.498039,.72549,.07451,.584314,.886275,.090196,.643137,.298039,.584314,.145098,.666667,.454902,.556863,.639216,.941176,.313725,.698039,.247059,.133333,.933333,.003922,.286275,.835294,.039216,.937255,.109804,.862745,.560784,.94902,.090196,.894118,.796078,.039216,.972549,.670588,.823529,.298039,.415686,.654902,.227451,.019608,.803922,.909804,.698039,.121569,.760784,.870588,.423529,.713725,.643137,.027451,.572549,.866667,.443137,.105882,.560784,.482353,.85098,.627451,.752941,.509804,.796078,.933333,.701961,.305882,.827451,.247059,.058824,.803922,.545098,.839216,.039216,.909804,.556863,.768627,.670588,.862745,.219608,.023529,.564706,.666667,.062745,.392157,.839216,.690196,.121569,.772549,.411765,.090196,.211765,.352941,.490196,.239216,.086275,.396078,.858824,.466667,.333333,.811765,.6,.25098,.788235,.035294,.368627,.090196,.980392,.301961,.572549,.227451,.329412,.537255,.137255,.921569,.631373,.380392,.960784,.603922,.741176,.823529,.247059,.54902,.8,.72549,.133333,.482353,.694118,.776471,.909804,.631373,.439216,.2,.933333,.345098,.701961,.231373,.517647,.066667,.74902,.909804,.333333,.972549,.094118,.164706,.784314,.086275,.4,.552941,.803922,.505882,.72549,.388235,.615686,.52549,.788235,.266667,.384314,.298039,.611765,.505882,.352941,.282353,.584314,.211765,.066667,.733333,.188235,.866667,.501961,.407843,.631373,.298039,.447059,1,.380392,.05098,.945098,.196078,.282353,.839216,.752941,.14902,1,.694118,.784314,.890196,.039216,.305882,.384314,.156863,.286275,.45098,.129412,.192157,.482353,.572549,.392157,.937255,.647059,.227451,.686275,.341176,.270588,.047059,.454902,.607843,.309804,.729412,.894118,.494118,.788235,.968627,.454902,.32549,.196078,.576471,.470588,.705882,.823529,.576471,.976471,.721569,.337255,.639216,.964706,.545098,.698039,.023529,.392157,.721569,.2,.890196,.286275,.478431,.172549,.67451,.788235,.505882,.011765,.890196,.8,.188235,.690196,.466667,.086275,.32549,.219608,.423529,.643137,.090196,.337255,.964706,.380392,.862745,.215686,.560784,.011765,.364706,.827451,.654902,.027451,.482353,.372549,.807843,1,.411765,.839216,.2,.603922,.270588,.705882,.380392,.576471,.835294,.45098,.890196,.219608,.32549,.964706,.101961,.231373,.45098,.988235,.698039,.490196,.062745,.803922,.156863,.454902,.717647,.909804,.4,.490196,.960784,.560784,.105882,.678431,.941176,.105882,.584314,.062745,.227451,.537255,.298039,.796078,.45098,.529412,.101961,.227451,.364706,.301961,.011765,.388235,.219608,.717647,.466667,.92549,.698039,.05098,.545098,.905882,.658824,.768627,.854902,.172549,.305882,.454902,.74902,.090196,.6,.921569,.396078,.145098,.952941,.827451,.443137,.129412,.345098,.160784,.223529,.031373,.529412,.921569,.039216,.964706,.313725,.137255,.407843,0,.796078,.462745,.2,.105882,.270588,.921569,.156863,.321569,.988235,.447059,.572549,.721569,.803922,.6,.388235,.113725,.964706,.643137,.364706,.298039,.588235,.254902,.023529,.854902,.145098,.690196,.941176,.039216,.862745,.192157,.501961,.662745,.266667,.972549,.411765,.105882,.294118,1,.14902,.282353,.556863,.854902,.192157,.027451,.576471,.368627,.109804,.533333,.003922,.870588,.478431,.227451,1,.039216,.713725,.619608,.129412,.67451,.909804,.584314,.305882,.164706,.007843,.643137,.913725,.243137,1,.196078,.854902,.109804,.321569,.784314,.619608,.282353,.886275,.32549,.2,.482353,.713725,.882353,.823529,.666667,.607843,.141176,.898039,.678431,.964706,.717647,.505882,.807843,.921569,.643137,.329412,.07451,.564706,.203922,.831373,.627451,.411765,.243137,.976471,.101961,.337255,.713725,.035294,1,.360784,.878431,.439216,.815686,.694118,.203922,.545098,.047059,.670588,.286275,.647059,.866667,.584314,.678431,.85098,.368627,.647059,.231373,.866667,.615686,.694118,.933333,.137255,.580392,.886275,.67451,.419608,.776471,.611765,.862745,.647059,.121569,.341176,.941176,0,.223529,.913725,.466667,.2,.078431,.745098,.427451,.945098,.533333,.768627,.898039,.564706,.494118,.278431,.768627,.588235,.427451,.905882,.101961,.05098,.615686,.741176,.882353,.6,.505882,.768627,.686275,.960784,.105882,.611765,.733333,.278431,.690196,.964706,.788235,.415686,.811765,.67451,.121569,.309804,.52549,.105882,.258824,.839216,.466667,.031373,.788235,.713725,.878431,.384314,.2,.752941,.423529,.584314,.678431,.007843,.564706,.827451,.141176,.027451,.372549,.713725,.058824,.780392,.980392,.254902,.360784,.172549,.411765,.741176,.019608,.25098,.341176,.4,.631373,.066667,.6,.105882,.529412,.862745,.780392,.992157,.137255,.345098,.745098,.831373,.329412,.027451,.517647,.427451,.890196,.592157,.082353,.52549,.258824,.172549,.023529,.494118,.905882,.32549,.176471,.933333,.462745,.94902,.07451,.419608,.760784,.14902,.270588,.811765,.439216,.176471,.529412,.231373,.368627,.282353,.517647,.815686,.039216,.25098,.521569,.090196,.466667,.035294,.243137,.776471,.423529,.086275,.878431,.309804,.713725,.831373,.615686,.85098,.164706,.066667,.345098,.631373,.423529,.25098,.968627,.364706,.67451,.121569,.231373,.698039,.333333,.807843,.533333,.333333,.2,.247059,.047059,.890196,.411765,.223529,.462745,.329412,.921569,.490196,.231373,.156863,.627451,.07451,.341176,.945098,.588235,.756863,.364706,.937255,.784314,.411765,.54902,.196078,.278431,.505882,.113725,.603922,.831373,.533333,.066667,.313725,.772549,.388235,.647059,.505882,.247059,.996078,.466667,.815686,.52549,.411765,.121569,.537255,.631373,.05098,.952941,.490196,.870588,.560784,.078431,.870588,.176471,.309804,.85098,.470588,.25098,.168627,.662745,.443137,.529412,.882353,.05098,.14902,.478431,.678431,.788235,.27451,.654902,.223529,.839216,.772549,.627451,.968627,.305882,.576471,.745098,.407843,.803922,.564706,.215686,.74902,.517647,.298039,.972549,.101961,.494118,.72549,.588235,.027451,.756863,.952941,.086275,.666667,.745098,.4,.329412,.996078,.729412,.352941,.788235,.941176,.552941,.67451,.168627,.509804,.631373,.556863,.058824,.356863,.278431,.482353,.690196,.988235,.827451,.117647,.188235,.705882,0,.101961,.835294,.537255,1,.392157,.756863,.160784,.466667,.941176,.67451,.784314,.478431,.309804,.07451,.643137,.772549,.145098,.866667,.062745,.760784,.392157,.921569,.552941,.243137,.184314,.039216,.666667,.498039,.231373,.698039,.007843,.341176,.952941,.807843,.407843,.933333,.466667,.270588,.882353,.137255,.490196,.960784,.27451,.203922,.917647,.745098,.662745,.109804,.219608,.584314,.298039,.870588,.745098,.454902,.823529,.282353,.2,.364706,.796078,.639216,.466667,.772549,.937255,.203922,.733333,.972549,.380392,.007843,.305882,.215686,.658824,.270588,.968627,.603922,.862745,.184314,.972549,.105882,.498039,.329412,.4,.129412,.47451,.666667,.835294,.090196,.27451,.658824,.113725,.384314,0,.815686,.196078,.564706,.396078,.890196,.05098,.980392,.321569,.388235,.823529,.443137,.2,.921569,.094118,.164706,.584314,.886275,.2,.258824,.396078,.858824,.321569,.976471,.827451,.384314,.780392,.172549,.988235,.533333,.003922,.239216,.572549,.305882,.470588,.878431,.6,.8,.47451,.2,.309804,.796078,.011765,.584314,.933333,.294118,.062745,.105882,.639216,.392157,.85098,.576471,.952941,.352941,.556863,.658824,.4,.576471,.827451,.301961,.47451,.745098,.839216,.415686,.913725,.827451,.172549,.572549,.878431,.643137,.066667,.721569,.145098,.654902,.047059,.341176,.619608,.733333,.898039,.094118,.823529,.45098,.047059,.576471,.364706,.870588,.917647,.666667,.007843,.67451,.215686,.086275,.917647,.584314,.698039,.113725,.992157,.156863,.270588,.003922,.658824,.4,.054902,.670588,.564706,.823529,.74902,.92549,.498039,.384314,.768627,.113725,.282353,.54902,.372549,.772549,.670588,.933333,.027451,.72549,.898039,.211765,.384314,.039216,.980392,.478431,.862745,.690196,.909804,.341176,.647059,.878431,.603922,.247059,.694118,.203922,.552941,.890196,.615686,0,.556863,.854902,.631373,.490196,.690196,.003922,.556863,.121569,.713725,.494118,.078431,.223529,.721569,.27451,.121569,.890196,.427451,.74902,.909804,.384314,.788235,.082353,.670588,.92549,.32549,.380392,.945098,.741176,.611765,.078431,.490196,.2,.647059,.843137,.415686,.545098,.992157,.129412,.721569,.2,.011765,.827451,.243137,.090196,.988235,.188235,.027451,.686275,.094118,.882353,.584314,.282353,.07451,.313725,.447059,.996078,.078431,.498039,.254902,.564706,.862745,.231373,.745098,.992157,.192157,.411765,.243137,.666667,.6,.133333,.862745,.407843,.278431,.058824,.427451,.172549,.972549,.368627,.890196,.329412,.505882,.011765,.423529,.760784,.313725,.498039,.917647,.54902,.835294,.345098,.494118,.105882,.898039,.466667,.145098,.086275,.572549,.196078,.905882,.423529,.717647,.047059,.45098,.062745,.278431,.854902,.560784,.352941,.05098,.545098,.933333,.443137,.584314,.164706,.294118,.529412,.141176,.231373,.454902,.05098,.14902,.352941,.843137,.47451,.105882,.282353,.160784,.729412,.32549,.411765,.243137,.796078,.372549,.968627,.435294,.631373,.760784,.047059,.352941,.588235,.447059,.031373,.490196,.670588,.305882,.113725,.619608,.164706,.72549,.521569,.215686,.062745,.533333,.156863,.231373,.670588,.435294,.94902,.870588,.368627,.137255,.717647,.313725,.784314,.239216,.882353,.509804,.282353,.670588,.462745,.768627,.305882,.701961,.501961,.588235,.94902,.14902,.364706,.705882,.482353,.807843,.133333,.72549,.203922,.380392,.776471,.921569,.427451,.321569,.505882,.07451,.796078,.560784,.007843,.52549,.360784,.305882,.968627,.768627,.188235,.639216,.796078,.517647,.733333,.27451,.47451,.615686,.8,.25098,.670588,.878431,.188235,.611765,.729412,.392157,.239216,.113725,.607843,.858824,.203922,.313725,.25098,.607843,.823529,.721569,.007843,.509804,.247059,.635294,.854902,.921569,.619608,.52549,.14902,.223529,.670588,.796078,.278431,.756863,.698039,.239216,.768627,.92549,.435294,.627451,1,.780392,.713725,.94902,.447059,.768627,.662745,.94902,.784314,.686275,.505882,.988235,.129412,.913725,.278431,.066667,.803922,.32549,.917647,.184314,.972549,.807843,.662745,.937255,.835294,.584314,.937255,.203922,.803922,.47451,.898039,.337255,.968627,.839216,.301961,.694118,.564706,.862745,.039216,.356863,.164706,.258824,.564706,.976471,.521569,.192157,.592157,0,.341176,.447059,.952941,.121569,.572549,.905882,.156863,.870588,.352941,.270588,.780392,.443137,.215686,0,.972549,.6,.678431,.529412,.85098,.286275,.658824,.117647,.184314,.972549,.603922,.478431,.380392,.294118,.85098,.945098,.756863,.47451,.05098,.678431,.490196,.933333,.129412,.572549,.337255,.839216,.082353,.552941,.137255,.407843,.960784,.341176,.537255,.101961,.905882,.031373,.67451,.952941,.294118,.788235,.662745,1,.537255,.396078,.952941,.313725,.662745,.811765,.980392,.345098,.082353,.215686,.788235,.407843,1,.439216,.913725,.494118,.172549,.105882,.517647,.870588,.023529,.368627,.733333,.058824,.203922,.509804,.298039,.109804,.552941,.019608,.278431,.396078,.058824,.337255,.243137,.815686,.039216,.576471,.705882,.52549,.196078,.105882,.678431,.384314,.254902,.533333,.141176,.309804,.078431,.396078,.733333,.058824,.533333,.266667,.027451,.4,.109804,.607843,.45098,.988235,.760784,.113725,.482353,.827451,.772549,.694118,.07451,.8,.047059,.937255,.47451,.807843,.698039,.086275,.627451,.854902,.372549,.05098,.615686,.411765,.803922,.054902,.905882,.521569,.631373,.827451,.172549,.337255,.25098,.94902,.035294,.592157,.811765,.470588,.011765,.670588,.827451,.141176,.917647,.717647,.627451,.101961,.156863,.831373,.203922,.552941,.356863,.019608,.866667,.231373,.968627,.027451,.694118,.921569,.733333,.058824,.823529,.137255,.270588,.831373,.443137,.321569,.796078,.156863,.478431,.411765,.023529,.796078,.07451,.733333,.129412,.435294,.607843,.090196,.160784,.701961,.498039,.309804,.662745,.023529,.756863,.294118,.094118,.615686,.945098,.411765,.309804,.643137,.090196,.478431,.278431,.839216,.6,.380392,.878431,.631373,.227451,.972549,.588235,.184314,.870588,.560784,.427451,.619608,.776471,.470588,.14902,.882353,.427451,.843137,.572549,.490196,.078431,.882353,.419608,.756863,.282353,.172549,.647059,.368627,.996078,.843137,.694118,.556863,.772549,.168627,.356863,.003922,.254902,.411765,.921569,.552941,.313725,.47451,.611765,.384314,.345098,.643137,.27451,.890196,.54902,.215686,.784314,.337255,.490196,.729412,.215686,.470588,.117647,.572549,.654902,.321569,.74902,.92549,.411765,.062745,.870588,.411765,.145098,.337255,.898039,.533333,.352941,.745098,.278431,.203922,.435294,.07451,.258824,.423529,.580392,.909804,.654902,.286275,.827451,.301961,.701961,.419608,.639216,.2,.384314,.309804,.219608,.505882,.627451,.698039,.592157,.972549,.188235,.631373,.505882,.905882,.082353,.560784,.227451,.345098,.615686,.176471,.294118,.898039,.356863,.490196,.270588,.780392,.415686,.964706,.552941,.145098,.870588,.694118,.356863,0,.854902,.67451,.247059,.992157,.580392,.835294,.678431,.172549,.913725,.094118,.8,.345098,.729412,.133333,.85098,.533333,.705882,.976471,.086275,.192157,.368627,.968627,.313725,.611765,.745098,0,.282353,.945098,.729412,.588235,.2,.517647,.811765,.952941,.784314,.419608,.129412,.603922,.086275,.223529,.952941,.505882,.690196,.890196,.8,.156863,.662745,.219608,.007843,.913725,.156863,.85098,.219608,.741176,.101961,.156863,.392157,.952941,.023529,.266667,.176471,1,.85098,.694118,.968627,.184314,.396078,.039216,.133333,.25098,.529412,.729412,.658824,.784314,.482353,.2,.713725,.258824,.992157,.101961,.576471,.890196,.662745,.972549,.509804,.780392,.337255,.027451,.427451,.113725,.960784,.607843,.172549,.470588,.811765,.509804,.886275,.662745,.439216,1,.188235,.298039,.380392,.47451,.058824,.776471,.247059,.384314,.745098,.639216,.945098,.878431,.490196,.854902,.556863,.776471,.023529,.862745,.941176,.572549,.121569,.854902,.203922,.470588,.282353,.576471,.784314,.196078,.470588,.576471,.133333,.745098,.184314,.388235,.960784,.337255,.498039,.443137,.035294,.533333,.898039,.470588,.384314,.243137,.003922,.772549,.294118,.85098,.67451,.031373,.254902,.121569,.968627,.45098,.686275,.156863,.345098,.039216,.988235,.698039,.101961,.560784,0,.254902,.505882,.756863,.329412,.878431,.635294,.278431,.082353,.6,.470588,.32549,.639216,.988235,.380392,.686275,.25098,.941176,.45098,.580392,.85098,.494118,.662745,.6,.74902,.890196,.552941,.639216,.031373,.305882,.329412,.882353,.705882,.490196,.960784,.611765,.45098,.082353,.305882,.576471,.101961,.913725,.619608,.054902,.843137,.419608,.517647,.337255,.019608,.733333,.164706,.882353,.286275,.992157,.752941,.509804,.772549,.392157,.058824,.905882,.101961,.592157,.054902,.768627,.113725,.564706,.866667,.011765,.917647,.745098,.141176,.870588,.564706,.011765,.835294,.305882,.156863,.415686,.686275,.05098,.964706,.239216,.670588,.407843,.184314,.639216,.054902,.733333,.337255,.639216,.92549,.094118,.509804,.976471,.286275,.796078,.058824,.890196,.454902,.011765,.54902,.121569,.74902,.701961,.270588,.176471,.686275,.047059,.619608,.811765,.341176,.47451,.160784,.501961,.92549,.545098,.796078,.647059,.356863,.509804,.239216,.788235,.843137,.647059,.462745,.254902,.352941,.462745,.894118,.705882,.917647,.2,.447059,.388235,.039216,.815686,.913725,.223529,.52549,.85098,.07451,.729412,.094118,.584314,.505882,.729412,.023529,.368627,.988235,.298039,.062745,.352941,.447059,.137255,.427451,.360784,.101961,.529412,.615686,.784314,.231373,.85098,.164706,.690196,.890196,.211765,1,.827451,.384314,.74902,.45098,.305882,.184314,.643137,.796078,.156863,.537255,.392157,.603922,.086275,.490196,.635294,.141176,.203922,.862745,.545098,.25098,.756863,.282353,.356863,.164706,.905882,.258824,.352941,.784314,.686275,.227451,.603922,.321569,.658824,.415686,.996078,.215686,.47451,.780392,.101961,.25098,.32549,.419608,.156863,.745098,.529412,.333333,.988235,.247059,.388235,.909804,.011765,.803922,.407843,.192157,.878431,.32549,.705882,.411765,.537255,.27451,.72549,.639216,.247059,.937255,.615686,.835294,.992157,.4,.294118,.117647,.964706,.635294,.917647,.588235,.729412,.090196,.415686,.2,.909804,.058824,.862745,.105882,.4,.529412,.321569,.121569,.905882,.721569,.619608,.129412,.333333,.654902,.027451,.968627,.721569,.529412,.160784,.345098,.717647,.117647,.952941,.286275,.478431,.882353,.811765,.188235,.321569,.627451,.066667,.694118,.196078,.807843,.866667,.227451,.721569,.8,.913725,.756863,.447059,.160784,.062745,.427451,.580392,.301961,.384314,.788235,.023529,.341176,.686275,.231373,.003922,.964706,.560784,.729412,.870588,.090196,.94902,.298039,.85098,.937255,.239216,.698039,.831373,.352941,.592157,.078431,.321569,.686275,.980392,.658824,.827451,.447059,.694118,.6,.415686,.509804,.07451,.466667,.537255,.945098,.082353,.282353,.698039,.078431,.584314,.537255,.94902,.705882,.811765,.619608,.886275,.278431,.796078,.007843,.454902,.827451,.521569,.6,.698039,.305882,.454902,.745098,.643137,.031373,.133333,.611765,.917647,.337255,.866667,.803922,.078431,.411765,.14902,.345098,.552941,.784314,.886275,.72549,.52549,.211765,.086275,.368627,.25098,.313725,.839216,.478431,.705882,.294118,.560784,.964706,.615686,.031373,.933333,.776471,.372549,.062745,.862745,.211765,.415686,.835294,.572549,.27451,.117647,.898039,.619608,.443137,.780392,.023529,.396078,.592157,.227451,.427451,.341176,.094118,.952941,.807843,.533333,.905882,.423529,.607843,.517647,.94902,.082353,.305882,.584314,.196078,.921569,.85098,.643137,.996078,0,.752941,.109804,.505882,.631373,.482353,.160784,.898039,.517647,.129412,.372549,.25098,.466667,.227451,.627451,.698039,.447059,.105882,.564706,.392157,.007843,.254902,.94902,.419608,.898039,.494118,.007843,.396078,.223529,.537255,.945098,.023529,.211765,.968627,.137255,.815686,.360784,.176471,.827451,.494118,.909804,.74902,.341176,.870588,.188235,.011765,.588235,.494118,.101961,.960784,.615686,.121569,.698039,.768627,.101961,.203922,.141176,.992157,.082353,.227451,.560784,.482353,.945098,.219608,.654902,.090196,.176471,.494118,.294118,.890196,.52549,.007843,.219608,.090196,.494118,.172549,.270588,.419608,.878431,.8,.662745,.976471,.023529,.6,.137255,.427451,.752941,.196078,.270588,.494118,.705882,.196078,.521569,.270588,.8,.552941,.968627,.082353,.380392,.780392,.686275,.466667,.247059,.992157,.305882,.670588,.898039,.776471,.164706,.941176,.643137,.772549,.258824,.454902,.113725,.254902,.768627,.003922,.160784,.380392,.643137,.023529,.501961,.239216,.678431,.27451,.352941,.498039,.215686,.862745,.92549,.247059,.741176,.964706,.309804,.6,.776471,.643137,.835294,.933333,.035294,.407843,.760784,.082353,.258824,.780392,.172549,.92549,.882353,.498039,.72549,.788235,.176471,.635294,.141176,.564706,.890196,.109804,.313725,.733333,.858824,.639216,.282353,.898039,.760784,0,.619608,.372549,.164706,.247059,.443137,.654902,.411765,.282353,.941176,.203922,.384314,.47451,.243137,.913725,.423529,.270588,.945098,.372549,.478431,.572549,.827451,.913725,.368627,.796078,.423529,.835294,.309804,.552941,1,.67451,.439216,.592157,.964706,.721569,.631373,.341176,.941176,.670588,.564706,.74902,.011765,.490196,.137255,.45098,.772549,.27451,.945098,.05098,.815686,.666667,.360784,.839216,.090196,.588235,.980392,.654902,.443137,.160784,.701961,.494118,.615686,.156863,.333333,.023529,.839216,.094118,.54902,.192157,.509804,.058824,.690196,.529412,.011765,.4,.576471,.686275,.85098,.32549,.482353,.976471,.286275,.717647,.831373,.341176,.964706,.72549,.4,.086275,.545098,.839216,.670588,.454902,.580392,.4,.188235,.047059,.858824,.423529,.211765,.078431,.309804,.701961,.580392,.992157,.529412,.870588,.360784,.494118,.733333,.329412,.639216,.121569,.215686,.035294,.384314,.278431,.85098,.756863,.447059,.254902,.67451,.172549,.47451,.352941,.713725,.592157,.439216,.247059,.717647,.968627,.580392,.019608,.811765,.133333,.905882,.733333,.423529,.843137,.054902,.713725,.862745,.196078,.54902,.062745,.615686,.866667,.776471,.666667,.321569,.023529,.701961,.270588,.160784,.047059,.74902,.396078,.066667,.815686,.203922,.101961,.278431,.784314,.435294,.886275,.05098,.380392,.101961,.972549,.341176,.619608,.917647,.176471,.356863,.878431,.662745,.392157,.490196,.121569,.905882,.423529,.776471,.25098,.309804,.019608,.898039,.086275,.278431,.776471,.243137,.972549,.866667,.521569,.388235,.658824,.788235,.454902,.945098,.313725,.243137,.611765,.839216,.090196,.886275,.168627,.368627,.741176,.086275,.666667,.439216,.85098,.54902,.478431,.137255,.8,.619608,.035294,.941176,.176471,.294118,.082353,.14902,.658824,.827451,.52549,.121569,.686275,.454902,.898039,.14902,.498039,.117647,.32549,.192157,.670588,.011765,.972549,.627451,.082353,.443137,.552941,.843137,.67451,.988235,.529412,.713725,.333333,.035294,.992157,.803922,.4,.537255,.035294,.231373,.094118,.937255,.117647,.329412,.454902,.862745,.690196,.52549,.32549,.039216,.611765,.145098,.529412,.776471,.019608,.380392,.643137,.996078,.345098,.713725,.047059,.258824,.113725,.423529,.188235,.635294,.980392,.545098,.694118,.898039,.509804,.254902,.631373,.74902,.909804,.360784,.160784,.85098,.258824,.6,.803922,.454902,.862745,.219608,.705882,.301961,.564706,.729412,.129412,.529412,.203922,.32549,1,.031373,.615686,.156863,.894118,.466667,.756863,.619608,.352941,.933333,.454902,.039216,.588235,.435294,.741176,.176471,.921569,.270588,.129412,.85098,.368627,.752941,.968627,.298039,.211765,.521569,1,.047059,.592157,.909804,.537255,.117647,.266667,.196078,.082353,.894118,.305882,.435294,.909804,.768627,.380392,.717647,.886275,.972549,.32549,.768627,.364706,.266667,.780392,.980392,.560784,.368627,.74902,.811765,.239216,.843137,.443137,.560784,.203922,.831373,.247059,.388235,.952941,.309804,.603922,.419608,.07451,.937255,.2,.647059,.490196,.607843,.121569,.858824,.745098,.976471,.462745,.658824,.533333,.807843,.215686,.086275,.282353,.945098,.768627,.560784,.992157,.258824,.647059,.329412,.572549,.286275,.117647,.788235,.505882,.164706,.447059,.890196,.952941,.580392,.501961,.882353,.105882,.32549,.45098,.211765,.945098,.133333,.337255,.54902,.007843,.490196,.658824,.078431,.533333,.203922,.717647,.309804,.164706,.537255,.082353,.823529,.05098,.47451,.937255,.254902,.694118,.796078,.580392,.243137,.713725,.372549,.54902,.117647,.823529,.215686,.564706,.839216,.666667,.14902,.890196,.294118,.07451,.705882,.345098,.007843,.713725,.584314,.054902,.478431,.121569,.427451,.713725,.345098,.776471,.45098,.282353,.176471,.827451,.341176,.952941,.780392,.576471,.666667,.172549,.521569,.25098,.133333,.576471,.462745,.239216,.529412,.023529,.462745,.92549,.619608,.145098,.341176,.039216,.862745,.423529,.635294,.039216,.717647,.921569,.117647,.298039,.717647,.890196,.054902,.752941,.188235,.101961,.8,.25098,.470588,.129412,.878431,.364706,.239216,.945098,.313725,.419608,.780392,.176471,.380392,.843137,.047059,.619608,.745098,.380392,.168627,.47451,.215686,.341176,.811765,.109804,.952941,.886275,.454902,.745098,.035294,.898039,.580392,.654902,.2,.360784,.72549,.066667,.768627,.396078,.803922,.588235,.007843,.658824,.831373,.443137,.960784,.713725,.329412,.576471,.988235,.745098,.427451,.92549,.007843,.666667,.882353,.423529,.980392,.419608,.631373,.831373,.003922,.443137,.866667,.066667,.462745,.92549,.658824,.286275,.960784,.4,.509804,.019608,.278431,.392157,.721569,.505882,.223529,.8,.545098,.980392,.478431,.6,.886275,.192157,.670588,.898039,.788235,.6,.058824,.647059,.227451,.937255,.698039,.415686,.615686,.019608,.717647,.392157,.996078,.05098,.866667,.698039,.345098,.815686,.062745,.627451,.823529,.686275,.203922,.870588,.066667,.517647,.72549,.215686,.607843,.109804,.964706,.270588,.552941,.368627,.803922,.466667,.521569,.14902,.603922,.815686,.482353,.368627,.909804,.611765,.678431,.54902,.784314,.031373,.701961,.172549,.643137,.078431,.611765,.25098,.898039,.509804,.301961,1,.427451,.580392,.839216,.658824,.082353,.45098,.854902,.501961,.188235,.427451,.607843,.831373,.231373,.309804,.423529,.101961,.815686,.521569,.85098,.298039,.227451,.639216,.172549,.894118,.278431,.705882,.372549,.05098,.2,.815686,.882353,.231373,.054902,.329412,.133333,.490196,.784314,.364706,.576471,.211765,.760784,.254902,.129412,.352941,.6,.74902,.145098,.631373,.313725,.188235,.772549,.031373,.854902,.137255,.705882,.784314,.168627,.992157,.321569,.639216,.917647,.470588,.145098,.831373,.223529,.407843,.294118,.8,.533333,.035294,.270588,.145098,.866667,.533333,.827451,.117647,.47451,.062745,.909804,.498039,.266667,.466667,.345098,.219608,.588235,.478431,.964706,.188235,.921569,.435294,.352941,.109804,.580392,.254902,.435294,.666667,.839216,.294118,.913725,.203922,.341176,.490196,.756863,.078431,.231373,.988235,.047059,.686275,.427451,.278431,.890196,.211765,.733333,0,.321569,.396078,.960784,.298039,.462745,.835294,.533333,.921569,.337255,.047059,.705882,.14902,.67451,.239216,.886275,.019608,.129412,.776471,.913725,.627451,0,.286275,.741176,.062745,.14902,.364706,.533333,.666667,.964706,.756863,.278431,.039216,.145098,.447059,.960784,.498039,.933333,.109804,.407843,.788235,.501961,.592157,.294118,.117647,.407843,.478431,.639216,.898039,.843137,.611765,.270588,.952941,.117647,.309804,.67451,.52549,.913725,.184314,.972549,.294118,.392157,.941176,.811765,.066667,.45098,.584314,.243137,.631373,.313725,.909804,.470588,.552941,.094118,.011765,.372549,.654902,.313725,.054902,.74902,.066667,.94902,.164706,.345098,.419608,.976471,.741176,.309804,.407843,.019608,.768627,.572549,.309804,.772549,.145098,.858824,.094118,.752941,.815686,.411765,.007843,.670588,.109804,.270588,.729412,.164706,.780392,.913725,.388235,.74902,.968627,.011765,.364706,.784314,.52549,.686275,.831373,.14902,.647059,.607843,.392157,.854902,.321569,.952941,.027451,.654902,.552941,.435294,.862745,.184314,.835294,.078431,.584314,.756863,.384314,.129412,.686275,.427451,.807843,.564706,.411765,.090196,.490196,.823529,.556863,.313725,.270588,.4,.717647,.345098,.556863,.913725,.231373,.690196,.980392,.105882,.858824,.164706,.498039,.694118,.627451,.890196,.576471,.670588,.011765,.345098,.533333,.231373,.968627,.156863,.909804,.756863,.654902,.94902,.160784,.796078,.282353,.545098,.176471,.05098,.694118,.47451,.843137,.019608,.72549,.372549,.796078,.635294,.509804,.109804,.694118,.52549,.890196,.352941,.498039,.741176,.945098,.372549,.058824,.67451,.862745,.74902,.807843,.231373,.968627,.584314,.886275,.529412,.686275,.466667,.654902,.839216,.592157,.501961,.662745,.192157,.466667,.905882,.27451,.678431,.980392,.219608,.380392,.643137,.933333,.533333,.921569,.141176,.717647,.384314,.85098,.54902,.898039,.482353,.647059,.305882,.552941,.160784,.109804,.576471,.482353,.662745,.137255,.972549,.027451,.427451,.945098,.294118,.741176,.192157,.784314,.560784,.4,.145098,.788235,.086275,.996078,.243137,.658824,.521569,.196078,.941176,.019608,.25098,.839216,.498039,.2,.968627,.858824,.760784,.345098,.188235,.643137,.972549,.521569,.078431,.988235,.215686,.803922,.658824,.364706,.501961,.776471,.447059,.611765,0,.372549,.223529,.996078,.396078,.337255,.133333,.74902,.831373,.615686,.67451,.054902,.470588,.196078,.545098,.309804,.498039,.003922,.698039,.368627,.066667,.462745,.909804,.380392,.8,.160784,.94902,.584314,.101961,.439216,.058824,.894118,.219608,.372549,.247059,.717647,.145098,.870588,.007843,.411765,.537255,.14902,.282353,.223529,.419608,.529412,.121569,.713725,.192157,.435294,.345098,.133333,.890196,.266667,.054902,.215686,.105882,.823529,.05098,.960784,.6,.372549,.105882,.435294,.811765,.603922,.301961,.05098,.2,.619608,.270588,.780392,.309804,.462745,.6,.239216,.007843,1,.054902,.835294,.341176,.8,.258824,.921569,.058824,.411765,.243137,.329412,.556863,.898039,0,.517647,.109804,.478431,.243137,.705882,.921569,.294118,.478431,.592157,.345098,.741176,.435294,.882353,.313725,.678431,.545098,.980392,.094118,.298039,.627451,0,.254902,.937255,.713725,.039216,.443137,.745098,.603922,.156863,.454902,.121569,.858824,.564706,.027451,.192157,.27451,.341176,.886275,.560784,.835294,.082353,.780392,.2,.858824,.27451,.447059,.164706,.882353,.298039,.839216,.694118,.388235,.078431,.839216,.564706,.223529,.976471,.741176,.854902,.647059,.247059,.54902,.337255,.27451,.435294,.227451,.701961,.313725,.772549,.560784,.843137,.027451,.615686,.298039,.988235,.203922,.686275,.815686,.92549,.462745,.619608,.980392,.301961,.894118,.462745,.047059,.639216,.988235,.211765,.784314,.580392,.92549,.756863,.894118,.337255,.537255,.694118,.239216,.870588,.168627,.537255,.003922,.882353,.72549,.505882,.415686,.368627,.066667,.517647,.976471,.14902,.086275,.772549,.368627,.419608,.2,.721569,.482353,.627451,.862745,.176471,.698039,.831373,.619608,.745098,.215686,.803922,.345098,.639216,.839216,.976471,.058824,.615686,.827451,.396078,.196078,.686275,.05098,.815686,.105882,.14902,.607843,.796078,.286275,.741176,.384314,.14902,.678431,.533333,.443137,.607843,.14902,.878431,.352941,.223529,.827451,.67451,.886275,.517647,.309804,.952941,.882353,.72549,.933333,.643137,.733333,.188235,.427451,.52549,.031373,.658824,.588235,.976471,.035294,.745098,.505882,.364706,.011765,.807843,.992157,.258824,.768627,.92549,.419608,.109804,.517647,.32549,.117647,1,.047059,.619608,.741176,.921569,.843137,.603922,1,.145098,.454902,.74902,.964706,.443137,.509804,.658824,.101961,.247059,.592157,.164706,.8,.705882,.039216,.168627,.576471,.756863,.854902,.286275,.733333,.509804,.011765,.313725,.396078,.517647,.427451,.286275,.788235,.141176,.427451,.745098,.635294,.960784,.47451,.243137,.141176,.980392,.811765,.870588,.686275,.913725,.215686,.823529,.717647,.933333,.52549,.823529,.603922,.101961,.945098,.039216,.443137,.298039,.576471,.356863,.909804,.058824,.501961,.698039,.121569,.411765,.270588,.67451,.32549,.172549,.52549,.019608,.878431,.941176,.54902,.286275,.968627,.498039,.392157,.05098,.462745,.047059,.643137,.780392,.921569,.227451,.062745,.831373,.305882,.552941,.113725,.913725,.294118,.011765,.345098,.72549,.082353,.662745,.145098,.54902,.4,.054902,.133333,.960784,.294118,.721569,.921569,.47451,.313725,.533333,.4,.129412,.964706,.611765,.576471,.443137,.164706,.121569,.615686,.356863,.184314,.67451,.796078,.278431,.6,.423529,.686275,.827451,.129412,.509804,.047059,.27451,.396078,.019608,.643137,.282353,.109804,.184314,.807843,.756863,.333333,.47451,.733333,.392157,.086275,.333333,.835294,.388235,.670588,.243137,.364706,.07451,.396078,.811765,.631373,.184314,.721569,.066667,.168627,.635294,.988235,.007843,.509804,.313725,.082353,.741176,.341176,.415686,.686275,.082353,.305882,.592157,.003922,.447059,.580392,.4,.039216,.32549,.666667,.160784,.917647,.411765,.231373,.52549,.752941,.976471,.011765,.509804,.164706,.937255,.27451,.580392,1,.172549,.533333,.803922,.894118,.423529,.752941,.231373,.647059,.133333,.45098,.227451,.643137,.905882,.72549,.188235,.94902,.878431,.498039,.345098,.894118,.411765,.741176,.384314,.964706,.678431,.776471,.482353,.392157,.545098,.941176,.219608,.419608,.266667,.835294,.356863,.243137,.505882,.662745,.854902,.572549,.364706,.160784,.890196,.066667,.239216,.811765,.72549,.282353,.094118,.227451,.905882,.517647,.717647,.466667,.286275,.898039,.564706,.027451,.945098,.2,.866667,.082353,.32549,.372549,.184314,.662745,.827451,.533333,.921569,.878431,.329412,.576471,.921569,.047059,.364706,.913725,.827451,.019608,.972549,.243137,.517647,.592157,.941176,.023529,.447059,.976471,.603922,.156863,.92549,.447059,.854902,.976471,.67451,.823529,.247059,.6,.372549,.839216,.937255,.258824,.611765,.203922,.913725,.760784,.545098,.219608,.74902,.282353,.129412,.333333,.654902,.258824,.490196,.137255,.27451,.772549,.729412,.329412,.67451,.145098,.8,.227451,.658824,.396078,.760784,.45098,.031373,.854902,.717647,.086275,.380392,.031373,.576471,.992157,.313725,.811765,.368627,.768627,.713725,0,.364706,.25098,.815686,.588235,.219608,.137255,.556863,.031373,.192157,.670588,.133333,.466667,.2,.039216,.647059,.713725,.137255,.807843,.607843,.482353,.760784,.078431,.611765,.988235,.760784,.47451,.215686,.007843,.619608,.25098,.694118,.768627,.607843,.92549,.454902,.533333,.854902,.760784,.32549,.670588,.952941,.019608,.815686,.082353,.482353,.372549,.717647,.45098,.780392,.52549,.952941,.466667,.886275,.756863,.309804,.109804,.701961,.501961,.219608,.67451,.466667,.545098,.227451,.615686,.14902,.517647,.643137,.894118,.74902,.133333,.278431,.8,.168627,.713725,.870588,.552941,.243137,.078431,.356863,.258824,.54902,.031373,.470588,.909804,.721569,.188235,.560784,.05098,.827451,.521569,.105882,.858824,.164706,.388235,1,.811765,.678431,.866667,.94902,.745098,.835294,.980392,.45098,0,.572549,.090196,.85098,.360784,.447059,.584314,.870588,.090196,.662745,.219608,.364706,.643137,.305882,.505882,.964706,.215686,.698039,.105882,.494118,.588235,.066667,.529412,.156863,.858824,.564706,.109804,.690196,.337255,.427451,.701961,.282353,.992157,.603922,.827451,.25098,.584314,.92549,.333333,.176471,.988235,.270588,.039216,.858824,.176471,.321569,.572549,.027451,.878431,.301961,.090196,.407843,.886275,.803922,.462745,.411765,.117647,.337255,.188235,0,.670588,.141176,.415686,.05098,.223529,.372549,.603922,.25098,.686275,.996078,.219608,.647059,.05098,.341176,.137255,.654902,.223529,.011765,.584314,.443137,.247059,.145098,.796078,.082353,.843137,.294118,.729412,.090196,.435294,.960784,.211765,.32549,.419608,.172549,.478431,.92549,.631373,.32549,.517647,.109804,.294118,.67451,.733333,.6,.137255,.870588,.407843,.756863,.309804,.113725,.447059,.705882,.396078,.992157,.439216,.301961,.6,.466667,.643137,.435294,.101961,.509804,.176471,.023529,.435294,.090196,.615686,.352941,.878431,.490196,.941176,.196078,.964706,.066667,.72549,.258824,.32549,.972549,.831373,.576471,.898039,.243137,.752941,.611765,.8,.294118,.407843,.913725,.192157,.866667,1,.407843,.298039,.941176,.447059,.494118,.968627,0,.784314,.854902,.356863,.101961,.494118,.898039,.019608,.741176,.545098,.807843,.470588,.372549,.686275,.517647,.976471,.705882,.933333,.454902,.176471,.694118,.603922,.952941,.745098,.094118,.517647,1,.835294,.658824,.498039,.890196,.380392,.796078,.501961,.996078,.8,.129412,.435294,.862745,.772549,.121569,.419608,.85098,.905882,.258824,.564706,.85098,.705882,.286275,.941176,.54902,.960784,.360784,.6,.4,.996078,.141176,.905882,.803922,.286275,.690196,.564706,.05098,.807843,.67451,.058824,.556863,.419608,.066667,.835294,.768627,.372549,.47451,.898039,.788235,.321569,.505882,.941176,.2,.062745,.619608,.886275,.247059,.780392,.141176,.729412,0,.678431,.952941,.054902,.239216,.921569,.345098,.615686,.368627,.54902,.223529,.701961,.192157,.647059,.254902,.603922,.427451,.294118,.631373,.117647,.909804,.537255,.176471,.003922,.494118,.141176,.062745,.462745,.345098,.156863,.654902,.854902,0,.67451,.345098,.25098,.580392,.662745,.05098,.878431,.172549,.74902,.082353,.643137,.45098,.537255,.760784,.313725,.713725,.415686,.372549,.882353,.078431,.619608,.913725,.301961,.101961,.407843,.639216,.117647,.25098,.545098,.839216,.164706,.337255,.537255,.188235,.294118,.023529,.564706,.247059,.960784,.058824,.301961,.619608,.247059,.686275,.580392,.92549,.52549,.176471,.329412,.529412,.580392,.164706,.784314,.380392,.980392,.082353,.415686,.788235,.160784,.035294,.85098,.729412,.278431,.521569,.003922,.639216,.392157,.509804,.054902,.768627,.878431,.47451,1,.356863,.788235,.223529,.713725,.960784,.25098,.156863,1,.011765,.188235,.45098,.039216,.705882,.647059,.337255,.580392,.968627,.505882,.329412,.066667,.588235,.364706,.894118,.2,.337255,.768627,.584314,.831373,.482353,.745098,.882353,.282353,.788235,.941176,.415686,.054902,.803922,.160784,.721569,.545098,.784314,.482353,.815686,.435294,.615686,.745098,.396078,.796078,1,.701961,.039216,.92549,.494118,.556863,.239216,.443137,.752941,.121569,.8,.090196,.760784,.239216,.607843,.329412,.905882,.247059,.211765,.145098,.921569,.058824,.223529,.168627,.643137,.278431,.129412,.223529,.729412,.545098,.85098,.223529,.470588,.878431,.388235,.772549,.478431,.05098,.419608,.643137,.854902,.72549,.917647,.172549,.392157,.745098,.576471,.803922,.941176,.101961,.352941,.035294,.298039,.635294,.733333,.007843,.921569,.278431,.082353,.478431,.698039,.027451,.607843,.517647,.352941,.690196,.647059,.454902,.07451,.894118,.662745,.768627,.25098,.552941,.184314,.941176,.345098,.137255,.270588,.113725,.631373,.294118,.921569,.027451,.607843,.447059,.694118,.588235,.807843,.286275,.631373,.976471,.160784,.25098,.839216,.784314,.121569,.415686,.831373,.654902,.952941,.266667,.454902,.796078,.52549,.137255,.698039,.023529,.215686,.141176,.976471,.698039,.058824,.533333,.337255,.745098,.996078,.086275,.341176,.882353,.019608,.243137,.372549,.054902,.294118,.945098,.247059,.666667,.411765,.533333,.211765,.839216,.372549,.090196,.776471,.627451,.92549,.521569,.913725,.470588,.341176,.545098,.823529,.384314,.482353,.592157,.964706,.4,.678431,.607843,.839216,.988235,.784314,.533333,.678431,.92549,.396078,.160784,.039216,.784314,.533333,.721569,.007843,.980392,.266667,.917647,.788235,.231373,.054902,.6,.321569,.780392,.639216,.078431,.447059,.2,.160784,.533333,.772549,.454902,.827451,.090196,.388235,.694118,.45098,.827451,.635294,.721569,.243137,.309804,.886275,.227451,.109804,.996078,.223529,.337255,.564706,.121569,.184314,.364706,.952941,.113725,.831373,.619608,.411765,.556863,.670588,.854902,.396078,.14902,.478431,.862745,.345098,.211765,.490196,.121569,.360784,.72549,.521569,.839216,.07451,.533333,.447059,0,.282353,.72549,.188235,.482353,.105882,.564706,.854902,.07451,.407843,.278431,.968627,.356863,.647059,.427451,.101961,.584314,.470588,.156863,.913725,.580392,.443137,.521569,.839216,.396078,.172549,.988235,.666667,.870588,.721569,.560784,.090196,.176471,.878431,.309804,.745098,.270588,.627451,1,.32549,.14902,.054902,.282353,.392157,.192157,.639216,.992157,.137255,.047059,.870588,.705882,.019608,.815686,.278431,.368627,.54902,.439216,.07451,.337255,.827451,.023529,.490196,.968627,.635294,.266667,.192157,.32549,.109804,.615686,.678431,.117647,.576471,.980392,.435294,.380392,.117647,.470588,.866667,.25098,.509804,.854902,.67451,.415686,.898039,.227451,.976471,.607843,.247059,.890196,.203922,.968627,.356863,.129412,.537255,.94902,.427451,.768627,.835294,.509804,.368627,.937255,.815686,.447059,.858824,.498039,.690196,.305882,.466667,.023529,.72549,.952941,.203922,.509804,.776471,.701961,.560784,.094118,.658824,.776471,.945098,.878431,.07451,.917647,.223529,.407843,.32549,.760784,.898039,.380392,.980392,.631373,.054902,.92549,.298039,.760784,.156863,.607843,.67451,.886275,.462745,.564706,.85098,.784314,.231373,.352941,.870588,.643137,.25098,.109804,.203922,.686275,.25098,.635294,.741176,.588235,.501961,.145098,.223529,.462745,.909804,.352941,.6,.062745,.811765,.470588,.047059,.721569,.419608,.886275,.560784,.670588,.843137,.011765,.72549,.266667,.435294,.654902,.172549,.333333,.784314,.101961,.517647,.72549,.027451,.203922,.937255,.423529,.592157,.258824,.662745,.760784,.380392,.913725,.952941,.6,.839216,.219608,.407843,.360784,.517647,.168627,.756863,.882353,.52549,.227451,.972549,.027451,.713725,.356863,.952941,.019608,.321569,.721569,.14902,.490196,.756863,.105882,.564706,.031373,.435294,.784314,.858824,.184314,.658824,.062745,.270588,.588235,.007843,.745098,.164706,.282353,.941176,.039216,.603922,.772549,.898039,.231373,.827451,.298039,.086275,.894118,.003922,.243137,.972549,.815686,.27451,.027451,.419608,.301961,.635294,.454902,.129412,.694118,.972549,.603922,.188235,.662745,.215686,.521569,.866667,.423529,.694118,.388235,.988235,.301961,.058824,.745098,.184314,.101961,.298039,.490196,.952941,.705882,.023529,.811765,.4,.72549,.858824,.047059,.952941,.109804,.423529,.294118,.078431,.933333,.407843,.831373,0,.760784,.521569,.980392,.129412,.580392,.894118,.192157,.529412,.815686,.333333,.223529,.756863,.521569,.945098,.094118,.776471,.913725,.556863,.294118,.470588,.643137,.952941,.176471,.882353,.717647,.627451,.121569,.898039,.196078,.32549,.078431,.447059,.109804,.678431,.419608,.52549,.788235,.898039,.705882,.019608,.835294,.266667,.035294,.686275,.831373,.572549,.309804,.752941,.117647,.247059,.776471,.631373,.552941,.054902,.423529,.870588,.329412,.517647,.713725,.239216,.611765,.301961,.023529,.572549,.741176,.466667,.866667,.094118,.658824,.505882,.705882,.564706,.078431,.4,.164706,.533333,.117647,.6,.407843,.678431,.454902,.305882,.631373,.364706,.435294,.176471,.592157,.701961,.231373,.533333,.768627,.858824,.270588,.054902,.498039,.090196,.305882,.780392,.109804,.337255,.803922,.023529,.211765,.643137,.490196,.921569,.239216,.823529,.615686,.027451,.890196,.168627,.611765,.219608,.529412,.945098,.337255,.627451,.478431,.364706,.54902,.815686,.886275,.25098,.760784,.556863,.654902,.266667,.705882,.45098,.223529,.341176,.690196,.4,.113725,.247059,.658824,.082353,.94902,.423529,.160784,.329412,.6,.501961,.215686,.756863,.980392,.156863,.85098,.239216,.423529,.32549,.494118,.282353,.760784,.533333,.862745,.721569,.564706,.8,.231373,.768627,.066667,.294118,.156863,.101961,.964706,.603922,.321569,.643137,.917647,.345098,.07451,.188235,.388235,.94902,.592157,.490196,.188235,.368627,.811765,.270588,.937255,.643137,.184314,.815686,.913725,.090196,.980392,.47451,.407843,.921569,.352941,.247059,.964706,.337255,.780392,.105882,.368627,.227451,.815686,.960784,.266667,.866667,.345098,.701961,.490196,.172549,.796078,.933333,.564706,.062745,.74902,.937255,.490196,.839216,.992157,.14902,.039216,.592157,.368627,.8,.898039,.419608,.713725,.937255,.482353,.576471,.25098,.898039,.54902,.121569,.784314,.360784,.443137,.552941,.992157,.392157,.658824,.462745,.121569,.745098,.439216,.058824,.176471,.784314,.278431,.898039,.196078,.058824,.698039,.356863,.607843,.07451,.32549,.184314,.945098,.062745,.639216,.854902,.282353,.784314,.968627,.466667,.733333,.035294,.466667,.607843,.858824,.25098,.701961,.364706,.039216,.419608,.094118,.584314,.368627,.05098,.670588,.776471,.894118,.090196,.360784,.054902,.419608,.941176,.023529,.509804,.862745,.266667,.627451,.992157,.54902,.443137,.247059,.74902,.462745,.14902,.427451,.501961,.611765,.796078,.462745,.854902,.556863,.066667,.858824,1,.505882,.105882,.741176,.462745,.023529,.6,.384314,.145098,.745098,.654902,.215686,.796078,.145098,.686275,.419608,.168627,.870588,.443137,.607843,.905882,.321569,.635294,.670588,.45098,.086275,1,.894118,.027451,.270588,.733333,.141176,.215686,.866667,.521569,.129412,.062745,.352941,.67451,.419608,.952941,.2,.643137,.239216,.560784,.027451,.827451,.172549,.658824,.05098,.733333,.45098,.858824,.266667,0,.686275,.133333,.333333,.713725,.270588,.772549,.368627,.305882,.909804,.666667,.588235,.92549,.113725,.74902,.6,.423529,.945098,.498039,.160784,.996078,.854902,.603922,.384314,.823529,.172549,.937255,.529412,.019608,.607843,.360784,.878431,.301961,.803922,.121569,.54902,.909804,.066667,.811765,.627451,.894118,.690196,.494118,.713725,.937255,.537255,.003922,.592157,.239216,.996078,.678431,.172549,.627451,.286275,.384314,.145098,.917647,.368627,.003922,.831373,.67451,.4,.058824,.866667,.203922,.996078,.776471,.239216,.933333,.047059,.137255,.278431,.678431,.427451,.698039,.164706,.6,.364706,.227451,.968627,.294118,.694118,.454902,.341176,.878431,.078431,.835294,.537255,0,.631373,.576471,.270588,.992157,.027451,.752941,.14902,.501961,.003922,.552941,.756863,.211765,.615686,.537255,.854902,.407843,.494118,.8,.309804,.662745,.25098,.384314,.6,.905882,.298039,.509804,.713725,.121569,.313725,.988235,.631373,.380392,.27451,.886275,.415686,.329412,.996078,.188235,.607843,.941176,.752941,.572549,.215686,.921569,.078431,.552941,1,.827451,.101961,.478431,.247059,.4,.011765,.521569,.678431,.223529,.101961,.784314,.396078,.733333,.447059,.121569,.517647,.745098,.494118,.105882,.454902,.196078,.843137,.133333,.584314,.239216,.980392,.364706,.662745,.203922,.45098,.968627,.160784,.266667,.85098,.301961,.192157,.807843,.372549,.160784,.454902,.843137,.564706,.796078,.466667,.223529,.968627,.686275,.6,.211765,.705882,.501961,.780392,.188235,.937255,.529412,.811765,.690196,.552941,.129412,.282353,.658824,.380392,.741176,.976471,.329412,.239216,0,.301961,.913725,.862745,.580392,.760784,.117647,.831373,.552941,.047059,.266667,.572549,.443137,.294118,.745098,.917647,.090196,.498039,.717647,.227451,.537255,.415686,.870588,.172549,.815686,.305882,.05098,.423529,.333333,.105882,.6,.980392,.07451,.619608,.415686,.886275,.698039,.815686,.211765,.788235,.07451,.407843,.870588,.760784,.45098,.2,.086275,.960784,.552941,.772549,.141176,.694118,.388235,.556863,.109804,.392157,.803922,.05098,.870588,.454902,.686275,.019608,.619608,.196078,.74902,.858824,.690196,.47451,.988235,.341176,.85098,.282353,.572549,.007843,.211765,.270588,.905882,.039216,.313725,.239216,.619608,.788235,.329412,.933333,.392157,.701961,.184314,.494118,.721569,0,.270588,.772549,.498039,.345098,.560784,.031373,.443137,.078431,.619608,.27451,.972549,.72549,.329412,.113725,.27451,.721569,.337255,.831373,.058824,.462745,.086275,.811765,.333333,.117647,.282353,.627451,.086275,.364706,.301961,.011765,.407843,.890196,.490196,.560784,.211765,.611765,.776471,.894118,.576471,.74902,.466667,.168627,.062745,.498039,.407843,.960784,.203922,.788235,.917647,.72549,.109804,.976471,.329412,.827451,.188235,.670588,.368627,.811765,.27451,.058824,.988235,.713725,.372549,.941176,.654902,.788235,.945098,.192157,.698039,.352941,.231373,.913725,.031373,.172549,.533333,.023529,.47451,.14902,.588235,.92549,.019608,.533333,.14902,.843137,.733333,.505882,.223529,.011765,.823529,.494118,.054902,.258824,.843137,.47451,.298039,.517647,.603922,.160784,.231373,.4,.505882,.945098,.360784,.039216,.313725,.823529,.168627,.086275,.92549,.639216,.52549,.886275,.823529,.631373,.772549,.678431,.945098,.866667,.396078,.717647,.05098,.647059,.533333,.917647,.047059,.8,.333333,.603922,.94902,.427451,.062745,.729412,.619608,.952941,.780392,.913725,.529412,.113725,.882353,.678431,.188235,.407843,.937255,.027451,.576471,.133333,.890196,.54902,.960784,.607843,.411765,.941176,.843137,.470588,.223529,.968627,.654902,.831373,.713725,.184314,.952941,.027451,.815686,.109804,.45098,.090196,.521569,.788235,.4,.67451,.32549,.886275,.647059,.011765,.305882,.615686,.509804,.380392,.188235,.611765,.47451,.227451,.407843,.878431,.035294,.945098,.572549,.643137,.360784,.258824,.52549,.121569,.498039,.266667,.705882,.462745,.07451,.843137,.576471,.462745,.733333,.980392,.32549,.85098,.254902,.952941,.658824,.372549,.223529,.678431,.282353,.427451,.647059,.337255,.6,.937255,.305882,.619608,.898039,.690196,.941176,.160784,.662745,.964706,.345098,.784314,.941176,.717647,.286275,.160784,.580392,.913725,.635294,.215686,.54902,.4,.745098,.443137,.203922,.694118,.321569,.078431,.435294,.360784,.184314,.584314,.141176,.988235,.498039,.254902,.086275,.286275,.643137,.435294,.917647,.129412,.843137,.635294,.219608,.862745,.129412,.364706,.25098,.686275,.321569,.423529,.54902,.062745,.501961,.615686,.905882,.658824,.509804,.796078,.419608,.305882,.772549,.129412,.227451,.698039,.560784,.011765,.780392,.435294,.14902,.498039,.258824,.607843,.435294,.329412,.92549,.498039,.372549,.196078,.960784,.247059,.039216,.996078,.219608,.776471,.443137,.733333,.160784,.866667,.419608,.035294,.780392,.894118,.054902,.772549,.556863,.313725,.466667,.129412,.698039,.435294,.843137,.101961,.607843,.8,.168627,.082353,.882353,.533333,.917647,.145098,.298039,.8,.388235,.121569,.647059,.443137,.564706,.741176,.298039,.498039,.823529,.592157,.909804,.960784,.023529,.811765,.113725,.447059,.396078,.188235,.776471,.435294,.32549,.203922,.023529,.741176,.254902,.094118,.490196,.05098,.882353,.796078,.427451,.109804,.494118,.772549,.862745,.611765,.027451,.258824,.121569,.988235,.462745,.564706,.14902,.858824,.509804,.05098,.827451,.352941,.176471,.756863,.862745,.388235,.8,.196078,.243137,.556863,.372549,.160784,.478431,.321569,.686275,.447059,.172549,.843137,.023529,.72549,.239216,.815686,.298039,.756863,.168627,.247059,.388235,.192157,.666667,.270588,.635294,.505882,.07451,.733333,.341176,.643137,.890196,.701961,.572549,.062745,.898039,.768627,.078431,.701961,.243137,.658824,.862745,.713725,.333333,.647059,.133333,.713725,.6,.094118,.247059,.356863,.588235,.968627,.666667,.247059,.552941,.27451,.686275,.129412,.968627,.615686,.803922,.25098,.898039,.184314,.011765,.741176,.909804,.407843,.960784,.564706,.345098,.247059,.407843,.662745,.007843,.517647,.192157,.6,.760784,.066667,.388235,.101961,.894118,.164706,.101961,.380392,.058824,.490196,.172549,.258824,.866667,.705882,.996078,.109804,.537255,.035294,.603922,.8,.552941,.870588,.423529,.584314,.839216,.631373,.329412,.545098,.67451,.254902,.988235,.027451,.286275,.466667,.94902,.8,.368627,.858824,.066667,.647059,.94902,.266667,.752941,.454902,.294118,.615686,.913725,.560784,.670588,.129412,.992157,.52549,.686275,.047059,.894118,.717647,1,.811765,.078431,.92549,.545098,.6,.976471,.494118,.890196,.364706,.972549,0,.466667,.878431,.078431,1,.831373,.027451,.917647,.866667,.419608,1,.176471,.105882,.301961,.192157,.380392,.992157,.341176,.196078,.533333,.870588,.160784,.588235,.278431,.023529,.54902,.862745,.494118,.396078,.882353,.529412,.945098,.823529,.478431,.07451,.141176,.815686,.937255,.427451,.498039,.368627,.192157,.721569,.011765,.52549,.380392,.768627,.560784,.490196,.215686,.282353,.678431,.635294,.019608,.780392,.741176,.6,.976471,.858824,.686275,.258824,.870588,.937255,.196078,.694118,.45098,.980392,.788235,.717647,.635294,.321569,.760784,.533333,.662745,.058824,.572549,.313725,.854902,.270588,.721569,.388235,.988235,.062745,.67451,.14902,.380392,.219608,.945098,.07451,.188235,.741176,.427451,.352941,.129412,.701961,.188235,.529412,.580392,.733333,.239216,.388235,.72549,.023529,.870588,.643137,.223529,.698039,.019608,.435294,.219608,.345098,.741176,.062745,.32549,.760784,.466667,.27451,.023529,.584314,.419608,.752941,.062745,.341176,.141176,.270588,.619608,.094118,.670588,.407843,.588235,.733333,.329412,.552941,.490196,.372549,.572549,.329412,.270588,.788235,.521569,.396078,.933333,.501961,.811765,.090196,.47451,.686275,.380392,.803922,.419608,.101961,.992157,.8,.439216,.156863,.933333,.286275,.329412,.184314,.023529,.670588,.219608,.298039,.521569,.341176,.627451,0,.745098,.843137,.247059,.941176,.427451,.094118,.980392,.333333,.643137,.937255,.352941,.05098,.831373,.466667,.215686,.941176,.117647,.435294,.313725,.078431,.407843,.14902,.462745,.309804,.807843,.607843,.031373,.533333,.27451,.470588,.223529,.835294,.921569,.439216,.364706,.227451,.772549,.160784,.662745,.921569,.109804,.184314,.466667,.298039,.517647,.905882,.05098,.752941,.470588,.372549,.854902,.898039,.603922,.54902,.831373,.894118,.333333,.643137,.031373,.294118,.937255,.501961,.176471,.6,.345098,.101961,.945098,.8,.470588,.086275,.945098,.607843,.443137,.584314,.909804,.411765,.611765,.2,.356863,.639216,.247059,.894118,.282353,.811765,.713725,.415686,.8,.176471,.529412,.27451,.933333,.211765,.8,.647059,.086275,.156863,.780392,.121569,.654902,.007843,.607843,.85098,.705882,.039216,.619608,.752941,.882353,.560784,.011765,.278431,.909804,.498039,.67451,.360784,.223529,.74902,.047059,.803922,.552941,.733333,.635294,.372549,.92549,.756863,.878431,.701961,.156863,.219608,.898039,.584314,.14902,.529412,.843137,.666667,.6,.156863,.254902,.858824,.141176,.552941,.760784,.141176,.521569,.854902,.282353,.168627,.478431,.772549,.909804,.54902,.011765,.647059,.482353,.243137,.337255,.670588,.137255,.898039,.011765,.564706,.105882,.141176,.827451,.952941,.454902,.882353,.396078,.490196,.831373,.635294,.776471,.239216,.835294,.6,.803922,.266667,.576471,.713725,0,.294118,.137255,.231373,.686275,.411765,.086275,.996078,.447059,.129412,.627451,.811765,.294118,.980392,.54902,.396078,.141176,.505882,.333333,.890196,.27451,.780392,.003922,.196078,.831373,.121569,.529412,.960784,.8,.129412,.501961,.192157,.631373,.462745,.898039,.062745,.509804,.921569,.741176,.831373,.137255,.05098,.427451,.937255,.25098,.705882,.94902,.203922,.380392,.941176,.47451,.239216,.160784,.552941,.309804,.278431,.129412,.164706,.964706,.741176,.611765,.211765,.062745,.52549,.960784,.6,.670588,.086275,.466667,.988235,.121569,.827451,.427451,.576471,.035294,.419608,.996078,.313725,.466667,.094118,.341176,.654902,.294118,.211765,.811765,.447059,.054902,.788235,.670588,.407843,.988235,.329412,.705882,.372549,.560784,.67451,.839216,.254902,.627451,.352941,.976471,.768627,.113725,.878431,.94902,.784314,.505882,.396078,.745098,.611765,.294118,.705882,.494118,.011765,.282353,.6,.047059,.227451,.576471,.356863,.007843,.94902,.121569,.341176,.439216,.972549,.133333,.886275,.505882,.631373,.8,.988235,.031373,.494118,.258824,.784314,.870588,.345098,.713725,.05098,.435294,.082353,.780392,.67451,.239216,.976471,.729412,.164706,.505882,.670588,.972549,.388235,.243137,.882353,.047059,.72549,.443137,.854902,.698039,.976471,.003922,.537255,.211765,.670588,.32549,.027451,.247059,.470588,.356863,.670588,.517647,.294118,.870588,.419608,.494118,.54902,.705882,.815686,.066667,.337255,.698039,.886275,.447059,.937255,.658824,.407843,.517647,.094118,.341176,.772549,.247059,.878431,.109804,.321569,.411765,.192157,.894118,.25098,.313725,.505882,.188235,.094118,.239216,.658824,.533333,.776471,.686275,.917647,.823529,.494118,.047059,.729412,.364706,.952941,.517647,.588235,.188235,.890196,.066667,.254902,.639216,.007843,.898039,.090196,.996078,.031373,.717647,.188235,.827451,.380392,.168627,.576471,.392157,.035294,.85098,.184314,.988235,.341176,.796078,.898039,.211765,.635294,.745098,.129412,.788235,.992157,.078431,.905882,.415686,.654902,.537255,.741176,.031373,.192157,.666667,.352941,.247059,.427451,.109804,.329412,.756863,.615686,.14902,.721569,.509804,.211765,.564706,.843137,.913725,.490196,.309804,.858824,.611765,.078431,.6,.407843,.717647,.105882,.301961,.439216,.647059,.705882,.345098,.294118,.607843,.086275,.396078,.333333,.74902,.129412,.952941,.835294,.603922,.439216,.992157,.631373,.909804,.611765,.827451,.156863,0,.627451,.078431,.886275,.145098,.294118,.564706,.745098,.960784,0,.219608,.52549,.823529,.713725,.231373,.843137,.54902,.960784,.615686,.435294,.717647,.47451,.839216,.556863,.72549,.639216,0,.8,.694118,.945098,.866667,.47451,.117647,.372549,.031373,.247059,.411765,.980392,.129412,.905882,.572549,0,.717647,.294118,.352941,.47451,.580392,.811765,.921569,.494118,.745098,.337255,.392157,.466667,.537255,.298039,.054902,.686275,.454902,.741176,.2,.619608,.294118,.686275,.078431,.231373,.470588,.411765,.066667,.529412,.921569,.368627,.427451,.694118,.282353,.505882,.733333,.184314,.270588,.866667,.490196,.607843,.815686,.054902,.960784,.717647,.462745,.870588,.572549,.372549,.964706,.286275,.094118,.941176,.415686,.133333,.254902,.729412,.176471,.019608,.447059,.360784,.823529,.05098,.231373,.560784,.843137,.780392,.537255,.094118,.494118,.921569,.160784,.243137,.898039,.466667,.839216,.435294,.254902,.364706,.145098,.780392,.113725,.313725,.035294,.172549,.372549,.972549,.666667,.321569,.796078,.254902,.435294,.933333,.192157,.490196,.392157,.627451,.768627,.078431,.345098,.035294,.937255,.447059,.145098,.007843,.372549,.184314,.827451,.027451,.94902,.345098,.082353,.423529,.886275,.545098,.364706,.584314,.282353,.811765,.192157,.866667,.603922,.698039,.188235,.584314,.678431,.329412,.192157,.419608,.917647,.101961,.839216,.729412,.160784,.415686,.227451,.109804,.545098,.184314,.607843,.858824,.137255,.952941,.576471,.92549,.278431,.066667,.976471,.470588,.129412,.45098,.533333,.878431,.14902,.662745,.976471,.329412,.227451,.839216,.172549,.654902,.870588,.129412,.584314,.996078,.360784,.078431,.921569,.4,.301961,.52549,.831373,.164706,.647059,.270588,.203922,.031373,.827451,.658824,.490196,.003922,.752941,.67451,.329412,.592157,.952941,.580392,.917647,.278431,.784314,.992157,.482353,.894118,.14902,.035294,.988235,.215686,.807843,.407843,.666667,.768627,.047059,.576471,.176471,.635294,.039216,.721569,.886275,.666667,.415686,.811765,.552941,.733333,.254902,.505882,.768627,.184314],FilterEngine=function(){return this.cache=null,this.actions=[],this};let oi=FilterEngine.prototype=Object.create(Object.prototype);oi.type="FilterEngine";let ai=1e3;const li=function(t){t.toFixed&&!isNaN(t)&&t>=200&&t<=1e4&&(ai=t)};oi.action=function(t){let{identifier:e,filters:i,image:s}=t,{workstoreLastAccessed:n,workstore:r,actions:o,theBigActionsObject:a}=this,l=Object.keys(r),h=Date.now()-ai;for(let t,e=0,i=l.length;e<i;e++)t=l[e],n[t]<h&&(delete r[t],delete n[t]);if(e&&r[e]&&!window.scrawlEnvironmentBrowserDetection.includes("safari"))return n[e]=Date.now(),r[e];o.length=0;for(let t=0,e=i.length;t<e;t++)o.push(...i[t].actions);let c=o.length;if(c){this.unknit(s);for(let t,e,i=0;i<c;i++)t=o[i],e=a[t.action],e&&e.call(this,t);return e&&!window.scrawlEnvironmentBrowserDetection.includes("safari")&&(r[e]=this.cache.work,n[e]=Date.now()),this.cache.work}return s},oi.workstore={},oi.workstoreLastAccessed={},oi.unknit=function(t){this.cache={};let e=this.cache,{width:i,height:s,data:n}=t;n.length,e.source=new ImageData(n,i,s),e.work=new ImageData(n,i,s)},oi.getAlphaData=function(t){let{width:e,height:i,data:s}=t,n=s.length,r=new ImageData(e,i),o=r.data;for(let t=0;t<n;t+=4){let e=s[t+3];o[t]=0,o[t+1]=0,o[t+2]=0,o[t+3]=e>0?255:0}return r},oi.buildImageGrid=function(t){let{cache:e,workstore:i,workstoreLastAccessed:s}=this;t||(t=e.source);let{width:n,height:r}=t;if(n&&r){let t=`grid-${n}-${r}`;if(i[t])return s[t]=Date.now(),i[t];let e=[],o=0;for(let t=0;t<r;t++){let t=[];for(let e=0;e<n;e++)t.push(o),o++;e.push(t)}return i[t]=e,s[t]=Date.now(),e}return!1},oi.getOrAddWorkstore=function(t){const{workstore:e,workstoreLastAccessed:i}=this;return e[t]?(i[t]=Date.now(),e[t]):(e[t]=[],i[t]=Date.now(),e[t])},oi.getRandomNumbers=function(t,e,i=0){let s=`random-${t}-${e}`;i&&(s+="-bluenoise");const{workstore:n,workstoreLastAccessed:r}=this;if(n[s])return r[s]=Date.now(),n[s];const o=[];if(i){const t=ri.length,s=Math.sqrt(t),n=e/i,r=[];for(let e=0;e<t;e+=s){let t=ri.slice(e,e+s);r.push(t)}for(let t=n;t>0;t-=s)for(let t=0;t<s;t++){let e=r[t];for(let t=i;t>0;t-=s)t<s?o.push(...e.slice(0,t)):o.push(...e)}}else{const i=ue(t);for(let t=0;t<e;t++)o.push(i.random())}return n[s]=o,r[s]=Date.now(),n[s]},oi.buildImageCoordinateLookup=function(t){const{cache:e,workstore:i,workstoreLastAccessed:s}=this;t||(t=e.source);const{width:n,height:r}=t;if(n&&r){const t=`coords-lookup-${n}-${r}`;if(i[t])return s[t]=Date.now(),i[t];const e=[];for(let t=0;t<r;t++)for(let i=0;i<n;i++)e.push([i,t]);return i[t]=e,s[t]=Date.now(),e}return!1},oi.buildAlphaTileSets=function(t,e,i,s,n,r,o,a){const{cache:l,workstore:h,workstoreLastAccessed:c}=this;a||(a=l.source);const{width:u,height:d}=a;if(u&&d){(t=t.toFixed&&!isNaN(t)?t:1)<1&&(t=1),(e=e.toFixed&&!isNaN(e)?e:1)<1&&(e=1),t+(i=i.toFixed&&!isNaN(i)?i:1)>=u&&(t=u-i-1),e+(s=s.toFixed&&!isNaN(s)?s:1)>=d&&(e=d-s-1),t<1&&(t=1),e<1&&(e=1),t+i>=u&&(i=u-t-1),e+s>=d&&(s=d-e-1);let o=t+i,a=e+s;(n=n.toFixed&&!isNaN(n)?n:0)<0&&(n=0),n>=o&&(n=o-1),(r=r.toFixed&&!isNaN(r)?r:0)<0&&(r=0),r>=a&&(r=a-1);const l=`alphatileset-${u}-${d}-${t}-${e}-${i}-${s}-${n}-${r}`;if(h[l])return c[l]=Date.now(),h[l];let f,p,m,g,y,b,S,k=[];for(g=r-a,y=d;g<y;g+=a)for(p=n-o,m=u;p<m;p+=o){for(f=[],b=g,S=g+e;b<S;b++)if(b>=0&&b<d)for(let e=p,i=p+t;e<i;e++)e>=0&&e<u&&f.push(4*(b*u+e)+3);for(k.push([].concat(f)),f=[],b=g+e,S=g+e+s;b<S;b++)if(b>=0&&b<d)for(let e=p,i=p+t;e<i;e++)e>=0&&e<u&&f.push(4*(b*u+e)+3);for(k.push([].concat(f)),f=[],b=g,S=g+e;b<S;b++)if(b>=0&&b<d)for(let e=p+t,s=p+t+i;e<s;e++)e>=0&&e<u&&f.push(4*(b*u+e)+3);for(k.push([].concat(f)),f=[],b=g+e,S=g+e+s;b<S;b++)if(b>=0&&b<d)for(let e=p+t,s=p+t+i;e<s;e++)e>=0&&e<u&&f.push(4*(b*u+e)+3);k.push([].concat(f))}return h[l]=k,c[l]=Date.now(),k}return!1},oi.buildImageTileSets=function(t,e,i,s,n){const{cache:r,workstore:o,workstoreLastAccessed:a}=this;n||(n=r.source);const{width:l,height:h}=n;if(l&&h){(t=t.toFixed&&!isNaN(t)?t:1)<1&&(t=1),t>=l&&(t=l-1),(e=e.toFixed&&!isNaN(e)?e:1)<1&&(e=1),e>=h&&(e=h-1),(i=i.toFixed&&!isNaN(i)?i:0)<0&&(i=0),i>=t&&(i=t-1),(s=s.toFixed&&!isNaN(s)?s:0)<0&&(s=0),s>=e&&(s=e-1);const n=`imagetileset-${l}-${h}-${t}-${e}-${i}-${s}`;if(o[n])return a[n]=Date.now(),o[n];const r=[];for(let n=s-e,o=h;n<o;n+=e)for(let s=i-t,o=l;s<o;s+=t){let i=[];for(let r=n,o=n+e;r<o;r++)if(r>=0&&r<h)for(let e=s,n=s+t;e<n;e++)e>=0&&e<l&&i.push(4*(r*l+e));i.length&&r.push(i)}return o[n]=r,a[n]=Date.now(),r}return!1},oi.buildHorizontalBlur=function(t,e){const{workstore:i,workstoreLastAccessed:s}=this;e&&e.toFixed&&!isNaN(e)||(e=0);const n=t.length,r=t[0].length,o=`blur-h-${r}-${n}-${e}`;if(i[o])return s[o]=Date.now(),i[o];let a=[];for(let i=0;i<n;i++)for(let s=0;s<r;s++){let n=[];for(let o=s-e,a=s+e+1;o<a;o++)o>=0&&o<r&&n.push(4*t[i][o]);a[i*r+s]=n}return i[o]=a,s[o]=Date.now(),a},oi.buildVerticalBlur=function(t,e){const{workstore:i,workstoreLastAccessed:s}=this;e&&e.toFixed&&!isNaN(e)||(e=0);const n=t.length,r=t[0].length,o=`blur-v-${r}-${n}-${e}`;if(i[o])return s[o]=Date.now(),i[o];let a=[];for(let i=0;i<r;i++)for(let s=0;s<n;s++){let o=[];for(let r=s-e,a=s+e+1;r<a;r++)r>=0&&r<n&&o.push(4*t[r][i]);a[s*r+i]=o}return i[o]=a,s[o]=Date.now(),a},oi.buildMatrixGrid=function(t,e,i,s,n){const{cache:r,workstore:o,workstoreLastAccessed:a}=this;n||(n=r.source);const{width:l,height:h,data:c}=n;(null==t||t<1)&&(t=1),(null==e||e<1)&&(e=1),null==i||i<0?i=0:i>=t&&(i=t-1),null==s||s<0?s=0:s>=e&&(s=e-1);const u=`matrix-${l}-${h}-${t}-${e}-${i}-${s}`;if(o[u])return a[u]=Date.now(),o[u];let d,f,p,m,g,y,b,S,k,A=c.length,w=[],v=[];for(p=-s,m=e-s;p<m;p++)for(d=-i,f=t-i;d<f;d++)w.push(4*(p*l+d));for(p=0;p<h;p++)for(d=0;d<l;d++){for(b=4*(p*l+d),S=[],g=0,y=w.length;g<y;g++)k=b+w[g],k<0?k+=A:k>=A&&(k-=A),S.push(k);v.push(S)}return o[u]=v,a[u]=Date.now(),v},oi.checkChannelLevelsParameters=function(t){const e=function(t,e=!1){if(t.toFixed)return t<0?[[0,255,0]]:t>255?[[0,255,255]]:isNaN(t)?e?[[0,255,255]]:[[0,255,0]]:[[0,255,t]];if(t.substring&&(t=t.split(",")),Array.isArray(t)){if(!t.length)return t;if(Array.isArray(t[0]))return t;if((t=t.map((t=>parseInt(t,10)))).sort(((t,e)=>t-e)),1==t.length)return[[0,255,t[0]]];let e,i,s=[];for(let n=0,r=t.length;n<r;n++)e=0,i=255,0!=n&&(e=Math.ceil(t[n-1]+(t[n]-t[n-1])/2)),n!=r-1&&(i=Math.floor(t[n]+(t[n+1]-t[n])/2)),s.push([e,i,t[n]]);return s}return e?[[0,255,255]]:[[0,255,0]]};t.red=e(t.red),t.green=e(t.green),t.blue=e(t.blue),t.alpha=e(t.alpha,!0)},oi.cacheOutput=function(t,e,i){cache[t]=e},oi.getInputAndOutputLines=function(t){let e,{cache:i}=this,s=i.work,n=!1,r=i.source,o=!1;return"source-alpha"!==t.lineIn&&"source-alpha"!==t.lineMix||(o=this.getAlphaData(r)),t.lineIn&&("source"===t.lineIn?s=r:"source-alpha"==t.lineIn?s=o:i[t.lineIn]&&(s=i[t.lineIn])),t.lineMix&&("source"==t.lineMix?n=r:"source-alpha"==t.lineMix?n=o:i[t.lineMix]&&(n=i[t.lineMix])),t.lineOut&&i[t.lineOut]?e=i[t.lineOut]:(e=new ImageData(s.width,s.height),t.lineOut&&(i[t.lineOut]=e)),[s,e,n]},oi.getGrayscaleValue=function(t,e,i){return Math.floor(.2126*t+.7152*e+.0722*i)},oi.processResults=function(t,e,i){let s,n=t.data,r=e.data;if(1===i)for(let t=0,e=n.length;t<e;t++)n[t]=r[t];else if(i>0){s=1-i;for(let t=0,e=n.length;t<e;t++)n[t]=n[t]*s+r[t]*i}},oi.colorEngine=ni({name:"filterEngine-colorEngine-do-not-overwrite"}),oi.initiateDithering=function(){this.labReference={},this.predefinedPalette={},this.createPalette("black-white",["#000","#fff"]),this.createPalette("monochrome-4",["#000","#555","#aaa","#fff"]),this.createPalette("monochrome-8",["#000","#333","#555","#777","#999","#bbb","#ddd","#fff"]),this.createPalette("monochrome-16",["#000","#111","#222","#333","#444","#555","#666","#777","#888","#999","#aaa","#bbb","#ccc","#ddd","#eee","#fff"]),this.createPalette("RGBK-extended",["#000","#fff","#003","#007","#337","#00a","#33a","#77a","#00f","#33f","#77f","#aaf","#030","#070","#373","#0a0","#3a3","#7a7","#0f0","#3f3","#7f7","#afa","#300","#700","#733","#a00","#a33","#a77","#f00","#f33","#f77","#faa"]),this.createPalette("CMYK-extended",["#000","#fff","#033","#077","#377","#0aa","#3aa","#7aa","#0ff","#3ff","#7ff","#aff","#303","#707","#737","#a0a","#a3a","#a7a","#f0f","#f3f","#f7f","#faf","#330","#770","#733","#aa0","#aa3","#aa7","#ff0","#ff3","#ff7","#ffa"]),this.createPalette("extended",["#000","#fff","#003","#007","#337","#00a","#33a","#77a","#00f","#33f","#77f","#aaf","#030","#070","#373","#0a0","#3a3","#7a7","#0f0","#3f3","#7f7","#afa","#300","#700","#733","#a00","#a33","#a77","#f00","#f33","#f77","#faa","#033","#077","#377","#0aa","#3aa","#7aa","#0ff","#3ff","#7ff","#aff","#303","#707","#737","#a0a","#a3a","#a7a","#f0f","#f3f","#f7f","#faf","#330","#770","#733","#aa0","#aa3","#aa7","#ff0","#ff3","#ff7","#ffa"]),this.createPalette("RGBK",["#000","#fff","#007","#00f","#77f","#070","#0f0","#7f7","#700","#f00","#f77"]),this.createPalette("CMYK",["#000","#fff","#077","#0ff","#7ff","#707","#f0f","#f7f","#770","#ff0","#ff7"]),this.createPalette("basic",["#000","#fff","#007","#00f","#77f","#070","#0f0","#7f7","#700","#f00","#f77","#077","#0ff","#7ff","#707","#f0f","#f7f","#770","#ff0","#ff7"])},oi.createPalette=function(t,e){if(t&&this.predefinedPalette[t])return this.predefinedPalette[t];const i=[],s=[],n=this.colorEngine.rgb,r=this.colorEngine.lab,{labReference:o,truncateLabData:a}=this;let l,h;return e.forEach((t=>{this.colorEngine.convert(t),l=`${n[0]}-${n[1]}-${n[2]}`,h=a([...r]),o[l]||(o[l]=[h[0],h[1],h[2]]),i.push(...h),s.push(...n)})),t&&(this.predefinedPalette[t]=[[...s],[...i]]),[s,i]},oi.createCommonestColorsPalette=function(t,e,i){let s,n,r,o,a,l,h,c,u,d,f,p,m,g,y,b,S,k,A;const w=e.length,v={},C=[],O=[];for(f=0;f<w;f+=4)m=f,s=e[m],n=e[++m],r=e[++m],o=e[++m],o&&(g=`rgb(${s} ${n} ${r})`,v[g]||(v[g]=[s,n,r,0]),y=v[g],b=y[3],y[3]=++b);for(S=Object.keys(v),k=S.length,m=0,S.sort(((t,e)=>v[e][3]-v[t][3]));m<k&&C.length<t;){if(m){for(A=!0,y=v[S[m]],[a,l,h]=y,f=0,p=O.length;f<p;f++)if([s,n,r]=O[f],c=s-a,u=n-l,d=r-h,c*c+u*u+d*d<i){A=!1;break}A&&(C.push(S[m]),O.push(v[S[m]]))}else C.push(S[m]),O.push(v[S[m]]);m++}return this.createPalette("",C)},oi.truncateLabData=function(t){return Array.isArray(t)&&(t[0]=parseInt(1e4*t[0],10)/1e4,t[1]=parseInt(1e4*t[1],10)/1e4,t[2]=parseInt(1e4*t[2],10)/1e4),t},oi.convertToLabData=function(t){const e=[],{labReference:i,truncateLabData:s}=this,{convertXYZtoLAB:n,convertRGBtoXYZ:r}=this.colorEngine;let o,a,l,h,c,u,d,f;for(let p=0;p<t.length;p+=4)h=p,o=t[h],a=t[++h],l=t[++h],c=t[++h],u=`${o}-${a}-${l}`,c?i[u]?e.push(...i[u],c):(d=r(o,a,l),f=n(...d),f=s(f),i[u]=[...f],e.push(...f,c)):e.push(0,0,0,0);return e},oi.getColorDistanceData=function(t,e){let i,s,n,r,o,a,l,h,c,u,d,f,p,m,g;const y=[];for(f=0,p=t.length;f<p;f+=4){if(!t[f+3]){y.push([]);continue}l=f,r=t[l],o=t[++l],a=t[++l];const p=[];for(m=0,g=e.length;m<g;m+=4)d=m,h=e[d],c=e[++d],u=e[++d],i=h-r,s=c-o,n=u-a,p.push(Math.sqrt(i*i+s*s+n*n));y.push(p)}return y},oi.selectClosestColors=function(t,e){const i=this.getColorDistanceData(t,e),s=e.length/4,n=s<3?2:3,r=[],o=[],a=[],l=[],h=[],c=Math.min;let u,d,f,p,m,g;for(d=0,f=i.length;d<f;d++)if(g=i[d],o.length=0,o.push(...g),o.length)if(1===s)h.push(0,0,0,0,0,0);else{for(r.length=0,a.length=0,a.push(...o);r.length<n;)u=c(...a),m=a.indexOf(u),r.push(...a.splice(m,1));for(p=r.reduce(((t,e)=>t+e)),l.length=0,r.forEach((t=>l.push(o.indexOf(t),t/p)));l.length<6;)l.push(0,0);l.length=6,h.push(...l)}else h.push(-1,0,0,0,0,0);return h},oi.getGrayscaleDistanceData=function(t,e){let i,s,n,r,o,a,l;const h=[],c=e.length/4;for(r=0,o=t.length;r<o;r+=4)if(t[r+3])for(i=t[r],a=0,l=e.length;a<l;a+=4)s=e[a],n=s-i,h.push(n*n);else for(h.push(-1),a=1;a<c;a++)h.push(0);return h},oi.selectClosestGrays=function(t,e){const i=this.getGrayscaleDistanceData(t,e),s=Math.min,n=e.length/4,r=n<3?2:3,o=[],a=[],l=[],h=[],c=[];let u,d,f,p,m,g,y;for(d=0,f=i.length;d<f;d+=n){for(l.length=0,p=d,m=d+n;p<m;p++)l.push(i[p]);if(l[0]>=0)if(1===n)o.push(0,0,0,0,0,0);else{for(a.length=0,h.length=0,h.push(...l);a.length<r&&(u=s(...h),y=h.indexOf(u),!(y<0));)a.push(...h.splice(y,1));for(g=a.reduce(((t,e)=>t+e)),c.length=0,a.forEach((t=>c.push(l.indexOf(t),t/g)));c.length<6;)c.push(0,1);o.push(...c)}else o.push(-1,0,0,0,0,0)}return o},oi.getGradientData=function(t){const e=qe(),{engine:i,element:s}=e;s.width=256,s.height=1,t.palette.recalculate();const n=i.createLinearGradient(0,0,255,0);t.addStopsToGradient(n,t.paletteStart,t.paletteEnd,t.cyclePalette),i.fillStyle=n,i.fillRect(0,0,256,1);let r=i.getImageData(0,0,256,1).data;return Qe(e),r},oi.theBigActionsObject={"alpha-to-channels":function(t){let e,i,s,n,r,o,[a,l]=this.getInputAndOutputLines(t),h=a.data,c=l.data,u=h.length,{opacity:d,includeRed:f,includeGreen:p,includeBlue:m,excludeRed:g,excludeGreen:y,excludeBlue:b,lineOut:S}=t;for(null==d&&(d=1),null==f&&(f=!0),null==p&&(p=!0),null==m&&(m=!0),null==g&&(g=!0),null==y&&(y=!0),null==b&&(b=!0),o=0;o<u;o+=4)e=o,i=e+1,s=i+1,n=s+1,r=h[n],r&&(c[e]=f?r:g?0:h[e],c[i]=p?r:y?0:h[i],c[s]=m?r:b?0:h[s],c[n]=255);S?this.processResults(l,a,1-d):this.processResults(this.cache.work,l,d)},"area-alpha":function(t){let e,i,s,n,r,o,a,l,[h,c]=this.getInputAndOutputLines(t),u=h.data,d=c.data,f=u.length,{opacity:p,tileWidth:m,tileHeight:g,offsetX:y,offsetY:b,gutterWidth:S,gutterHeight:k,areaAlphaLevels:A,lineOut:w}=t;null==p&&(p=1),null==m&&(m=1),null==g&&(g=1),null==y&&(y=0),null==b&&(b=0),null==S&&(S=1),null==k&&(k=1),null==A&&(A=[255,0,0,0]);let v=this.buildAlphaTileSets(m,g,S,k,y,b,A);for(r=0;r<f;r+=4)e=r,i=e+1,s=i+1,d[e]=u[e],d[i]=u[i],d[s]=u[s];v.forEach(((t,e)=>{for(n=A[e%4],o=0,a=t.length;o<a;o++)l=t[o],u[l]&&(d[l]=n)})),w?this.processResults(c,h,1-p):this.processResults(this.cache.work,c,p)},"average-channels":function(t){let e,i,s,n,r,o,[a,l]=this.getInputAndOutputLines(t),h=a.data,c=l.data,u=h.length,{opacity:d,includeRed:f,includeGreen:p,includeBlue:m,excludeRed:g,excludeGreen:y,excludeBlue:b,lineOut:S}=t;null==d&&(d=1),null==f&&(f=!0),null==p&&(p=!0),null==m&&(m=!0),null==g&&(g=!1),null==y&&(y=!1),null==b&&(b=!1);let k=0;for(f&&k++,p&&k++,m&&k++,e=0;e<u;e+=4)s=e,n=s+1,r=n+1,o=r+1,h[o]?k?(i=0,f&&(i+=h[s]),p&&(i+=h[n]),m&&(i+=h[r]),i=Math.floor(i/k),c[s]=g?0:i,c[n]=y?0:i,c[r]=b?0:i,c[o]=h[o]):(c[s]=g?0:h[s],c[n]=y?0:h[n],c[r]=b?0:h[r],c[o]=h[o]):(c[s]=h[s],c[n]=h[n],c[r]=h[r],c[o]=h[o]);S?this.processResults(l,a,1-d):this.processResults(this.cache.work,l,d)},blend:function(t){const e=function(t,e,i){let s=t+1,n=s+1,r=n+1,o=e+1,a=o+1,l=a+1;p[e]=i[t],p[o]=i[s],p[a]=i[n],p[l]=i[r]},i=function(t,e){let i=t-X,s=e-N,n=-1;return i>=0&&i<m&&s>=0&&s<g&&(n=4*(s*m+i)),[4*(e*h+t),n]},s=function(t,e){let i=t+1,s=i+1,n=s+1,r=e+1,o=r+1,a=o+1;return[u[t]/255,u[i]/255,u[s]/255,u[n]/255,y[e]/255,y[r]/255,y[o]/255,y[a]/255]},n=(t,e)=>255*(t+e*(1-t)),r=this.colorEngine;let[o,a,l]=this.getInputAndOutputLines(t),{width:h,height:c,data:u}=o,{width:d,height:f,data:p}=a,{width:m,height:g,data:y}=l;u.length;let b,S,k,A,w,v,C,O,P,x,D,R,F,E,I,M,T,H,B,L,$,{opacity:j,blend:Y,offsetX:X,offsetY:N,lineOut:G}=t;switch(null==j&&(j=1),null==Y&&(Y=""),null==X&&(X=0),null==N&&(N=0),Y){case"color-burn":const t=(t,e)=>1==e?255:0==t?0:255*(1-Math.min(1,(1-e)/t));for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,H=I+3,u[E]&&(I<0?e(D,D,u):u[E]?y[H]?([k,A,w,v,C,O,P,x]=s(D,I),R=D+1,F=R+1,p[D]=t(k,C),p[R]=t(A,O),p[F]=t(w,P),p[E]=n(v,x)):e(D,D,u):e(I,D,y));break;case"color-dodge":const o=(t,e)=>0==e?0:1==t?255:255*Math.min(1,e/(1-t));for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,H=I+3,u[E]&&(I<0?e(D,D,u):u[E]?y[H]?([k,A,w,v,C,O,P,x]=s(D,I),R=D+1,F=R+1,p[D]=o(k,C),p[R]=o(A,O),p[F]=o(w,P),p[E]=n(v,x)):e(D,D,u):e(I,D,y));break;case"darken":const a=(t,e)=>t<e?t:e;for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,H=I+3,u[E]&&(I<0?e(D,D,u):u[E]?y[H]?(R=D+1,F=R+1,M=I+1,T=M+1,p[D]=a(u[D],y[I]),p[R]=a(u[R],y[M]),p[F]=a(u[F],y[T]),p[E]=n(u[E]/255,y[H]/255)):e(D,D,u):e(I,D,y));break;case"difference":const l=(t,e)=>255*Math.abs(t-e);for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,u[E]&&(I<0?e(D,D,u):u[E]?([k,A,w,v,C,O,P,x]=s(D,I),R=D+1,F=R+1,p[D]=l(k,C),p[R]=l(A,O),p[F]=l(w,P),p[E]=n(v,x)):e(I,D,y));break;case"exclusion":const d=(t,e)=>255*(t+e-2*e*t);for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,u[E]&&(I<0?e(D,D,u):u[E]?([k,A,w,v,C,O,P,x]=s(D,I),R=D+1,F=R+1,p[D]=d(k,C),p[R]=d(A,O),p[F]=d(w,P),p[E]=n(v,x)):e(I,D,y));break;case"hard-light":const f=(t,e)=>t<=.5?t*e*255:255*(e+(t-e*t));for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,u[E]&&(I<0?e(D,D,u):u[E]?([k,A,w,v,C,O,P,x]=s(D,I),R=D+1,F=R+1,p[D]=f(k,C),p[R]=f(A,O),p[F]=f(w,P),p[E]=n(v,x)):e(I,D,y));break;case"lighten":const m=(t,e)=>t>e?t:e;for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,u[E]&&(I<0?e(D,D,u):u[D]?(R=D+1,F=R+1,M=I+1,T=M+1,H=T+1,p[D]=m(u[D],y[I]),p[R]=m(u[R],y[M]),p[F]=m(u[F],y[T]),p[E]=n(u[E]/255,y[H]/255)):e(I,D,y));break;case"lighter":const g=(t,e)=>255*(t+e);for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,u[E]&&(I<0?e(D,D,u):u[E]?([k,A,w,v,C,O,P,x]=s(D,I),R=D+1,F=R+1,p[D]=g(k,C),p[R]=g(A,O),p[F]=g(w,P),p[E]=n(v,x)):e(I,D,y));break;case"multiply":const j=(t,e)=>t*e*255;for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,H=I+3,u[E]&&(I<0?e(D,D,u):u[E]?y[H]?([k,A,w,v,C,O,P,x]=s(D,I),R=D+1,F=R+1,p[D]=j(k,C),p[R]=j(A,O),p[F]=j(w,P),p[E]=n(v,x)):e(D,D,u):e(I,D,y));break;case"overlay":const Y=(t,e)=>t>=.5?t*e*255:255*(e+(t-e*t));for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,u[E]&&(I<0?e(D,D,u):u[E]?([k,A,w,v,C,O,P,x]=s(D,I),R=D+1,F=R+1,p[D]=Y(k,C),p[R]=Y(A,O),p[F]=Y(w,P),p[E]=n(v,x)):e(I,D,y));break;case"screen":const X=(t,e)=>255*(e+(t-e*t));for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,u[E]&&(I<0?e(D,D,u):u[E]?([k,A,w,v,C,O,P,x]=s(D,I),R=D+1,F=R+1,p[D]=X(k,C),p[R]=X(A,O),p[F]=X(w,P),p[E]=n(v,x)):e(I,D,y));break;case"soft-light":const N=(t,e)=>{let i=e<=.25?((16*e-12)*e+4)*e:Math.sqrt(e);return t<=.5?255*(e-(1-2*t)*e*(1-e)):255*(e+(2*t-1)*(i-e))};for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,H=I+3,u[E]&&(I<0?e(D,D,u):u[E]?y[H]?([k,A,w,v,C,O,P,x]=s(D,I),R=D+1,F=R+1,p[D]=N(k,C),p[R]=N(A,O),p[F]=N(w,P),p[E]=n(v,x)):e(D,D,u):e(I,D,y));break;case"color":for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),R=D+1,F=R+1,E=F+1,M=I+1,T=M+1,H=T+1,u[E]&&(I<0?e(D,D,u):u[E]?y[H]?([B,L,$]=r.calculateColorBlend(u[D],u[R],u[F],y[I],y[M],y[T]),p[D]=B,p[R]=L,p[F]=$,p[E]=n(u[E]/255,y[H]/255)):e(D,D,u):e(I,D,y));break;case"hue":for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),R=D+1,F=R+1,E=F+1,M=I+1,T=M+1,H=T+1,u[E]&&(I<0?e(D,D,u):u[E]?y[H]?([B,L,$]=r.calculateHueBlend(u[D],u[R],u[F],y[I],y[M],y[T]),p[D]=B,p[R]=L,p[F]=$,p[E]=n(u[E]/255,y[H]/255)):e(D,D,u):e(I,D,y));break;case"luminosity":for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),R=D+1,F=R+1,E=F+1,M=I+1,T=M+1,H=T+1,u[E]&&(I<0?e(D,D,u):u[E]?y[H]?([B,L,$]=r.calculateLuminosityBlend(u[D],u[R],u[F],y[I],y[M],y[T]),p[D]=B,p[R]=L,p[F]=$,p[E]=n(u[E]/255,y[H]/255)):e(D,D,u):e(I,D,y));break;case"saturation":for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),R=D+1,F=R+1,E=F+1,M=I+1,T=M+1,H=T+1,u[E]&&(I<0?e(D,D,u):u[E]?y[H]?([B,L,$]=r.calculateSaturationBlend(u[D],u[R],u[F],y[I],y[M],y[T]),p[D]=B,p[R]=L,p[F]=$,p[E]=n(u[E]/255,y[H]/255)):e(D,D,u):e(I,D,y));break;default:const G=(t,e,i,s)=>e*t+s*i*(1-e);for(S=0;S<c;S++)for(b=0;b<h;b++)[D,I]=i(b,S),E=D+3,u[E]&&(I<0?e(D,D,u):u[E]?(R=D+1,F=R+1,M=I+1,T=M+1,H=T+1,v=u[E]/255,x=y[H]/255,p[D]=G(u[D],v,y[I],x),p[R]=G(u[R],v,y[M],x),p[F]=G(u[F],v,y[T],x),p[E]=n(v,x)):e(I,D,y))}G?this.processResults(a,o,1-j):this.processResults(this.cache.work,a,j)},blur:function(t){const e=function(t,e,i,s,n){if(t){let t=e[i];if(null!=t){let e,i,r=t.length,o=0,a=0;for(i=0;i<r;i+=P)e=t[i]+n,a+=s[e],o++;return a/o}}return s[4*i+n]};let i,s,n,r,o,a,l,h,[c,u]=this.getInputAndOutputLines(t),d=c.data,f=u.data,p=d.length,m=Math.floor(p/4),{opacity:g,radius:y,passes:b,processVertical:S,processHorizontal:k,includeRed:A,includeGreen:w,includeBlue:v,includeAlpha:C,excludeTransparentPixels:O,step:P,lineOut:x}=t;if(null==g&&(g=1),null==y&&(y=0),null==b&&(b=1),null==S&&(S=!0),null==k&&(k=!0),null==A&&(A=!0),null==w&&(w=!0),null==v&&(v=!0),null==C&&(C=!1),null==O&&(O=!1),null==P&&(P=1),k||S){let t=this.buildImageGrid(c);k&&(l=this.buildHorizontalBlur(t,y)),S&&(h=this.buildVerticalBlur(t,y))}f.set(d);const D=new Uint8ClampedArray(d),R=O?function(t,e,i,s,n){if(t){let t=e[i];if(null!=t){let e,i,r,o,a=t.length,l=0,h=0;for(i=0;i<a;i+=P)o=t[i],r=o+3,s[r]&&(e=o+n,h+=s[e],l++);if(l)return h/l}}return s[4*i+n]}:e;for(a=0;a<b;a++){if(k){for(i=0;i<m;i++)s=4*i,n=s+1,r=n+1,o=r+1,(C||D[o])&&(f[s]=R(A,l,i,D,0),f[n]=R(w,l,i,D,1),f[r]=R(v,l,i,D,2),f[o]=e(C,l,i,D,3));(S||a<b-1)&&D.set(f)}if(S){for(i=0;i<m;i++)s=4*i,n=s+1,r=n+1,o=r+1,(C||D[o])&&(f[s]=R(A,h,i,D,0),f[n]=R(w,h,i,D,1),f[r]=R(v,h,i,D,2),f[o]=e(C,h,i,D,3));a<b-1&&D.set(f)}}x?this.processResults(u,c,1-g):this.processResults(this.cache.work,u,g)},"channels-to-alpha":function(t){let e,i,s,n,r,o,a,l,h,[c,u]=this.getInputAndOutputLines(t),d=c.data,f=u.data,p=d.length,{opacity:m,includeRed:g,includeGreen:y,includeBlue:b,lineOut:S}=t;null==m&&(m=1),null==g&&(g=!0),null==y&&(y=!0),null==b&&(b=!0);let k=0;for(g&&k++,y&&k++,b&&k++,l=0;l<p;l+=4)e=l,i=e+1,s=i+1,n=s+1,r=d[e],o=d[i],a=d[s],f[e]=r,f[i]=o,f[s]=a,k?(h=0,g&&(h+=r),y&&(h+=o),b&&(h+=a),f[n]=Math.floor(h/k)):f[n]=d[n];S?this.processResults(u,c,1-m):this.processResults(this.cache.work,u,m)},chroma:function(t){let e,i,s,n,r,o,a,l,h,c,[u,d]=this.getInputAndOutputLines(t),f=u.data,p=d.data,m=f.length,{opacity:g,ranges:y,lineOut:b}=t;null==g&&(g=1),null==y&&(y=[]);for(let t=0;t<m;t+=4){for(c=!1,e=t,i=e+1,s=i+1,n=s+1,r=f[e],o=f[i],a=f[s],l=0,h=y.length;l<h;l++){let[t,e,i,s,n,h]=y[l];if(r>=t&&r<=s&&o>=e&&o<=n&&a>=i&&a<=h){c=!0;break}}p[e]=r,p[i]=o,p[s]=a,p[n]=c?0:f[n]}b?this.processResults(d,u,1-g):this.processResults(this.cache.work,d,g)},"clamp-channels":function(t){let e,i,s,n,r,o,a,l,h,[c,u]=this.getInputAndOutputLines(t),d=c.data,f=u.data,p=d.length,{opacity:m,lowRed:g,lowGreen:y,lowBlue:b,highRed:S,highGreen:k,highBlue:A,lineOut:w}=t;null==m&&(m=1),null==g&&(g=0),null==y&&(y=0),null==b&&(b=0),null==S&&(S=255),null==k&&(k=255),null==A&&(A=255);const v=S-g,C=k-y,O=A-b;for(h=0;h<p;h+=4)e=h,i=e+1,s=i+1,n=s+1,r=d[e],o=d[i],a=d[s],l=d[n],l?(r/=255,o/=255,a/=255,f[e]=g+r*v,f[i]=y+o*C,f[s]=b+a*O):(f[e]=r,f[i]=o,f[s]=a),f[n]=l;w?this.processResults(u,c,1-m):this.processResults(this.cache.work,u,m)},"colors-to-alpha":function(t){const e=function(t,e,i){let s=(Math.abs(m-t)+Math.abs(g-e)+Math.abs(y-i))/3;return s<w?0:s>v?255:(s-w)/C*255};let i,s,n,r,o,a,l,[h,c]=this.getInputAndOutputLines(t),u=h.data,d=c.data,f=u.length,{opacity:p,red:m,green:g,blue:y,opaqueAt:b,transparentAt:S,lineOut:k}=t;null==p&&(p=1),null==m&&(m=0),null==g&&(g=255),null==y&&(y=0),null==b&&(b=1),null==S&&(S=0);let A=Math.max((m+g+y)/3,(255-m+(255-g)+(255-y))/3),w=S*A,v=b*A,C=v-w;for(let t=0;t<f;t+=4)i=t,s=i+1,n=s+1,r=n+1,u[r]&&(o=u[i],a=u[s],l=u[n],d[i]=o,d[s]=a,d[n]=l,d[r]=e(o,a,l));k?this.processResults(c,h,1-p):this.processResults(this.cache.work,c,p)},compose:function(t){const e=function(t,e,i){let s=t+1,n=s+1,r=n+1,o=e+1,a=o+1,l=a+1;u[e]=i[t],u[o]=i[s],u[a]=i[n],u[l]=i[r]},i=function(t,e){let i=t-R,s=e-F,n=-1;return i>=0&&i<d&&s>=0&&s<f&&(n=4*(s*d+i)),[4*(e*o+t),n]};let[s,n,r]=this.getInputAndOutputLines(t),{width:o,height:a,data:l}=s,{width:h,height:c,data:u}=n,{width:d,height:f,data:p}=r;l.length;let m,g,y,b,S,k,A,w,v,C,O,P,{opacity:x,compose:D,offsetX:R,offsetY:F,lineOut:E}=t;switch(null==x&&(x=1),null==D&&(D=""),null==R&&(R=0),null==F&&(F=0),D){case"source-only":n.data.set(l);break;case"source-atop":const t=(t,e,i,s)=>e*t*s+s*i*(1-e);for(C=0;C<a;C++)for(v=0;v<o;v++)[m,S]=i(v,C),S>=0&&(g=m+1,y=g+1,b=y+1,k=S+1,A=k+1,w=A+1,O=l[b]/255,P=p[w]/255,u[m]=t(l[m],O,p[S],P),u[g]=t(l[g],O,p[k],P),u[y]=t(l[y],O,p[A],P),u[b]=255*(O*P+P*(1-O)));break;case"source-in":const s=(t,e,i)=>e*t*i;for(C=0;C<a;C++)for(v=0;v<o;v++)[m,S]=i(v,C),S>=0&&(g=m+1,y=g+1,b=y+1,w=S+3,O=l[b]/255,P=p[w]/255,u[m]=s(l[m],O,P),u[g]=s(l[g],O,P),u[y]=s(l[y],O,P),u[b]=O*P*255);break;case"source-out":const r=(t,e,i)=>e*t*(1-i);for(C=0;C<a;C++)for(v=0;v<o;v++)[m,S]=i(v,C),S<0?e(m,m,l):(g=m+1,y=g+1,b=y+1,w=S+3,O=l[b]/255,P=p[w]/255,u[m]=r(l[m],O,P),u[g]=r(l[g],O,P),u[y]=r(l[y],O,P),u[b]=O*(1-P)*255);break;case"destination-only":for(C=0;C<a;C++)for(v=0;v<o;v++)[m,S]=i(v,C),S>=0&&e(S,m,p);break;case"destination-atop":const h=(t,e,i,s)=>e*t*(1-s)+s*i*e;for(C=0;C<a;C++)for(v=0;v<o;v++)[m,S]=i(v,C),S<0?e(m,m,l):(g=m+1,y=g+1,b=y+1,k=S+1,A=k+1,w=A+1,O=l[b]/255,P=p[w]/255,u[m]=h(l[m],O,p[S],P),u[g]=h(l[g],O,p[k],P),u[y]=h(l[y],O,p[A],P),u[b]=255*(O*(1-P)+P*O));break;case"destination-over":const c=(t,e,i,s)=>e*t*(1-s)+s*i;for(C=0;C<a;C++)for(v=0;v<o;v++)[m,S]=i(v,C),S<0?e(m,m,l):(g=m+1,y=g+1,b=y+1,k=S+1,A=k+1,w=A+1,O=l[b]/255,P=p[w]/255,u[m]=c(l[m],O,p[S],P),u[g]=c(l[g],O,p[k],P),u[y]=c(l[y],O,p[A],P),u[b]=255*(O*(1-P)+P));break;case"destination-in":const d=(t,e,i)=>e*t*i;for(C=0;C<a;C++)for(v=0;v<o;v++)[m,S]=i(v,C),S>=0&&(g=m+1,y=g+1,b=y+1,k=S+1,A=k+1,w=A+1,O=l[b]/255,P=p[w]/255,u[m]=d(p[S],O,P),u[g]=d(p[k],O,P),u[y]=d(p[A],O,P),u[b]=O*P*255);break;case"destination-out":const f=(t,e,i)=>i*t*(1-e);for(C=0;C<a;C++)for(v=0;v<o;v++)[m,S]=i(v,C),S>=0&&(g=m+1,y=g+1,b=y+1,k=S+1,A=k+1,w=A+1,O=l[b]/255,P=p[w]/255,u[m]=f(p[S],O,P),u[g]=f(p[k],O,P),u[y]=f(p[A],O,P),u[b]=P*(1-O)*255);break;case"clear":break;case"xor":const x=(t,e,i,s)=>e*t*(1-s)+s*i*(1-e);for(C=0;C<a;C++)for(v=0;v<o;v++)[m,S]=i(v,C),S<0?e(m,m,l):(g=m+1,y=g+1,b=y+1,k=S+1,A=k+1,w=A+1,O=l[b]/255,P=p[w]/255,u[m]=x(l[m],O,p[S],P),u[g]=x(l[g],O,p[k],P),u[y]=x(l[y],O,p[A],P),u[b]=255*(O*(1-P)+P*(1-O)));break;default:const D=(t,e,i,s)=>e*t+s*i*(1-e);for(C=0;C<a;C++)for(v=0;v<o;v++)[m,S]=i(v,C),S<0?e(m,m,l):(g=m+1,y=g+1,b=y+1,k=S+1,A=k+1,w=A+1,O=l[b]/255,P=p[w]/255,u[m]=D(l[m],O,p[S],P),u[g]=D(l[g],O,p[k],P),u[y]=D(l[y],O,p[A],P),u[b]=255*(O+P*(1-O)))}E?this.processResults(n,s,1-x):this.processResults(this.cache.work,n,x)},corrode:function(t){const e=function(t,e,i){let s=[];for(let n=0,r=e.length;n<r;n++)s.push(t[e[n]+i]);if(!s.length)return 0;switch(g){case"lowest":return Math.min(...s);case"highest":return Math.max(...s);case"median":let t=Math.max(...s),e=Math.min(...s);return Math.floor(e+(t-e)/2);default:let i=s.reduce(((t,e)=>t+e),0);return Math.floor(i/s.length)}};let[i,s]=this.getInputAndOutputLines(t),n=i.data,r=s.data,o=n.length,{opacity:a,includeRed:l,includeGreen:h,includeBlue:c,includeAlpha:u,width:d,height:f,offsetX:p,offsetY:m,operation:g,lineOut:y}=t;null==a&&(a=1),null==l&&(l=!1),null==h&&(h=!1),null==c&&(c=!1),null==u&&(u=!0),(null==d||d<1)&&(d=3),(null==f||f<1)&&(f=3),null==p&&(p=1),null==m&&(m=1),null==g&&(g="mean");let b,S,k,A,w,v=this.buildMatrixGrid(d,f,p,m,i),C=Math.floor(o/4);for(w=0;w<C;w++)b=4*w,S=b+1,k=S+1,A=k+1,r[b]=l?e(n,v[w],0):n[b],r[S]=h?e(n,v[w],1):n[S],r[k]=c?e(n,v[w],2):n[k],r[A]=u?e(n,v[w],3):n[A];y?this.processResults(s,i,1-a):this.processResults(this.cache.work,s,a)},displace:function(t){const e=function(t,e,i){t<0?u[e+3]=0:(u[e]=i[t],t++,e++,u[e]=i[t],t++,e++,u[e]=i[t],t++,e++,u[e]=i[t])},i=function(t,e){let i=t+k,s=e+A,n=-1;return i>=0&&i<d&&s>=0&&s<f&&(n=4*(s*d+i)),[4*(e*o+t),n]};let[s,n,r]=this.getInputAndOutputLines(t),{width:o,height:a,data:l}=s,{width:h,height:c,data:u}=n,{width:d,height:f,data:p}=r,{opacity:m,channelX:g,channelY:y,scaleX:b,scaleY:S,offsetX:k,offsetY:A,transparentEdges:w,lineOut:v}=t;null==m&&(m=1),null==g&&(g="red"),null==y&&(y="green"),null==b&&(b=1),null==S&&(S=1),null==k&&(k=0),null==A&&(A=0),null==w&&(w=!1);let C=3;"red"==g?C=0:"green"==g?C=1:"blue"==g&&(C=2);let O,P,x,D,R,F,E,I=3;for("red"==y?I=0:"green"==y?I=1:"blue"==y&&(I=2),P=0;P<a;P++)for(O=0;O<o;O++)[F,E]=i(O,P),E>=0?(x=Math.floor(O+(127-p[E+C])/127*b),D=Math.floor(P+(127-p[E+I])/127*S),w?R=x<0||x>=o||D<0||D>=a?-1:4*(D*o+x):(x<0&&(x=0),x>=o&&(x=o-1),D<0&&(D=0),D>=a&&(D=a-1),R=4*(D*o+x)),e(R,F,l)):e(F,F,l);v?this.processResults(n,s,1-m):this.processResults(this.cache.work,n,m)},emboss:function(t){const e=function(t,e,i){let s=0;for(let n=0,r=e.length;n<r;n++)g[n]&&(s+=t[e[n]+i]*g[n]);return s};let[i,s]=this.getInputAndOutputLines(t),n=i.data,r=s.data,o=n.length,{opacity:a,strength:l,angle:h,tolerance:c,keepOnlyChangedAreas:u,postProcessResults:d,lineOut:f}=t;for(null==a&&(a=1),null==l&&(l=1),null==h&&(h=0),null==c&&(c=0),null==u&&(u=!1),null==d&&(d=!1),l=Math.abs(l);h<0;)h+=360;h%=360;let p=Math.floor(h/45),m=h%45/45*l,g=new Array(9);g=g.fill(0,0,9),g[4]=1,0==p?(g[5]=l-m,g[8]=m,g[3]=-g[5],g[0]=-g[8]):1==p?(g[8]=l-m,g[7]=m,g[0]=-g[8],g[1]=-g[7]):2==p?(g[7]=l-m,g[6]=m,g[1]=-g[7],g[2]=-g[6]):3==p?(g[6]=l-m,g[3]=m,g[2]=-g[6],g[5]=-g[3]):4==p?(g[3]=l-m,g[0]=m,g[5]=-g[3],g[8]=-g[0]):5==p?(g[0]=l-m,g[1]=m,g[8]=-g[0],g[7]=-g[1]):6==p?(g[1]=l-m,g[2]=m,g[7]=-g[1],g[6]=-g[2]):(g[2]=l-m,g[5]=m,g[6]=-g[2],g[3]=-g[5]);const y=this.buildMatrixGrid(3,3,1,1,i);let b,S,k,A,w,v,C,O,P,x,D,R,F;for(b=0;b<o;b+=4)S=b,k=S+1,A=k+1,w=A+1,v=n[S],C=n[k],O=n[A],P=n[w],P&&(F=Math.floor(b/4),r[S]=e(n,y[F],0),r[k]=e(n,y[F],1),r[A]=e(n,y[F],2),r[w]=n[w],d&&(x=r[S],D=r[k],R=r[A],x>=v-c&&x<=v+c&&D>=C-c&&D<=C+c&&R>=O-c&&R<=O+c&&(u?r[w]=0:(r[S]=127,r[k]=127,r[A]=127))));f?this.processResults(s,i,1-a):this.processResults(this.cache.work,s,a)},flood:function(t){let e,i,[s,n]=this.getInputAndOutputLines(t),r=s.data,o=n.data,a=r.length,{opacity:l,red:h,green:c,blue:u,alpha:d,lineOut:f}=t;for(null==l&&(l=1),null==h&&(h=0),null==c&&(c=0),null==u&&(u=0),null==d&&(d=255),e=0;e<a;e+=4)r[e+3]&&(i=e,o[i]=h,i++,o[i]=c,i++,o[i]=u,i++,o[i]=d);f?this.processResults(n,s,1-l):this.processResults(this.cache.work,n,l)},"gaussian-blur":function(t){let e,i,s,n,r,o,a,l;const h=function(t,e,i,s,n,r){let o,a,l,h,c,u,d,f,p,m,g,y,b,S,k,A,w,v,C,O,P,x,D,R,F,E,I,M,T,H;for(F=0;F<r;F++){for(x=F*n,D=F,R=0,o=t[x],a=255&o,l=o>>8&255,h=o>>16&255,c=o>>24&255,v=a*s[6],C=l*s[6],O=h*s[6],P=c*s[6],S=v,k=C,A=O,w=P,I=s[0],M=s[1],T=s[4],H=s[5],E=0;E<n;E++)o=t[x],u=255&o,d=o>>8&255,f=o>>16&255,p=o>>24&255,m=u*I+a*M+S*T+v*H,g=d*I+l*M+k*T+C*H,y=f*I+h*M+A*T+O*H,b=p*I+c*M+w*T+P*H,v=S,C=k,O=A,P=w,S=m,k=g,A=y,w=b,a=u,l=d,h=f,c=p,i[R]=S,i[R+1]=k,i[R+2]=A,i[R+3]=w,R+=4,x++;for(x--,R-=4,D+=r*(n-1),o=t[x],a=255&o,l=o>>8&255,h=o>>16&255,c=o>>24&255,v=a*s[7],C=l*s[7],O=h*s[7],P=c*s[7],S=v,k=C,A=O,w=P,u=a,d=l,f=h,p=c,I=s[2],M=s[3],E=n-1;E>=0;E--)m=u*I+a*M+S*T+v*H,g=d*I+l*M+k*T+C*H,y=f*I+h*M+A*T+O*H,b=p*I+c*M+w*T+P*H,v=S,C=k,O=A,P=w,S=m,k=g,A=y,w=b,a=u,l=d,h=f,c=p,o=t[x],u=255&o,d=o>>8&255,f=o>>16&255,p=o>>24&255,o=(i[R]+S<<0)+(i[R+1]+k<<8)+(i[R+2]+A<<16)+(i[R+3]+w<<24),e[D]=o,x--,R-=4,D-=r}};let[c,u]=this.getInputAndOutputLines(t),d=c.data,f=u.data,{width:p,height:m}=c,{opacity:g,radius:y,lineOut:b}=t;null==g&&(g=1),null==y&&(y=1);const S=new Uint8ClampedArray(d),k=new Uint32Array(S.buffer),A=new Uint32Array(k.length),w=new Float32Array(4*Math.max(p,m)),v=function(t){t<.5&&(t=.5);let h=Math.exp(.527076)/t,c=Math.exp(-h),u=Math.exp(-2*h),d=(1-c)*(1-c)/(1+2*h*c-u);return e=d,i=d*(h-1)*c,s=d*(h+1)*c,n=-d*u,r=2*c,o=-u,a=(e+i)/(1-r-o),l=(s+n)/(1-r-o),new Float32Array([e,i,s,n,r,o,a,l])}(y);h(k,A,w,v,p,m),h(A,k,w,v,m,p),f.set(S),b?this.processResults(u,c,1-g):this.processResults(this.cache.work,u,g)},glitch:function(t){let e,i,s,n,r,o,a,l,h,c,u,d,f,p,m,g,y,b,S,k,A,w,v,C,O,[P,x]=this.getInputAndOutputLines(t),D=P.data,R=x.data,F=D.length,E=P.width,I=P.height,{opacity:M,useMixedChannel:T,seed:H,level:B,step:L,offsetMin:$,offsetMax:j,offsetRedMin:Y,offsetRedMax:X,offsetGreenMin:N,offsetGreenMax:G,offsetBlueMin:z,offsetBlueMax:W,offsetAlphaMin:V,offsetAlphaMax:Z,transparentEdges:U,lineOut:_}=t;null==M&&(M=1),null==T&&(T=!0),null==H&&(H="some-random-string-or-other"),null==B&&(B=0),null==L&&(L=1),null==$&&($=0),null==j&&(j=0),null==Y&&(Y=0),null==X&&(X=0),null==N&&(N=0),null==G&&(G=0),null==z&&(z=0),null==W&&(W=0),null==V&&(V=0),null==Z&&(Z=0),null==U&&(U=!1);const q=this.getRandomNumbers(H,5*I),Q=j-$,K=X-Y,J=G-N,tt=W-z,et=Z-V;let it=-1;const st=[];for(L=Math.floor(L),L<1&&(L=1),e=0;e<I;e+=L)if(s=q[++it]<B,s)if(T)for(n=4*($+Math.floor(q[++it]*Q)),i=0;i<L;i++)st.push(n,n,n,n);else for(r=4*(Y+Math.floor(q[++it]*K)),o=4*(N+Math.floor(q[++it]*J)),a=4*(z+Math.floor(q[++it]*tt)),l=4*(V+Math.floor(q[++it]*et)),i=0;i<L;i++)st.push(r,o,a,l);else for(i=0;i<L;i++)st.push(0,0,0,0);for(e=0;e<F;e+=4)h=e,c=h+1,u=c+1,d=u+1,f=4*E,p=Math.floor(e/f),y=4*p,b=st[y],S=st[++y],k=st[++y],A=st[++y],w=h+b,v=c+S,C=u+k,O=d+A,R[h]=D[w],R[c]=D[v],R[u]=D[C],U?(m=p*f,g=m+f,R[d]=w<m||w>g||v<m||v>g||C<m||C>g||O<m||O>g?0:D[O]):R[d]=D[O];_?this.processResults(x,P,1-M):this.processResults(this.cache.work,x,M)},grayscale:function(t){let e,i,s,n,r,o,[a,l]=this.getInputAndOutputLines(t),h=a.data,c=l.data,u=h.length,{opacity:d,lineOut:f}=t;null==d&&(d=1);const p=this.getGrayscaleValue;for(r=0;r<u;r+=4)e=r,i=e+1,s=i+1,n=s+1,o=p(h[e],h[i],h[s]),c[e]=o,c[i]=o,c[s]=o,c[n]=h[n];f?this.processResults(l,a,1-d):this.processResults(this.cache.work,l,d)},"invert-channels":function(t){let e,i,s,n,r,[o,a]=this.getInputAndOutputLines(t),l=o.data,h=a.data,c=l.length,{opacity:u,includeRed:d,includeGreen:f,includeBlue:p,includeAlpha:m,lineOut:g}=t;for(null==u&&(u=1),null==d&&(d=!0),null==f&&(f=!0),null==p&&(p=!0),null==m&&(m=!1),r=0;r<c;r+=4)e=r,i=e+1,s=i+1,n=s+1,h[e]=d?255-l[e]:l[e],h[i]=f?255-l[i]:l[i],h[s]=p?255-l[s]:l[s],h[n]=m?255-l[n]:l[n];g?this.processResults(a,o,1-u):this.processResults(this.cache.work,a,u)},"lock-channels-to-levels":function(t){const e=function(t,e){if(!e.length)return t;for(let i=0,s=e.length;i<s;i++){let[s,n,r]=e[i];if(t>=s&&t<=n)return r}};this.checkChannelLevelsParameters(t);let i,s,n,r,o,[a,l]=this.getInputAndOutputLines(t),h=a.data,c=l.data,u=h.length,{opacity:d,red:f,green:p,blue:m,alpha:g,lineOut:y}=t;for(null==d&&(d=1),null==f&&(f=[0]),null==p&&(p=[0]),null==m&&(m=[0]),null==g&&(g=[255]),o=0;o<u;o+=4)i=o,s=i+1,n=s+1,r=n+1,c[i]=e(h[i],f),c[s]=e(h[s],p),c[n]=e(h[n],m),c[r]=e(h[r],g);y?this.processResults(l,a,1-d):this.processResults(this.cache.work,l,d)},"map-to-gradient":function(t){let e,i,s,n,r,o,a,[l,h]=this.getInputAndOutputLines(t),c=l.data,u=h.data,d=c.length,{opacity:f,useNaturalGrayscale:p,gradient:m,lineOut:g}=t;if(null==f&&(f=1),null==p&&(p=!1),null==m&&(m=!1),m){let t=this.getGradientData(m);const l=this.getGrayscaleValue;for(e=0;e<d;e+=4)s=e,n=s+1,r=n+1,o=r+1,c[o]&&(i=p?l(c[s],c[n],c[r]):Math.floor(.3333*c[s]+.3333*c[n]+.3333*c[r]),a=4*i,u[s]=t[a],u[n]=t[++a],u[r]=t[++a],u[o]=t[++a])}else for(e=0;e<d;e+=4)s=e,n=s+1,r=n+1,o=r+1,u[s]=c[s],u[n]=c[n],u[r]=c[r],u[o]=c[o];g?this.processResults(h,l,1-f):this.processResults(this.cache.work,h,f)},matrix:function(t){const e=function(t,e,i){let s,n=0;for(let r=0,o=e.length;r<o;r++)w[r]&&(s=e[r]+i,n+=t[s]*w[r]);return n};let i,s,n,r,o,a,[l,h]=this.getInputAndOutputLines(t),c=l.data,u=h.data,d=c.length,{opacity:f,includeRed:p,includeGreen:m,includeBlue:g,includeAlpha:y,width:b,height:S,offsetX:k,offsetY:A,weights:w,lineOut:v}=t;null==f&&(f=1),null==p&&(p=!0),null==m&&(m=!0),null==g&&(g=!0),null==y&&(y=!1),(null==b||b<1)&&(b=3),(null==S||S<1)&&(S=3),null==k&&(k=1),null==A&&(A=1),null==w&&(w=[].fill(0,0,b*S-1),w[Math.floor(w.length/2)+1]=1);let C=this.buildMatrixGrid(b,S,k,A,l);for(o=0;o<d;o+=4)i=o,s=i+1,n=s+1,r=n+1,c[r]&&(a=Math.floor(o/4),u[i]=p?e(c,C[a],0):c[i],u[s]=m?e(c,C[a],1):c[s],u[n]=g?e(c,C[a],2):c[n],u[r]=y?e(c,C[a],3):c[r]);v?this.processResults(h,l,1-f):this.processResults(this.cache.work,h,f)},"modulate-channels":function(t){let e,i,s,n,r,o,a,l,h,[c,u]=this.getInputAndOutputLines(t),d=c.data,f=u.data,p=d.length,{opacity:m,red:g,green:y,blue:b,alpha:S,saturation:k,lineOut:A}=t;if(null==m&&(m=1),null==g&&(g=1),null==y&&(y=1),null==b&&(b=1),null==S&&(S=1),null==k&&(k=!1),k){const t=this.getGrayscaleValue;for(h=0;h<p;h+=4)e=h,i=e+1,s=i+1,n=s+1,o=d[e],a=d[i],l=d[s],r=t(o,a,l),f[e]=r+(o-r)*g,f[i]=r+(a-r)*y,f[s]=r+(l-r)*b,f[n]=d[n]*S}else for(h=0;h<p;h+=4)e=h,i=e+1,s=i+1,n=s+1,f[e]=d[e]*g,f[i]=d[i]*y,f[s]=d[s]*b,f[n]=d[n]*S;A?this.processResults(u,c,1-m):this.processResults(this.cache.work,u,m)},offset:function(t){let[e,i]=this.getInputAndOutputLines(t),s=e.data,n=i.data;s.length;let{opacity:r,offsetRedX:o,offsetRedY:a,offsetGreenX:l,offsetGreenY:h,offsetBlueX:c,offsetBlueY:u,offsetAlphaX:d,offsetAlphaY:f,lineOut:p}=t;if(null==r&&(r=1),null==o&&(o=0),null==a&&(a=0),null==l&&(l=0),null==h&&(h=0),null==c&&(c=0),null==u&&(u=0),null==d&&(d=0),null==f&&(f=0),o||l||c||d||a||h||u||f){let t=!1;o==l&&o==c&&o==d&&a==h&&a==u&&a==f&&(t=!0);let i,r,p,m,g,y,b,S,k,A,w=this.buildImageGrid(e),v=w[0].length,C=w.length;for(let e=0;e<C;e++)for(let O=0;O<v;O++)k=4*w[e][O],t?(i=O+o,r=e+a,i>=0&&i<v&&r>=0&&r<C&&(A=4*w[r][i],n[A]=s[k],n[A+1]=s[k+1],n[A+2]=s[k+2],n[A+3]=s[k+3])):(i=O+o,r=e+a,p=O+l,m=e+h,g=O+c,y=e+u,b=O+d,S=e+f,i>=0&&i<v&&r>=0&&r<C&&(A=4*w[r][i],n[A]=s[k]),p>=0&&p<v&&m>=0&&m<C&&(A=4*w[m][p],n[A+1]=s[k+1]),g>=0&&g<v&&y>=0&&y<C&&(A=4*w[y][g],n[A+2]=s[k+2]),b>=0&&b<v&&S>=0&&S<C&&(A=4*w[S][b],n[A+3]=s[k+3]))}p?this.processResults(i,e,1-r):this.processResults(this.cache.work,i,r)},pixelate:function(t){const e=function(t,e,i,s){let n=i.reduce(((e,i)=>e+t[i+s]),0);n=Math.floor(n/i.length);for(let t=0,r=i.length;t<r;t++)e[i[t]+s]=n},i=function(t,e,i,s){let n;for(let r=0,o=i.length;r<o;r++)n=i[r],e[n+s]=t[n+s]};let[s,n]=this.getInputAndOutputLines(t),r=s.data,o=n.data;r.length;let{opacity:a,tileWidth:l,tileHeight:h,offsetX:c,offsetY:u,includeRed:d,includeGreen:f,includeBlue:p,includeAlpha:m,lineOut:g}=t;null==a&&(a=1),null==d&&(d=!0),null==f&&(f=!0),null==p&&(p=!0),null==m&&(m=!1),null==l&&(l=1),null==h&&(h=1),null==c&&(c=0),null==u&&(u=0);this.buildImageTileSets(l,h,c,u).forEach((t=>{d?e(r,o,t,0):i(r,o,t,0),f?e(r,o,t,1):i(r,o,t,1),p?e(r,o,t,2):i(r,o,t,2),m?e(r,o,t,3):i(r,o,t,3)})),g?this.processResults(n,s,1-a):this.processResults(this.cache.work,n,a)},"process-image":function(t){const{assetData:e,lineOut:i}=t;if(i&&i.substring&&i.length){const{width:t,height:s,data:n}=e;t&&s&&n&&(this.cache[i]=new ImageData(n,t,s))}},"random-noise":function(t){let e,i,s,n,r,o,a,l,[h,c]=this.getInputAndOutputLines(t),u=h.data,d=c.data,f=u.length,p=h.width,{opacity:m,width:g,height:y,level:b,seed:S,noWrap:k,includeRed:A,includeGreen:w,includeBlue:v,includeAlpha:C,excludeTransparentPixels:O,lineOut:P}=t;null==m&&(m=1),null==g&&(g=1),null==y&&(y=1),null==b&&(b=.5),null==S&&(S="some-random-string-or-other"),null==k&&(k=!1),null==A&&(A=!0),null==w&&(w=!0),null==v&&(v=!0),null==C&&(C=!0),null==O&&(O=!0);const x=this.getRandomNumbers(S,Math.ceil(f/4*3));let D=-1;const R=g/2,F=y/2;for(r=0;r<f;r+=4)e=r,i=e+1,s=i+1,n=s+1,x[++D]<b?(o=Math.floor(x[++D]*g-R),a=Math.floor(x[++D]*y-F),l=r+4*(a*p+o),k&&(l<0||l>=f)?(d[e]=u[e],d[i]=u[i],d[s]=u[s],d[n]=u[n]):(l<0?l+=f:l>=f&&(l-=f),!O||u[n]&&u[l+3]?(d[e]=A?u[l]:u[e],l++,d[i]=w?u[l]:u[i],l++,d[s]=v?u[l]:u[s],l++,d[n]=C?u[l]:u[n]):(d[e]=u[e],d[i]=u[i],d[s]=u[s],d[n]=u[n]))):(d[e]=u[e],d[i]=u[i],d[s]=u[s],d[n]=u[n]);P?this.processResults(c,h,1-m):this.processResults(this.cache.work,c,m)},"reduce-palette":function(t,e){this.predefinedPalette||this.initiateDithering();let i,s,n,r,o,a,l,h,c,u,d,f,p,m,g,y,b,S,k,A,w,v,C,O,[P,x]=this.getInputAndOutputLines(t),D=P.data,R=x.data,F=D.length;const E=[],I=[];let{opacity:M,palette:T,seed:H,useBluenoise:B,minimumColorDistance:L,lineOut:$}=t;null==M&&(M=1),null==H&&(H="some-random-string-or-other"),null==B&&(B=!1),null==T&&(T="black-white"),null==L&&(L=1e3);const j=B?this.getRandomNumbers(H,F/4,P.width):this.getRandomNumbers(H,F/4);k=-1,T.substring?[C,O]=this.createPalette(T,[]):Array.isArray(T)?[C,O]=this.createPalette("",T):T.toFixed?[C,O]=this.createCommonestColorsPalette(T,D,L):(T="black-white",[C,O]=this.createPalette(T,[])),v=["black-white","monochrome-4","monochrome-8","monochrome-16"].includes(T),v?w=this.selectClosestGrays(D,C):(A=this.convertToLabData(D),w=this.selectClosestColors(A,O));const Y=C.length/4;for(i=0,s=F/4;i<s;i++)if(r=4*i,o=r+1,a=o+1,l=a+1,d=6*i,f=d+2,p=f+2,m=d+1,g=m+2,y=g+2,b=w[d],S=w[m],!Y||b<0)R[r]=D[r],R[o]=D[o],R[a]=D[a],R[l]=D[l],++k;else if(b||S){if(E.length=0,I.length=0,E.push(w[d],w[f],w[p]),I.push(w[m],w[g],w[y]),c=0,Y<3)for(n=0;n<2;n++)c+=1-I[n],I[n]=c;else for(n=0;n<3;n++)c+=1-I[n],I[n]=c/2;for(u=j[++k],n=0;n<3;n++)if(!(u>I[n]&&n<2)){h=4*E[n],R[r]=C[h],R[o]=C[++h],R[a]=C[++h],R[l]=D[l];break}}else R[r]=C[0],R[o]=C[1],R[a]=C[2],R[l]=D[l],++k;$?this.processResults(x,P,1-M):this.processResults(this.cache.work,x,M)},"set-channel-to-level":function(t){let e,i,s,n,r,[o,a]=this.getInputAndOutputLines(t),l=o.data,h=a.data,c=l.length,{opacity:u,includeRed:d,includeGreen:f,includeBlue:p,includeAlpha:m,level:g,lineOut:y}=t;for(null==u&&(u=1),null==d&&(d=!1),null==f&&(f=!1),null==p&&(p=!1),null==m&&(m=!1),null==g&&(g=0),r=0;r<c;r+=4)e=r,i=e+1,s=i+1,n=s+1,h[e]=d?g:l[e],h[i]=f?g:l[i],h[s]=p?g:l[s],h[n]=m?g:l[n];y?this.processResults(a,o,1-u):this.processResults(this.cache.work,a,u)},"step-channels":function(t){let e,i,s,n,r,[o,a]=this.getInputAndOutputLines(t),l=o.data,h=a.data,c=l.length,u=Math.floor,d=Math.ceil,f=Math.round,{opacity:p,red:m,green:g,blue:y,clamp:b,lineOut:S}=t;for(null==p&&(p=1),null==m&&(m=1),null==g&&(g=1),null==y&&(y=1),null==b&&(b="down"),r=0;r<c;r+=4){switch(e=r,i=e+1,s=i+1,n=s+1,b){case"up":h[e]=d(l[e]/m)*m,h[i]=d(l[i]/g)*g,h[s]=d(l[s]/y)*y;break;case"round":h[e]=f(l[e]/m)*m,h[i]=f(l[i]/g)*g,h[s]=f(l[s]/y)*y;break;default:h[e]=u(l[e]/m)*m,h[i]=u(l[i]/g)*g,h[s]=u(l[s]/y)*y}h[n]=l[n]}S?this.processResults(a,o,1-p):this.processResults(this.cache.work,a,p)},swirl:function(t){const e=function(t,e){return t.substring?F(parseFloat(t)/100*e):t};let i,s,n,r,o,a,l,h,c,u,d,f,p,m,g,y,b,S,k,A,w,[v,C]=this.getInputAndOutputLines(t),O=v.data,P=C.data,x=O.length,D=v.width,R=v.height,F=Math.floor,E=new ImageData(D,R),I=E.data,M=E.width,T=E.height,{opacity:H,swirls:B,lineOut:L}=t;for(null==H&&(H=1),null==B&&(B=[]),f=0;f<x;f+=4)i=f,s=i+1,n=s+1,r=n+1,I[i]=O[i],I[s]=O[s],I[n]=O[n],I[r]=O[r],P[i]=O[i],P[s]=O[s],P[n]=O[n],P[r]=O[r];if(Array.isArray(B)&&B.length){let t=this.buildImageGrid(v);for(o=0,a=B.length;o<a;o++){const[a,v,C,O,x,E]=B[o],H=e(a,D),L=e(v,R);let $=e(O,D),j=e(C,D);if(j>$){let t=j;j=$,$=t}const Y=$-j;if(h=H-$,h<0&&(h=0),u=H+$,u>M&&(u=M),c=L-$,c<0&&(c=0),d=L+$,d>=T&&(d=T),h<u&&c<d&&h<M&&u>0&&c<T&&d>0){let e=E,o=E;q(e)?o=`ude-${e(0)}-${e(.1)}-${e(.2)}-${e(.3)}-${e(.4)}-${e(.5)}-${e(.6)}-${e(.7)}-${e(.8)}-${e(.9)}-${e(1)}`:e=null!=lt[e]?lt[e]:lt.linear;const M=`swirl-${a}-${v}-${C}-${O}-${x}-${o}-${D}-${R}`,T=this.getOrAddWorkstore(M);if(!T.length){const s=be(),n=be();for(s.setFromArray([H,L]),f=c;f<d;f++)for(p=h;p<u;p++)l=[p,f],i=4*t[f][p],m=n.set(l).subtract(s).getMagnitude(),m>$?g=i:m<j?(n.rotate(x).add(s),k=F(n[0]),A=F(n[1]),k<0?k+=D:k>=D&&(k-=D),A<0?A+=R:A>=R&&(A-=R),g=4*t[A][k]):(w=1-(m-j)/Y,w=e(w),n.rotate(x*w).add(s),k=F(n[0]),A=F(n[1]),k<0?k+=D:k>=D&&(k-=D),A<0?A+=R:A>=R&&(A-=R),g=4*t[A][k]),T.push(g);Se(n),Se(s)}let B=-1;for(f=c;f<d;f++)for(p=h;p<u;p++)i=4*t[f][p],s=i+1,n=s+1,r=n+1,g=T[++B],y=g+1,b=y+1,S=b+1,P[i]=I[g],P[s]=I[y],P[n]=I[b],P[r]=I[S];for(f=c;f<d;f++)for(p=h;p<u;p++)i=4*t[f][p],s=i+1,n=s+1,r=n+1,I[i]=P[i],I[s]=P[s],I[n]=P[n],I[r]=P[r]}}}L?this.processResults(C,v,1-H):this.processResults(this.cache.work,C,H)},threshold:function(t){let e,i,s,n,r,o,a,l,h,c,[u,d]=this.getInputAndOutputLines(t),f=u.data,p=d.data,m=f.length,{opacity:g,low:y,high:b,level:S,red:k,green:A,blue:w,alpha:v,includeRed:C,includeGreen:O,includeBlue:P,includeAlpha:x,useMixedChannel:D,lineOut:R}=t;null==g&&(g=1),null==y&&(y=[0,0,0]),null==b&&(b=[255,255,255]),null==S&&(S=128),null==k&&(k=128),null==A&&(A=128),null==w&&(w=128),null==v&&(v=128),null==C&&(C=!0),null==O&&(O=!0),null==P&&(P=!0),null==x&&(x=!1),null==D&&(D=!0);let[F,E,I,M]=y,[T,H,B,L]=b;const $=this.getGrayscaleValue;for(r=0;r<m;r+=4)e=r,i=e+1,s=i+1,n=s+1,o=f[e],a=f[i],l=f[s],h=f[n],D?(c=$(o,a,l),c<S?(p[e]=C?F:o,p[i]=O?E:a,p[s]=P?I:l,p[n]=x?M:h):(p[e]=C?T:o,p[i]=O?H:a,p[s]=P?B:l,p[n]=x?L:h)):(p[e]=C?o<k?F:T:o,p[i]=O?a<A?E:H:a,p[s]=P?l<w?I:B:l,p[n]=x?h<v?M:L:h);R?this.processResults(d,u,1-g):this.processResults(this.cache.work,d,g)},"tint-channels":function(t){let e,i,s,n,r,o,a,l,[h,c]=this.getInputAndOutputLines(t),u=h.data,d=c.data,f=u.length,{opacity:p,redInRed:m,redInGreen:g,redInBlue:y,greenInRed:b,greenInGreen:S,greenInBlue:k,blueInRed:A,blueInGreen:w,blueInBlue:v,lineOut:C}=t;for(null==p&&(p=1),null==m&&(m=1),null==g&&(g=0),null==y&&(y=0),null==b&&(b=0),null==S&&(S=1),null==k&&(k=0),null==A&&(A=0),null==w&&(w=0),null==v&&(v=1),r=0;r<f;r+=4)e=r,i=e+1,s=i+1,n=s+1,o=u[e],a=u[i],l=u[s],d[e]=Math.floor(o*m+a*b+l*A),d[i]=Math.floor(o*g+a*S+l*w),d[s]=Math.floor(o*y+a*k+l*v),d[n]=u[n];C?this.processResults(c,h,1-p):this.processResults(this.cache.work,c,p)},"user-defined-legacy":function(t){let[e,i]=this.getInputAndOutputChannels(t),{opacity:s,lineOut:n}=t;null==s&&(s=1),this.copyOver(e,i),n?this.processResults(i,e,1-s):this.processResults(this.cache.work,i,s)},"vary-channels-by-weights":function(t){let e,i,s,n,r,o,a,l,h,c,u,d,f,[p,m]=this.getInputAndOutputLines(t),g=p.data,y=m.data,b=g.length,{opacity:S,weights:k,useMixedChannel:A,lineOut:w}=t;null==S&&(S=1),null==A&&(A=!0),null==k&&(k=!1),k&&1024===k.length||(k=new Array(1024),k.fill(0));const v=this.getGrayscaleValue;for(e=0;e<b;e+=4)i=e,s=i+1,n=s+1,r=n+1,o=g[i],a=g[s],l=g[n],A?(h=v(o,a,l),c=k[4*h+3],u=.2126*c,d=.7152*c,f=.0722*c,y[i]=o+u,y[s]=a+d,y[n]=l+f,y[r]=g[r]):(y[i]=o+k[4*o],y[s]=a+k[4*a+1],y[n]=l+k[4*l+2],y[r]=g[r]);w?this.processResults(m,p,1-S):this.processResults(this.cache.work,m,S)}},Rt({name:"filters-cleanup-action",order:999,fn:function(){u.forEach((t=>{const e=c[t];e&&(e.dirtyFilterIdentifier=!1)})),A.forEach((t=>{const e=k[t];e&&(e.dirtyFilterIdentifier=!1)}))}}),v.FilterEngine=FilterEngine;const hi=new FilterEngine,Group=function(t=z){return this.makeName(t.name),this.register(),this.artefacts=[],this.artefactBuckets=[],this.set(this.defs),this.set(t),this};let ci=Group.prototype=Object.create(Object.prototype);ci.type="Group",ci.lib="group",ci.isArtefact=!1,ci.isAsset=!1,ci=xt(ci),ci=Ge(ci);ci.defs=tt(ci.defs,{artefacts:null,order:0,visibility:!0,regionRadius:0}),ci.packetExclusions=it(ci.packetExclusions,["artefactBuckets","batchResort"]),ci.postCloneAction=function(t,e){let s;return s=e.host?i[e.host]:this.currentHost?this.currentHost:!!this.host&&i[this.host],s&&(s.addGroups(t.name),t.host||(t.host=s.name)),t},ci.kill=function(t=!1){let e=this.name;return Object.entries(i).forEach((([t,i])=>{Array.isArray(i.groups)&&i.groups.indexOf(e)>=0&&(st(i.groups,e),i.batchResort=!0)})),Object.entries(a).forEach((([t,i])=>{Array.isArray(i.groups)&&i.groups.indexOf(e)>=0&&(st(i.groups,e),i.batchResort=!0)})),t&&this.artefactBuckets.forEach((t=>t.kill())),this.deregister()},ci.killArtefacts=function(){return this.artefactBuckets.forEach((t=>t.kill())),this};let ui=ci.getters,di=ci.setters;ui.artefacts=function(){return[].concat(this.artefacts)},di.artefacts=function(t){this.artefacts=[],this.addArtefacts(t)},di.host=function(t){let e=this.getHost(t);e&&e.addGroups&&(this.host=t,e.addGroups(this.name),this.dirtyHost=!0)},di.order=function(t){let e=this.getHost(this.host);this.order=t,e&&e.set({batchResort:!0})},ci.getHost=function(t){let e=this.currentHost;return!e||e.substring?i[t]||a[t]||i[e]||a[e]||null:e},ci.forceStamp=function(){let t=this.visibility;this.visibility=!0,this.stamp(),this.visibility=t},ci.stamp=function(){if(this.dirtyHost||!this.currentHost){this.dirtyHost=!1;let t=this.getHost(this.host);t?this.currentHost=t:this.dirtyHost=!0}if(this.visibility){let{currentHost:t,stashOutput:e,noFilters:i,filters:s}=this;if(t){this.sortArtefacts();let n=!!(e||!i&&s&&s.length)&&qe();if(n&&n.element){let e=t.currentDimensions,i=n.currentDimensions,s=n.element;e&&i&&s&&(i[0]=e[0],i[1]=e[1],s.width=e[0],s.height=e[1])}else t.engine&&t.engine.save();this.prepareStamp(n),this.stampAction(n),n?Qe(n):t.engine&&(t.engine.restore(),t.setEngineFromState(t.engine))}}},ci.sortArtefacts=function(){if(this.batchResort){this.batchResort=!1;let t=Math.floor,e=[];this.artefacts.forEach((s=>{let n=i[s],r=t(n.order)||0;e[r]||(e[r]=[]),e[r].push(n)})),this.artefactBuckets=e.reduce(((t,e)=>t.concat(e)),[])}},ci.prepareStamp=function(t){let e=this.currentHost;t&&(e=t),this.artefactBuckets.forEach((i=>{"entity"===i.lib&&(i.currentHost&&i.currentHost.name===e.name||(i.currentHost=e,t||(i.dirtyHost=!0))),i.noDeltaUpdates||i.updateByDelta(),i.prepareStamp()}))},ci.stampAction=function(t){!this.currentHost||this.currentHost.stashOutput;let{dirtyFilters:e,currentFilters:i,artefactBuckets:s,noFilters:n,filters:r,stashOutput:o,currentHost:a}=this;if(!e&&i||this.cleanFilters(),s.forEach((t=>{t&&t.stamp&&t.stamp()})),t)if(!n&&r&&r.length){let e=this.applyFilters(t);this.stashAction(e)}else if(o){let e=t.element,i=t.engine,s=!(!a||!a.engine)&&a.engine;if(s){s.save(),s.globalCompositeOperation="source-over",s.globalAlpha=1,s.setTransform(1,0,0,1,0,0),s.drawImage(e,0,0),s.restore();let t=i.getImageData(0,0,e.width,e.height);this.stashAction(t)}}},ci.applyFilters=function(t){let e=this.currentHost,i=t;if(!e||!i)return!1;let s=e.element,n=e.engine,r=i.element,o=i.engine;this.isStencil&&(o.save(),o.globalCompositeOperation="source-in",o.globalAlpha=1,o.setTransform(1,0,0,1,0,0),o.drawImage(s,0,0),o.restore(),this.dirtyFilterIdentifier=!0),o.setTransform(1,0,0,1,0,0);let a=o.getImageData(0,0,r.width,r.height);this.preprocessFilters(this.currentFilters);let l=hi.action({identifier:this.filterIdentifier,image:a,filters:this.currentFilters});return l&&(o.globalCompositeOperation="source-over",o.globalAlpha=1,o.setTransform(1,0,0,1,0,0),o.putImageData(l,0,0)),n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(r,0,0),n.restore(),l},ci.stashAction=function(t){if(!t)return!1;if(this.stashOutput){this.stashOutput=!1;let[e,i,s,n]=this.getCellCoverage(t),r=qe(),o=r.engine,a=r.element;if(a.width=s,a.height=n,o.putImageData(t,-e,-i),this.stashedImageData=o.getImageData(0,0,s,n),this.stashOutputAsAsset)if(this.stashOutputAsAsset=!1,this.stashedImage)this.stashedImage.src=a.toDataURL();else{let t=this.stashedImage=document.createElement("img");t.id=`${this.name}-groupimage`,t.onload=function(){cs.appendChild(t),De(`#${t.id}`)},t.src=a.toDataURL()}Qe(r)}},ci.getCellCoverage=function(t){let e,i,s=t.width,n=t.height,r=t.data,o=0,a=0,l=s,h=n,c=3;for(i=0;i<n;i++)for(e=0;e<s;e++)r[c]&&(l>e&&(l=e),o<e&&(o=e),h>i&&(h=i),a<i&&(a=i)),c+=4;return l<o&&h<a?[l,h,o-l,a-h]:[0,0,s,n]},ci.addArtefacts=function(...t){return t&&Array.isArray(t[0])&&(t=t[0]),t.forEach((t=>{t&&(t.substring?it(this.artefacts,t):t.name&&it(this.artefacts,t.name))}),this),this.batchResort=!0,this},ci.getArtefact=function(t){return this.artefacts.indexOf(t)>=0&&i[t]||!1},ci.removeArtefacts=function(...t){return t.forEach((t=>{t&&(t.substring?st(this.artefacts,t):t.name&&st(this.artefacts,t.name))}),this),this.batchResort=!0,this},ci.moveArtefactsIntoGroup=function(...t){let e,s;return t.forEach((t=>{t&&(s=t.substring?i[t]:t,s&&s.isArtefact&&(e=s.group?s.group:!!s.host&&d[s.host]),e&&(e.removeArtefacts(t),e.batchResort=!0),it(this.artefacts,t))}),this),this.batchResort=!0,this},ci.clearArtefacts=function(){return this.artefacts.length=0,this.artefactBuckets.length=0,this.batchResort=!0,this},ci.updateArtefacts=function(t){return this.cascadeAction(t,"setDelta"),this},ci.setArtefacts=function(t){return this.cascadeAction(t,"set"),this},ci.updateByDelta=function(){return this.cascadeAction(!1,"updateByDelta"),this},ci.reverseByDelta=function(){return this.cascadeAction(!1,"reverseByDelta"),this},ci.addArtefactClasses=function(t){return this.cascadeAction(t,"addClasses"),this},ci.removeArtefactClasses=function(t){return this.cascadeAction(t,"removeClasses"),this},ci.cascadeAction=function(t,e){return this.artefacts.forEach((s=>{let n=i[s];n&&n[e]&&n[e](t)})),this},ci.setDeltaValues=function(t=z){return this.artefactBuckets.forEach((e=>e.setDeltaValues(t))),this},ci.addFiltersToEntitys=function(...t){return this.artefacts.forEach((e=>{let i=h[e];i&&i.addFilters&&i.addFilters(t)})),this},ci.removeFiltersFromEntitys=function(...t){return this.artefacts.forEach((e=>{let i=h[e];i&&i.removeFilters&&i.removeFilters(t)})),this},ci.clearFiltersFromEntitys=function(){return this.artefacts.forEach((t=>{let e=h[t];e&&e.clearFilters&&e.clearFilters()})),this},ci.getArtefactAt=function(t){let e=qe(),i=this.artefactBuckets;this.sortArtefacts();for(let s=i.length-1;s>=0;s--){let n=i[s];if(n){let i=n.checkHit(t,e);if(i)return Qe(e),i}}return Qe(e),!1},ci.getAllArtefactsAt=function(t){let e=qe(),i=this.artefactBuckets,s=[],n=[];this.sortArtefacts();for(let r=i.length-1;r>=0;r--){let o=i[r];if(o){let i=o.checkHit(t,e);if(i&&i.artefact){let t=i.artefact;s.indexOf(t.name)<0&&(s.push(t.name),n.push(i))}}}return Qe(e),n};const fi=function(t){return!!t&&new Group(t)};v.Group=Group;const Vector=function(t,e,i){return this.x=0,this.y=0,this.z=0,nt(t)&&this.set(t,e,i),this};let pi=Vector.prototype=Object.create(Object.prototype);pi.type="Vector",pi.getXYCoordinate=function(){return[this.x,this.y]},pi.getXYZCoordinate=function(){return[this.x,this.y,this.z]},pi.setX=function(t){if(!nt(t))throw new Error(`${this.name} Vector error - setX() arguments error: ${t}`);return this.x=t,this},pi.setY=function(t){if(!nt(t))throw new Error(`${this.name} Vector error - setY() arguments error: ${t}`);return this.y=t,this},pi.setZ=function(t){if(!nt(t))throw new Error(`${this.name} Vector error - setZ() arguments error: ${t}`);return this.z=t,this},pi.setXY=function(t,e){if(!rt(t,e))throw new Error(`${this.name} Vector error - setXY() arguments error: ${t}, ${e}`);return this.x=t,this.y=e,this},pi.set=function(t,e,i){return K(t)?this.setFromVector(t):Array.isArray(t)?this.setFromArray(t):rt(t,e)?this.setFromArray([t,e,i]):this},pi.setFromArray=function(t){if(!Array.isArray(t))throw new Error(`${this.name} Vector error - setFromArray() arguments error: ${t}`);let[e,i,s]=t;return Q(e)&&(this.x=e),Q(i)&&(this.y=i),Q(s)&&(this.z=s),this},pi.setFromVector=function(t){if(!K(t))throw new Error(`${this.name} Vector error - setFromVector() arguments error: ${JSON.stringify(t)}`);let{x:e,y:i,z:s}=t;return Q(e)&&(this.x=e),Q(i)&&(this.y=i),Q(s)&&(this.z=s),this},pi.zero=function(){return this.x=0,this.y=0,this.z=0,this},pi.vectorAdd=function(t=z){if(Array.isArray(t))return this.vectorAddArray(t);let{x:e,y:i,z:s}=t;return Q(e)&&(this.x+=e),Q(i)&&(this.y+=i),Q(s)&&(this.z+=s),this},pi.vectorAddArray=function(t=[]){let[e,i,s]=t;return Q(e)&&(this.x+=e),Q(i)&&(this.y+=i),Q(s)&&(this.z+=s),this},pi.vectorSubtract=function(t=z){if(Array.isArray(t))return this.vectorSubtractArray(t);let{x:e,y:i,z:s}=t;return Q(e)&&(this.x-=e),Q(i)&&(this.y-=i),Q(s)&&(this.z-=s),this},pi.vectorSubtractArray=function(t){let[e,i,s]=t;return Q(e)&&(this.x-=e),Q(i)&&(this.y-=i),Q(s)&&(this.z-=s),this},pi.scalarMultiply=function(t){if(!Q(t))throw new Error(`${this.name} Vector error - scalarMultiply() argument not a number: ${t}`);return this.x*=t,this.y*=t,this.z*=t,this},pi.vectorMultiply=function(t=z){if(Array.isArray(t))return this.vectorMultiplyArray(t);let{x:e,y:i,z:s}=t;return Q(e)&&(this.x*=e),Q(i)&&(this.y*=i),Q(s)&&(this.z*=s),this},pi.vectorMultiplyArray=function(t){let[e,i,s]=t;return Q(e)&&(this.x*=e),Q(i)&&(this.y*=i),Q(s)&&(this.z*=s),this},pi.scalarDivide=function(t){if(!Q(t))throw new Error(`${this.name} Vector error - scalarDivide() argument not a number: ${t}`);if(!t)throw new Error(`${this.name} Vector error - scalarDivide() division by zero: ${t}`);return this.x/=t,this.y/=t,this.z/=t,this},pi.getMagnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},pi.rotate=function(t){if(!Q(t))throw new Error(`${this.name} Vector error - rotate() argument not a number: ${t}`);let e=Math.atan2(this.y,this.x);e+=.01745329251*t;let i=this.getMagnitude();return this.x=i*Math.cos(e),this.y=i*Math.sin(e),this},pi.reverse=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},pi.normalize=function(){let t=this.getMagnitude();return t>0&&(this.x/=t,this.y/=t,this.z/=t),this};const mi=[],gi=function(t,e,i){mi.length||mi.push(new Vector);let s=mi.shift();return s.set(t,e,i),s},yi=function(t){t&&"Vector"===t.type&&mi.push(t.zero())},bi=function(t,e,i){return new Vector(t,e,i)};v.Vector=Vector;const Quaternion=function(t=z){return this.name=t.name||"generic",this.n=t.n||1,this.v=bi(),this.set(t),this};let Si=Quaternion.prototype=Object.create(Object.prototype);Si.type="Quaternion",Si.set=function(t=z){if(J(t))return this.setFromQuaternion(t);if(at(t.pitch,t.yaw,t.roll))return this.setFromEuler(t);let e,i,s,n,r,o=this.v;return r=!(!nt(t.vector)&&!nt(t.v))&&(t.vector||t.v),n=!(!nt(t.scalar)&&!nt(t.n))&&(t.scalar||t.n||0),e=r?r.x||0:t.x||!1,i=r?r.y||0:t.y||!1,s=r?r.z||0:t.z||!1,this.n=Q(n)?n:this.n,o.x=Q(e)?e:o.x,o.y=Q(i)?i:o.y,o.z=Q(s)?s:o.z,this},Si.setFromQuaternion=function(t){if(!J(t))throw new Error(`${this.name} Quaternion error - setFromQuaternion() bad argument: ${t}`);let e=this.v,i=t.v;return this.n=t.n,e.x=i.x,e.y=i.y,e.z=i.z,this},Si.setFromEuler=function(t=z){let e,i,s,n,r,o,a,l,h,c=Math.cos,u=Math.sin,d=this.v;return e=(t.pitch||t.x||0)*C,i=(t.yaw||t.y||0)*C,s=(t.roll||t.z||0)*C,n=c(e/2),r=c(i/2),o=c(s/2),a=u(e/2),l=u(i/2),h=u(s/2),d.x=a*r*o+n*l*h,d.y=n*l*o+a*r*h,d.z=n*r*h-a*l*o,this.n=n*r*o-a*l*h,this},Si.zero=function(){let t=this.v;return this.n=1,t.x=0,t.y=0,t.z=0,this},Si.getMagnitude=function(){let t=this.v;return Math.sqrt(this.n*this.n+t.x*t.x+t.y*t.y+t.z*t.z)},Si.normalize=function(){let t=this.getMagnitude(),e=this.v;if(!t)throw new Error(`${this.name} Quaternion error - normalize() division by zero: ${t}`);return this.n/=t,this.n=this.n>-1e-6&&this.n<1e-6?0:this.n,e.x/=t,e.x=e.x>-1e-6&&e.x<1e-6?0:e.x,e.y/=t,e.y=e.y>-1e-6&&e.y<1e-6?0:e.y,e.z/=t,e.z=e.z>-1e-6&&e.z<1e-6?0:e.z,this},Si.quaternionMultiply=function(t){if(!J(t))throw new Error(`${this.name} Quaternion error - quaternionMultiply() bad argument: ${t}`);let e=this.v,i=t.v,s=this.n,n=e.x,r=e.y,o=e.z,a=t.n,l=i.x,h=i.y,c=i.z;return this.n=s*a-n*l-r*h-o*c,e.x=s*l+n*a+r*c-o*h,e.y=s*h+r*a+o*l-n*c,e.z=s*c+o*a+n*h-r*l,this},Si.getAngle=function(t){let e;return t=!!nt(t)&&t,e=2*Math.acos(this.n),t&&(e*=1/C),e>-1e-6&&e<1e-6?0:e},Si.quaternionRotate=function(t){if(!J(t))throw new Error(`${this.name} Quaternion error - quaternionRotate() bad argument: ${t}`);let e=Ai(t),i=Ai(this);return this.setFromQuaternion(e.quaternionMultiply(i)),wi(e),wi(i),this};const ki=[],Ai=function(t){ki.length||ki.push(vi({name:"pool"}));let e=ki.shift();return e.set(t),e},wi=function(t){t&&"Quaternion"===t.type&&ki.push(t.zero())},vi=function(t){return new Quaternion(t)};function Ci(t=z){(t=Ye(t=Le(t=Be(t=He(t=Te(t=Me(t))))))).defs=tt(t.defs,{domElement:"",pitch:0,yaw:0,offsetZ:0,css:null,classes:"",position:"absolute",smoothFont:!0,checkForResize:!1,trackHere:"",activePadding:5,includeInTabNavigation:!1,moreContrastAction:null,otherContrastAction:null,reduceMotionAction:null,noPreferenceMotionAction:null,colorSchemeLightAction:null,colorSchemeDarkAction:null,reduceTransparencyAction:null,noPreferenceTransparencyAction:null,reduceDataAction:null,noPreferenceDataAction:null}),t.packetExclusions=it(t.packetExclusions,["domElement","pathCorners","rotation"]),t.packetFunctions=it(t.packetFunctions,["onEnter","onLeave","onDown","onUp"]),t.processDOMPacketOut=function(t,e,i){return this.processFactoryPacketOut(t,e,i)},t.processFactoryPacketOut=function(t,e,i){let s=!0;return i.indexOf(t)<0&&e===this.defs[t]&&(s=!1),s},t.finalizePacketOut=function(t,e){if(_(this.domElement)){let e=this.domElement,i=e.cloneNode(!0);i.querySelectorAll('[data-corner-div="sc"]').forEach((t=>i.removeChild(t))),t.outerHTML=i.outerHTML,t.host=e.parentElement.id}return t=this.handlePacketAnchor(t,e)},t.postCloneAction=function(t,e){return this.onEnter&&(t.onEnter=this.onEnter),this.onLeave&&(t.onLeave=this.onLeave),this.onDown&&(t.onDown=this.onDown),this.onUp&&(t.onUp=this.onUp),t};let e=t.setters,s=t.deltaSetters;e.trackHere=function(t){var e;nt(t)&&(t?(it(Ft,this.name),"local"===t&&(K(e=this)&&(e.localMouseListener&&e.localMouseListener(),e.here||(e.here={}),e.here.originalWidth=e.currentDimensions[0],e.here.originalHeight=e.currentDimensions[1],e.localMouseListener=ct("move",(function(t){e.here&&(e.here.x=Math.round(parseFloat(t.offsetX)),e.here.y=Math.round(parseFloat(t.offsetY)))}),e.domElement)))):(st(Ft,this.name),function(t){K(t)&&(t.localMouseListener&&t.localMouseListener(),t.localMouseListener=!1)}(this)),this.trackHere=t)},e.position=function(t){this.position=t,this.dirtyPosition=!0},e.smoothFont=function(t){this.smoothFont=t,this.dirtySmoothFont=!0},e.visibility=function(t){this.visibility=t,this.dirtyVisibility=!0},e.offsetZ=function(t){this.offsetZ=t,this.dirtyOffsetZ=!0},s.offsetZ=function(t){this.offsetZ+=t,this.dirtyOffsetZ=!0},e.roll=function(t){this.roll=this.checkRotationAngle(t),this.dirtyRotation=!0},s.roll=function(t){this.roll=this.checkRotationAngle(this.roll+t),this.dirtyRotation=!0},e.pitch=function(t){this.pitch=this.checkRotationAngle(t),this.dirtyRotation=!0},s.pitch=function(t){this.pitch=this.checkRotationAngle(this.pitch+t),this.dirtyRotation=!0},e.yaw=function(t){this.yaw=this.checkRotationAngle(t),this.dirtyRotation=!0},s.yaw=function(t){this.yaw=this.checkRotationAngle(this.yaw+t),this.dirtyRotation=!0},e.css=function(t){this.css=this.css?tt(this.css,t):t,this.dirtyCss=!0},e.classes=function(t){this.classes=t,this.dirtyClasses=!0},e.domAttributes=function(t){this.updateDomAttributes(t)},e.includeInTabNavigation=function(t){const e=this.domElement;e&&(this.includeInTabNavigation=t,t?e.setAttribute("tabindex",0):e.setAttribute("tabindex",-1))},t.checkRotationAngle=function(t){return(t<-180||t>180)&&(t+=t>0?-360:360),t},t.updateDomAttributes=function(t,e){if(this.domElement){let i=this.domElement;t.substring&&nt(e)?e?i.setAttribute(t,e):i.removeAttribute(t):K(t)&&Object.entries(t).forEach((([t,e])=>{e?i.setAttribute(t,e):i.removeAttribute(t)}))}return this},t.initializeDomLayout=function(t){let e=t.domElement,s=e.style;if(s.boxSizing="border-box",e&&t.setInitialDimensions){let n=e.getBoundingClientRect();e.style.transform,e.style.transformOrigin;let r,o=!1;if(t&&t.host&&(o=t.host,o.substring&&i[o]&&(o=i[o])),this.currentDimensions[0]=n.width,this.currentDimensions[1]=n.height,t.width=n.width,t.height=n.height,e.className&&(t.classes=e.className),o&&o.domElement&&(r=o.domElement.getBoundingClientRect(),r&&(t.startX=n.left-r.left,t.startY=n.top-r.top)),"Stack"===this.type){nt(t.perspective)||nt(t.perspectiveZ)||(t.perspectiveZ=nt(s.perspective)&&s.perspective?parseFloat(s.perspective):0);let e=s.perspectiveOrigin;e.length&&(e=e.split(" "),e.length>0&&!nt(t.perspective)&&!nt(t.perspectiveX)&&(t.perspectiveX=e[0]),nt(t.perspective)||nt(t.perspectiveY)||(e.length>1?t.perspectiveY=e[1]:t.perspectiveY=e[0]))}}},t.addClasses=function(t){if(t.substring){let e=this.classes;e+=` ${t}`,e=e.trim(),e=e.replace(/[\s\uFEFF\xA0]+/g," "),e!==this.classes&&(this.classes=e,this.dirtyClasses=!0)}return this},t.removeClasses=function(t){if(t.substring){let e,i=this.classes;t.split().forEach((t=>{e=new RegExp(" ?"+t+" ?"),i=i.replace(e," "),i=i.trim(),i=i.replace(/[\s\uFEFF\xA0]+/g," ")})),i!==this.classes&&(this.classes=i,this.dirtyClasses=!0)}return this},t.emptyElementTagNames=["AREA","BASE","BR","COL","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR","CANVAS"],t.addPathCorners=function(){if(this.domElement&&!this.noUserInteraction&&this.emptyElementTagNames.indexOf(this.domElement.tagName)<0){let t=function(){let t=document.createElement("div");return t.style.width=0,t.style.height=0,t.style.position="absolute",t.style.margin=0,t.style.border=0,t.style.padding=0,t},e=t(),i=t(),s=t(),n=t();e.style.top="0%",e.style.left="0%",e.setAttribute("data-corner-div","sc"),i.style.top="0%",i.style.left="100%",i.setAttribute("data-corner-div","sc"),s.style.top="100%",s.style.left="100%",s.setAttribute("data-corner-div","sc"),n.style.top="100%",n.style.left="0%",n.setAttribute("data-corner-div","sc");let r=this.domElement;r.appendChild(e),r.appendChild(i),r.appendChild(s),r.appendChild(n),this.pathCorners.push(e),this.pathCorners.push(i),this.pathCorners.push(s),this.pathCorners.push(n),this.currentCornersData||(this.currentCornersData=[])}return this},t.checkCornerPositions=function(t){let e=this.pathCorners;if(4===e.length){let i,s=this.getHere(),n=jt.scrollX-(s.offsetX||0),r=jt.scrollY-(s.offsetY||0),o=Math.round,a=[];const l=function(t){let e=t[0];e?(a.push(o(e.left+n)),a.push(o(e.top+r))):a.push(0,0)};switch(t){case"topLeft":return i=e[0].getClientRects(),l(i),a;case"topRight":return i=e[1].getClientRects(),l(i),a;case"bottomRight":return i=e[2].getClientRects(),l(i),a;case"bottomLeft":return i=e[3].getClientRects(),l(i),a;default:return e.forEach((t=>{_(t)&&(i=t.getClientRects(),l(i))})),a}}};const n=["topLeft","topRight","bottomRight","bottomLeft"];return t.getCornerCoordinate=function(t){return n.indexOf(t)>=0?this.checkCornerPositions(t):[].concat(this.currentStampPosition)},t.cleanPathObject=function(){if(this.dirtyPathObject=!1,this.domElement&&!this.noUserInteraction)if(this.pathCorners.length||this.addPathCorners(),this.pathCorners.length){this.currentCornersData||(this.currentCornersData=[]);let t=this.currentCornersData;t.length=0,t.push(...this.checkCornerPositions());let e=this.pathObject=new Path2D;e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.lineTo(t[6],t[7]),e.closePath()}else{let t=this.pathObject=new Path2D;t.moveTo(0,0),t.lineTo(10,0),t.lineTo(0,10),t.lineTo(-10,0),t.closePath()}},t.checkHit=function(t=[],e){if(this.noUserInteraction)return!1;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();let i=Array.isArray(t)?t:[t],s=!1;e||(e=requestCell(),s=!0);let n,r,o=e.engine,a=this.currentStampPosition;return a[0],a[1],i.some((t=>{if(Array.isArray(t))n=t[0],r=t[1];else{if(!rt(t,t.x,t.y))return!1;n=t.x,r=t.y}return!(!n.toFixed||!r.toFixed||isNaN(n)||isNaN(r))&&o.isPointInPath(this.pathObject,n,r)}),this)?(s&&releaseCell(e),{x:n,y:r,artefact:this}):(s&&releaseCell(e),!1)},t.cleanRotation=function(){this.dirtyRotation=!1,this.rotation&&J(this.rotation)||(this.rotation=vi()),this.currentRotation&&J(this.rotation)||(this.currentRotation=vi());let t=this.rotation;t.setFromEuler({pitch:this.pitch||0,yaw:this.yaw||0,roll:this.roll||0}),1!==t.getMagnitude()&&t.normalize();let e=Ai(),i=this.path,s=this.mimic,n=this.pivot,r=this.lockTo;i&&r.indexOf("path")>=0?e.set(t):s&&this.useMimicRotation&&r.indexOf("mimic")>=0?nt(s.currentRotation)?(e.set(s.currentRotation),this.addOwnRotationToMimic&&e.quaternionRotate(t)):this.dirtyMimicRotation=!0:(e.set(t),n&&this.addPivotRotation&&r.indexOf("pivot")>=0&&(nt(n.currentRotation)?e.quaternionRotate(n.currentRotation):this.dirtyPivotRotation=!0)),this.currentRotation.set(e),wi(e),this.dirtyPositionSubscribers=!0,this.mimicked&&this.mimicked.length&&(this.dirtyMimicRotation=!0)},t.cleanOffsetZ=function(){this.dirtyOffsetZ=!1},t.cleanContent=function(){this.dirtyContent=!1,this.domElement&&(this.dirtyDimensions=!0)},t.cleanDisplayShape=Y,t.cleanDisplayArea=Y,t.prepareStamp=function(){(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle||this.dirtyRotation)&&(this.dirtyPathObject=!0),this.dirtyContent&&this.cleanContent(),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyDisplayArea&&this.cleanDisplayArea(),this.dirtyDisplayShape&&this.cleanDisplayShape(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyOffsetZ&&this.cleanOffsetZ(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.indexOf("mouse")>=0||this.lockTo.indexOf("particle")>=0)&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.pivoted.length&&(this.dirtyStampPositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject()},t.stamp=function(){if(!this.domElement)return!1;let t,e,i,s,n,[r,o]=this.currentStampPosition,[a,l]=this.currentStampHandlePosition,h=this.currentScale,c=this.currentRotation,u=`${a}px ${l}px 0`,d=`translate(${r-a}px,${o-l}px)`;(this.yaw||this.pitch||this.roll||this.pivot&&this.addPivotRotation||this.mimic&&this.useMimicRotation||this.path&&this.addPathRotation)&&(t=c.v,e=t.x,i=t.y,s=t.z,n=c.getAngle(!1),d+=` rotate3d(${e},${i},${s},${n}rad)`),this.offsetZ&&(d+=` translateZ(${this.offsetZ}px)`),1!==h&&(d+=` scale(${h},${h})`),d!==this.currentTransformString&&(this.currentTransformString=d,this.dirtyTransform=!0),u!==this.currentTransformOriginString&&(this.currentTransformOriginString=u,this.dirtyTransformOrigin=!0),(this.dirtyTransform||this.dirtyPerspective||this.dirtyPosition||this.dirtyDomDimensions||this.dirtyTransformOrigin||this.dirtyVisibility||this.dirtySmoothFont||this.dirtyCss||this.dirtyClasses||this.domShowRequired)&&(this.domShowRequired=!1,os(this.name),ls(!0)),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),(this.dirtyMimicRotation||this.dirtyPivotRotation)&&(this.dirtyMimicRotation=!1,this.dirtyPivotRotation=!1,this.dirtyRotation=!0),this.dirtyMimicScale&&(this.dirtyMimicScale=!1,this.dirtyScale=!0)},t.initializeAccessibility=function(){this.reduceMotionAction=Y,this.noPreferenceMotionAction=Y,this.colorSchemeLightAction=Y,this.colorSchemeDarkAction=Y,this.reduceTransparencyAction=Y,this.noPreferenceTransparencyAction=Y,this.reduceDataAction=Y,this.noPreferenceDataAction=Y,this.moreContrastAction=Y,this.otherContrastAction=Y},e.moreContrastAction=function(t){q(t)&&(this.moreContrastAction=t)},t.setMoreContrastAction=function(t){q(t)&&(this.moreContrastAction=t)},e.otherContrastAction=function(t){q(t)&&(this.otherContrastAction=t)},t.setOtherContrastAction=function(t){q(t)&&(this.otherContrastAction=t)},t.contrastActions=function(){const t=this.here;if(nt(t)){const e=t.prefersContrast;nt(e)&&(e?this.moreContrastAction():this.otherContrastAction())}},e.reduceMotionAction=function(t){q(t)&&(this.reduceMotionAction=t)},t.setReduceMotionAction=function(t){q(t)&&(this.reduceMotionAction=t)},e.noPreferenceMotionAction=function(t){q(t)&&(this.noPreferenceMotionAction=t)},t.setNoPreferenceMotionAction=function(t){q(t)&&(this.noPreferenceMotionAction=t)},t.reducedMotionActions=function(){const t=this.here;if(nt(t)){const e=t.prefersReducedMotion;nt(e)&&(e?this.reduceMotionAction():this.noPreferenceMotionAction())}},e.colorSchemeLightAction=function(t){q(t)&&(this.colorSchemeLightAction=t)},t.setColorSchemeLightAction=function(t){q(t)&&(this.colorSchemeLightAction=t)},e.colorSchemeDarkAction=function(t){q(t)&&(this.colorSchemeDarkAction=t)},t.setColorSchemeDarkAction=function(t){q(t)&&(this.colorSchemeDarkAction=t)},t.colorSchemeActions=function(){const t=this.here;if(nt(t)){const e=t.prefersDarkColorScheme;nt(e)&&(e?this.colorSchemeDarkAction():this.colorSchemeLightAction())}},e.reduceTransparencyAction=function(t){q(t)&&(this.reduceTransparencyAction=t)},t.setReduceTransparencyAction=function(t){q(t)&&(this.reduceTransparencyAction=t)},e.noPreferenceTransparencyAction=function(t){q(t)&&(this.noPreferenceTransparencyAction=t)},t.setNoPreferenceTransparencyAction=function(t){q(t)&&(this.noPreferenceTransparencyAction=t)},t.reducedTransparencyActions=function(){const t=this.here;if(nt(t)){const e=t.prefersReduceTransparency;nt(e)&&(e?this.reduceTransparencyAction():this.noPreferenceTransparencyAction())}},e.reduceDataAction=function(t){q(t)&&(this.reduceDataAction=t)},t.setReduceDataAction=function(t){q(t)&&(this.reduceDataAction=t)},e.noPreferenceDataAction=function(t){q(t)&&(this.noPreferenceDataAction=t)},t.setNoPreferenceDataAction=function(t){q(t)&&(this.noPreferenceDataAction=t)},t.reducedDataActions=function(){const t=this.here;if(nt(t)){const e=t.prefersReduceData;nt(e)&&(e?this.reduceDataAction():this.noPreferenceDataAction())}},t.checkAccessibilityValues=function(){this.contrastActions(),this.reducedMotionActions(),this.colorSchemeActions(),this.reducedTransparencyActions(),this.reducedDataActions()},t.apply=function(){re(),this.prepareStamp(),this.stamp(),hs(this.name),this.dirtyPathObject=!0,this.cleanPathObject()},t}function Oi(t=z){let e={breakToBanner:3,breakToLandscape:1.5,breakToPortrait:.65,breakToSkyscraper:.35,actionBannerShape:null,actionLandscapeShape:null,actionRectangleShape:null,actionPortraitShape:null,actionSkyscraperShape:null,breakToSmallest:2e4,breakToSmaller:8e4,breakToLarger:18e4,breakToLargest:32e4,actionSmallestArea:null,actionSmallerArea:null,actionRegularArea:null,actionLargerArea:null,actionLargestArea:null};t.defs=tt(t.defs,e),tt(t,e),t.packetFunctions=it(t.packetFunctions,["actionBannerShape","actionLandscapeShape","actionRectangleShape","actionPortraitShape","actionSkyscraperShape"]);let i=t.getters,s=t.setters;return i.displayShape=function(){return this.currentDisplayShape},i.displayShapeBreakpoints=function(){return{breakToBanner:this.breakToBanner,breakToLandscape:this.breakToLandscape,breakToPortrait:this.breakToPortrait,breakToSkyscraper:this.breakToSkyscraper,breakToSmallest:this.breakToSmallest,breakToSmaller:this.breakToSmaller,breakToLarger:this.breakToLarger,breakToLargest:this.breakToLargest}},s.displayShapeBreakpoints=function(t=z){for(let[e,i]of Object.entries(t))if(Q(i))switch(e){case"breakToBanner":this.breakToBanner=i;break;case"breakToLandscape":this.breakToLandscape=i;break;case"breakToPortrait":this.breakToPortrait=i;break;case"breakToSkyscraper":this.breakToSkyscraper=i;break;case"breakToSmallest":this.breakToSmallest=i;break;case"breakToSmaller":this.breakToSmaller=i;break;case"breakToLarger":this.breakToLarger=i;break;case"breakToLargest":this.breakToLargest=i}this.dirtyDisplayShape=!0,this.dirtyDisplayArea=!0},t.setDisplayShapeBreakpoints=s.displayShapeBreakpoints,s.breakToBanner=function(t){Q(t)&&(this.breakToBanner=t),this.dirtyDisplayShape=!0},s.breakToLandscape=function(t){Q(t)&&(this.breakToLandscape=t),this.dirtyDisplayShape=!0},s.breakToPortrait=function(t){Q(t)&&(this.breakToPortrait=t),this.dirtyDisplayShape=!0},s.breakToSkyscraper=function(t){Q(t)&&(this.breakToSkyscraper=t),this.dirtyDisplayShape=!0},s.breakToSmallest=function(t){Q(t)&&(this.breakToSmallest=t),this.dirtyDisplayArea=!0},s.breakToSmaller=function(t){Q(t)&&(this.breakToSmaller=t),this.dirtyDisplayArea=!0},s.breakToLarger=function(t){Q(t)&&(this.breakToLarger=t),this.dirtyDisplayArea=!0},s.breakToLargest=function(t){Q(t)&&(this.breakToLargest=t),this.dirtyDisplayArea=!0},s.actionBannerShape=function(t){q(t)&&(this.actionBannerShape=t),this.dirtyDisplayShape=!0},t.setActionBannerShape=s.actionBannerShape,s.actionLandscapeShape=function(t){q(t)&&(this.actionLandscapeShape=t),this.dirtyDisplayShape=!0},t.setActionLandscapeShape=s.actionLandscapeShape,s.actionRectangleShape=function(t){q(t)&&(this.actionRectangleShape=t),this.dirtyDisplayShape=!0},t.setActionRectangleShape=s.actionRectangleShape,s.actionPortraitShape=function(t){q(t)&&(this.actionPortraitShape=t),this.dirtyDisplayShape=!0},t.setActionPortraitShape=s.actionPortraitShape,s.actionSkyscraperShape=function(t){q(t)&&(this.actionSkyscraperShape=t),this.dirtyDisplayShape=!0},t.setActionSkyscraperShape=s.actionSkyscraperShape,s.actionSmallestArea=function(t){q(t)&&(this.actionSmallestArea=t),this.dirtyDisplayArea=!0},t.setActionSmallestArea=s.actionSmallestArea,s.actionSmallerArea=function(t){q(t)&&(this.actionSmallerArea=t),this.dirtyDisplayArea=!0},t.setActionSmallerArea=s.actionSmallerArea,s.actionRegularArea=function(t){q(t)&&(this.actionRegularArea=t),this.dirtyDisplayArea=!0},t.setActionRegularArea=s.actionRegularArea,s.actionLargerArea=function(t){q(t)&&(this.actionLargerArea=t),this.dirtyDisplayArea=!0},t.setActionLargerArea=s.actionLargerArea,s.actionLargestArea=function(t){q(t)&&(this.actionLargestArea=t),this.dirtyDisplayArea=!0},t.setActionLargestArea=s.actionLargestArea,t.initializeDisplayShapeActions=function(){this.actionBannerShape=Y,this.actionLandscapeShape=Y,this.actionRectangleShape=Y,this.actionPortraitShape=Y,this.actionSkyscraperShape=Y,this.currentDisplayShape="",this.dirtyDisplayShape=!0,this.actionSmallestArea=Y,this.actionSmallerArea=Y,this.actionRegularArea=Y,this.actionLargerArea=Y,this.actionLargestArea=Y,this.currentDisplayArea="",this.dirtyDisplayArea=!0},t.cleanDisplayShape=function(){this.dirtyDisplayShape=!1;let[t,e]=this.currentDimensions;if(t>0&&e>0){let i=t/e,s=this.currentDisplayShape,n=this.breakToBanner,r=this.breakToLandscape,o=this.breakToPortrait,a=this.breakToSkyscraper;return i>n?"banner"!==s&&(this.currentDisplayShape="banner",this.actionBannerShape(),!0):i>r?"landscape"!==s&&(this.currentDisplayShape="landscape",this.actionLandscapeShape(),!0):i<a?"skyscraper"!==s&&(this.currentDisplayShape="skyscraper",this.actionSkyscraperShape(),!0):i<o?"portrait"!==s&&(this.currentDisplayShape="portrait",this.actionPortraitShape(),!0):"rectangle"!==s&&(this.currentDisplayShape="rectangle",this.actionRectangleShape(),!0)}return this.dirtyDisplayShape=!0,!1},t.cleanDisplayArea=function(){this.dirtyDisplayArea=!1;let[t,e]=this.currentDimensions;if(t>0&&e>0){let i=t*e,s=this.currentDisplayArea,n=this.breakToLargest,r=this.breakToLarger,o=this.breakToSmaller,a=this.breakToSmallest;return i>n?"largest"!==s&&(this.currentDisplayArea="largest",this.actionLargestArea(),!0):i>r?"larger"!==s&&(this.currentDisplayArea="larger",this.actionLargerArea(),!0):i<a?"smallest"!==s&&(this.currentDisplayArea="smallest",this.actionSmallestArea(),!0):i<o?"smaller"!==s&&(this.currentDisplayArea="smaller",this.actionSmallerArea(),!0):"regular"!==s&&(this.currentDisplayArea="regular",this.actionRegularArea(),!0)}return this.dirtyDisplayArea=!0,!1},t.updateDisplayShape=function(){this.currentDisplayShape="",this.dirtyDisplayShape=!0},t.updateDisplayArea=function(){this.currentDisplayArea="",this.dirtyDisplayArea=!0},t.updateDisplay=function(){this.updateDisplayShape(),this.updateDisplayArea()},t}v.Quaternion=Quaternion;const Canvas=function(t=z){let e;if(this.makeName(t.name),this.register(),this.initializePositions(),this.dimensions[0]=300,this.dimensions[1]=150,this.pathCorners=[],this.css={},this.here={},this.perspective={x:"50%",y:"50%",z:0},this.dirtyPerspective=!0,this.initializeDomLayout(t),this.set(this.defs),t.label||(t.label=`${this.name} canvas element`),this.initializeDisplayShapeActions(),this.initializeAccessibility(),this.set(t),this.cleanDimensions(),e=this.domElement,e){this.engine=this.domElement.getContext("2d"),this.state=pe({engine:this.engine}),this.cells=[],this.cellBatchesClear=[],this.cellBatchesCompile=[],this.cellBatchesShow=[];let t=this.currentDimensions[0],i=this.currentDimensions[1];const s=e.dataset;if(s.isResponsive){e.style.width="100%",e.style.height="100%";let n=!0;s.baseWidth&&s.baseHeight&&(n=!1,t=parseFloat(s.baseWidth),i=parseFloat(s.baseHeight)),this.set({checkForResize:!0,baseMatchesCanvasDimensions:n,ignoreCanvasCssDimensions:!0,fit:s.fit||this.fit}),this.cleanDimensions()}const n={name:`${this.name}_base`,element:!1,width:t,height:i,cleared:!0,compiled:!0,shown:!1,isBase:!0,host:this.name,controller:this,order:10};s.baseClearAlpha&&(n.clearAlpha=parseFloat(s.baseClearAlpha)),s.baseBackgroundColor&&(n.backgroundColor=s.baseBackgroundColor),this.base=this.buildCell(n),it(ji,this.name),Yi();const r=document.createElement("nav");r.id=`${this.name}-navigation`,r.style.width="0px",r.style.height="0px",r.style.maxWidth="0px",r.style.maxHeight="0px",r.style.border="0px",r.style.padding="0px",r.style.margin="0px",r.style.overflow="hidden",this.navigation=r,e.appendChild(r);const o=document.createElement("div");o.id=`${this.name}-text-hold`,o.style.width="0px",o.style.height="0px",o.style.maxWidth="0px",o.style.maxHeight="0px",o.style.border="0px",o.style.padding="0px",o.style.margin="0px",o.style.overflow="hidden",this.textHold=o,e.appendChild(o);const a=document.createElement("div");a.id=`${this.name}-ARIA-label`,a.textContent=this.label,this.ariaLabelElement=a,cs.appendChild(a),e.setAttribute("aria-labelledby",a.id),e.setAttribute("aria-live","polite");const l=document.createElement("div");l.id=`${this.name}-ARIA-description`,l.textContent=this.description,this.ariaDescriptionElement=l,cs.appendChild(l),e.setAttribute("aria-describedby",l.id),e.setAttribute("aria-live","polite"),this.cleanAria()}else this.cleanDimensions();return this.dirtyCells=!0,this.apply(),this.dirtyDomDimensions=!0,t.setAsCurrentCanvas&&this.setAsCurrentCanvas(),this};let Pi=Canvas.prototype=Object.create(Object.prototype);Pi.type="Canvas",Pi.lib="canvas",Pi.isArtefact=!0,Pi.isAsset=!1,Pi=xt(Pi),Pi=Ci(Pi),Pi=Oi(Pi);Pi.defs=tt(Pi.defs,{position:"relative",trackHere:"subscribe",fit:"none",isComponent:!1,baseMatchesCanvasDimensions:!1,renderOnResize:!0,ignoreCanvasCssDimensions:!1,title:"",label:"",description:"",role:"img"}),Pi.stringifyFunction=Y,Pi.processPacketOut=Y,Pi.finalizePacketOut=Y,Pi.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Pi.clone=N,Pi.factoryKill=function(){let t,e,s=this.name,n=this.host;st(ji,s),Yi(),st(Ft,s),n&&"root"!==n&&(t=this.currentHost?this.currentHost:i[n],t&&(t.removeGroups(s),e=d[t.name],e&&e.removeArtefacts(s))),d[s]&&d[s].kill(),this.base.kill(),this.navigation.remove(),this.textHold.remove(),this.ariaLabelElement.remove(),this.ariaDescriptionElement.remove(),this.domElement.remove()};let xi=Pi.getters,Di=Pi.setters,Ri=Pi.deltaSetters;Pi.fitDefaults=["fill","contain","cover"],Di.fit=function(t){this.fit=this.fitDefaults.indexOf(t)>=0?t:"none"},Di.title=function(t){this.title=t,this.dirtyAria=!0},Di.label=function(t){this.label=t,this.dirtyAria=!0},Di.description=function(t){this.description=t,this.dirtyAria=!0},Di.role=function(t){this.role=t,this.dirtyAria=!0},xi.backgroundColor=function(){return this.base.backgroundColor},Di.backgroundColor=function(t){this.base&&this.base.set({backgroundColor:t})},xi.alpha=function(){return this.base.alpha},Di.alpha=function(t){this.base&&this.base.set({alpha:t})},Ri.alpha=function(t){this.base&&this.base.deltaSet({alpha:t})},xi.composite=function(){return this.base.composite},Di.composite=function(t){this.base&&this.base.set({composite:t})},Pi.setAsCurrentCanvas=function(){return this.base&&Qi(this),this},Pi.setBase=function(t){return this.base&&(this.base.set(t),this.setBaseHelper()),this},Pi.deltaSetBase=function(t){return this.base&&(this.base.deltaSet(t),this.setBaseHelper()),this},Pi.updateBaseHere=function(){this.base&&this.base.updateBaseHere(this.here,this.fit)},Pi.setBaseHelper=function(){let t={};this.base.dirtyScale&&(t.dirtyScale=!0),this.base.dirtyDimensions&&(t.dirtyDimensions=!0),this.base.dirtyLock&&(t.dirtyLock=!0),this.base.dirtyStart&&(t.dirtyStart=!0),this.base.dirtyOffset&&(t.dirtyOffset=!0),this.base.dirtyHandle&&(t.dirtyHandle=!0),this.base.dirtyRotation&&(t.dirtyRotation=!0),this.cleanCells(),this.base.prepareStamp(),this.updateCells(t)},Pi.updateCells=function(t=z){const e=this.cells;for(let i,s=0,n=e.length;s<n;s++)i=a[e[s]],i&&(t.dirtyScale&&(i.dirtyScale=!0),t.dirtyDimensions&&(i.dirtyDimensions=!0),t.dirtyLock&&(i.dirtyLock=!0),t.dirtyStart&&(i.dirtyStart=!0),t.dirtyOffset&&(i.dirtyOffset=!0),t.dirtyHandle&&(i.dirtyHandle=!0),t.dirtyRotation&&(i.dirtyRotation=!0))},Pi.buildCell=function(t=z){t.host||!1||(t.host=this.base.name);let e=Ke(t);return this.addCell(e),this.cleanCells(),e},Pi.cleanDimensionsAdditionalActions=function(){this.cells&&this.updateCells({dirtyDimensions:!0}),this.dirtyDomDimensions=!0,this.dirtyDisplayShape=!0,this.dirtyDisplayArea=!0},Pi.addCell=function(t){if(t=t.substring?t:t.name||!1){const e=a[t];e&&(this.base&&(e.host=this.base.name,e.currentHost=null),e.prepareStamp(),it(this.cells,t),this.dirtyCells=!0)}return this},Pi.removeCell=function(t){return(t=t.substring?t:t.name||!1)&&(st(this.cells,t),this.dirtyCells=!0),this},Pi.killCell=function(t){let e=t.substring?a[t]:t;return e&&e.kill(),this.dirtyCells=!0,this},Pi.clear=function(){this.dirtyCells&&this.cleanCells(),this.base&&this.base.dirtyDimensions&&this.base.cleanDimensions();const t=this.cellBatchesClear;for(let e=0,i=t.length;e<i;e++)t[e].clear()},Pi.compile=function(){this.dirtyCells&&this.cleanCells(),this.base&&this.base.dirtyDimensions&&this.base.cleanDimensions();const t=this.cellBatchesCompile;for(let e=0,i=t.length;e<i;e++)t[e].compile();this.prepareStamp(),this.stamp()},Pi.show=function(){this.dirtyCells&&this.cleanCells(),this.base&&this.base.dirtyDimensions&&this.base.cleanDimensions();const t=this.cellBatchesShow;for(let e=0,i=t.length;e<i;e++)t[e].show();this.base.show(),hs(),this.dirtyAria&&this.cleanAria()},Pi.render=function(){this.clear(),this.compile(),this.show()},Pi.cleanCells=function(){this.dirtyCells=!1;let t,e=[],i=[],s=[],n=this.cells;for(let r,o=0,l=n.length;o<l;o++)r=a[n[o]],r&&(r.cleared&&e.push(r),r.compiled&&(t=r.compileOrder,i[t]||(i[t]=[]),i[t].push(r)),r.shown&&(t=r.showOrder,s[t]||(s[t]=[]),s[t].push(r)));this.cellBatchesClear=[].concat(e),this.cellBatchesCompile=i.reduce(((t,e)=>t.concat(e)),[]),this.cellBatchesShow=s.reduce(((t,e)=>t.concat(e)),[])},Pi.cascadeEventAction=function(t){this.currentActiveEntityNames||(this.currentActiveEntityNames=[]);let e,s,n,r,o,l,h=this.currentActiveEntityNames,c=[],u=[],d=[],f=[],p=[],m=[];const g=this.cells;for(e=0,s=g.length;e<s;e++)n=a[g[e]],n&&(n.shown||n.isBase)&&c.push(n.getEntityHits());for(c=c.reduce(((t,e)=>t.concat(e)),[]),e=0,s=c.length;e<s;e++)r=c[e],o=r.name,u.indexOf(o)<0&&(u.push(o),h.indexOf(o)<0?(d.push(r),f.push(o)):(p.push(r),m.push(o)));let y=d.concat(p),b=function(){if(h.length){for(e=0,s=f.length;e<s;e++)st(h,f[e]);for(e=0,s=m.length;e<s;e++)st(h,m[e]);for(e=0,s=h.length;e<s;e++)l=i[h[e]],l&&l.onLeave()}};const S=y.length,k=d.length;switch(t){case"down":for(e=0;e<S;e++)y[e].onDown();break;case"up":for(e=0;e<S;e++)y[e].onUp();break;case"enter":for(e=0;e<k;e++)d[e].onEnter();break;case"leave":b();break;case"move":for(b(),e=0;e<k;e++)d[e].onEnter()}return this.currentActiveEntityNames=f.concat(m),this.currentActiveEntityNames},Pi.cleanAria=function(){this.dirtyAria=!1,this.domElement.setAttribute("title",this.title),this.domElement.setAttribute("role",this.role),this.ariaLabelElement.textContent=this.label,this.ariaDescriptionElement.textContent=this.description};const Fi=function(t){return!!t&&new Canvas(t)};v.Canvas=Canvas;const Element=function(t=z){let e=t.domElement;return this.makeName(t.name),this.register(),e&&(t.text?e.textContent=t.text:t.content&&(e.innerHTML=t.content)),this.initializePositions(),this.dimensions[0]=this.dimensions[1]=100,this.pathCorners=[],this.css={},this.here={},this.initializeDomLayout(t),this.set(this.defs),this.initializeAccessibility(),this.set(t),e=this.domElement,e&&(e.id=this.name),this.apply(),this};let Ei=Element.prototype=Object.create(Object.prototype);Ei.type="Element",Ei.lib="element",Ei.isArtefact=!0,Ei.isAsset=!1,Ei=xt(Ei),Ei=Ci(Ei),Ei.factoryKill=function(){st(Ft,this.name),this.domElement.remove()};let Ii=Ei.setters;Ii.text=function(t){if(_(this.domElement)){let e=this.domElement,i=e.querySelectorAll('[data-corner-div="sc"]');e.textContent=t,i.forEach((t=>e.appendChild(t))),this.dirtyContent=!0}},Ii.content=function(t){if(this.domElement){let e=this.domElement,i=e.querySelectorAll('[data-corner-div="sc"]');e.innerHTML=t,i.forEach((t=>e.appendChild(t))),this.dirtyContent=!0}},Ei.cleanDimensionsAdditionalActions=function(){this.dirtyDomDimensions=!0},Ei.addCanvas=function(t=z){if(this.canvas)return this.canvas;{let e=document.createElement("canvas"),i=this.domElement,s=i.getBoundingClientRect();window.getComputedStyle(i),i.parentNode.insertBefore(e,this.domElement);let n=Fi({name:`${this.name}-canvas`,domElement:e,position:"absolute",width:s.width,height:s.height,mimic:this.name,lockTo:"mimic",useMimicDimensions:!0,useMimicScale:!0,useMimicStart:!0,useMimicHandle:!0,useMimicOffset:!0,useMimicRotation:!0,addOwnDimensionsToMimic:!1,addOwnScaleToMimic:!1,addOwnStartToMimic:!1,addOwnHandleToMimic:!1,addOwnOffsetToMimic:!1,addOwnRotationToMimic:!1});return n.set(t),this.canvas=n,n}};const Mi=function(t){return!!t&&new Element(t)};v.Element=Element;const Stack=function(t=z){let e,i;return this.makeName(t.name),this.register(),this.initializePositions(),this.initializeCascade(),this.dimensions[0]=300,this.dimensions[1]=150,this.pathCorners=[],this.css={},this.here={},this.perspective={x:"50%",y:"50%",z:0},this.dirtyPerspective=!0,this.initializeDomLayout(t),e=fi({name:this.name,host:this.name}),this.addGroups(e.name),this.set(this.defs),this.initializeDisplayShapeActions(),this.initializeAccessibility(),this.set(t),i=this.domElement,i&&"root"===i.getAttribute("data-group")&&(it(ji,this.name),Yi()),this};let Ti=Stack.prototype=Object.create(Object.prototype);Ti.type="Stack",Ti.lib="stack",Ti.isArtefact=!0,Ti.isAsset=!1,Ti=xt(Ti),Ti=Xe(Ti),Ti=Ci(Ti),Ti=Oi(Ti);Ti.defs=tt(Ti.defs,{position:"relative",perspective:null,trackHere:"subscribe",isResponsive:!1,containElementsInHeight:!1}),Ti.stringifyFunction=Y,Ti.processPacketOut=Y,Ti.finalizePacketOut=Y,Ti.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Ti.clone=N,Ti.factoryKill=function(){let t=this.name;st(ji,t),Yi(),st(Ft,t),d[t]&&d[t].kill(),Object.entries(i).forEach((([e,i])=>{i.host===t&&i.kill()})),this.domElement.remove()};let Hi=Ti.getters,Bi=Ti.setters,Li=Ti.deltaSetters;Hi.perspectiveX=function(){return this.perspective.x},Hi.perspectiveY=function(){return this.perspective.y},Hi.perspectiveZ=function(){return this.perspective.z},Bi.perspectiveX=function(t){this.perspective.x=t,this.dirtyPerspective=!0},Bi.perspectiveY=function(t){this.perspective.y=t,this.dirtyPerspective=!0},Bi.perspectiveZ=function(t){this.perspective.z=t,this.dirtyPerspective=!0},Bi.perspective=function(t=z){this.perspective.x=nt(t.x)?t.x:this.perspective.x,this.perspective.y=nt(t.y)?t.y:this.perspective.y,this.perspective.z=nt(t.z)?t.z:this.perspective.z,this.dirtyPerspective=!0},Li.perspectiveX=function(t){this.perspective.x=B(this.perspective.x,t),this.dirtyPerspective=!0},Li.perspectiveY=function(t){this.perspective.y=B(this.perspective.y,t),this.dirtyPerspective=!0},Ti.updateArtefacts=function(t=z){this.groupBuckets.forEach((e=>{e.artefactBuckets.forEach((e=>{t.dirtyScale&&(e.dirtyScale=!0),t.dirtyDimensions&&(e.dirtyDimensions=!0),t.dirtyLock&&(e.dirtyLock=!0),t.dirtyStart&&(e.dirtyStart=!0),t.dirtyOffset&&(e.dirtyOffset=!0),t.dirtyHandle&&(e.dirtyHandle=!0),t.dirtyRotation&&(e.dirtyRotation=!0),t.dirtyPathObject&&(e.dirtyPathObject=!0)}))}))},Ti.cleanDimensionsAdditionalActions=function(){this.groupBuckets&&this.updateArtefacts({dirtyDimensions:!0,dirtyPath:!0,dirtyStart:!0,dirtyHandle:!0}),this.dirtyDomDimensions=!0,this.dirtyPath=!0,this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyDisplayShape=!0,this.dirtyDisplayArea=!0},Ti.cleanPerspective=function(){this.dirtyPerspective=!1;let t=this.perspective;this.domPerspectiveString=`perspective-origin: ${t.x} ${t.y}; perspective: ${t.z}px;`,this.domShowRequired=!0,this.groupBuckets&&this.updateArtefacts({dirtyHandle:!0,dirtyPathObject:!0})},Ti.checkResponsive=function(){this.isResponsive&&this.trackHere&&(this.currentVportWidth||(this.currentVportWidth=jt.w),this.currentVportHeight||(this.currentVportHeight=jt.h),this.dirtyHeight&&this.containElementsInHeight&&(console.log("stack height final fixes need to be done"),this.dirtyHeight=!1),this.currentVportWidth!==jt.w&&(console.log("need to update for resized viewport width"),this.currentVportWidth=jt.w,this.containElementsInHeight&&(this.dirtyHeight=!0)),this.currentVportHeight!==jt.h&&(console.log("need to update for resized viewport height"),this.currentVportHeight=jt.h))},Ti.clear=function(){this.checkResponsive()},Ti.compile=function(){this.sortGroups(),this.prepareStamp(),this.stamp(),this.groupBuckets.forEach((t=>t.stamp()))},Ti.show=function(){hs()},Ti.render=function(){this.compile(),this.show()},Ti.addExistingDomElements=function(t){let e,i,s,n,r;if(nt(t))for(e=t.substring?document.querySelectorAll(t):[].concat(t),n=0,r=e.length;n<r;n++)i=e[n],_(i)&&(s=Mi({name:i.id||i.name,domElement:i,group:this.name,host:this.name,position:"absolute",setInitialDimensions:!0}),s&&s.domElement&&this.domElement.appendChild(s.domElement));return this},Ti.addNewElement=function(t){if(t&&t.tag){t.domElement=document.createElement(t.tag),t.domElement.setAttribute("data-group",this.name),nt(t.group)||(t.group=this.name),t.host=this.name,t.position||(t.position="absolute"),nt(t.width)||(t.width=100),nt(t.height)||(t.height=100);let e=Mi(t);return e&&e.domElement&&(nt(t.boxSizing)||(e.domElement.style.boxSizing="border-box"),this.domElement.appendChild(e.domElement)),e}return!1};const $i=function(t){return!!t&&new Stack(t)};v.Stack=Stack;let ji=[],Yi=()=>{Ni=!0},Xi=[],Ni=!0;const Gi=function(t){let e=t.getAttribute("data-group"),i=t.id||t.getAttribute("name"),s="absolute";e||(t.setAttribute("data-group","root"),e="root",s="relative"),i||(i=W(),t.id=i);let n=$i({name:i,domElement:t,group:e,host:e,position:s,setInitialDimensions:!0});return zi(t,i),n},zi=function(t,e){let i=t.getBoundingClientRect(),s=0;Array.from(t.children).forEach((t=>{if(null!=t.getAttribute("data-stack")||U(t)||"SCRIPT"===t.tagName)t.setAttribute("data-group",e);else{let n=t.getBoundingClientRect(),r=window.getComputedStyle(t),o=parseFloat(r.marginTop)+parseFloat(r.borderTopWidth)+parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderBottomWidth)+parseFloat(r.marginBottom);s=s||n.top-i.top;let a={name:t.id||t.getAttribute("name"),domElement:t,group:e,host:e,position:"absolute",width:n.width,height:n.height,startX:n.left-i.left,startY:s,classes:t.className?t.className:""};s+=o+n.height,Mi(a)}}))},Wi=function(t=z){let e,s,n,r,o,a,l="absolute";return e=t.element&&t.element.substring?document.querySelector(t.element):_(t.element)?t.element:document.createElement("div"),t.host&&t.host.substring?(s=document.querySelector(t.host),s||(s=document.body)):s=_(t.host)?t.host:nt(e.parentElement)?e.parentElement:document.body,nt(t.width)&&(e.style.width=t.width.toFixed?`${t.width}px`:t.width),nt(t.height)&&(e.style.height=t.height.toFixed?`${t.height}px`:t.height),a=t.name||e.id||e.getAttribute("name")||"",a||(a=W()),e.id=a,e.setAttribute("data-stack","data-stack"),s&&null!=s.getAttribute("data-stack")?(n=i[s.id],o=n?n.name:"root"):o="root",e.setAttribute("data-group",o),"root"===o&&(l="relative"),e.parentElement&&s.id===e.parentElement.id||s.appendChild(e),r=$i({name:a,domElement:e,group:o,host:o,position:l,setInitialDimensions:!0}),zi(e,a),Array.from(e.childNodes).forEach((t=>{t.id&&ji.indexOf(t.id)>=0&&st(ji,t.id)})),delete t.name,delete t.element,delete t.host,delete t.width,delete t.height,r.set(t),Ni=!0,r},Vi=function(t){let e=t.getAttribute("data-group"),i=t.id||t.getAttribute("name"),s="absolute";return e||(t.setAttribute("data-group","root"),e="root",s=t.style.position),i||(i=W(),t.id=i),Fi({name:i,domElement:t,group:e,host:e,position:s,setInitialDimensions:!0})},Zi=function(t){let e=document.querySelector(t),i=!1;return e&&(i=Vi(e)),Qi(i),i},Ui=function(t){let e,i=document.querySelector(t);return i&&(e=Gi(i)),e};let _i=null,qi=null;const Qi=function(t){let e=!1;if(t)if(t.substring){let i=o[t];i&&(_i=i,e=!0)}else"Canvas"===t.type&&(_i=t,e=!0);if(e&&_i.base){let t=d[_i.base.name];t&&(qi=t)}},Ki=function(t=z){let e=document.createElement("canvas"),s=t.name?t.name:W(),n=t.host,r="root",o=t.width||300,a=t.height||150,l="relative";if(n.substring){let t=i[n];!t&&n?(n=document.querySelector(n),n&&(r=n.id)):n=t}n?"Stack"===n.type?(r=n.name,l="absolute",n=n.domElement):_(n)||(n=document.body):n=document.body,e.id=s,e.setAttribute("data-group",r),e.width=o,e.height=a,e.style.position=l,n.appendChild(e);let h=Fi({name:s,domElement:e,group:r,host:r,position:l,setInitialDimensions:!1,setAsCurrentCanvas:!nt(t.setAsCurrentCanvas)||t.setAsCurrentCanvas,trackHere:nt(t.trackHere)?t.trackHere:"subscribe"});return delete t.group,delete t.host,delete t.name,delete t.element,delete t.position,delete t.setInitialDimensions,delete t.setAsCurrentCanvas,delete t.trackHere,h.set(t),h},Ji=function(...t){ss(t),ns("clear")},ts=function(...t){ss(t),ns("compile")},es=function(...t){ss(t),ns("show")},is=function(...t){ss(t),ns("render")},ss=function(t){t.length?Xi=t:Ni&&function(){let t=Math.floor;if(Ni){Ni=!1;let e,s,n,r,o,a=[];for(n=0,r=ji.length;n<r;n++)o=ji[n],e=i[o],e&&(s=t(e.order)||0,a[s]||(a[s]=[]),a[s].push(e.name));Xi=a.reduce(((t,e)=>t.concat(e)),[])}}()},ns=function(t){let e,s,n,r;for(e=0,s=Xi.length;e<s;e++)n=Xi[e],r=i[n],r&&r[t]&&r[t]()},rs=[],os=function(t=""){if(!t)throw new Error(`core/document addDomShowElement() error - false argument supplied: ${t}`);if(!t.substring)throw new Error(`core/document addDomShowElement() error - argument not a string: ${t}`);it(rs,t)};let as=!1;const ls=function(t=!0){as=t},hs=function(t=""){if(as||t){let e,s,n,r,o,a,l,h,c,u,d,f,p,m,g,y,b,S;t?e=[t]:(as=!1,e=[].concat(rs),rs.length=0);let k=Ct(),A=wt();for(s=0,n=e.length;s<n;s++){if(r=e[s],o=i[r],!o)throw new Error(`core/document domShow() error - artefact missing: ${r}`);if(a=o.domElement,!a)throw new Error(`core/document domShow() error - DOM element missing: ${r}`);if(l=a.style,o.dirtyPerspective&&(o.dirtyPerspective=!1,h=o.perspective,l.perspectiveOrigin=`${h.x} ${h.y}`,l.perspective=`${h.z}px`),o.dirtyPosition&&(o.dirtyPosition=!1,l.position=o.position),o.dirtyDomDimensions&&(o.dirtyDomDimensions=!1,c=o.currentDimensions,u=c[0],d=c[1],"Canvas"===o.type?(k?(a.width=u,a.height=d):(o.ignoreCanvasCssDimensions||(l.width=`${u}px`,l.height=`${d}px`),a.width=u*A,a.height=d*A),o.renderOnResize&&o.render()):(l.width=`${u}px`,l.height=d?`${d}px`:"auto")),o.dirtyTransformOrigin&&(o.dirtyTransformOrigin=!1,l.transformOrigin=o.currentTransformOriginString),o.dirtyTransform&&(o.dirtyTransform=!1,l.transform=o.currentTransformString),o.dirtyVisibility&&(o.dirtyVisibility=!1,l.display=o.visibility?"block":"none"),o.dirtySmoothFont&&(o.dirtySmoothFont=!1,o.smoothFont?(l.webkitFontSmoothing="auto",l.mozOsxFontSmoothing="auto",l.smoothFont="auto"):(l.webkitFontSmoothing="none",l.mozOsxFontSmoothing="grayscale",l.smoothFont="never")),o.dirtyCss)for(o.dirtyCss=!1,m=o.css||{},g=Object.keys(m),f=0,p=g.length;f<p;f++)y=g[f],S=m[y],P.has(y)?(b=`${y[0].toUpperCase}${y.substr(1)}`,l[`webkit${b}`]=S,l[`moz${b}`]=S,l[`ms${b}`]=S,l[`o${b}`]=S,l[y]=S):O.has(y)&&(l[y]=S);o.dirtyClasses&&(o.dirtyClasses=!1,a.className.substring&&(a.className=o.classes))}}};let cs=document.createElement("div");cs.style.padding=0,cs.style.border=0,cs.style.margin=0,cs.style.width="4500px",cs.style.boxSizing="border-box",cs.style.position="absolute",cs.style.top="-5000px",cs.style.left="-5000px",cs.id="Scrawl-ARIA-default-hold",document.body.appendChild(cs);let us=document.createElement("nav");us.style.position="absolute",us.style.top="-5000px",us.style.left="-5000px",us.id="Scrawl-navigation-default-hold",document.body.prepend(us);const ds=function(){window.scrawlEnvironmentTouchSupported=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),document.querySelectorAll("[data-stack]").forEach((t=>Gi(t))),function(){let t;document.querySelectorAll("canvas").forEach(((e,i)=>{t=Vi(e),i||Qi(t)}))}(),T(),re(),Vt(),It=!0,ie(),window.scrawlEnvironmentColorChecker=ni({name:"entity-colorEngine-do-not-overwrite"})},RenderAnimation=function(t=z){let e;if(t.target){if(Array.isArray(t.target)){let e=[];return t.target.forEach((i=>{let s=Object.assign({},t);s.name=`${s.name}_${i.name}`,s.target=i,e.push(new RenderAnimation(s))})),e}e=t.target.substring?i[t.target]:t.target}else e={clear:Ji,compile:ts,show:es,checkAccessibilityValues:Y};if(!(e&&e.clear&&e.compile&&e.show))return!1;this.makeName(t.name),this.order=nt(t.order)?t.order:this.defs.order,this.onRun=t.onRun||Y,this.onHalt=t.onHalt||Y,this.onKill=t.onKill||Y,this.target=e,this.commence=t.commence||Y,this.afterClear=t.afterClear||Y,this.afterCompile=t.afterCompile||Y,this.afterShow=t.afterShow||Y,this.afterCreated=t.afterCreated||Y,this.error=t.error||Y,this.readyToInitialize=!0,this.fn=function(){this.commence(),this.target.clear(),this.afterClear(),this.target.compile(),this.afterCompile(),this.target.show(),this.afterShow(),this.readyToInitialize&&(this.target.checkAccessibilityValues(),this.afterCreated(this),this.readyToInitialize=!1)},this.register();const s=t.observer||!1;return s&&(Z(s)?this.observer=ht(this,this.target):this.observer=ht(this,this.target,s)),t.delay||this.run(),this};let fs=RenderAnimation.prototype=Object.create(Object.prototype);fs.type="RenderAnimation",fs.lib="animation",fs.isArtefact=!1,fs.isAsset=!1,fs=xt(fs);fs.defs=tt(fs.defs,{order:1,onRun:null,onHalt:null,onKill:null,commence:null,afterClear:null,afterCompile:null,afterShow:null,afterCreated:null,error:null,target:null}),fs.stringifyFunction=Y,fs.processPacketOut=Y,fs.finalizePacketOut=Y,fs.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},fs.clone=N,fs.kill=function(){return this.onKill(),st(E,this.name),I(),this.deregister(),!0},fs.run=function(){return this.onRun(),it(E,this.name),I(),this.target.checkAccessibilityValues(),setTimeout((()=>oe()),20),this},fs.isRunning=function(){return E.indexOf(this.name)>=0},fs.halt=function(){return this.onHalt(),st(E,this.name),I(),this};const ps=function(t){return!!t&&new RenderAnimation(t)};v.RenderAnimation=RenderAnimation;const UnstackedElement=function(t){let e=t.id||t.name;return this.makeName(e),this.register(),t.setAttribute("data-scrawl-name",this.name),this.domElement=t,this.elementComputedStyles=window.getComputedStyle(t),this.hostStyles=z,this.canvasStartX=0,this.canvasStartY=0,this.canvasWidth=0,this.canvasHeight=0,this.canvasZIndex=0,this};let ms=UnstackedElement.prototype=Object.create(Object.prototype);ms.type="UnstackedElement",ms.lib="unstackedelement",ms.isArtefact=!1,ms.isAsset=!1,ms=xt(ms);ms.defs=tt(ms.defs,{canvasOnTop:!1}),ms.getters,ms.setters,ms.deltaSetters,ms.demolish=function(t=!1){return!0},ms.addCanvas=function(t=z){if(!this.canvas){let e=document.createElement("canvas"),i=this.domElement,s=i.style;"static"===s.position&&(s.position="relative"),i.prepend(e);let n=Fi({name:`${this.name}-canvas`,domElement:e,position:"absolute"});return this.canvas=n,n.set(t),this.updateCanvas(),n}},ms.includedStyles=["width","height","zIndex","borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"],ms.mimickedStyles=["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"],ms.checkElementStyleValues=function(){let t={},e=this.domElement,i=this.canvas;if(e&&i&&i.domElement){let s=this.hostStyles,n=this.elementComputedStyles,r=i.domElement,o=this.includedStyles,{x:a,y:l,width:h,height:c}=e.getBoundingClientRect(),{x:u,y:d}=r.getBoundingClientRect(),{zIndex:f,width:p,height:m}=n;a=Math.floor(a),l=Math.floor(l),u=Math.floor(u),d=Math.floor(d),h=Math.floor(h),c=Math.floor(c),p=Math.floor(parseFloat(p)),m=Math.floor(parseFloat(m)),o.forEach((e=>{switch(e){case"width":let i=Math.max(p,h);this.canvasWidth!==i&&(this.canvasWidth=i,this.dirtyDimensions=!0);break;case"height":let r=Math.max(m,c);this.canvasHeight!==r&&(this.canvasHeight=r,this.dirtyDimensions=!0);break;case"zIndex":let o="auto"===f?0:parseInt(f,10);o=this.canvasOnTop?o+1:o-1,this.canvasZIndex!==o&&(this.canvasZIndex=o,this.dirtyZIndex=!0);break;default:let a=s[e],l=n[e];nt(a)&&a===l||(s[e]=l,t[e]=l)}}));let g=a-u,y=l-d;(g||y)&&(this.canvasStartX+=g,this.canvasStartY+=y,this.dirtyStart=!0)}return t},ms.updateCanvas=function(){if(this.canvas&&this.canvas.domElement){let t=this.canvas,e=t.domElement.style,i=this.mimickedStyles,s=this.checkElementStyleValues();for(let[t,n]of Object.entries(s))i.indexOf(t)>=0&&(e[t]=n);if(this.dirtyStart&&(this.dirtyStart=!1,t.set({startX:this.canvasStartX,startY:this.canvasStartY})),this.dirtyDimensions){this.dirtyDimensions=!1;let e=this.canvasWidth,i=this.canvasHeight;t.set({width:e,height:i}),t.dirtyDimensions=!0,t.base.set({width:e,height:i}),t.base.dirtyDimensions=!0,t.cleanDimensions(),t.base.cleanDimensions()}this.dirtyZIndex&&(this.dirtyZIndex=!1,e.zIndex=this.canvasZIndex)}};v.UnstackedElement=UnstackedElement;const gs=function(t){let e=!!_(t.domElement)&&t.domElement,s=K(t.animationHooks)?t.animationHooks:{},n=K(t.canvasSpecs)?t.canvasSpecs:{},r=K(t.observerSpecs)?t.observerSpecs:{},o=!Z(t.includeCanvas)||t.includeCanvas;return e&&e.id&&i[e.id]?ys(e,n,s,r):bs(e,n,s,r,o)},ys=function(t,e,s,n){let r=i[t.id];if(!r)return!1;e.baseMatchesCanvasDimensions=!0,e.ignoreCanvasCssDimensions=!0,e.checkForResize=!0;let o=r.addCanvas(e);r.elementComputedStyles=window.getComputedStyle(t),s.name=`${r.name}-animation`,s.target=o;let a=ps(s),l=ht(a,r,n);return{element:r,canvas:o,animation:a,demolish:()=>{l(),a.kill(),o.demolish(),r.demolish(!0)}}},bs=function(t,e,i,s,n){if(!t||["AREA","BASE","BR","COL","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"].indexOf(t.tagName)>=0)return{};let r,o=t.id;var a;o&&w[o]?r=w[o]:r=!!(a=t)&&new UnstackedElement(a),e.baseMatchesCanvasDimensions=!0,e.checkForResize=!0;let l=!!n&&r.addCanvas(e);i.name=`${r.name}-animation`,l&&(i.afterClear||(i.afterClear=()=>r.updateCanvas()),i.target=l);let h=ps(i),c=ht(h,r,s);return{element:r,canvas:l,animation:h,demolish:()=>{c(),h.kill(),l&&l.demolish(),r.demolish(!0)}}},Ss=["artefact","group","animation","tween","styles"],ks=t=>{if(t&&t.substring){let e;return!!Ss.some((i=>(e=x[i][t],e)))&&e}return!1};function As(t=z){t.defs=tt(t.defs,{order:1,ticker:"",targets:null,time:0,action:null,reverseOnCycleEnd:!1,reversed:!1}),t.kill=function(){let t,i=this.ticker;return i===`${this.name}_ticker`?(t=e[i],t&&t.kill()):i&&this.removeFromTicker(i),this.deregister(),!0};let i=t.getters,s=t.setters;return i.targets=function(){return[].concat(this.targets)},s.targets=function(t=[]){this.setTargets(t)},s.action=function(t){this.action=t,"function"!=typeof this.action&&(this.action=Y)},t.calculateEffectiveTime=function(t){let i,s=ot(t,this.time),n=L(s),r=n[1],o=n[0],a=0;return this.effectiveTime=0,"%"===o&&r<=100?this.ticker&&(i=e[this.ticker],i&&(a=i.effectiveDuration,this.effectiveTime=a*(r/100))):this.effectiveTime=r,this},t.addToTicker=function(t){let i;return nt(t)&&(this.ticker&&this.ticker!==t&&this.removeFromTicker(this.ticker),i=e[t],nt(i)&&(this.ticker=t,i.subscribe(this.name),this.calculateEffectiveTime())),this},t.removeFromTicker=function(t){let i;return(t=nt(t)?t:this.ticker)&&(i=e[t],nt(i)&&(this.ticker="",i.unsubscribe(this.name))),this},t.setTargets=function(t){t=[].concat(t);let e=[];return t.forEach((t=>{if(q(t))q(t.set)&&e.push(t);else if(K(t)&&nt(t.name))e.push(t);else{let i=ks(t);i&&e.push(i)}})),this.targets=e,this},t.addToTargets=function(t){return(t=[].concat(t)).forEach((t=>{"function"==typeof t?"function"==typeof t.set&&this.targets.push(t):(result=ks(t),result&&this.targets.push(result))}),this),this},t.removeFromTargets=function(t){t=[].concat(t);let e=[],i=[].concat(this.targets);return i.forEach((t=>{let i=t.type||"unknown",s=t.name||"unnamed";"unknown"!==i&&"unnamed"!==s&&e.push(`${i}_${s}`)})),t.forEach((t=>{let s;if(s="function"==typeof t?t:ks(t),s){let t=s.type||"unknown",n=s.name||"unnamed";if("unknown"!==t&&"unnamed"!==n){let s=`${t}_${n}`,r=e.indexOf(s);r>=0&&(i[r]=!1)}}})),this.targets=[],i.forEach((t=>{t&&this.targets.push(t)}),this),this},t.checkForTarget=function(t){return!!t.substring&&this.targets.some((e=>e.name===t))},t.run=Y,t.isRunning=Y,t.halt=Y,t.reverse=Y,t.resume=Y,t.seekTo=Y,t.seekFor=Y,t}const Action=function(t=z){return this.makeName(t.name),this.register(),this.set(this.defs),this.action=Y,this.revert=Y,this.set(t),this.calculateEffectiveTime(),nt(t.ticker)&&this.addToTicker(t.ticker),this};let ws=Action.prototype=Object.create(Object.prototype);ws.type="Action",ws.lib="tween",ws.isArtefact=!1,ws.isAsset=!1,ws=xt(ws),ws=As(ws);ws.defs=tt(ws.defs,{revert:null}),ws.packetExclusions=it(ws.packetExclusions,["targets"]),ws.packetFunctions=it(ws.packetFunctions,["revert","action"]),ws.finalizePacketOut=function(t,e){return Array.isArray(this.targets)&&(t.targets=this.targets.map((t=>t.name))),t};let vs=ws.setters;vs.revert=function(t){this.revert=t,"function"!=typeof this.revert&&(this.revert=Y)},vs.triggered=function(t){this.triggered!==t&&(t?this.action():this.revert(),this.triggered=t)},ws.set=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.setters,n=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&"name"!==a&&null!=l&&(r=s[a],r?r.call(this,l):void 0!==n[a]&&(this[a]=l));let h=!!nt(t.ticker)&&this.ticker;h?(this.ticker=h,this.addToTicker(t.ticker)):nt(t.time)&&this.calculateEffectiveTime()}return this},ws.getEndTime=function(){return this.effectiveTime},ws.update=function(t){let e=this.reversed,i=this.effectiveTime,s=this.triggered;this.reverseOnCycleEnd;let n=t.tick,r=t.reverseTick,o=t.willLoop;return t.next,e?r>=i?s||(this.action(),this.triggered=!0):s&&(this.revert(),this.triggered=!1):n>=i?s||(this.action(),this.triggered=!0):s&&(this.revert(),this.triggered=!1),o&&(this.triggered=!this.triggered),!0};const Cs=function(t){return!!t&&new Action(t)};function Os(t=z){(t=Ge(t=Ye(t=Le(t=Be(t=He(t=Te(t=Me(t)))))))).defs=tt(t.defs,{method:"fill",pathObject:null,winding:"nonzero",flipReverse:!1,flipUpend:!1,scaleOutline:!0,lockFillStyleToEntity:!1,lockStrokeStyleToEntity:!1,onEnter:null,onLeave:null,onDown:null,onUp:null}),t.packetExclusions=it(t.packetExclusions,["state"]),t.packetFunctions=it(t.packetFunctions,["onEnter","onLeave","onDown","onUp"]),t.processEntityPacketOut=function(t,e,i){return this.processFactoryPacketOut(t,e,i)},t.processFactoryPacketOut=function(t,e,i){let s=!0;return i.indexOf(t)<0&&e===this.defs[t]&&(s=!1),s},t.finalizePacketOut=function(t,e){let i=JSON.parse(this.state.saveAsPacket(e))[3];return t=tt(t,i),t=this.handlePacketAnchor(t,e)},t.postCloneAction=function(t,e){return this.onEnter&&(t.onEnter=this.onEnter),this.onLeave&&(t.onLeave=this.onLeave),this.onDown&&(t.onDown=this.onDown),this.onUp&&(t.onUp=this.onUp),e.sharedState&&(t.state=this.state),e.anchor&&(e.anchor.host=t,nt(e.anchor.focusAction)||(e.anchor.focusAction=this.anchor.focusAction),nt(e.anchor.blurAction)||(e.anchor.blurAction=this.anchor.blurAction),t.buildAnchor(e.anchor),e.anchor.clickAction||(t.anchor.clickAction=this.anchor.clickAction)),t};let e=t.getters,i=t.setters;return t.deltaSetters,e.group=function(){return this.group?this.group.name:""},i.lockStylesToEntity=function(t){this.lockFillStyleToEntity=t,this.lockStrokeStyleToEntity=t},t.get=function(t){const e=this.getters[t];if(e)return e.call(this);{let e,i=this.defs[t],s=this.state;return void 0!==i?(e=this[t],void 0!==e?e:i):(i=s.defs[t],void 0!==i?(e=s[t],void 0!==e?e:i):null)}},t.set=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.setters,n=this.defs,r=this.state,o=r?r.setters:z,a=r?r.defs:z;let l,h,c,u;for(h=0;h<i;h++)c=e[h],u=t[c],c&&"name"!=c&&null!=u&&(me.indexOf(c)<0?(l=s[c],l?l.call(this,u):void 0!==n[c]&&(this[c]=u)):(l=o[c],l?l.call(r,u):void 0!==a[c]&&(r[c]=u)))}return this},t.setDelta=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.deltaSetters,n=this.defs,r=this.state,o=r?r.deltaSetters:z,a=r?r.defs:z;let l,h,c,u;for(h=0;h<i;h++)c=e[h],u=t[c],c&&"name"!=c&&null!=u&&(me.indexOf(c)<0?(l=s[c],l?l.call(this,u):void 0!==n[c]&&(this[c]=B(this[c],u))):(l=o[c],l?l.call(r,u):void 0!==a[c]&&(r[c]=B(r[c],u))))}return this},t.entityInit=function(t=z){this.makeName(t.name),this.register(),this.initializePositions(),this.state=pe(z),this.set(this.defs),t.group||(t.group=qi),this.onEnter=Y,this.onLeave=Y,this.onDown=Y,this.onUp=Y,this.set(t),this.midInitActions(t),this.purge&&this.purgeArtefact(this.purge)},t.midInitActions=Y,t.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1,this.dirtyDimensions=!0),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.indexOf("mouse")>=0||this.lockTo.indexOf("particle")>=0)&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.anchor&&this.dirtyAnchorHold&&(this.dirtyAnchorHold=!1,this.buildAnchor(this.anchor))},t.cleanPathObject=Y,t.stamp=function(t=!1,e,i){let s=!(this.noFilters||!this.filters||!this.filters.length);return t?(e&&"Cell"===e.type&&(this.currentHost=e),i&&this.set(i),this.prepareStamp(),s?this.filteredStamp():this.regularStamp()):this.visibility?this.stashOutput||s?this.filteredStamp():this.regularStamp():void 0},t.regularStamp=function(){let t=this.currentHost;if(t){let e=t.engine,i=this.currentStampPosition,s=i[0],n=i[1];t.rotateDestination(e,s,n,this),this.noCanvasEngineUpdates||t.setEngine(this),this[this.method](e)}},t.filteredStamp=function(){!this.dirtyFilters&&this.currentFilters||this.cleanFilters();let t=this.currentHost,e=t.element,i=t.engine,s=t.currentDimensions,n=qe(),r=n.element,o=n.engine;this.currentHost=n;let a=r.width=s[0]||e.width,l=r.height=s[1]||e.height;if(a&&l){let s=this.noCanvasEngineUpdates;if(this.noCanvasEngineUpdates=!1,this.regularStamp(),!this.noFilters&&this.filters&&this.filters.length){this.isStencil&&(o.save(),o.globalCompositeOperation="source-in",o.globalAlpha=1,o.setTransform(1,0,0,1,0,0),o.drawImage(e,0,0),o.restore(),this.dirtyFilterIdentifier=!0),o.setTransform(1,0,0,1,0,0);let t=o.getImageData(0,0,a,l);this.preprocessFilters(this.currentFilters);let i=hi.action({identifier:this.filterIdentifier,image:t,filters:this.currentFilters});i&&(o.globalCompositeOperation="source-over",o.globalAlpha=1,o.setTransform(1,0,0,1,0,0),o.putImageData(i,0,0))}if(i.save(),i.globalAlpha=this.state&&this.state.globalAlpha?this.state.globalAlpha:1,i.globalCompositeOperation=this.state&&this.state.globalCompositeOperation?this.state.globalCompositeOperation:"source-over",i.setTransform(1,0,0,1,0,0),i.drawImage(r,0,0),this.stashOutput){this.stashOutput=!1;let[t,e,i,s]=this.getCellCoverage(o.getImageData(0,0,r.width,r.height));if(this.stashedImageData=o.getImageData(t,e,i,s),this.stashOutputAsAsset)if(this.stashOutputAsAsset=!1,r.width=i,r.height=s,o.putImageData(this.stashedImageData,0,0),this.stashedImage)this.stashedImage.src=r.toDataURL();else{let t=this.stashedImage=document.createElement("img");t.id=`${this.name}-image`,t.onload=function(){cs.appendChild(t),De(`#${t.id}`)},t.src=r.toDataURL()}}i.restore(),this.currentHost=t,this.noCanvasEngineUpdates=s}Qe(n)},t.getCellCoverage=function(t){let e,i,s=t.width,n=t.height,r=t.data,o=0,a=0,l=s,h=n,c=3;for(i=0;i<n;i++)for(e=0;e<s;e++)r[c]&&(l>e&&(l=e),o<e&&(o=e),h>i&&(h=i),a<i&&(a=i)),c+=4;return l<o&&h<a?[l,h,o-l,a-h]:[0,0,s,n]},t.simpleStamp=function(t,e=z){t&&"Cell"===t.type&&(this.currentHost=t,this.set(e),this.prepareStamp(),this.regularStamp())},t.draw=function(t){t.stroke(this.pathObject)},t.fill=function(t){t.fill(this.pathObject,this.winding)},t.drawAndFill=function(t){let e=this.pathObject;t.stroke(e),t.fill(e,this.winding),this.currentHost.clearShadow(),t.stroke(e),t.fill(e,this.winding)},t.fillAndDraw=function(t){let e=this.pathObject;t.fill(e,this.winding),t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(e)},t.drawThenFill=function(t){let e=this.pathObject;t.stroke(e),t.fill(e,this.winding)},t.fillThenDraw=function(t){let e=this.pathObject;t.fill(e,this.winding),t.stroke(e)},t.clip=function(t){t.clip(this.pathObject,this.winding)},t.clear=function(t){let e=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",t.fill(this.pathObject,this.winding),t.globalCompositeOperation=e},t.none=function(t){},t}v.Action=Action;const Block=function(t=z){return this.entityInit(t),t.dimensions||(t.width||(this.currentDimensions[0]=this.dimensions[0]=10),t.height||(this.currentDimensions[1]=this.dimensions[1]=10)),this};let Ps=Block.prototype=Object.create(Object.prototype);Ps.type="Block",Ps.lib="entity",Ps.isArtefact=!0,Ps.isAsset=!1,Ps=xt(Ps),Ps=Os(Ps),Ps.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){let t=this.pathObject=new Path2D,e=this.currentStampHandlePosition,i=this.currentScale,s=this.currentDimensions,n=-e[0]*i,r=-e[1]*i,o=s[0]*i,a=s[1]*i;t.rect(n,r,o,a)}};const xs=function(t){return!!t&&new Block(t)};v.Block=Block;const Ds={x:0,y:0},Rs=function(t,e,i){t.x=e,t.y=i},Fs=function(t,e){let i=Math.atan2(t.y,t.x);i+=.01745329251*e;let s=Math.sqrt(t.x*t.x+t.y*t.y);t.x=s*Math.cos(i),t.y=s*Math.sin(i)},Es=function(t,e,i){let s,n,r=[],o=[],a=[],l=[],h=0;if("linear"===t){let[t,e,a,l]=i;s=a-t,n=l-e,h=Math.sqrt(s*s+n*n),r=r.concat([t,a]),o=o.concat([e,l])}else if("bezier"===t||"quadratic"===t){let c,u,d,f,p,m,g="bezier"===t?"getBezierXY":"getQuadraticXY",y=!1,b=.25,S=0;for(;!y;){for(r.length=0,o.length=0,S=0,a.length=0,l.length=0,m=Is[g](0,...i),c=m.x,u=m.y,r.push(c),o.push(u),p=b;p<=1;p+=b)m=Is[g](p,...i),({x:d,y:f}=m),r.push(d),o.push(f),s=d-c,n=f-u,S+=Math.sqrt(s*s+n*n),c=d,u=f,a.push(S),l.push(p);S<h+e&&(y=!0),h=S,b/=2,b<.004&&(y=!0)}}return{length:h,xPoints:r,yPoints:o,positions:l,progression:a}},Is={getBezierXY:function(t,e,i,s,n,r,o,a,l){let h=1-t;return{x:Math.pow(h,3)*e+3*t*Math.pow(h,2)*s+3*t*t*h*r+t*t*t*a,y:Math.pow(h,3)*i+3*t*Math.pow(h,2)*n+3*t*t*h*o+t*t*t*l}},getQuadraticXY:function(t,e,i,s,n,r,o){let a=1-t;return{x:a*a*e+2*a*t*s+t*t*r,y:a*a*i+2*a*t*n+t*t*o}}};function Ms(t=z){(t=Os(t)).defs=tt(t.defs,{species:"",useAsPath:!1,precision:10,constantPathSpeed:!1,pathDefinition:"",showBoundingBox:!1,boundingBoxColor:"rgba(0,0,0,0.5)",minimumBoundingBoxDimensions:20}),t.packetExclusions=it(t.packetExclusions,["dimensions","pathed"]),t.packetExclusionsByRegex=it(t.packetExclusionsByRegex,[]),t.packetCoordinates=it(t.packetCoordinates,[]),t.packetObjects=it(t.packetObjects,[]),t.packetFunctions=it(t.packetFunctions,[]),t.finalizePacketOut=function(t,e){let i=JSON.parse(this.state.saveAsPacket(e))[3];return t=tt(t,i),t=this.handlePacketAnchor(t,e)},t.getters;let e=t.setters,s=t.deltaSetters;return e.species=function(t){nt(t)&&(this.species=t,this.updateDirty())},e.precision=function(t){nt(t)&&t.toFixed&&(this.precision=t,this.updateDirty())},e.constantPathSpeed=function(t){this.constantPathSpeed=t,this.updateDirty()},e.width=Y,e.height=Y,e.dimensions=Y,s.width=Y,s.height=Y,s.dimensions=Y,e.pathDefinition=function(t){t.substring&&(this.pathDefinition=t),this.pathCalculatedOnce=!1,this.dirtyPathObject=!0},t.updateDirty=function(){this.dirtySpecies=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},t.midInitActions=function(t){this.set(t)},t.shapeInit=function(t){this.entityInit(t),this.units=[],this.unitLengths=[],this.unitPartials=[],this.pathed=[],this.localBox=[]},t.positionPointOnPath=function(t){let e=gi(t);e.vectorSubtract(this.currentStampHandlePosition),this.flipReverse&&(e.x=-e.x),this.flipUpend&&(e.y=-e.y),e.rotate(this.roll),e.vectorAdd(this.currentStampPosition);let i={x:e.x,y:e.y};return yi(e),i},t.getBezierXY=function(t,e,i,s,n,r,o,a,l){let h=1-t;return{x:Math.pow(h,3)*e+3*t*Math.pow(h,2)*s+3*t*t*h*r+t*t*t*a,y:Math.pow(h,3)*i+3*t*Math.pow(h,2)*n+3*t*t*h*o+t*t*t*l}},t.getQuadraticXY=function(t,e,i,s,n,r,o){let a=1-t;return{x:a*a*e+2*a*t*s+t*t*r,y:a*a*i+2*a*t*n+t*t*o}},t.getLinearXY=function(t,e,i,s,n){return{x:e+(s-e)*t,y:i+(n-i)*t}},t.getBezierAngle=function(t,e,i,s,n,r,o,a,l){let h=1-t,c=Math.pow(h,2)*(s-e)+2*t*h*(r-s)+t*t*(a-r),u=Math.pow(h,2)*(n-i)+2*t*h*(o-n)+t*t*(l-o);return(-Math.atan2(c,u)+.5*Math.PI)/C},t.getQuadraticAngle=function(t,e,i,s,n,r,o){let a=1-t,l=2*a*(s-e)+2*t*(r-s),h=2*a*(n-i)+2*t*(o-n);return(-Math.atan2(l,h)+.5*Math.PI)/C},t.getLinearAngle=function(t,e,i,s,n){let r=s-e,o=n-i;return(-Math.atan2(r,o)+.5*Math.PI)/C},t.getConstantPosition=function(t){if(!t||!t.toFixed||isNaN(t))return 0;if(t>=1)return.9999;let e=this.unitPositions;if(e&&e.length){let e,i,s,n,r,o,a,l=this.length,h=this.unitProgression,c=this.unitPositions,u=t*l,d=-1;for(let t=0,e=h.length;t<e;t++)if(u<=h[t]){d=t-1;break}return d<0?(e=h[0],n=u/e*c[0]):(e=h[d],i=d?h[d-1]:0,s=e-i,r=c[d],o=c[d+1],a=o-r,n=r+(u-e)/s*a),n}return t},t.buildPathPositionObject=function(t,e){if(t){let i,s,[n,...r]=t;switch(n){case"linear":i=this.positionPointOnPath(this.getLinearXY(e,...r)),s=this.getLinearAngle(e,...r);break;case"quadratic":i=this.positionPointOnPath(this.getQuadraticXY(e,...r)),s=this.getQuadraticAngle(e,...r);break;case"bezier":i=this.positionPointOnPath(this.getBezierXY(e,...r)),s=this.getBezierAngle(e,...r)}let o=0;return this.flipReverse&&o++,this.flipUpend&&o++,1===o&&(s=-s),s+=this.roll,i.angle=s,i}return!1},t.getPathPositionData=function(t,e=!1){if(this.useAsPath&&nt(t)&&t.toFixed){let i,s,n,r,o,a,l=t%1,h=this.unitPartials,c=0;for(0===t?l=0:1===t&&(l=.9999),e&&(l=this.getConstantPosition(l)),n=0,r=h.length;n<r;n++)if(a=this.units[n][0],"move"!==a&&"close"!==a&&"unknown"!==a){if(i=h[n],l<=i){o=this.units[n],s=(l-c)/(i-c);break}c=i}return this.buildPathPositionObject(o,s)}return!1},t.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),(this.dirtyScale||this.dirtySpecies||this.dirtyDimensions||this.dirtyStart||this.dirtyHandle)&&(this.dirtyPathObject=!0,(this.dirtyScale||this.dirtySpecies)&&(this.pathCalculatedOnce=!1)),(this.isBeingDragged||this.lockTo.indexOf("mouse")>=0||this.lockTo.indexOf("particle")>=0)&&(this.dirtyStampPositions=!0),this.dirtyScale&&this.cleanScale(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyRotation&&this.cleanRotation(),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtySpecies&&this.cleanSpecies(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers()},t.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0},t.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){this.dirtyDimensions&&(this.cleanSpecies(),this.pathCalculatedOnce=!1),this.calculateLocalPath(this.pathDefinition),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyHandle&&this.cleanHandle(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions();let t=this.currentStampHandlePosition;this.pathObject=new Path2D(`m${-t[0]},${-t[1]}${this.localPath}`)}},t.calculateLocalPath=function(t,e){let i;if(this.pathCalculatedOnce||(i=function(t,e,i,s,n){let r,o,a,l,h=[],c=[],u="",d="",f=[],p=[],m=[],g=t.match(/([A-Za-z][0-9. ,\-]*)/g),y=0,b={},S=0,k=0,A=0,w=0,v=[],C=[],O=[],P=[],x=0,D=0,R=t=>{c.push({c:u.toLowerCase(),p:t||null,x:A,y:w,cx:S,cy:k,rx:x,ry:D}),s||(v.push(S),C.push(k)),A=S,w=k};for(r=0,o=g.length;r<o;r++)if(u=g[r][0],h=g[r].match(/(-?[0-9.]+\b)/g)||[],h.length){for(a=0,l=h.length;a<l;a++)h[a]=parseFloat(h[a]);switch(0===r?"M"===u&&(A=h[0]*e-i.x,w=h[1]*e-i.y,u="m"):(A=S,w=k),u){case"H":for(a=0,l=h.length;a<l;a++)h[a]=h[a]*e-A,S+=h[a],x=D=0,R(h.slice(a,a+1));break;case"V":for(a=0,l=h.length;a<l;a++)h[a]=h[a]*e-w,k+=h[a],x=D=0,R(h.slice(a,a+1));break;case"M":for(a=0,l=h.length;a<l;a+=2)h[a]=h[a]*e-A,h[a+1]=h[a+1]*e-w,S+=h[a],k+=h[a+1],x=D=0,R(h.slice(a,a+2));break;case"L":case"T":for(a=0,l=h.length;a<l;a+=2)h[a]=h[a]*e-A,h[a+1]=h[a+1]*e-w,S+=h[a],k+=h[a+1],"T"===u?(x=h[a]+A,D=h[a+1]+w):x=D=0,R(h.slice(a,a+2));break;case"Q":case"S":for(a=0,l=h.length;a<l;a+=4)h[a]=h[a]*e-A,h[a+1]=h[a+1]*e-w,h[a+2]=h[a+2]*e-A,h[a+3]=h[a+3]*e-w,S+=h[a+2],k+=h[a+3],x=h[a]+A,D=h[a+1]+w,R(h.slice(a,a+4));break;case"C":for(a=0,l=h.length;a<l;a+=6)h[a]=h[a]*e-A,h[a+1]=h[a+1]*e-w,h[a+2]=h[a+2]*e-A,h[a+3]=h[a+3]*e-w,h[a+4]=h[a+4]*e-A,h[a+5]=h[a+5]*e-w,S+=h[a+4],k+=h[a+5],x=h[a+2]+A,D=h[a+3]+w,R(h.slice(a,a+6));break;case"A":for(a=0,l=h.length;a<l;a+=7)h[a+5]=h[a+5]*e-A,h[a+6]=h[a+6]*e-w,S+=h[a+5],k+=h[a+6],x=D=0,R(h.slice(a,a+7));break;case"h":for(a=0,l=h.length;a<l;a++)h[a]*=e,S+=h[a],x=D=0,R(h.slice(a,a+1));break;case"v":for(a=0,l=h.length;a<l;a++)h[a]*=e,k+=h[a],x=D=0,R(h.slice(a,a+1));break;case"m":case"l":case"t":for(a=0,l=h.length;a<l;a+=2)h[a]*=e,h[a+1]*=e,S+=h[a],k+=h[a+1],"t"===u?(x=h[a]+A,D=h[a+1]+w):x=D=0,R(h.slice(a,a+2));break;case"q":case"s":for(a=0,l=h.length;a<l;a+=4)h[a]*=e,h[a+1]*=e,h[a+2]*=e,h[a+3]*=e,S+=h[a+2],k+=h[a+3],x=h[a]+A,D=h[a+1]+w,R(h.slice(a,a+4));break;case"c":for(a=0,l=h.length;a<l;a+=6)h[a]*=e,h[a+1]*=e,h[a+2]*=e,h[a+3]*=e,h[a+4]*=e,h[a+5]*=e,S+=h[a+4],k+=h[a+5],x=h[a+2]+A,D=h[a+3]+w,R(h.slice(a,a+6));break;case"a":for(a=0,l=h.length;a<l;a+=7)h[a]*=e,h[a+1]*=e,h[a+5]*=e,h[a+6]*=e,S+=h[a+5],k+=h[a+6],x=D=0,R(h.slice(a,a+7))}}else x=D=0,R();for(r=0,o=c.length;r<o;r++){let t=c[r],e=t.p;if(e){for(a=0,l=e.length;a<l;a++)e[a]=e[a].toFixed(1);for(d+=`${t.c}${t.p.join()}`,a=0,l=e.length;a<l;a++)e[a]=parseFloat(e[a])}else d+=`${t.c}`}if(b.localPath=d,s){let t=Ds;for(r=0,o=c.length;r<o;r++){let e=c[r],i=r>0&&c[r-1],{c:s,p:n,x:o,y:a,cx:l,cy:h,rx:u,ry:d}=e;if(n)switch(s){case"h":f[r]=["linear",o,a,n[0]+o,a];break;case"v":f[r]=["linear",o,a,o,n[0]+a];break;case"m":f[r]=["move",o,a];break;case"l":f[r]=["linear",o,a,n[0]+o,n[1]+a];break;case"t":i&&(i.rx||i.ry)?(Rs(t,i.rx-l,i.ry-h),Fs(t,180),f[r]=["quadratic",o,a,t.x+l,t.y+h,n[0]+o,n[1]+a]):f[r]=["quadratic",o,a,o,a,n[0]+o,n[1]+a];break;case"q":f[r]=["quadratic",o,a,n[0]+o,n[1]+a,n[2]+o,n[3]+a];break;case"s":i&&(i.rx||i.ry)?(Rs(t,i.rx-l,i.ry-h),Fs(t,180),f[r]=["bezier",o,a,t.x+l,t.y+h,n[0]+o,n[1]+a,n[2]+o,n[3]+a]):f[r]=["bezier",o,a,o,a,n[0]+o,n[1]+a,n[2]+o,n[3]+a];break;case"c":f[r]=["bezier",o,a,n[0]+o,n[1]+a,n[2]+o,n[3]+a,n[4]+o,n[5]+a];break;case"a":f[r]=["linear",o,a,n[5]+o,n[6]+a];break;case"z":isNaN(o)&&(o=0),isNaN(a)&&(a=0),f[r]=["close",o,a];break;default:isNaN(o)&&(o=0),isNaN(a)&&(a=0),f[r]=["unknown",o,a]}else f[r]=[`no-points-${s}`,o,a]}for(b.units=f,r=0,o=f.length;r<o;r++){let t,[e,...i]=f[r];switch(e){case"linear":case"quadratic":case"bezier":t=Es(e,n,i),p[r]=t.length,v=v.concat(t.xPoints),C=C.concat(t.yPoints),O.push(t.progression),P.push(t.positions);break;default:p[r]=0}}y=p.reduce(((t,e)=>t+e),0);let e=0;for(r=0,o=p.length;r<o;r++)e+=p[r]/y,m[r]=parseFloat(e.toFixed(6))}b.unitLengths=p,b.unitPartials=m,b.length=parseFloat(y.toFixed(1)),b.unitPositions=P,b.unitProgression=O;let F=Math.max(...v),E=Math.max(...C),I=Math.min(...v),M=Math.min(...C);return b.maxX=F,b.maxY=E,b.minX=I,b.minY=M,b.xRange=v,b.yRange=C,b}(t,this.currentScale,this.currentStart,this.useAsPath,this.precision),this.pathCalculatedOnce=!0),i){this.localPath=i.localPath,this.length=i.length;let t=i.maxX,s=i.maxY,n=i.minX,r=i.minY,o=this.dimensions,a=this.currentDimensions,l=this.localBox;if(o[0]=parseFloat((t-n).toFixed(1)),o[1]=parseFloat((s-r).toFixed(1)),o[0]===a[0]&&o[1]===a[1]||(a[0]=o[0],a[1]=o[1],this.dirtyHandle=!0),l.length=0,l.push(parseFloat(n.toFixed(1)),parseFloat(r.toFixed(1)),o[0],o[1]),this.useAsPath){const{units:t,unitLengths:e,unitPartials:s,unitProgression:n,unitPositions:r}=i;let o,a,l,h,c,u,d,f,p,m,g=0,y=[],b=[];for(c=0,u=e.length;c<u;c++)if(g+=e[c],l=n[c],l)for(a=s[c],o=s[c+1]-a,h=r[c],d=0,f=l.length;d<f;d++)p=g+l[d],y.push(parseFloat(p.toFixed(1))),m=a+h[d]*o,b.push(parseFloat(m.toFixed(6)));this.units=t,this.unitLengths=e,this.unitPartials=s,this.unitProgression=y,this.unitPositions=b}e||this.calculateLocalPathAdditionalActions()}},t.calculateLocalPathAdditionalActions=Y,t.updatePathSubscribers=function(){this.pathed.forEach((t=>{let e=i[t];e&&(e.currentPathData=!1,e.dirtyStart=!0,e.addPathHandle&&(e.dirtyHandle=!0),e.addPathOffset&&(e.dirtyOffset=!0),e.addPathRotation&&(e.dirtyRotation=!0),"Polyline"===e.type?e.dirtyPins=!0:"Line"!==e.type&&"Quadratic"!==e.type&&"Bezier"!==e.type||e.dirtyPins.push(this.name))}),this)},t.draw=function(t){t.stroke(this.pathObject),this.showBoundingBox&&this.drawBoundingBox(t)},t.fill=function(t){t.fill(this.pathObject,this.winding),this.showBoundingBox&&this.drawBoundingBox(t)},t.drawAndFill=function(t){let e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),this.showBoundingBox&&this.drawBoundingBox(t)},t.fillAndDraw=function(t){let e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(e),this.showBoundingBox&&this.drawBoundingBox(t)},t.drawThenFill=function(t){let e=this.pathObject;t.stroke(e),t.fill(e,this.winding),this.showBoundingBox&&this.drawBoundingBox(t)},t.fillThenDraw=function(t){let e=this.pathObject;t.fill(e,this.winding),t.stroke(e),this.showBoundingBox&&this.drawBoundingBox(t)},t.clear=function(t){let e=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",t.fill(this.pathObject,this.winding),t.globalCompositeOperation=e,this.showBoundingBox&&this.drawBoundingBox(t)},t.drawBoundingBox=function(t){t.save(),t.strokeStyle=this.boundingBoxColor,t.lineWidth=1,t.globalCompositeOperation="source-over",t.globalAlpha=1,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.strokeRect(...this.getBoundingBox()),t.restore()},t.getBoundingBox=function(){let t=Math.floor,e=Math.ceil,i=this.minimumBoundingBoxDimensions,[s,n,r,o]=this.localBox,[a,l]=this.currentStampHandlePosition,[h,c]=this.currentStampPosition;return r<i&&(r=i),o<i&&(o=i),[t(s-a),t(n-l),e(r),e(o),h,c]},t}const Ts=t=>"string"!=typeof t?"":t.charAt(0).toUpperCase()+t.slice(1);function Hs(t=z){t.defs=tt(t.defs,{end:null,endPivot:"",endPivotCorner:"",addEndPivotHandle:!1,addEndPivotOffset:!1,endPath:"",endPathPosition:0,addEndPathHandle:!1,addEndPathOffset:!0,endParticle:"",endLockTo:"",useStartAsControlPoint:!1}),t.packetExclusions=it(t.packetExclusions,["controlledLineOffset"]),t.packetExclusionsByRegex=it(t.packetExclusionsByRegex,[]),t.packetCoordinates=it(t.packetCoordinates,["end"]),t.packetObjects=it(t.packetObjects,["endPivot","endPath"]),t.packetFunctions=it(t.packetFunctions,[]),t.factoryKill=function(){Object.entries(i).forEach((([t,e])=>{e.name!==this.name&&(e.startControlPivot&&e.startControlPivot.name===this.name&&e.set({startControlPivot:!1}),e.controlPivot&&e.controlPivot.name===this.name&&e.set({controlPivot:!1}),e.endControlPivot&&e.endControlPivot.name===this.name&&e.set({endControlPivot:!1}),e.endPivot&&e.endPivot.name===this.name&&e.set({endPivot:!1}),e.startControlPath&&e.startControlPath.name===this.name&&e.set({startControlPath:!1}),e.controlPath&&e.controlPath.name===this.name&&e.set({controlPath:!1}),e.endControlPath&&e.endControlPath.name===this.name&&e.set({endControlPath:!1}),e.endPath&&e.endPath.name===this.name&&e.set({endPath:!1}))}))};let e=t.getters,s=t.setters,n=t.deltaSetters;return s.useStartAsControlPoint=function(t){if(this.useStartAsControlPoint=t,!t){let t=this.controlledLineOffset;t[0]=0,t[1]=0}this.updateDirty()},s.endPivot=function(t){this.setControlHelper(t,"endPivot","end"),this.updateDirty(),this.dirtyEnd=!0},s.endParticle=function(t){this.setControlHelper(t,"endParticle","end"),this.updateDirty(),this.dirtyEnd=!0},s.endPath=function(t){this.setControlHelper(t,"endPath","end"),this.updateDirty(),this.dirtyEnd=!0},s.endPathPosition=function(t){this.endPathPosition=t,this.dirtyEnd=!0,this.currentEndPathData=!1,this.dirtyFilterIdentifier=!0},n.endPathPosition=function(t){this.endPathPosition+=t,this.dirtyEnd=!0,this.currentEndPathData=!1,this.dirtyFilterIdentifier=!0},e.endPositionX=function(){return this.currentEnd[0]},e.endPositionY=function(){return this.currentEnd[1]},e.endPosition=function(){return[].concat(this.currentEnd)},s.endX=function(t){null!=t&&(this.end[0]=t,this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1)},s.endY=function(t){null!=t&&(this.end[1]=t,this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1)},s.end=function(t,e){this.setCoordinateHelper("end",t,e),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},n.endX=function(t){let e=this.end;e[0]=B(e[0],t),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},n.endY=function(t){let e=this.end;e[1]=B(e[1],t),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},n.end=function(t,e){this.setDeltaCoordinateHelper("end",t,e),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},s.endLockTo=function(t){this.endLockTo=t,this.updateDirty(),this.dirtyEndLock=!0,this.currentEndPathData=!1},t.curveInit=function(t){this.end=ke(),this.currentEnd=ke(),this.endLockTo="coord",this.dirtyEnd=!0,this.dirtyPins=[],this.controlledLineOffset=ke()},t.setControlHelper=function(t,e,s){if(Z(t)&&!t)this[e]=null,"startControl"===s?this.dirtyStartControlLock=!0:"control"===s?this.dirtyControlLock=!0:"endControl"===s?this.dirtyEndControlLock=!0:this.dirtyEndLock=!0;else if(t){let n=this[e],r=t.substring?i[t]:t;e.indexOf("Pivot")>0?r&&r.isArtefact&&(n&&n.isArtefact&&st(n.pivoted,this.name),it(r.pivoted,this.name),this[e]=r):e.indexOf("Path")>0?r&&r.isArtefact&&(n&&n.isArtefact&&st(n.pathed,this.name),it(r.pathed,this.name),this[e]=r):e.indexOf("Particle")>0&&(r=t.substring?f[t]:t,r||(this.updateDirty(),"startControl"===s?this.dirtyStartControl=!0:"control"===s?this.dirtyControl=!0:"endControl"===s?this.dirtyEndControl=!0:this.dirtyEnd=!0,this[e]=t))}},t.buildPathPositionObject=function(t,e){if(t){let i,s,[n,...r]=t;switch(n){case"linear":i=this.positionPointOnPath(this.getLinearXY(e,...r)),s=this.getLinearAngle(e,...r);break;case"quadratic":i=this.positionPointOnPath(this.getQuadraticXY(e,...r)),s=this.getQuadraticAngle(e,...r);break;case"bezier":i=this.positionPointOnPath(this.getBezierXY(e,...r)),s=this.getBezierAngle(e,...r)}let o=0;this.flipReverse&&o++,this.flipUpend&&o++,1===o&&(s=-s),s+=this.roll,this.currentStampPosition;let a=this.controlledLineOffset;return this.localBox,i.x+=a[0],i.y+=a[1],i.angle=s,i}return!1},t.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),this.dirtyPins.length&&this.preparePinsForStamp(),this.dirtyLock&&this.cleanLock(),this.dirtyStartControlLock&&this.cleanControlLock("startControl"),this.dirtyEndControlLock&&this.cleanControlLock("endControl"),this.dirtyControlLock&&this.cleanControlLock("control"),this.dirtyEndLock&&this.cleanControlLock("end"),(this.dirtyScale||this.dirtySpecies||this.dirtyDimensions||this.dirtyStart||this.dirtyStartControl||this.dirtyEndControl||this.dirtyControl||this.dirtyEnd||this.dirtyHandle)&&(this.dirtyPathObject=!0,this.useStartAsControlPoint&&this.dirtyStart&&(this.dirtySpecies=!0,this.pathCalculatedOnce=!1),(this.dirtyScale||this.dirtySpecies||this.dirtyStartControl||this.dirtyEndControl||this.dirtyControl||this.dirtyEnd)&&(this.pathCalculatedOnce=!1)),(this.isBeingDragged||this.lockTo.indexOf("mouse")>=0||this.lockTo.indexOf("particle")>=0)&&(this.dirtyStampPositions=!0,this.useStartAsControlPoint&&(this.dirtySpecies=!0,this.dirtyPathObject=!0,this.pathCalculatedOnce=!1)),this.dirtyScale&&this.cleanScale(),this.dirtyStart&&this.cleanStart(),(this.dirtyStartControl||"particle"===this.startControlLockTo)&&this.cleanControl("startControl"),(this.dirtyEndControl||"particle"===this.endControlLockTo)&&this.cleanControl("endControl"),(this.dirtyControl||"particle"===this.controlLockTo)&&this.cleanControl("control"),(this.dirtyEnd||"particle"===this.endLockTo)&&this.cleanControl("end"),this.dirtyOffset&&this.cleanOffset(),this.dirtyRotation&&this.cleanRotation(),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtySpecies&&this.cleanSpecies(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&(this.updatePositionSubscribers(),this.updateControlPathSubscribers())},t.cleanControlLock=function(t){let e=Ts(t);this[`dirty${e}Lock`]=!1,this[`dirty${e}`]=!0},t.cleanControl=function(t){let e=Ts(t);this[`dirty${e}`]=!1;let s,n,r=`${t}Path`,o=`${t}Particle`,a=this[`${t}Pivot`],l=this[r],h=this[o];a&&a.substring&&(s=i[a],s&&(a=s)),l&&l.substring&&(s=i[l],s&&(l=s)),h&&h.substring&&(s=f[h],s&&(h=s));let c,u,d,p,m,g,y,b=this[`${t}LockTo`],S=this[t],k=this[`current${e}`];switch(("pivot"!==b||a&&!a.substring)&&("path"!==b||l&&!l.substring)&&("particle"!==b||h&&!h.substring)||(b="coord"),b){case"pivot":this.pivotCorner&&a.getCornerCoordinate?[c,u]=a.getCornerCoordinate(this[`${t}PivotCorner`]):[c,u]=a.currentStampPosition,this.addPivotOffset||([d,p]=a.currentOffset,c-=d,u-=p);break;case"path":n=this.getControlPathData(l,t,e),c=n.x,u=n.y,this.addPathOffset||(c-=l.currentOffset[0],u-=l.currentOffset[1]);break;case"particle":c=h.position.x,u=h.position.y,this.pathCalculatedOnce=!1;break;case"mouse":m=this.getHere(),c=m.x||0,u=m.y||0;break;default:c=u=0,g=this.getHost(),g&&(y=g.currentDimensions,y&&(this.cleanPosition(k,S,y),[c,u]=k))}k[0]=c,k[1]=u,this.dirtySpecies=!0,this.dirtyPathObject=!0,this.dirtyPositionSubscribers=!0},t.getControlPathData=function(t,e,i){let s=this[`current${i}PathData`];if(s)return s;let n=this[`${e}PathPosition`],r=n,o=t.getPathPositionData(n);if(n<0&&(n+=1),n>1&&(n%=1),n=parseFloat(n.toFixed(6)),n!==r&&(this[`${e}PathPosition`]=n),o)return this[`current${i}PathData`]=o,o;{let t=this.getHost();if(t){let s=t.currentDimensions;if(s){let t=this[`current${i}`];return this.cleanPosition(t,this[e],s),{x:t[0],y:t[1]}}}return{x:0,y:0}}},t.updateControlPathSubscribers=function(){[].concat(this.endSubscriber,this.endControlSubscriber,this.controlSubscriber,this.startControlSubscriber).forEach((t=>{let e=i[t];e&&("Line"!==e.type&&"Quadratic"!==e.type&&"Bezier"!==e.type||("Quadratic"===e.type?(e.dirtyControl=!0,e.currentControlPathData=!1):"Bezier"===e.type&&(e.dirtyStartControl=!0,e.dirtyEndControl=!0,e.currentStartControlPathData=!1,e.currentEndControlPathData=!1),e.currentEndPathData=!1,e.dirtyEnd=!0),e.currentPathData=!1,e.dirtyStart=!0)}))},t}const Bezier=function(t=z){return this.startControl=ke(),this.endControl=ke(),this.currentStartControl=ke(),this.currentEndControl=ke(),this.startControlLockTo="coord",this.endControlLockTo="coord",this.curveInit(t),this.shapeInit(t),this.dirtyStartControl=!0,this.dirtyEndControl=!0,this};let Bs=Bezier.prototype=Object.create(Object.prototype);Bs.type="Bezier",Bs.lib="entity",Bs.isArtefact=!0,Bs.isAsset=!1,Bs=xt(Bs),Bs=Ms(Bs),Bs=Hs(Bs);Bs.defs=tt(Bs.defs,{startControl:null,startControlPivot:"",startControlPivotCorner:"",addStartControlPivotHandle:!1,addStartControlPivotOffset:!1,startControlPath:"",startControlPathPosition:0,addStartControlPathHandle:!1,addStartControlPathOffset:!0,startControlParticle:"",endControl:null,endControlPivot:"",endControlPivotCorner:"",addEndControlPivotHandle:!1,addEndControlPivotOffset:!1,endControlPath:"",endControlPathPosition:0,addEndControlPathHandle:!1,addEndControlPathOffset:!0,endControlParticle:"",startControlLockTo:"",endControlLockTo:""}),Bs.packetExclusions=it(Bs.packetExclusions,[]),Bs.packetExclusionsByRegex=it(Bs.packetExclusionsByRegex,[]),Bs.packetCoordinates=it(Bs.packetCoordinates,["startControl","endControl"]),Bs.packetObjects=it(Bs.packetObjects,["startControlPivot","startControlPath","endControlPivot","endControlPath"]),Bs.packetFunctions=it(Bs.packetFunctions,[]);let Ls=Bs.getters,$s=Bs.setters,js=Bs.deltaSetters;$s.endControlPivot=function(t){this.setControlHelper(t,"endControlPivot","endControl"),this.updateDirty(),this.dirtyEndControl=!0},$s.endControlParticle=function(t){this.setControlHelper(t,"endControlParticle","endControl"),this.updateDirty(),this.dirtyEndControl=!0},$s.endControlPath=function(t){this.setControlHelper(t,"endControlPath","endControl"),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},$s.endControlPathPosition=function(t){this.endControlPathPosition=t,this.dirtyEndControl=!0,this.currentEndControlPathData=!1,this.dirtyFilterIdentifier=!0},js.endControlPathPosition=function(t){this.endControlPathPosition+=t,this.dirtyEndControl=!0,this.currentEndControlPathData=!1,this.dirtyFilterIdentifier=!0},$s.startControlPivot=function(t){this.setControlHelper(t,"startControlPivot","startControl"),this.updateDirty(),this.dirtyStartControl=!0},$s.startControlParticle=function(t){this.setControlHelper(t,"startControlParticle","startControl"),this.updateDirty(),this.dirtyStartControl=!0},$s.startControlPath=function(t){this.setControlHelper(t,"startControlPath","startControl"),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},$s.startControlPathPosition=function(t){this.startControlPathPosition=t,this.dirtyStartControl=!0,this.currentStartControlPathData=!1,this.dirtyFilterIdentifier=!0},js.startControlPathPosition=function(t){this.startControlPathPosition+=t,this.dirtyStartControl=!0,this.currentStartControlPathData=!1,this.dirtyFilterIdentifier=!0},Ls.startControlPositionX=function(){return this.currentStartControl[0]},Ls.startControlPositionY=function(){return this.currentStartControl[1]},Ls.startControlPosition=function(){return[].concat(this.currentStartControl)},$s.startControlX=function(t){null!=t&&(this.startControl[0]=t,this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1)},$s.startControlY=function(t){null!=t&&(this.startControl[1]=t,this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1)},$s.startControl=function(t,e){this.setCoordinateHelper("startControl",t,e),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},js.startControlX=function(t){let e=this.startControl;e[0]=B(e[0],t),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},js.startControlY=function(t){let e=this.startControl;e[1]=B(e[1],t),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},js.startControl=function(t,e){this.setDeltaCoordinateHelper("startControl",t,e),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},Ls.endControlPositionX=function(){return this.currentEndControl[0]},Ls.endControlPositionY=function(){return this.currentEndControl[1]},Ls.endControlPosition=function(){return[].concat(this.currentEndControl)},$s.endControlX=function(t){null!=t&&(this.endControl[0]=t,this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1)},$s.endControlY=function(t){null!=t&&(this.endControl[1]=t,this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1)},$s.endControl=function(t,e){this.setCoordinateHelper("endControl",t,e),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},js.endControlX=function(t){let e=this.endControl;e[0]=B(e[0],t),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},js.endControlY=function(t){let e=this.endControl;e[1]=B(e[1],t),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},js.endControl=function(t,e){this.setDeltaCoordinateHelper("endControl",t,e),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},$s.startControlLockTo=function(t){this.startControlLockTo=t,this.updateDirty(),this.dirtyStartControlLock=!0},$s.endControlLockTo=function(t){this.endControlLockTo=t,this.updateDirty(),this.dirtyEndControlLock=!0,this.currentEndControlPathData=!1},Bs.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makeBezierPath(),this.pathDefinition=t},Bs.makeBezierPath=function(){let[t,e]=this.currentStampPosition,[i,s]=this.currentStartControl,[n,r]=this.currentEndControl,[o,a]=this.currentEnd;return`m0,0c${(i-t).toFixed(2)},${(s-e).toFixed(2)} ${(n-t).toFixed(2)},${(r-e).toFixed(2)} ${(o-t).toFixed(2)},${(a-e).toFixed(2)}`},Bs.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyStart=!0,this.dirtyStartControl=!0,this.dirtyEndControl=!0,this.dirtyEnd=!0,this.dirtyFilterIdentifier=!0},Bs.preparePinsForStamp=function(){const t=this.dirtyPins,e=this.endPivot,i=this.endPath,s=this.startControlPivot,n=this.startControlPath,r=this.endControlPivot,o=this.endControlPath;for(let a,l=0,h=t.length;l<h;l++)a=t[l],(s&&s.name==a||n&&n.name==a)&&(this.dirtyStartControl=!0,this.startControlLockTo.includes("path")&&(this.currentStartControlPathData=!1)),(r&&r.name==a||o&&o.name==a)&&(this.dirtyEndControl=!0,this.endControlLockTo.includes("path")&&(this.currentEndControlPathData=!1)),(e&&e.name==a||i&&i.name==a)&&(this.dirtyEnd=!0,this.endLockTo.includes("path")&&(this.currentEndPathData=!1));t.length=0};const Ys=function(t=z){return!!t&&(t.species="bezier",new Bezier(t))};v.Bezier=Bezier;const Cog=function(t=z){return this.shapeInit(t),this};let Xs=Cog.prototype=Object.create(Object.prototype);Xs.type="Cog",Xs.lib="entity",Xs.isArtefact=!0,Xs.isAsset=!1,Xs=xt(Xs),Xs=Ms(Xs);Xs.defs=tt(Xs.defs,{outerRadius:0,innerRadius:0,outerControlsDistance:0,innerControlsDistance:0,outerControlsOffset:0,innerControlsOffset:0,points:0,twist:0,curve:"bezier"});let Ns=Xs.setters,Gs=Xs.deltaSetters;Ns.outerRadius=function(t){this.outerRadius=t,this.updateDirty()},Gs.outerRadius=function(t){this.outerRadius+=t,this.updateDirty()},Ns.innerRadius=function(t){this.innerRadius=t,this.updateDirty()},Gs.innerRadius=function(t){this.innerRadius+=t,this.updateDirty()},Ns.outerControlsDistance=function(t){this.outerControlsDistance=t,this.updateDirty()},Gs.outerControlsDistance=function(t){this.outerControlsDistance+=t,this.updateDirty()},Ns.innerControlsDistance=function(t){this.innerControlsDistance=t,this.updateDirty()},Gs.innerControlsDistance=function(t){this.innerControlsDistance+=t,this.updateDirty()},Ns.outerControlsOffset=function(t){this.outerControlsOffset=t,this.updateDirty()},Gs.outerControlsOffset=function(t){this.outerControlsOffset+=t,this.updateDirty()},Ns.innerControlsOffset=function(t){this.innerControlsOffset=t,this.updateDirty()},Gs.innerControlsOffset=function(t){this.innerControlsOffset+=t,this.updateDirty()},Ns.points=function(t){this.points=t,this.updateDirty()},Gs.points=function(t){this.points+=t,this.updateDirty()},Ns.twist=function(t){this.twist=t,this.updateDirty()},Gs.twist=function(t){this.twist+=t,this.updateDirty()},Ns.curve=function(t){t&&["line","quadratic","bezier"].indexOf(t)>=0?(this.curve=t,this.updateDirty()):(this.curve="bezier",this.updateDirty())},Xs.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makeCogPath(),this.pathDefinition=t},Xs.makeCogPath=function(){let t,e,i,s,n,r,o,{points:a,twist:l,outerRadius:h,innerRadius:c,outerControlsDistance:u,innerControlsDistance:d,outerControlsOffset:f,innerControlsOffset:p,curve:m}=this,g=360/a,y=[],b="";if(h.substring||c.substring||u.substring||d.substring||f.substring||p.substring){let t=this.getHost();if(t){let[e,i]=t.currentDimensions;h=h.substring?parseFloat(h)/100*e:h,c=c.substring?parseFloat(c)/100*e:c,u=u.substring?parseFloat(u)/100*e:u,d=d.substring?parseFloat(d)/100*e:d,f=f.substring?parseFloat(f)/100*e:f,p=p.substring?parseFloat(p)/100*e:p}}let S=gi({x:0,y:-h}),k=gi({x:0,y:-c}),A=gi({x:u+f,y:-h}),w=gi({x:-d+p,y:-c}),v=gi({x:d+p,y:-c}),C=gi({x:-u+f,y:-h});if(w.rotate(-g/2),w.rotate(l),k.rotate(-g/2),k.rotate(l),v.rotate(-g/2),v.rotate(l),t=S.x,e=S.y,y.push(t),"bezier"==m)for(o=0;o<a;o++)i=parseFloat((A.x-t).toFixed(1)),s=parseFloat((A.y-e).toFixed(1)),b+=`${i},${s} `,w.rotate(g),k.rotate(g),v.rotate(g),i=parseFloat((w.x-t).toFixed(1)),s=parseFloat((w.y-e).toFixed(1)),b+=`${i},${s} `,i=parseFloat((k.x-t).toFixed(1)),t+=i,y.push(t),s=parseFloat((k.y-e).toFixed(1)),e+=s,b+=`${i},${s} `,i=parseFloat((v.x-t).toFixed(1)),s=parseFloat((v.y-e).toFixed(1)),b+=`${i},${s} `,C.rotate(g),S.rotate(g),A.rotate(g),i=parseFloat((C.x-t).toFixed(1)),s=parseFloat((C.y-e).toFixed(1)),b+=`${i},${s} `,i=parseFloat((S.x-t).toFixed(1)),t+=i,y.push(t),s=parseFloat((S.y-e).toFixed(1)),e+=s,b+=`${i},${s} `;else if("quadratic"==m)for(o=0;o<a;o++)i=parseFloat((A.x-t).toFixed(1)),s=parseFloat((A.y-e).toFixed(1)),b+=`${i},${s} `,k.rotate(g),v.rotate(g),i=parseFloat((k.x-t).toFixed(1)),t+=i,y.push(t),s=parseFloat((k.y-e).toFixed(1)),e+=s,b+=`${i},${s} `,i=parseFloat((v.x-t).toFixed(1)),s=parseFloat((v.y-e).toFixed(1)),b+=`${i},${s} `,S.rotate(g),A.rotate(g),i=parseFloat((S.x-t).toFixed(1)),t+=i,y.push(t),s=parseFloat((S.y-e).toFixed(1)),e+=s,b+=`${i},${s} `;else for(o=0;o<a;o++)i=parseFloat((A.x-t).toFixed(1)),t+=i,y.push(t),s=parseFloat((A.y-e).toFixed(1)),e+=s,b+=`${i},${s} `,w.rotate(g),k.rotate(g),v.rotate(g),i=parseFloat((w.x-t).toFixed(1)),t+=i,y.push(t),s=parseFloat((w.y-e).toFixed(1)),e+=s,b+=`${i},${s} `,i=parseFloat((k.x-t).toFixed(1)),t+=i,y.push(t),s=parseFloat((k.y-e).toFixed(1)),e+=s,b+=`${i},${s} `,i=parseFloat((v.x-t).toFixed(1)),t+=i,y.push(t),s=parseFloat((v.y-e).toFixed(1)),e+=s,b+=`${i},${s} `,C.rotate(g),S.rotate(g),A.rotate(g),i=parseFloat((C.x-t).toFixed(1)),t+=i,y.push(t),s=parseFloat((C.y-e).toFixed(1)),e+=s,b+=`${i},${s} `,i=parseFloat((S.x-t).toFixed(1)),t+=i,y.push(t),s=parseFloat((S.y-e).toFixed(1)),e+=s,b+=`${i},${s} `;return yi(S),n=Math.min(...y),r=Math.abs(n).toFixed(1),"bezier"==m?`m${r},0c${b}z`:"quadratic"==m?`m${r},0q${b}z`:`m${r},0l${b}z`};const zs=function(t){return!!t&&(t.species="cog",new Cog(t))};v.Cog=Cog;const Palette=function(t=z){return this.makeName(t.name),this.register(),this.factory=ni({name:`${this.name}-color-factory`}),this.set(this.defs),this.colors=t.colors||{"0 ":[0,0,0,1],"999 ":[255,255,255,1]},this.stops=Array(1e3),this.easingFunction=X,this.set(t),this.dirtyPalette=!0,this};let Ws=Palette.prototype=Object.create(Object.prototype);Ws.type="Palette",Ws.lib="palette",Ws.isArtefact=!1,Ws.isAsset=!1,Ws=xt(Ws);Ws.defs=tt(Ws.defs,{colors:null,stops:null,cyclic:!1,easing:"linear",easingFunction:null,precision:25}),Ws.packetFunctions=it(Ws.packetFunctions,["easingFunction"]),Ws.packetExclusions=it(Ws.packetExclusions,["stops"]),Ws.kill=function(){return this.factory&&this.factory.kill&&this.factory.kill(),this.deregister(),this};let Vs=Ws.getters,Zs=Ws.setters;Vs.colors=function(){const t=this.factory,e=[];if(t){const i=t.colorSpace;for(const[s,n]of Object.entries(this.colors))e.push([parseInt(s,10),t.buildColorString(...n,i)])}else e.push([0,"rgba(0 0 0 / 1)"],[999,"rgba(255 255 255 / 1)"]);return e},Zs.colors=function(t){if(Array.isArray(t)){let e=this.factory,i={},s=e.colorSpace.toLowerCase();t.forEach((t=>{let[n,r]=t;n.toFixed&&r.substring&&(e.convert(r),i[`${n} `]=[...e[s]])})),this.colors=i,this.dirtyPalette=!0}},Zs.easing=function(t){this.setEasingHelper(t)},Zs.easingFunction=Zs.easing,Ws.setEasing=function(t){return this.setEasingHelper(t),this},Ws.setEasingFunction=Ws.setEasing,Ws.setEasingHelper=function(t){q(t)?(this.easing="function",this.easingFunction=t):t.substring&&lt[t]?(this.easing=t,this.easingFunction=X):(this.easing="linear",this.easingFunction=X),this.dirtyPalette=!0},Vs.colorSpace=function(){return this.getColorSpace()},Zs.colorSpace=function(t){if(t.substring){const e=t.toUpperCase(),i=t.toLowerCase();if(["RGB","HSL","HWB","XYZ","LAB","LCH"].includes(e)){const t=Object.assign({},this.colors),s=this.factory.colorSpace;this.factory.set({colorSpace:e});for(const[e,n]of Object.entries(t)){const t=this.factory.buildColorString(...n,s);this.factory.setColor(t),this.colors[e].length=0,this.colors[e].push(...this.factory[i])}this.dirtyPalette=!0}}},Vs.returnColorAs=function(){return this.getReturnColorAs()},Zs.returnColorAs=function(t){this.factory.set({returnColorAs:t}),this.dirtyPalette=!0},Zs.precision=function(t){t=parseInt(t,10),(isNaN(t)||t<0)&&(t=0),t>50&&(t=50),this.precision=t,this.dirtyPalette=!0},Zs.stops=Y,Ws.getColorSpace=function(){return this.factory?this.factory.colorSpace:"RGB"},Ws.getReturnColorAs=function(){return this.factory?this.factory.returnColorAs:"RGB"},Ws.recalculateHold=[],Ws.recalculate=function(){this.dirtyPalette=!1;const{colors:t,stops:e,factory:i}=this;e.fill("rgba(0 0 0 / 0)");const{colorSpace:s}=i;let n=Object.keys(t);n=n.map((t=>parseInt(t,10))),n.sort(((t,e)=>t-e));let r,o,a,l,h=n[0],[c,u,d,f]=t[`${h} `];e[h]=i.returnColorFromValues(c,u,d,f);for(let c=0,u=n.length-1;c<u;c++){h=n[c],r=n[c+1],o=t[`${h} `],a=t[`${r} `],i.setMinimumColor(i.buildColorString(...o,s)),i.setMaximumColor(i.buildColorString(...a,s)),l=r-h;for(let t=h+1;t<=r;t++)e[t]=i.getRangeColor((t-h)/l,!0)}},Ws.updateColor=function(t,e){const i=this.factory,s=i.colorSpace.toLowerCase();rt(t,e)&&(t=t.substring?parseInt(t,10):Math.floor(t))>=0&&t<=999&&(i.convert(e),t+=" ",this.colors[t]=[...i[s]],this.dirtyPalette=!0)},Ws.removeColor=function(t){nt(t)&&(t=t.substring?parseInt(t,10):Math.floor(t))>=0&&t<=999&&(t+=" ",delete this.colors[t],this.dirtyPalette=!0)},Ws.addStopsToGradient=function(t,e,i,s){let n,r,o,a,l,h,{stops:c,easing:u,easingFunction:d,precision:f}=this,p=Object.keys(this.colors);if(t){p=p.map((t=>parseInt(t,10))),p.sort(((t,e)=>t-e)),rt(e,i)||(e=0,i=999);let m=d;"function"!==u&&lt[u]&&(m=lt[u]);const g=this.getColorSpace(),y=!(!f||"linear"===u&&"RGB"===g);if(e===i)return c[e]||"rgba(0 0 0 / 0)";if(e<i)if(t.addColorStop(0,c[e]),t.addColorStop(1,c[i]),n=i-e,y)for(o=e+1;o<i;o+=f)r=(o-e)/n,s&&(r>1?r-=1:r<0&&(r+=1)),r=m(r),r>0&&r<1&&t.addColorStop(r,c[o]);else for(o=0,a=p.length;o<a;o++)l=p[o],l>e&&l<i&&(r=(l-e)/n,s&&(r>1?r-=1:r<0&&(r+=1)),r>0&&r<1&&t.addColorStop(r,c[l]));else if(s)if(t.addColorStop(0,c[e]),t.addColorStop(1,c[i]),h=999-e,n=h+i,y)for(o=0;o<n;o+=f)l=o+e,l>999&&(l-=999),r=m(o/n),r>0&&r<1&&t.addColorStop(r,c[l]);else for(o=0,a=p.length;o<a;o++){if(l=p[o],999===l)r=(l-e-.01)/n;else if(l>e)r=(l-e)/n;else if(0===l)r=(l+h+.01)/n;else{if(!(l<i))continue;r=(l+h)/n}r>1?r-=1:r<0&&(r+=1),r>0&&r<1&&t.addColorStop(r,c[l])}else if(t.addColorStop(0,c[e]),t.addColorStop(1,c[i]),n=e-i,y)for(o=i+1;o<e;o+=f)o<e&&o>i&&(r=m(1-(o-i)/n),r>0&&r<1&&t.addColorStop(r,c[o]));else for(o=0,a=p.length;o<a;o++)l=p[o],l<e&&l>i&&(r=1-(l-i)/n,r>0&&r<1&&t.addColorStop(r,c[l]));return t}return"rgba(0 0 0 / 0)"};v.Palette=Palette;const Us=["colors","cyclic","stops"];function _s(t=z){t.defs=tt(t.defs,{start:null,end:null,palette:null,paletteStart:0,paletteEnd:999,cyclePalette:!1}),t.finalizePacketOut=function(t,e){return e.colors?t.colors=e.colors:this.palette?t.colors=this.palette.get("colors"):t.colors=[[0,"rgba(0 0 0 / 1)"],[999,"rgba(255 255 255 / 1)"]],e.easing?t.easing=e.easing:this.palette&&this.palette.easing?t.easing=this.palette.easing:t.easing="linear",nt(e.precision)?t.precision=e.precision:this.palette&&nt(this.palette.precision)?t.precision=this.palette.precision:t.precision=0,e.colorSpace?t.colorSpace=e.colorSpace:this.palette?t.colorSpace=this.palette.getColorSpace():t.colorSpace="RGB",e.returnColorAs?t.returnColorAs=e.returnColorAs:this.palette?t.returnColorAs=this.palette.getReturnColorAs():t.returnColorAs="RGB",t},t.kill=function(){let t=this.name;return this.palette&&this.palette.kill&&this.palette.kill(),Object.entries(h).forEach((([e,i])=>{let s=i.state;if(s){let e=s.fillStyle,i=s.strokeStyle;K(e)&&e.name===t&&(s.fillStyle=s.defs.fillStyle),K(i)&&i.name===t&&(s.strokeStyle=s.defs.strokeStyle)}})),this.deregister(),this};let e=t.getters,i=t.setters,s=t.deltaSetters;return e.startX=function(){return this.currentStart[0]},e.startY=function(){return this.currentStart[1]},i.startX=function(t){null!=t&&(this.start[0]=t,this.dirtyStart=!0)},i.startY=function(t){null!=t&&(this.start[1]=t,this.dirtyStart=!0)},i.start=function(t,e){this.setCoordinateHelper("start",t,e),this.dirtyStart=!0},s.startX=function(t){let e=this.start;e[0]=B(e[0],t),this.dirtyStart=!0},s.startY=function(t){let e=this.start;e[1]=B(e[1],t),this.dirtyStart=!0},s.start=function(t,e){this.setDeltaCoordinateHelper("start",t,e),this.dirtyStart=!0},e.endX=function(){return this.currentEnd[0]},e.endY=function(){return this.currentEnd[1]},i.endX=function(t){null!=t&&(this.end[0]=t,this.dirtyEnd=!0)},i.endY=function(t){null!=t&&(this.end[1]=t,this.dirtyEnd=!0)},i.end=function(t,e){this.setCoordinateHelper("end",t,e),this.dirtyEnd=!0},s.endX=function(t){let e=this.end;e[0]=B(e[0],t),this.dirtyEnd=!0},s.endY=function(t){let e=this.end;e[1]=B(e[1],t),this.dirtyEnd=!0},s.end=function(t,e){this.setDeltaCoordinateHelper("end",t,e),this.dirtyEnd=!0},i.palette=function(t=z){"Palette"===t.type&&(this.palette=t)},i.paletteStart=function(t){t.toFixed&&(this.paletteStart=t,(t<0||t>999)&&(this.paletteStart=t>500?999:0))},s.paletteStart=function(t){let e;t.toFixed&&(e=this.paletteStart+t,(e<0||e>999)&&(e=this.cyclePalette?e>500?e-1e3:e+1e3:t>500?999:0),this.paletteStart=e)},i.paletteEnd=function(t){t.toFixed&&(this.paletteEnd=t,(t<0||t>999)&&(this.paletteEnd=t>500?999:0))},s.paletteEnd=function(t){let e;t.toFixed&&(e=this.paletteEnd+t,(e<0||e>999)&&(e=this.cyclePalette?e>500?e-1e3:e+1e3:t>500?999:0),this.paletteEnd=e)},i.colors=function(t){Array.isArray(t)&&this.palette&&this.palette.set({colors:t})},i.easing=function(t){this.palette&&this.palette.set({easing:t})},i.easingFunction=i.easing,i.colorSpace=function(t){this.palette&&this.palette.set({colorSpace:t})},i.returnColorAs=function(t){this.palette&&this.palette.set({returnColorAs:t})},i.precision=function(t){this.palette&&this.palette.set({precision:t})},i.delta=function(t=z){t&&(this.delta=et(this.delta,t))},t.get=function(t){let e=this.getters[t];if(e)return e.call(this);{let e,i=this.defs[t],s=this.palette;return void 0!==i?(e=this[t],void 0!==e?e:i):(i=s.defs[t],void 0!==i?(e=s[t],void 0!==e?e:i):undef)}},t.set=function(t=z){let e=Object.keys(t),i=e.length;if(i){const s=this.setters,n=this.defs,r=this.palette;let o,a,l,h,c,u;for(r&&(o=r.setters||z,a=r.defs||z),h=0;h<i;h++)c=e[h],u=t[c],c&&"name"!=c&&null!=u&&(Us.indexOf(c)<0?(l=s[c],l?l.call(this,u):void 0!==n[c]&&(this[c]=u)):(l=o[c],l?l.call(r,u):void 0!==a[c]&&(r[c]=u)));this.dirtyFilterIdentifier=!0}return this},t.setDelta=function(t=z){let e=Object.keys(t),i=e.length;if(i){let s,n,r,o,a,l,h=this.deltaSetters,c=this.defs,u=this.palette;for(u&&(s=u.deltaSetters||z,n=u.defs||z),o=0;o<i;o++)a=e[o],l=t[a],a&&"name"!=a&&null!=l&&(Us.indexOf(a)<0?(r=h[a],r?r.call(this,l):void 0!==c[a]&&(this[a]=B(this[a],l))):(r=s[a],r?r.call(u,l):void 0!==n[a]&&(u[a]=B(this[a],l))));this.dirtyFilterIdentifier=!0}return this},t.setCoordinateHelper=function(t,e,i){let s=this[t];Array.isArray(e)?(s[0]=e[0],s[1]=e[1]):(s[0]=e,s[1]=i)},t.setDeltaCoordinateHelper=function(t,e,i){let s=this[t],n=s[0],r=s[1];Array.isArray(e)?(s[0]=B(n,e[0]),s[1]=B(r,e[1])):(s[0]=B(n,e),s[1]=B(r,i))},t.updateByDelta=function(){return this.setDelta(this.delta),this},t.stylesInit=function(t=z){this.makeName(t.name),this.register(),this.gradientArgs=[],this.start=ke(),this.end=ke(),this.currentStart=ke(),this.currentEnd=ke(),this.palette=function(t){return!!t&&new Palette(t)}({name:`${this.name}_palette`}),this.delta={},this.set(this.defs),this.set(t)},t.getData=function(t,e){return this.palette&&this.palette.dirtyPalette&&this.palette.recalculate(),this.cleanStyle(t,e),this.finalizeCoordinates(t),this.buildStyle(e)},t.cleanStyle=function(t=z,e=z){let i,s,n,r;t.lockFillStyleToEntity||t.lockStrokeStyleToEntity?(i=t.currentDimensions,r=t.currentScale,s=i[0]*r,n=i[1]*r):(i=e.currentDimensions,s=i[0],n=i[1]),this.cleanPosition(this.currentStart,this.start,[s,n]),this.cleanPosition(this.currentEnd,this.end,[s,n]),this.cleanRadius(s)},t.cleanPosition=function(t,e,i){let s,n;for(let r=0;r<2;r++)s=e[r],n=i[r],s.toFixed?t[r]=s:t[r]="left"===s||"top"===s?0:"right"===s||"bottom"===s?n:"center"===s?n/2:parseFloat(s)/100*n},t.finalizeCoordinates=function(t=z){this.currentStart,this.currentEnd;let e,i,s=t.currentStampPosition,n=t.currentStampHandlePosition,r=t.currentScale;t.lockFillStyleToEntity||t.lockStrokeStyleToEntity?(e=-n[0]*r||0,i=-n[1]*r||0):(e=-s[0]||0,i=-s[1]||0),this.updateGradientArgs(e,i)},t.cleanRadius=Y,t.buildStyle=function(t){return"rgba(0,0,0,0)"},t.addStopsToGradient=function(t,e,i,s){return this.palette?(this.dirtyFilterIdentifier=!0,this.palette.addStopsToGradient(t,e,i,s)):t},t.updateColor=function(t,e){return this.palette&&(this.dirtyFilterIdentifier=!0,this.palette.updateColor(t,e)),this},t.removeColor=function(t){return this.palette&&(this.dirtyFilterIdentifier=!0,this.palette.removeColor(t)),this},t}const ConicGradient=function(t=z){return this.stylesInit(t),this};let qs=ConicGradient.prototype=Object.create(Object.prototype);qs.type="ConicGradient",qs.lib="styles",qs.isArtefact=!1,qs.isAsset=!1,qs=xt(qs),qs=_s(qs);qs.defs=tt(qs.defs,{angle:0}),qs.packetObjects=it(qs.packetObjects,["palette"]),qs.buildStyle=function(t){if(t){let e=t.engine;if(e){if(!e.createConicGradient)return"rgba(0,0,0,0)";let t=e.createConicGradient(...this.gradientArgs);return this.addStopsToGradient(t,this.paletteStart,this.paletteEnd,this.cyclePalette)}}return"rgba(0,0,0,0)"},qs.updateGradientArgs=function(t,e){let i=this.gradientArgs,s=this.currentStart,n=this.angle*C,r=s[0]+t,o=s[1]+e;i.length=0,i.push(n,r,o)};const Qs=function(t){return!!t&&new ConicGradient(t)};v.ConicGradient=ConicGradient;const Crescent=function(t=z){return at(t.dimensions,t.width,t.height,t.radius)||(t.radius=5),this.entityInit(t),this};let Ks=Crescent.prototype=Object.create(Object.prototype);Ks.type="Crescent",Ks.lib="entity",Ks.isArtefact=!0,Ks.isAsset=!1,Ks=xt(Ks),Ks=Os(Ks);Ks.defs=tt(Ks.defs,{outerRadius:20,innerRadius:10,displacement:0,displayIntersect:!1}),Ks.getters;let Js=Ks.setters,tn=Ks.deltaSetters;Js.outerRadius=function(t){null!=t&&(this.outerRadius=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},tn.outerRadius=function(t){null!=t&&(this.outerRadius=addStrings(this.outerRadius,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},Js.innerRadius=function(t){null!=t&&(this.innerRadius=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},tn.innerRadius=function(t){null!=t&&(this.innerRadius=addStrings(this.innerRadius,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},Js.width=Js.outerRadius,tn.width=tn.outerRadius,Js.height=Js.innerRadius,tn.height=tn.innerRadius,Js.displacement=function(t){if(null!=t&&t.toFixed&&t>=0){let e=t;e<0&&(e=0),this.displacement=e,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0}},tn.displacement=function(t){if(null!=t&&t.toFixed){let e=addStrings(this.displacement,t);e.toFixed&&e<0&&(e=0),this.displacement=e,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0}},Js.displayIntersect=function(t){this.displayIntersect=t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Ks.cleanDimensionsAdditionalActions=function(){const{outerRadius:t,innerRadius:e,displacement:i}=this;let s,n=this.getHost();s=n?n.currentDimensions?n.currentDimensions:[n.w,n.h]:[300,150];let[r,o]=s;this.currentOuterRadius=t.substring?parseFloat(t)/100*r:t,this.currentInnerRadius=e.substring?parseFloat(e)/100*o:e,this.currentDisplacement=i.substring?parseFloat(i)/100*r:i,this.currentDimensions[0]=this.currentDimensions[1]=2*this.currentOuterRadius,this.dirtyPathObject=!0},Ks.calculateInterception=function(){rt(this.currentOuterRadius,this.currentInnerRadius,this.currentDisplacement)||this.cleanDimensionsAdditionalActions();const{currentOuterRadius:t,currentInnerRadius:e,currentDisplacement:i}=this;this.outerCircleStart=0,this.outerCircleEnd=360*C,this.innerCircleStart=0,this.innerCircleEnd=360*C,this.drawOuterCircle=!1,this.drawDonut=!1;let s=t+e,n=t-e;if(!n&&!i)this.drawOuterCircle=!0;else if(i>=s)this.drawOuterCircle=!0;else if(i<s&&i>n){let s,n,r=qe(),{engine:o,element:a}=r,l=be();for(a.width=a.width,o.fillStyle="black",o.save(),o.beginPath(),o.arc(0,0,t,0,2*Math.PI),l.setFromArray([e,0]),s=0;s<360&&(l.rotate(.5),!o.isPointInPath(l[0]+i,l[1]));s+=.5);for(o.restore(),o.save(),o.beginPath(),o.arc(i,0,e,0,2*Math.PI),l.setFromArray([t,0]),n=0;n<360&&(l.rotate(.5),o.isPointInPath(...l));n+=.5);o.restore(),this.outerCircleStart=-n*C,this.outerCircleEnd=n*C,this.innerCircleStart=s*C,this.innerCircleEnd=-s*C,Se(l),Qe(r)}else this.drawDonut=!0},Ks.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){this.calculateInterception();let{currentStampHandlePosition:t,currentScale:e,currentOuterRadius:i,currentInnerRadius:s,outerCircleStart:n,outerCircleEnd:r,innerCircleStart:o,innerCircleEnd:a,drawOuterCircle:l,currentDisplacement:h,displayIntersect:c}=this,u=this.pathObject=new Path2D;i*=e,s*=e,h*=e;let d=i-t[0]*e,f=i-t[1]*e;if(l)u.arc(d,f,i,n,r),u.closePath(),this.pathObjectOuter=!1,this.pathObjectInner=!1;else{let t=this.pathObjectOuter=new Path2D,e=this.pathObjectInner=new Path2D;c?u.arc(d,f,i,n,r):u.arc(d,f,i,n,r,!0),u.arc(d+h,f,s,o,a),u.closePath(),t.arc(d,f,i,n,r,!0),t.closePath(),e.arc(d+h,f,s,o,a),e.closePath()}}},Ks.draw=function(t){this.drawDonut?(t.stroke(this.pathObjectOuter),t.stroke(this.pathObjectInner)):t.stroke(this.pathObject)},Ks.fill=function(t){t.fill(this.pathObject,this.winding)},Ks.drawAndFill=function(t){if(this.drawDonut){let e=this.pathObject,i=this.pathObjectOuter,s=this.pathObjectInner;t.stroke(i),t.stroke(s),t.fill(e,this.winding),this.currentHost.clearShadow(),t.stroke(i),t.stroke(s),t.fill(e,this.winding)}else{let e=this.pathObject;t.stroke(e),t.fill(e,this.winding),this.currentHost.clearShadow(),t.stroke(e),t.fill(e,this.winding)}},Ks.fillAndDraw=function(t){if(this.drawDonut){let e=this.pathObject,i=this.pathObjectOuter,s=this.pathObjectInner;t.fill(e,this.winding),t.stroke(i),t.stroke(s),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(i),t.stroke(s)}else{let e=this.pathObject;t.fill(e,this.winding),t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(e)}},Ks.drawThenFill=function(t){if(this.drawDonut){let e=this.pathObject,i=this.pathObjectOuter,s=this.pathObjectInner;t.stroke(i),t.stroke(s),t.fill(e,this.winding)}else{let e=this.pathObject;t.stroke(e),t.fill(e,this.winding)}},Ks.fillThenDraw=function(t){if(this.drawDonut){let e=this.pathObject,i=this.pathObjectOuter,s=this.pathObjectInner;t.fill(e,this.winding),t.stroke(i),t.stroke(s)}else{let e=this.pathObject;t.fill(e,this.winding),t.stroke(e)}},Ks.clip=function(t){t.clip(this.pathObject,this.winding)},Ks.clear=function(t){let e=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",t.fill(this.pathObject,this.winding),t.globalCompositeOperation=e};const en=function(t){return!!t&&new Crescent(t)};v.Crescent=Crescent;const ParticleHistory=function(t){let e=[];return Object.setPrototypeOf(e,ParticleHistory.prototype),t&&e.set(t),e};let sn=ParticleHistory.prototype=Object.create(Array.prototype);sn.constructor=ParticleHistory,sn.type="ParticleHistory";const nn=[],rn=function(t){t&&"ParticleHistory"===t.type&&(t.length=0,nn.push(t),nn.length>100&&(nn.length=0))};v.ParticleHistory=ParticleHistory;const Particle=function(t=z){return this.makeName(t.name),this.register(),this.set(this.defs),this.initializePositions(),this.set(t),this};let on=Particle.prototype=Object.create(Object.prototype);on.type="Particle",on.lib="particle",on.isArtefact=!1,on.isAsset=!1,on=xt(on);on.defs=tt(on.defs,{position:null,velocity:null,load:null,history:null,historyLength:1,engine:"euler",forces:null,mass:1,fill:"#000000",stroke:"#000000"}),on.packetExclusions=it(on.packetExclusions,[]),on.packetExclusionsByRegex=it(on.packetExclusionsByRegex,["^(local|dirty|current)"]),on.packetCoordinates=it(on.packetCoordinates,[]),on.packetObjects=it(on.packetObjects,["position","velocity","acceleration"]),on.packetFunctions=it(on.packetFunctions,[]),on.factoryKill=function(){this.history.forEach((t=>rn(t)));g.forEach((t=>{let e=m[t];e.particleFrom&&e.particleFrom.name===this.name||e.particleTo&&(e.particleTo.name,this.name)})),[].forEach((t=>t.kill()))};let an=on.getters,ln=on.setters,hn=on.deltaSetters;an.positionX=function(){return this.position.x},an.positionY=function(){return this.position.y},an.positionZ=function(){return this.position.z},an.position=function(){let t=this.position;return[t.x,t.y,t.z]},ln.positionX=function(t){this.position.x=t},ln.positionY=function(t){this.position.y=t},ln.positionZ=function(t){this.position.z=t},ln.position=function(t){this.position.set(t)},hn.positionX=function(t){this.position.x+=t},hn.positionY=function(t){this.position.y+=t},hn.positionZ=function(t){this.position.z+=t},hn.position=Y,an.velocityX=function(){return this.velocity.x},an.velocityY=function(){return this.velocity.y},an.velocityZ=function(){return this.velocity.z},an.velocity=function(){let t=this.velocity;return[t.x,t.y,t.z]},ln.velocityX=function(t){this.velocity.x=t},ln.velocityY=function(t){this.velocity.y=t},ln.velocityZ=function(t){this.velocity.z=t},ln.velocity=function(t,e,i){this.velocity.set(t,e,i)},hn.velocityX=function(t){this.velocity.x+=t},hn.velocityY=function(t){this.velocity.y+=t},hn.velocityZ=function(t){this.velocity.z+=t},hn.velocity=Y,ln.forces=function(t){t&&(Array.isArray(t)?(this.forces.length=0,this.forces=this.forces.concat(t)):this.forces.push(t))},ln.load=Y,ln.history=Y,hn.load=Y,on.initializePositions=function(){this.initialPosition=bi(),this.position=bi(),this.velocity=bi(),this.load=bi(),this.forces=[],this.history=[],this.isRunning=!1},on.applyForces=function(t,e){this.load.zero(),this.isBeingDragged||this.forces.forEach((i=>{let s=p[i];s&&s.action&&s.action(this,t,e)}))},on.update=function(t,e){this.isBeingDragged?this.position.setFromVector(this.isBeingDragged).vectorAdd(this.dragOffset):pn[this.engine].call(this,t*e.tickMultiplier)},on.manageHistory=function(t,e){let{history:i,remainingTime:s,position:n,historyLength:r,hasLifetime:o,distanceLimit:a,initialPosition:l,killBeyondCanvas:h}=this,c=!0,u=0;if(o)if(u=s-t,u<=0){let t=i.pop();rn(t),c=!1,i.length||(this.isRunning=!1)}else this.remainingTime=u;let d=i[i.length-1];if(d){let[t,i,s,n]=d;if(h){let t=e.element.width,i=e.element.height;(s<0||n<0||s>t||n>i)&&(c=!1,this.isRunning=!1)}if(a){let t=gi(l);t.vectorSubtractArray([s,n,i]),t.getMagnitude()>a&&(c=!1,this.isRunning=!1),yi(t)}}if(c){let{x:t,y:e,z:s}=n,o=(nn.length||nn.push(new ParticleHistory),nn.shift());if(o.push(u,s,t,e),i.unshift(o),i.length>r){i.splice(r).forEach((t=>rn(t)))}}},on.run=function(t,e,i){this.hasLifetime=!1,t&&(this.remainingTime=t,this.hasLifetime=!0),this.distanceLimit=0,e&&(this.initialPosition.set(this.position),this.distanceLimit=e),this.killBeyondCanvas=i,this.isRunning=!0};const cn=function(t){return!!t&&new Particle(t)};v.Particle=Particle;const un=[],dn=function(t){un.length||un.push(new Particle);let e=un.shift();return e.set(t),e},fn=function(t){if(t&&"Particle"===t.type&&(t.history.forEach((t=>rn(t))),t.history.length=0,t.set(t.defs),un.push(t),un.length>50)){let t=[].concat(un);un.length=0,t.forEach((t=>t.kill()))}},pn={euler:function(t){let{position:e,velocity:i,load:s,mass:n}=this,r=gi(),o=gi(i);r.setFromVector(s).scalarDivide(n),o.vectorAdd(r.scalarMultiply(t)),i.setFromVector(o),e.vectorAdd(o.scalarMultiply(t)),yi(r)},"improved-euler":function(t){let{position:e,velocity:i,load:s,mass:n}=this,r=gi(),o=gi(),a=gi(),l=gi(i);r.setFromVector(s).scalarDivide(n).scalarMultiply(t),o.setFromVector(s).vectorAdd(r).scalarDivide(n).scalarMultiply(t),a.setFromVector(r).vectorAdd(o).scalarDivide(2),l.vectorAdd(a),i.setFromVector(l),e.vectorAdd(l.scalarMultiply(t)),yi(r)},"runge-kutta":function(t){let{position:e,velocity:i,load:s,mass:n}=this,r=gi(),o=gi(),a=gi(),l=gi(),h=gi(),c=gi(i);r.setFromVector(s).scalarDivide(n).scalarMultiply(t).scalarDivide(2),o.setFromVector(s).vectorAdd(r).scalarDivide(n).scalarMultiply(t).scalarDivide(2),a.setFromVector(s).vectorAdd(o).scalarDivide(n).scalarMultiply(t).scalarDivide(2),l.setFromVector(s).vectorAdd(a).scalarDivide(n).scalarMultiply(t).scalarDivide(2),o.scalarMultiply(2),a.scalarMultiply(2),h.setFromVector(r).vectorAdd(o).vectorAdd(a).vectorAdd(l).scalarDivide(6),c.vectorAdd(h),i.setFromVector(c),e.vectorAdd(c.scalarMultiply(t)),yi(r)}},Emitter=function(t=z){return this.makeName(t.name),this.register(),this.initializePositions(),this.set(this.defs),this.onEnter=Y,this.onLeave=Y,this.onDown=Y,this.onUp=Y,this.fillColorFactory=ni({name:`${this.name}-fillColorFactory`}),this.strokeColorFactory=ni({name:`${this.name}-strokeColorFactory`}),this.range=bi(),this.rangeFrom=bi(),this.preAction=Y,this.stampAction=Y,this.postAction=Y,this.particleStore=[],this.deadParticles=[],this.liveParticles=[],t.group||(t.group=qi),this.set(t),this.purge&&this.purgeArtefact(this.purge),this};let mn=Emitter.prototype=Object.create(Object.prototype);mn.type="Emitter",mn.lib="entity",mn.isArtefact=!0,mn.isAsset=!1,mn=xt(mn),mn=Os(mn);mn.defs=tt(mn.defs,{world:null,artefact:null,range:null,rangeFrom:null,generationRate:0,particleCount:0,generateAlongPath:null,generateInArea:null,generateFromExistingParticles:!1,generateFromExistingParticleHistories:!1,limitDirectionToAngleMultiples:0,generationChoke:15,killAfterTime:0,killAfterTimeVariation:0,killRadius:0,killRadiusVariation:0,killBeyondCanvas:!1,historyLength:1,forces:null,mass:1,massVariation:0,engine:"euler",hitRadius:10,showHitRadius:!1,hitRadiusColor:"#000000",resetAfterBlur:3}),mn.packetExclusions=it(mn.packetExclusions,["forces","particleStore","deadParticles","liveParticles","fillColorFactory","strokeColorFactory"]),mn.packetExclusionsByRegex=it(mn.packetExclusionsByRegex,[]),mn.packetCoordinates=it(mn.packetCoordinates,[]),mn.packetObjects=it(mn.packetObjects,["world","artefact","generateInArea","generateAlongPath"]),mn.packetFunctions=it(mn.packetFunctions,["preAction","stampAction","postAction"]),mn.finalizePacketOut=function(t,e){let i=e.forces||this.forces||!1;if(i){let e=[];i.forEach((t=>{t.substring?e.push(t):K(t)&&t.name&&e.push(t.name)})),t.forces=e}let s=[];return this.particleStore.forEach((t=>s.push(t.saveAsPacket()))),t.particleStore=s,t},mn.postCloneAction=function(t,e){return t},mn.factoryKill=function(t,e){this.isRunning=!1,t&&this.artefact.kill(),e&&this.world.kill(),this.fillColorFactory.kill(),this.strokeColorFactory.kill(),this.deadParticles.forEach((t=>t.kill())),this.liveParticles.forEach((t=>t.kill())),this.particleStore.forEach((t=>t.kill()))},mn.getters;let gn=mn.setters,yn=mn.deltaSetters;gn.rangeX=function(t){this.range.x=t},gn.rangeY=function(t){this.range.y=t},gn.rangeZ=function(t){this.range.z=t},gn.range=function(t){this.range.set(t)},gn.rangeFromX=function(t){this.rangeFrom.x=t},gn.rangeFromY=function(t){this.rangeFrom.y=t},gn.rangeFromZ=function(t){this.rangeFrom.z=t},gn.rangeFrom=function(t){this.rangeFrom.set(t)},gn.preAction=function(t){q(t)&&(this.preAction=t,this.dirtyFilterIdentifier=!0)},gn.stampAction=function(t){q(t)&&(this.stampAction=t,this.dirtyFilterIdentifier=!0)},gn.postAction=function(t){q(t)&&(this.postAction=t,this.dirtyFilterIdentifier=!0)},gn.world=function(t){let e;t.substring?e=y[t]:K(t)&&"World"===t.type&&(e=t),e&&(this.world=e)},gn.artefact=function(t){let e;t.substring?e=i[t]:K(t)&&t.isArtefact&&(e=t),e&&(this.artefact=e,this.dirtyFilterIdentifier=!0)},gn.generateAlongPath=function(t){let e;t.substring?e=i[t]:K(t)&&t.isArtefact&&(e=t),e&&e.useAsPath?this.generateAlongPath=e:this.generateAlongPath=!1,this.dirtyFilterIdentifier=!0},gn.generateInArea=function(t){let e;t.substring?e=i[t]:K(t)&&t.isArtefact&&(e=t),this.generateInArea=e||!1,this.dirtyFilterIdentifier=!0},gn.fillColor=function(t){this.fillColorFactory.set({color:t}),this.dirtyFilterIdentifier=!0},gn.fillMinimumColor=function(t){this.fillColorFactory.set({minimumColor:t}),this.dirtyFilterIdentifier=!0},gn.fillMaximumColor=function(t){this.fillColorFactory.set({maximumColor:t}),this.dirtyFilterIdentifier=!0},gn.strokeColor=function(t){this.strokeColorFactory.set({color:t}),this.dirtyFilterIdentifier=!0},gn.strokeMinimumColor=function(t){this.strokeColorFactory.set({minimumColor:t}),this.dirtyFilterIdentifier=!0},gn.strokeMaximumColor=function(t){this.strokeColorFactory.set({maximumColor:t}),this.dirtyFilterIdentifier=!0},gn.hitRadius=function(t){t.toFixed&&(this.hitRadius=t,this.width=this.height=2*t)},yn.hitRadius=function(t){t.toFixed&&(this.hitRadius+=t,this.width=this.height=2*this.hitRadius)},gn.width=function(t){t.toFixed&&(this.hitRadius=t/2,this.width=this.height=t)},yn.width=function(t){t.toFixed&&(this.hitRadius=t/2,this.width=this.height=t)},gn.height=gn.width,yn.height=yn.width,mn.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1,this.dirtyDimensions=!0),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.lockTo.indexOf("mouse")>=0||this.lockTo.indexOf("particle")>=0)&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions();let t=Date.now(),{particleStore:e,deadParticles:i,liveParticles:s,particleCount:n,generationRate:r,generatorChoke:o,resetAfterBlur:a}=this;o||(this.generatorChoke=o=t),e.forEach((t=>{t.isRunning?s.push(t):i.push(t)})),e.length=0,i.forEach((t=>fn(t))),i.length=0,e.push(...s),s.length=0;let l=t-o;if(l/1e3>a&&(l=0,this.generatorChoke=t),l>0&&r){let i=Math.floor(r/1e3*l);if(n){let t=n-e.length;t<=0?i=0:t<i&&(i=t)}i&&(this.addParticles(i),this.generatorChoke=t)}},mn.addParticles=function(t){const e=Math.random,i=function(t,i){return t+(e()*i*2-i)},s=function(t,i){return t+e()*i};let n,r,o,a,l=Date.now(),{historyLength:h,engine:c,forces:u,mass:d,massVariation:f,fillColorFactory:p,strokeColorFactory:m,range:g,rangeFrom:y,currentStampPosition:b,particleStore:S,killAfterTime:k,killAfterTimeVariation:A,killRadius:w,killRadiusVariation:v,killBeyondCanvas:C,currentRotation:O,generateAlongPath:P,generateInArea:x,generateFromExistingParticles:D,generateFromExistingParticleHistories:R,limitDirectionToAngleMultiples:F,generationChoke:E}=this,{x:I,y:M,z:T}=g,{x:H,y:B,z:L}=y;if(x){let g=this.currentHost;if(g){const y=g.element,{width:b,height:O}=y;x.pathObject&&!x.dirtyPathObject||x.cleanPathObject();const P=qe(),D=P.engine,R=be();let{pathObject:F,winding:$,currentStart:j}=x;[o,a]=j;const Y=t=>D.isPointInPath(F,...t,$);P.rotateDestination(D,o,a,x);t:for(n=0;n<t;n++){let t=!1;for(;!t;){if(l+E<Date.now())break t;R.set(e()*b,e()*O),Y(R)&&(t=!0)}r=dn(),r.set({positionX:R[0],positionY:R[1],positionZ:0,velocityX:s(H,I),velocityY:s(B,M),velocityZ:s(L,T),historyLength:h,engine:c,forces:u,mass:i(d,f),fill:p.getRangeColor(Math.random()),stroke:m.getRangeColor(Math.random())});let n=Math.abs(i(k,A)),o=Math.abs(i(w,v));r.run(n,o,C),S.push(r)}Qe(P),Se(R)}}else if(P){if(P.useAsPath){P.pathObject&&!P.dirtyPathObject||P.cleanPathObject();t:for(n=0;n<t;n++){let t=!1,n=!1;for(;!n;){if(l+E<Date.now())break t;t=P.getPathPositionData(e(),!0),t&&(n=!0)}r=dn(),r.set({positionX:t.x,positionY:t.y,positionZ:0,velocityX:s(H,I),velocityY:s(B,M),velocityZ:s(L,T),historyLength:h,engine:c,forces:u,mass:i(d,f),fill:p.getRangeColor(Math.random()),stroke:m.getRangeColor(Math.random())});let o=Math.abs(i(k,A)),a=Math.abs(i(w,v));r.run(o,a,C),S.push(r)}}}else if(R){let e,o,a,l,g,y,P=S.length,x=gi();for(n=0;n<t;n++){P?(o=S[Math.floor(Math.random()*P)],a=o.history,a&&a.length>1?([l,g,...y]=a[Math.floor(Math.random()*a.length)],y?x.setFromArray(y):x.setFromVector(o.position)):x.setFromVector(o.position)):x.setFromArray(b),r=dn(),r.set({positionX:x.x,positionY:x.y,positionZ:x.z,historyLength:h,engine:c,forces:u,mass:i(d,f),fill:p.getRangeColor(Math.random()),stroke:m.getRangeColor(Math.random())}),F?(x.zero(),e=Math.floor(360/F),x.x=s(H,I),x.rotate(Math.floor(Math.random()*e)*F),r.set({velocityX:x.x,velocityY:x.y,velocityZ:s(L,T)})):r.set({velocityX:s(H,I),velocityY:s(B,M),velocityZ:s(L,T)}),yi(x),r.velocity.rotate(O);let t=Math.abs(i(k,A)),n=Math.abs(i(w,v));r.run(t,n,C),S.push(r)}}else if(D){let e,o,a=S.length,l=gi();for(n=0;n<t;n++){a?(o=S[Math.floor(Math.random()*a)],l.setFromVector(o.position)):l.setFromArray(b),r=dn(),r.set({positionX:l.x,positionY:l.y,positionZ:l.z,historyLength:h,engine:c,forces:u,mass:i(d,f),fill:p.getRangeColor(Math.random()),stroke:m.getRangeColor(Math.random())}),F?(l.zero(),e=Math.floor(360/F),l.x=s(H,I),l.rotate(Math.floor(Math.random()*e)*F),r.set({velocityX:l.x,velocityY:l.y,velocityZ:s(L,T)})):r.set({velocityX:s(H,I),velocityY:s(B,M),velocityZ:s(L,T)}),yi(l),r.velocity.rotate(O);let t=Math.abs(i(k,A)),n=Math.abs(i(w,v));r.run(t,n,C),S.push(r)}}else for([o,a]=b,n=0;n<t;n++){r=dn(),r.set({positionX:o,positionY:a,positionZ:0,velocityX:s(H,I),velocityY:s(B,M),velocityZ:s(L,T),historyLength:h,engine:c,forces:u,mass:i(d,f),fill:p.getRangeColor(Math.random()),stroke:m.getRangeColor(Math.random())}),r.velocity.rotate(O);let t=Math.abs(i(k,A)),e=Math.abs(i(w,v));r.run(t,e,C),S.push(r)}},mn.regularStamp=function(){let{world:t,artefact:e,particleStore:i,preAction:s,stampAction:n,postAction:r,lastUpdated:o,resetAfterBlur:a,showHitRadius:l,hitRadius:h,hitRadiusColor:c,currentStampPosition:u}=this,d=this.currentHost,f=.016,p=Date.now();if(o&&(f=(p-o)/1e3),f>a&&(i.forEach((t=>fn(t))),i.length=0,f=.016),i.forEach((e=>e.applyForces(t,d))),i.forEach((e=>e.update(f,t))),s.call(this,d),i.forEach((t=>{t.manageHistory(f,d),n.call(this,e,t,d)})),r.call(this,d),l){let t=d.engine;t.save(),t.lineWidth=1,t.strokeStyle=c,t.setTransform(1,0,0,1,0,0),t.beginPath(),t.arc(u[0],u[1],h,0,2*Math.PI),t.stroke(),t.restore()}this.lastUpdated=p},mn.checkHit=function(t=[],e){if(this.noUserInteraction)return!1;let i,s,n=Array.isArray(t)?t:[t],r=this.currentStampPosition,o=!1;if(n.some((t=>{if(Array.isArray(t))i=t[0],s=t[1];else{if(!rt(t,t.x,t.y))return!1;i=t.x,s=t.y}if(!i.toFixed||!s.toFixed||isNaN(i)||isNaN(s))return!1;let e=gi(r).vectorSubtract(t);return e.getMagnitude()<this.hitRadius&&(o=!0),yi(e),o}),this)){return this.checkHitReturn(i,s,e)}return!1};const bn=function(t){return!!t&&new Emitter(t)};v.Emitter=Emitter;const Gradient=function(t=z){return this.stylesInit(t),this};let Sn=Gradient.prototype=Object.create(Object.prototype);Sn.type="Gradient",Sn.lib="styles",Sn.isArtefact=!1,Sn.isAsset=!1,Sn=xt(Sn),Sn=_s(Sn),Sn.packetObjects=it(Sn.packetObjects,["palette"]),Sn.buildStyle=function(t){if(t){let e=t.engine;if(e){let t=e.createLinearGradient(...this.gradientArgs);return this.addStopsToGradient(t,this.paletteStart,this.paletteEnd,this.cyclePalette)}}return"rgba(0,0,0,0)"},Sn.updateGradientArgs=function(t,e){let i=this.gradientArgs,s=this.currentStart,n=this.currentEnd,r=s[0]+t,o=s[1]+e,a=n[0]+t,l=n[1]+e;r===a&&o===l&&a++,i.length=0,i.push(r,o,a,l)};const kn=function(t){return!!t&&new Gradient(t)};v.Gradient=Gradient;const Filter=function(t=z){return this.makeName(t.name),this.register(),this.actions=[],this.set(t),this};let An=Filter.prototype=Object.create(Object.prototype);An.type="Filter",An.lib="filter",An.isArtefact=!1,An.isAsset=!1,An=xt(An);An.defs=tt(An.defs,{actions:null,method:"",lineIn:"",lineMix:"",lineOut:"",opacity:1,alpha:255,angle:0,areaAlphaLevels:null,asset:"",blend:"normal",blue:0,blueInBlue:0,blueColor:"rgba(0 0 0 / 1)",blueInGreen:0,blueInRed:0,channelX:"red",channelY:"green",clamp:0,compose:"source-over",copyHeight:1,copyWidth:1,copyX:0,copyY:0,concurrent:!1,easing:"linear",excludeAlpha:!0,excludeBlue:!1,excludeGreen:!1,excludeRed:!1,excludeTransparentPixels:!0,gradient:null,green:0,greenInBlue:0,greenColor:"rgba(0 0 0 / 1)",greenInGreen:0,greenInRed:0,gutterHeight:1,gutterWidth:1,height:1,highAlpha:255,highBlue:255,highColor:"rgba(255 255 255 / 1)",highGreen:255,highRed:255,includeAlpha:!1,includeBlue:!0,includeGreen:!0,includeRed:!0,innerRadius:0,keepOnlyChangedAreas:!1,level:0,lowAlpha:0,lowBlue:0,lowColor:"rgba(0 0 0 / 1)",lowGreen:0,lowRed:0,minimumColorDistance:1e3,noWrap:!1,offsetAlphaX:0,offsetAlphaY:0,offsetBlueX:0,offsetBlueY:0,offsetGreenX:0,offsetGreenY:0,offsetRedX:0,offsetRedY:0,offsetX:0,offsetY:0,offsetAlphaMin:0,offsetAlphaMax:0,offsetBlueMin:0,offsetBlueMax:0,offsetGreenMin:0,offsetGreenMax:0,offsetRedMin:0,offsetRedMax:0,offsetMin:0,offsetMax:0,opaqueAt:1,operation:"mean",outerRadius:"30%",palette:"black-white",passes:1,postProcessResults:!0,processHorizontal:!0,processVertical:!0,radius:1,ranges:null,red:0,redInBlue:0,redColor:"rgba(0 0 0 / 1)",redInGreen:0,redInRed:0,reference:"black",scaleX:1,scaleY:1,seed:"some-random-string-or-other",smoothing:0,startX:"50%",startY:"50%",step:1,strength:1,staticSwirls:null,tileHeight:1,tileWidth:1,tolerance:0,transparentAt:0,transparentEdges:!1,useBluenoise:!1,useMixedChannel:!0,useNaturalGrayscale:!1,weights:null,width:1}),An.kill=function(){let t=this.name;return Object.entries(h).forEach((([e,i])=>{let s=i.filters;s&&s.indexOf(t)>=0&&st(s,t)})),Object.entries(d).forEach((([e,i])=>{let s=i.filters;s&&s.indexOf(t)>=0&&st(s,t)})),Object.entries(a).forEach((([e,i])=>{let s=i.filters;s&&s.indexOf(t)>=0&&st(s,t)})),this.deregister(),this},An.setters,An.deltaSetters,An.set=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.setters,n=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&"name"!==a&&null!=l&&(r=s[a],r?r.call(this,l):void 0!==n[a]&&(this[a]=l))}return this.method&&wn[this.method]&&wn[this.method](this),this.dirtyFilterIdentifier=!0,this},An.setDelta=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.deltaSetters,n=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&"name"!==a&&null!=l&&(r=s[a],r?r.call(this,l):void 0!==n[a]&&(this[a]=addStrings(this[a],l)))}return this.method&&wn[this.method]&&wn[this.method](this),this.dirtyFilterIdentifier=!0,this};const wn={alphaToChannels:function(t){t.actions=[{action:"alpha-to-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,excludeRed:null==t.excludeRed||t.excludeRed,excludeGreen:null==t.excludeGreen||t.excludeGreen,excludeBlue:null==t.excludeBlue||t.excludeBlue}]},areaAlpha:function(t){t.actions=[{action:"area-alpha",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,tileWidth:null!=t.tileWidth?t.tileWidth:1,tileHeight:null!=t.tileHeight?t.tileHeight:1,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,gutterWidth:null!=t.gutterWidth?t.gutterWidth:1,gutterHeight:null!=t.gutterHeight?t.gutterHeight:1,areaAlphaLevels:null!=t.areaAlphaLevels?t.areaAlphaLevels:[255,0,0,0]}]},binary:function(t){let e=null!=t.lowRed?t.lowRed:0,i=null!=t.lowGreen?t.lowGreen:0,s=null!=t.lowBlue?t.lowBlue:0,n=null!=t.lowAlpha?t.lowAlpha:255,r=null!=t.highRed?t.highRed:255,o=null!=t.highGreen?t.highGreen:255,a=null!=t.highBlue?t.highBlue:255,l=null!=t.highAlpha?t.highAlpha:255,h=null!=t.low?t.low:[e,i,s,n],c=null!=t.high?t.high:[r,o,a,l];t.actions=[{action:"threshold",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,level:null!=t.level?t.level:128,red:null!=t.red?t.red:128,green:null!=t.green?t.green:128,blue:null!=t.blue?t.blue:128,alpha:null!=t.alpha?t.alpha:128,low:h,high:c,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,useMixedChannel:null!=t.useMixedChannel&&t.useMixedChannel}]},blend:function(t){t.actions=[{action:"blend",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",lineMix:null!=t.lineMix?t.lineMix:"",blend:null!=t.blend?t.blend:"normal",offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,opacity:null!=t.opacity?t.opacity:1}]},blue:function(t){t.actions=[{action:"average-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,excludeRed:!0,excludeGreen:!0}]},blur:function(t){t.actions=[{action:"blur",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,excludeTransparentPixels:null!=t.excludeTransparentPixels&&t.excludeTransparentPixels,processHorizontal:null==t.processHorizontal||t.processHorizontal,processVertical:null==t.processVertical||t.processVertical,radius:null!=t.radius?t.radius:1,passes:null!=t.passes?t.passes:1,step:null!=t.step?t.step:1}]},brightness:function(t){let e=null!=t.level?t.level:1;t.actions=[{action:"modulate-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,red:e,green:e,blue:e}]},channelLevels:function(t){t.actions=[{action:"lock-channels-to-levels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,red:null!=t.red?t.red:[0],green:null!=t.green?t.green:[0],blue:null!=t.blue?t.blue:[0],alpha:null!=t.alpha?t.alpha:[255]}]},channels:function(t){t.actions=[{action:"modulate-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,red:null!=t.red?t.red:1,green:null!=t.green?t.green:1,blue:null!=t.blue?t.blue:1,alpha:null!=t.alpha?t.alpha:1}]},channelstep:function(t){let e=null!=t.clamp?t.clamp:"down";["down","round","up"].includes(e)||(e="down"),t.actions=[{action:"step-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,clamp:e,red:null!=t.red?t.red:1,green:null!=t.green?t.green:1,blue:null!=t.blue?t.blue:1}]},channelsToAlpha:function(t){t.actions=[{action:"channels-to-alpha",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue}]},chroma:function(t){const e=[],i=[];null!=t.ranges&&t.ranges.forEach((t=>{6===t.length?e.push(t):2===t.length&&(t[0].substring&&t[1].substring&&(i.length=0,t.forEach((t=>{let[e,s,n]=window.scrawlEnvironmentColorChecker.extractRGBfromColor(t);i.push(e,s,n)}))),e.push(i))})),t.actions=[{action:"chroma",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,ranges:e}]},chromakey:function(t){let e=null!=t.red?t.red:0,i=null!=t.green?t.green:255,s=null!=t.blue?t.blue:0;null!=t.reference&&([e,i,s]=window.scrawlEnvironmentColorChecker.extractRGBfromColor(t.reference),t.red=e,t.green=i,t.blue=s,delete t.reference),t.actions=[{action:"colors-to-alpha",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,red:e,green:i,blue:s,transparentAt:null!=t.transparentAt?t.transparentAt:0,opaqueAt:null!=t.opaqueAt?t.opaqueAt:1}]},clampChannels:function(t){let e=null!=t.lowRed?t.lowRed:0,i=null!=t.lowGreen?t.lowGreen:0,s=null!=t.lowBlue?t.lowBlue:0,n=null!=t.highRed?t.highRed:255,r=null!=t.highGreen?t.highGreen:255,o=null!=t.highBlue?t.highBlue:255;null!=t.lowColor&&([e,i,s]=window.scrawlEnvironmentColorChecker.extractRGBfromColor(t.lowColor),t.lowRed=e,t.lowGreen=i,t.lowBlue=s,delete t.lowColor),null!=t.highColor&&([n,r,o]=window.scrawlEnvironmentColorChecker.extractRGBfromColor(t.highColor),t.highRed=n,t.highGreen=r,t.highBlue=o,delete t.highColor),t.actions=[{action:"clamp-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,lowRed:e,lowGreen:i,lowBlue:s,highRed:n,highGreen:r,highBlue:o}]},compose:function(t){t.actions=[{action:"compose",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",lineMix:null!=t.lineMix?t.lineMix:"",compose:null!=t.compose?t.compose:"source-over",offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,opacity:null!=t.opacity?t.opacity:1}]},corrode:function(t){t.actions=[{action:"corrode",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",width:null!=t.width?t.width:3,height:null!=t.height?t.height:3,offsetX:null!=t.offsetX?t.offsetX:1,offsetY:null!=t.offsetY?t.offsetY:1,includeRed:null!=t.includeRed&&t.includeRed,includeGreen:null!=t.includeGreen&&t.includeGreen,includeBlue:null!=t.includeBlue&&t.includeBlue,includeAlpha:null==t.includeAlpha||t.includeAlpha,operation:null!=t.operation?t.operation:"mean",opacity:null!=t.opacity?t.opacity:1}]},curveWeights:function(t){t.actions=[{action:"vary-channels-by-weights",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,weights:null!=t.weights&&t.weights,useMixedChannel:null==t.useMixedChannel||t.useMixedChannel}]},cyan:function(t){t.actions=[{action:"average-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeGreen:!0,includeBlue:!0,excludeRed:!0}]},displace:function(t){t.actions=[{action:"displace",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",lineMix:null!=t.lineMix?t.lineMix:"",opacity:null!=t.opacity?t.opacity:1,channelX:null!=t.channelX?t.channelX:"red",channelY:null!=t.channelY?t.channelY:"green",offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,scaleX:null!=t.scaleX?t.scaleX:1,scaleY:null!=t.scaleY?t.scaleY:1,transparentEdges:null!=t.transparentEdges&&t.transparentEdges}]},edgeDetect:function(t){t.actions=[{action:"matrix",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,width:3,height:3,offsetX:1,offsetY:1,includeRed:!0,includeGreen:!0,includeBlue:!0,includeAlpha:!1,weights:[0,1,0,1,-4,1,0,1,0]}]},emboss:function(t){const e=[];t.useNaturalGrayscale?e.push({action:"grayscale",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:"emboss-work"}):e.push({action:"average-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:"emboss-work",includeRed:!0,includeGreen:!0,includeBlue:!0}),t.clamp&&e.push({action:"clamp-channels",lineIn:"emboss-work",lineOut:"emboss-work",lowRed:0+t.clamp,lowGreen:0+t.clamp,lowBlue:0+t.clamp,highRed:255-t.clamp,highGreen:255-t.clamp,highBlue:255-t.clamp}),t.smoothing&&e.push({action:"gaussian-blur",lineIn:"emboss-work",lineOut:"emboss-work",radius:t.smoothing}),e.push({action:"emboss",lineIn:"emboss-work",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,angle:null!=t.angle?t.angle:0,strength:null!=t.strength?t.strength:1,tolerance:null!=t.tolerance?t.tolerance:0,keepOnlyChangedAreas:null!=t.keepOnlyChangedAreas&&t.keepOnlyChangedAreas,postProcessResults:null==t.postProcessResults||t.postProcessResults}),t.actions=e},flood:function(t){let e=null!=t.red?t.red:0,i=null!=t.green?t.green:0,s=null!=t.blue?t.blue:0,n=null!=t.alpha?t.alpha:255;null!=t.reference&&([e,i,s,n]=window.scrawlEnvironmentColorChecker.extractRGBfromColor(t.reference),n=Math.round(255*n),t.red=e,t.green=i,t.blue=s,t.alpha=n,delete t.reference),t.actions=[{action:"flood",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,red:e,green:i,blue:s,alpha:n}]},gaussianBlur:function(t){t.actions=[{action:"gaussian-blur",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,radius:null!=t.radius?t.radius:1}]},glitch:function(t){t.actions=[{action:"glitch",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,useMixedChannel:null==t.useMixedChannel||t.useMixedChannel,seed:null!=t.seed?t.seed:"some-random-string-or-other",step:null!=t.step?t.step:1,offsetMin:null!=t.offsetMin?t.offsetMin:0,offsetMax:null!=t.offsetMax?t.offsetMax:0,offsetRedMin:null!=t.offsetRedMin?t.offsetRedMin:0,offsetRedMax:null!=t.offsetRedMax?t.offsetRedMax:0,offsetGreenMin:null!=t.offsetGreenMin?t.offsetGreenMin:0,offsetGreenMax:null!=t.offsetGreenMax?t.offsetGreenMax:0,offsetBlueMin:null!=t.offsetBlueMin?t.offsetBlueMin:0,offsetBlueMax:null!=t.offsetBlueMax?t.offsetBlueMax:0,offsetAlphaMin:null!=t.offsetAlphaMin?t.offsetAlphaMin:0,offsetAlphaMax:null!=t.offsetAlphaMax?t.offsetAlphaMax:0,transparentEdges:null!=t.transparentEdges&&t.transparentEdges,level:null!=t.level?t.level:0}]},gray:function(t){t.actions=[{action:"average-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeGreen:!0,includeBlue:!0}]},grayscale:function(t){t.actions=[{action:"grayscale",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1}]},green:function(t){t.actions=[{action:"average-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,excludeRed:!0,excludeBlue:!0}]},image:function(t){t.actions=[{action:"process-image",lineOut:null!=t.lineOut?t.lineOut:"",asset:null!=t.asset?t.asset:"",width:null!=t.width?t.width:1,height:null!=t.height?t.height:1,copyWidth:null!=t.copyWidth?t.copyWidth:1,copyHeight:null!=t.copyHeight?t.copyHeight:1,copyX:null!=t.copyX?t.copyX:0,copyY:null!=t.copyY?t.copyY:0}]},invert:function(t){t.actions=[{action:"invert-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeGreen:!0,includeBlue:!0}]},magenta:function(t){t.actions=[{action:"average-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeBlue:!0,excludeGreen:!0}]},mapToGradient:function(t){t.gradient&&t.gradient.substring&&(t.gradient=k[t.gradient]),t.actions=[{action:"map-to-gradient",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,useNaturalGrayscale:null!=t.useNaturalGrayscale&&t.useNaturalGrayscale,gradient:t.gradient||kn()}]},matrix:function(t){t.actions=[{action:"matrix",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,width:3,height:3,offsetX:1,offsetY:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,weights:null!=t.weights?t.weights:[0,0,0,0,1,0,0,0,0]}]},matrix5:function(t){t.actions=[{action:"matrix",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,width:5,height:5,offsetX:2,offsetY:2,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,weights:null!=t.weights?t.weights:[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]}]},notblue:function(t){t.actions=[{action:"set-channel-to-level",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeBlue:!0,level:0}]},notgreen:function(t){t.actions=[{action:"set-channel-to-level",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeGreen:!0,level:0}]},notred:function(t){t.actions=[{action:"set-channel-to-level",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeRed:!0,level:0}]},offset:function(t){t.actions=[{action:"offset",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,offsetRedX:null!=t.offsetX?t.offsetX:0,offsetRedY:null!=t.offsetY?t.offsetY:0,offsetGreenX:null!=t.offsetX?t.offsetX:0,offsetGreenY:null!=t.offsetY?t.offsetY:0,offsetBlueX:null!=t.offsetX?t.offsetX:0,offsetBlueY:null!=t.offsetY?t.offsetY:0,offsetAlphaX:null!=t.offsetX?t.offsetX:0,offsetAlphaY:null!=t.offsetY?t.offsetY:0}]},offsetChannels:function(t){t.actions=[{action:"offset",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,offsetRedX:null!=t.offsetRedX?t.offsetRedX:0,offsetRedY:null!=t.offsetRedY?t.offsetRedY:0,offsetGreenX:null!=t.offsetGreenX?t.offsetGreenX:0,offsetGreenY:null!=t.offsetGreenY?t.offsetGreenY:0,offsetBlueX:null!=t.offsetBlueX?t.offsetBlueX:0,offsetBlueY:null!=t.offsetBlueY?t.offsetBlueY:0,offsetAlphaX:null!=t.offsetAlphaX?t.offsetAlphaX:0,offsetAlphaY:null!=t.offsetAlphaY?t.offsetAlphaY:0}]},pixelate:function(t){t.actions=[{action:"pixelate",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,tileWidth:null!=t.tileWidth?t.tileWidth:1,tileHeight:null!=t.tileHeight?t.tileHeight:1,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha}]},randomNoise:function(t){t.actions=[{action:"random-noise",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,width:null!=t.width?t.width:1,height:null!=t.height?t.height:1,seed:null!=t.seed?t.seed:"some-random-string-or-other",level:null!=t.level?t.level:0,noWrap:null!=t.noWrap&&t.noWrap,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null==t.includeAlpha||t.includeAlpha,excludeTransparentPixels:null==t.excludeTransparentPixels||t.excludeTransparentPixels}]},red:function(t){t.actions=[{action:"average-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,excludeGreen:!0,excludeBlue:!0}]},reducePalette:function(t){let e=null!=t.palette?t.palette:"black-white";t.actions=[],e.substring&&(e.includes(",")?(e=e.split(","),e.forEach((t=>t.trim()))):["black-white","monochrome-4","monochrome-8","monochrome-16"].includes(e)&&t.actions.push({action:"grayscale",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineIn?t.lineIn:"",opacity:1})),t.actions.push({action:"reduce-palette",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",seed:null!=t.seed?t.seed:"some-random-string-or-other",minimumColorDistance:null!=t.minimumColorDistance?t.minimumColorDistance:1e3,palette:e,useBluenoise:null!=t.useBluenoise&&t.useBluenoise,opacity:null!=t.opacity?t.opacity:1})},saturation:function(t){let e=null!=t.level?t.level:1;t.actions=[{action:"modulate-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,red:e,green:e,blue:e,saturation:!0}]},sepia:function(t){t.actions=[{action:"tint-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,redInRed:.393,redInGreen:.349,redInBlue:.272,greenInRed:.769,greenInGreen:.686,greenInBlue:.534,blueInRed:.189,blueInGreen:.168,blueInBlue:.131}]},sharpen:function(t){t.actions=[{action:"matrix",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,width:3,height:3,offsetX:1,offsetY:1,includeRed:!0,includeGreen:!0,includeBlue:!0,includeAlpha:!1,weights:[0,-1,0,-1,5,-1,0,-1,0]}]},swirl:function(t){let e=null!=t.startX?t.startX:"50%",i=null!=t.startY?t.startY:"50%",s=null!=t.innerRadius?t.innerRadius:0,n=null!=t.outerRadius?t.outerRadius:"30%",r=null!=t.angle?t.angle:0,o=null!=t.easing?t.easing:"linear";const a=[...null!=t.staticSwirls?t.staticSwirls:[]];a.push([e,i,s,n,r,o]),t.actions=[{action:"swirl",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,swirls:a}]},threshold:function(t){let e=null!=t.lowRed?t.lowRed:0,i=null!=t.lowGreen?t.lowGreen:0,s=null!=t.lowBlue?t.lowBlue:0,n=null!=t.lowAlpha?t.lowAlpha:255,r=null!=t.highRed?t.highRed:255,o=null!=t.highGreen?t.highGreen:255,a=null!=t.highBlue?t.highBlue:255,l=null!=t.highAlpha?t.highAlpha:255;null!=t.lowColor&&([e,i,s,n]=window.scrawlEnvironmentColorChecker.extractRGBfromColor(t.lowColor),n=Math.round(255*n),t.lowRed=e,t.lowGreen=i,t.lowBlue=s,t.lowAlpha=n,t.low=[e,i,s,n],delete t.lowColor),null!=t.highColor&&([r,o,a,l]=window.scrawlEnvironmentColorChecker.extractRGBfromColor(t.highColor),l=Math.round(255*l),t.highRed=r,t.highGreen=o,t.highBlue=a,t.highAlpha=l,t.high=[r,o,a,l],delete t.highColor);let h=null!=t.low?t.low:[e,i,s,n],c=null!=t.high?t.high:[r,o,a,l];t.actions=[{action:"threshold",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,level:null!=t.level?t.level:128,red:null!=t.red?t.red:128,green:null!=t.green?t.green:128,blue:null!=t.blue?t.blue:128,alpha:null!=t.alpha?t.alpha:128,low:h,high:c,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,useMixedChannel:null==t.useMixedChannel||t.useMixedChannel}]},tint:function(t){let e=null!=t.redInRed?t.redInRed:1,i=null!=t.redInGreen?t.redInGreen:0,s=null!=t.redInBlue?t.redInBlue:0,n=null!=t.greenInRed?t.greenInRed:0,r=null!=t.greenInGreen?t.greenInGreen:1,o=null!=t.greenInBlue?t.greenInBlue:0,a=null!=t.blueInRed?t.blueInRed:0,l=null!=t.blueInGreen?t.blueInGreen:0,h=null!=t.blueInBlue?t.blueInBlue:1;null!=t.redColor&&([e,n,a]=window.scrawlEnvironmentColorChecker.extractRGBfromColor(t.redColor),e/=255,n/=255,a/=255,t.redInRed=e,t.greenInRed=n,t.blueInRed=a,delete t.redColor),null!=t.greenColor&&([i,r,l]=window.scrawlEnvironmentColorChecker.extractRGBfromColor(t.greenColor),i/=255,r/=255,l/=255,t.redInGreen=i,t.greenInGreen=r,t.blueInGreen=l,delete t.greenColor),null!=t.blueColor&&([s,o,h]=window.scrawlEnvironmentColorChecker.extractRGBfromColor(t.blueColor),s/=255,o/=255,h/=255,t.redInBlue=s,t.greenInBlue=o,t.blueInBlue=h,delete t.blueColor),t.actions=[{action:"tint-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,redInRed:e,redInGreen:i,redInBlue:s,greenInRed:n,greenInGreen:r,greenInBlue:o,blueInRed:a,blueInGreen:l,blueInBlue:h}]},userDefined:function(t){t.actions=[{action:"user-defined-legacy",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1}]},yellow:function(t){t.actions=[{action:"average-channels",lineIn:null!=t.lineIn?t.lineIn:"",lineOut:null!=t.lineOut?t.lineOut:"",opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeGreen:!0,excludeBlue:!0}]}},vn=function(t){return!!t&&new Filter(t)};v.Filter=Filter;const Force=function(t=z){return this.makeName(t.name),this.register(),this.set(this.defs),this.set(t),this.action||(this.action=Y),this};let Cn=Force.prototype=Object.create(Object.prototype);Cn.type="Force",Cn.lib="force",Cn.isArtefact=!1,Cn.isAsset=!1,Cn=xt(Cn);Cn.defs=tt(Cn.defs,{action:null}),Cn.packetFunctions=it(Cn.packetFunctions,["action"]),Cn.kill=function(){return this.deregister(),!0},Cn.setters.action=function(t){q(t)?this.action=t:this.action=Y};const On=function(t){return!!t&&new Force(t)};v.Force=Force,On({name:"gravity",action:(t,e,i)=>{let{mass:s,load:n}=t,r=gi();r.setFromVector(e.gravity).scalarMultiply(s),n.vectorAdd(r),yi(r)}});const Grid=function(t=z){return this.tileFill=[],this.tileSources=[],this.entityInit(t),t.tileSources||(this.tileSources=[].concat([{type:"color",source:"#000000"},{type:"color",source:"#ffffff"}])),t.tileFill?Array.isArray(t.tileFill)&&this.tileFill.length===t.tileFill.length&&(this.tileFill=t.tileFill):(this.tileFill.length=this.columns*this.rows,this.tileFill.fill(0)),this.tilePaths=[],this.tileRealCoordinates=[],this.tileVirtualCoordinates=[],t.dimensions||(t.width||(this.currentDimensions[0]=this.dimensions[0]=20),t.height||(this.currentDimensions[1]=this.dimensions[1]=20)),this};let Pn=Grid.prototype=Object.create(Object.prototype);Pn.type="Grid",Pn.lib="entity",Pn.isArtefact=!0,Pn.isAsset=!1,Pn=xt(Pn),Pn=Os(Pn);Pn.defs=tt(Pn.defs,{columns:2,rows:2,columnGutterWidth:1,rowGutterWidth:1,tileSources:null,tileFill:null,gutterColor:"#808080"}),Pn.packetExclusions=it(Pn.packetExclusions,["tileSources"]),Pn.finalizePacketOut=function(t,e){let i=t.tileSources=[];this.tileSources.forEach((t=>{i.push({type:t.type,source:K(t.source)?t.source.name:t.source})})),K(t.gutterColor)&&(t.gutterColor=t.gutterColor.name);let s=JSON.parse(this.state.saveAsPacket(e))[3];return t=tt(t,s),t=this.handlePacketAnchor(t,e)},Pn.getters;let xn=Pn.setters,Dn=Pn.deltaSetters;xn.columns=function(t){if(Q(t)&&(Number.isInteger(t)||(t=parseInt(t,10)),t!==this.columns)){let e,i,s,n=this.tileFill,r=this.columns,o=[];for(this.columns=t,e=0,i=this.rows;e<i;e++)for(s=0;s<t;s++)s<r?o.push(n[e*r+s]):o.push(0);this.tileFill=o}this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Dn.columns=Y,xn.rows=function(t){if(Q(t)&&(Number.isInteger(t)||(t=parseInt(t,10)),t!==this.rows)){let e=this.rows;this.rows=t,this.tileFill.length=this.columns*t,e<t&&this.tileFill.fill(0,e*this.columns)}this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Dn.rows=Y,Pn.setAllTilesTo=function(t){return Q(t)&&(Number.isInteger(t)||(t=parseInt(t,10)),this.tileFill.fill(t),this.dirtyFilterIdentifier=!0),this},Pn.setTileFill=function(t){const{columns:e,rows:i}=this;return Array.isArray(t)&&t.length===e*i&&(this.tileFill=t,this.dirtyFilterIdentifier=!0),this},Pn.setTilesTo=function(t,e){let i=this.tileFill;return nt(t)&&Q(e)&&(Number.isInteger(e)||(e=parseInt(e,10)),Q(t)?i[t]=e:Array.isArray(t)&&t.forEach((t=>{Q(t)&&(i[t]=e)})),this.dirtyFilterIdentifier=!0),this},Pn.setTileSourceTo=function(t,e){return Q(t)&&K(e)&&e.type&&e.source&&(this.tileSources[t]=e),this},Pn.removeTileSource=function(t){return Q(t)&&t&&(this.tileSources[t]=null,this.tileFill=this.tileFill.map((e=>e===t?0:e))),this},Pn.getTileSource=function(t,e){if(Q(t))return Q(e)?this.tileFill[t*this.rows+e]:this.tileFill[t]},Pn.getTilesUsingSource=function(t){let e=[];return Q(t)&&this.tileFill.forEach(((i,s)=>i==t&&e.push(s))),e},Pn.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){let t=this.pathObject=new Path2D,e=new Path2D,i=new Path2D,s=this.currentStampHandlePosition,n=this.currentScale,r=this.currentDimensions,o=-s[0]*n,a=-s[1]*n,l=r[0]*n,h=r[1]*n;t.rect(o,a,l,h);let c,u,d,f,p=this.columns,m=this.rows,g=l/p,y=h/m,b=this.tilePaths,S=this.tileRealCoordinates,k=this.tileVirtualCoordinates;for(e.moveTo(o,a),e.lineTo(o+l,a),c=1;c<=m;c++){let t=a+c*y;e.moveTo(o,t),e.lineTo(o+l,t)}for(this.rowLines=e,i.moveTo(o,a),i.lineTo(o,a+h),u=1;u<=p;u++){let t=o+u*g;i.moveTo(t,a),i.lineTo(t,a+h)}for(this.columnLines=i,b.length=0,S.length=0,k.length=0,c=0;c<m;c++)for(u=0;u<p;u++){let t=new Path2D;d=u*g,f=c*y,t.rect(o+d,a+f,g,y),b.push(t),k.push([d,f]),S.push([o+d,a+f])}this.currentTileWidth=g,this.currentTileHeight=y}},Pn.performFill=function(t){t.save();let e,i=qe(),s=i.engine,n=i.element,r=this.tileSources,o=this.tileFill,a=this.tilePaths,l=this.tileRealCoordinates,c=this.tileVirtualCoordinates,u=this.winding,d=this.currentTileWidth,f=this.currentTileHeight,p=this.scale,m=this.currentDimensions;r.forEach(((r,g)=>{if(r&&r.type)switch(r.type){case"color":t.fillStyle=r.source;break;case"cellGradient":this.lockFillStyleToEntity=!1,t.fillStyle=r.source.getData(this,this.currentHost);break;case"gridGradient":this.lockFillStyleToEntity=!0,t.fillStyle=r.source.getData(this,this.currentHost)}let y=o.map((t=>t===g));if(y.length)switch(r.type){case"gridPicture":e=r.source.substring?h[r.source]:r.source,e.simpleStamp&&(n.width=m[0]*p,n.height=m[1]*p,s.globalCompositeOperation="source-over",s.fillStyle="#000000",y.forEach(((t,e)=>{t&&s.fillRect(c[e][0],c[e][1],d,f)})),s.globalCompositeOperation="source-in",e.simpleStamp(i,{startX:0,startY:0,width:m[0]*p,height:m[1]*p,method:"fill"}),t.drawImage(n,l[0][0],l[0][1]));break;case"tilePicture":e=r.source.substring?h[r.source]:r.source,e.simpleStamp&&(n.width=d,n.height=f,s.globalCompositeOperation="source-over",e.simpleStamp(i,{startX:0,startY:0,width:d,height:f,method:"fill"}),y.forEach(((e,i)=>e&&t.drawImage(n,l[i][0],l[i][1]))));break;default:y.forEach(((e,i)=>e&&t.fill(a[i],u)))}}));let g,y=this.gutterColor,b=this.rowGutterWidth,S=this.columnGutterWidth;if(nt(y)){switch(y.substring?g={type:"color",source:this.gutterColor}:K(y)?g=y:Q(y)&&K(r[y])&&(g=r[y]),g.type){case"cellGradient":this.lockFillStyleToEntity=!1,t.strokeStyle=g.source.getData(this,this.currentHost);break;case"gridGradient":this.lockFillStyleToEntity=!0,t.strokeStyle=g.source.getData(this,this.currentHost);break;case"color":t.strokeStyle=g.source}switch(g.type){case"gridPicture":case"tilePicture":if((b||S)&&(e=g.source.substring?h[g.source]:g.source,e.simpleStamp)){let r=this.currentStampHandlePosition,o=this.currentScale,a=r[0]*o,h=r[1]*o;n.width=m[0]*o,n.height=m[1]*o,s.globalCompositeOperation="source-over",s.strokeStyle="#000000",s.translate(a,h),b&&(s.lineWidth=b,s.stroke(this.rowLines)),S&&(s.lineWidth=S,s.stroke(this.columnLines)),s.globalCompositeOperation="source-in",e.simpleStamp(i,{startX:0,startY:0,width:m[0]*o,height:m[1]*o,method:"fill"}),t.drawImage(n,l[0][0],l[0][1]),s.translate(0,0)}break;default:b&&(t.lineWidth=b,t.stroke(this.rowLines)),S&&(t.lineWidth=S,t.stroke(this.columnLines))}}Qe(i),t.restore()},Pn.fill=function(t){this.performFill(t)},Pn.drawAndFill=function(t){let e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),this.performFill(t)},Pn.fillAndDraw=function(t){let e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),this.performFill(t),t.stroke(e)},Pn.drawThenFill=function(t){let e=this.pathObject;t.stroke(e),this.performFill(t)},Pn.fillThenDraw=function(t){let e=this.pathObject;this.performFill(t),t.stroke(e)},Pn.checkHit=function(t=[],e){if(this.noUserInteraction)return!1;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();let i=Array.isArray(t)?t:[t],s=!1;e||(e=qe(),s=!0);let n,r,o,a=e.engine,l=this.currentStampPosition,h=l[0],c=l[1],u=new Set,d=this.tilePaths;const f=t=>{let e,i;if(Array.isArray(t))e=t[0],i=t[1];else{if(!rt(t,t.x,t.y))return[!1];e=t.x,i=t.y}return!e.toFixed||!i.toFixed||isNaN(e)||isNaN(i)?[!1]:[!0,e,i]};return e.rotateDestination(a,h,c,this),i.some((t=>([n,r,o]=f(t),!!n&&a.isPointInPath(this.pathObject,r,o,this.winding))),this)?(i.forEach((t=>{[n,r,o]=f(t),n&&d.some(((t,e)=>!!a.isPointInPath(t,r,o,this.winding)&&(u.add(e),!0)))})),s&&Qe(e),{x:r,y:o,tiles:[...u],artefact:this}):(s&&Qe(e),!1)};const Rn=function(t){return!!t&&new Grid(t)};v.Grid=Grid;const Line=function(t=z){return this.curveInit(t),this.shapeInit(t),this};let Fn=Line.prototype=Object.create(Object.prototype);Fn.type="Line",Fn.lib="entity",Fn.isArtefact=!0,Fn.isAsset=!1,Fn=xt(Fn),Fn=Ms(Fn),Fn=Hs(Fn),Fn.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makeLinePath(),this.pathDefinition=t},Fn.makeLinePath=function(){let[t,e]=this.currentStampPosition,[i,s]=this.currentEnd;return`m0,0l${(i-t).toFixed(2)},${(s-e).toFixed(2)}`},Fn.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyStart=!0,this.dirtyEnd=!0},Fn.preparePinsForStamp=function(){const t=this.dirtyPins,e=this.endPivot,i=this.endPath;for(let s,n=0,r=t.length;n<r;n++)s=t[n],(e&&e.name==s||i&&i.name==s)&&(this.dirtyEnd=!0,this.endLockTo.includes("path")&&(this.currentEndPathData=!1));t.length=0};const En=function(t){return!!t&&(t.species="line",new Line(t))};v.Line=Line;const LineSpiral=function(t=z){return this.shapeInit(t),this};let In=LineSpiral.prototype=Object.create(Object.prototype);In.type="LineSpiral",In.lib="entity",In.isArtefact=!0,In.isAsset=!1,In=xt(In),In=Ms(In);In.defs=tt(In.defs,{startRadius:0,radiusIncrement:.1,radiusIncrementAdjust:1,startAngle:0,angleIncrement:5,angleIncrementAdjust:1,stepLimit:100});let Mn=In.setters,Tn=In.deltaSetters;Mn.startRadius=function(t){this.startRadius=t,this.updateDirty()},Tn.startRadius=function(t){this.startRadius+=t,this.updateDirty()},Mn.radiusIncrement=function(t){this.radiusIncrement=t,this.updateDirty()},Tn.radiusIncrement=function(t){this.radiusIncrement+=t,this.updateDirty()},Mn.radiusIncrementAdjust=function(t){this.radiusIncrementAdjust=t,this.updateDirty()},Tn.radiusIncrementAdjust=function(t){this.radiusIncrementAdjust+=t,this.updateDirty()},Mn.startAngle=function(t){this.startAngle=t,this.updateDirty()},Tn.startAngle=function(t){this.startAngle+=t,this.updateDirty()},Mn.angleIncrement=function(t){this.angleIncrement=t,this.updateDirty()},Tn.angleIncrement=function(t){this.angleIncrement+=t,this.updateDirty()},Mn.angleIncrementAdjust=function(t){this.angleIncrementAdjust=t,this.updateDirty()},Tn.angleIncrementAdjust=function(t){this.angleIncrementAdjust+=t,this.updateDirty()},Mn.stepLimit=function(t){this.stepLimit=t,this.updateDirty()},Tn.stepLimit=function(t){this.stepLimit+=t,this.updateDirty()},In.cleanSpecies=function(){this.dirtySpecies=!1;let t="m0,0";t=this.makeLineSpiralPath(),this.pathDefinition=t},In.makeLineSpiralPath=function(){let t="m0,0 m",{startRadius:e,radiusIncrement:i,radiusIncrementAdjust:s,startAngle:n,angleIncrement:r,angleIncrementAdjust:o,stepLimit:a}=this,l=be(),h=n,c=r,u=e,d=i,f=0;for(l.setFromArray([0,u]).rotate(h),t+=`${l[0].toFixed(1)},${l[1].toFixed(1)}l`;f<a;)f++,c*=o,h+=c,d*=s,u+=d,l.setFromArray([0,u]).rotate(h),t+=`${l[0].toFixed(1)},${l[1].toFixed(1)} `;return Se(l),t},In.calculateLocalPathAdditionalActions=function(){let[t,e,i,s]=this.localBox,n=this.scale;this.pathDefinition=this.pathDefinition.replace("m0,0 ",`m${-t/n},${-e/n}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Hn=function(t){return!!t&&(t.species="linespiral",new LineSpiral(t))};v.LineSpiral=LineSpiral;const Loom=function(t=z){return this.makeName(t.name),this.register(),this.state=pe(z),this.set(this.defs),t.group||(t.group=qi),this.onEnter=Y,this.onLeave=Y,this.onDown=Y,this.onUp=Y,this.delta={},this.set(t),this.fromPathData=[],this.toPathData=[],this.watchFromPath=null,this.watchIndex=-1,this.engineInstructions=[],this.engineDeltaLengths=[],this};let Bn=Loom.prototype=Object.create(Object.prototype);Bn.type="Loom",Bn.lib="entity",Bn.isArtefact=!0,Bn.isAsset=!1,Bn=xt(Bn),Bn=Te(Bn),Bn=Ye(Bn);Bn.defs=tt(Bn.defs,{fromPath:null,toPath:null,fromPathStart:0,fromPathEnd:1,toPathStart:0,toPathEnd:1,synchronizePathCursors:!0,loopPathCursors:!0,constantPathSpeed:!0,isHorizontalCopy:!0,showBoundingBox:!1,boundingBoxColor:"#000000",source:null,sourceIsVideoOrSprite:!1,interferenceLoops:2,interferenceFactor:1.03,visibility:!0,order:0,host:null,group:null,anchor:null,noCanvasEngineUpdates:!1,noDeltaUpdates:!1,onEnter:null,onLeave:null,onDown:null,onUp:null,noUserInteraction:!1,method:"fill"}),Bn.packetExclusions=it(Bn.packetExclusions,["pathObject","state"]),Bn.packetExclusionsByRegex=it(Bn.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),Bn.packetCoordinates=it(Bn.packetCoordinates,[]),Bn.packetObjects=it(Bn.packetObjects,["group","fromPath","toPath","source"]),Bn.packetFunctions=it(Bn.packetFunctions,["onEnter","onLeave","onDown","onUp"]),Bn.processPacketOut=function(t,e,i){let s=!0;return i.indexOf(t)<0&&e===this.defs[t]&&(s=!1),s},Bn.finalizePacketOut=function(t,e){let i=JSON.parse(this.state.saveAsPacket(e))[3];return t=tt(t,i),t=this.handlePacketAnchor(t,e)},Bn.handlePacketAnchor=function(t,e){if(this.anchor){let i=JSON.parse(this.anchor.saveAsPacket(e))[3];t.anchor=i}return t},Bn.clone=N;let Ln=Bn.getters,$n=Bn.setters,jn=Bn.deltaSetters;Bn.get=function(t){const e=this.getters[t];if(e)return e.call(this);{const e=this.defs[t],i=this.state;let s;return void 0!==e?(s=this[t],void 0!==s?s:e):(e=i.defs[t],void 0!==e?(s=i[t],void 0!==s?s:e):null)}},Bn.set=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.setters,n=this.defs,r=this.state,o=r?r.setters:z,a=r?r.defs:z;let l,h,c,u;for(h=0;h<i;h++)c=e[h],u=t[c],c&&"name"!=c&&null!=u&&(me.indexOf(c)<0?(l=s[c],l?l.call(this,u):void 0!==n[c]&&(this[c]=u)):(l=o[c],l?l.call(r,u):void 0!==a[c]&&(r[c]=u)))}return this},Bn.setDelta=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.deltaSetters,n=this.defs,r=this.state,o=r?r.deltaSetters:z,a=r?r.defs:z;let l,h,c,u;for(h=0;h<i;h++)c=e[h],u=t[c],c&&"name"!=c&&null!=u&&(me.indexOf(c)<0?(l=s[c],l?l.call(this,u):void 0!==n[c]&&(this[c]=addStrings(this[c],u))):(l=o[c],l?l.call(r,u):void 0!==a[c]&&(r[c]=addStrings(r[c],u))))}return this},$n.host=function(t){if(t){let e=i[t];e&&e.here?this.host=e.name:this.host=t}else this.host=""},Ln.group=function(){return this.group?this.group.name:""},$n.group=function(t){let e;t&&(this.group&&"Group"===this.group.type&&this.group.removeArtefacts(this.name),t.substring?(e=d[t],this.group=e||t):this.group=t),this.group&&"Group"===this.group.type&&this.group.addArtefacts(this.name)},Bn.getHere=function(){return currentCorePosition},$n.delta=function(t){t&&(this.delta=et(this.delta,t))},$n.fromPath=function(t){if(t){let e=this.fromPath,s=t.substring?i[t]:t,n=this.name;s&&s.name&&s.useAsPath&&(e&&e.name!==s.name&&removeItem(e.pathed,n),it(s.pathed,n),this.fromPath=s,this.dirtyStart=!0)}},$n.toPath=function(t){if(t){let e=this.toPath,s=t.substring?i[t]:t,n=this.name;s&&s.name&&s.useAsPath&&(e&&e.name!==s.name&&removeItem(e.pathed,n),it(s.pathed,n),this.toPath=s,this.dirtyStart=!0)}},$n.source=function(t){if((t=t.substring?i[t]:t)&&"Picture"===t.type){let e=this.source;e&&"Picture"===e.type&&e.imageUnsubscribe(this.name),this.source=t,t.imageSubscribe(this.name),this.dirtyInput=!0}},$n.isHorizontalCopy=function(t){this.isHorizontalCopy=!!t,this.dirtyPathData=!0},$n.synchronizePathCursors=function(t){this.synchronizePathCursors=!!t,t&&(this.toPathStart=this.fromPathStart,this.toPathEnd=this.fromPathEnd),this.dirtyPathData=!0},$n.loopPathCursors=function(t){if(this.loopPathCursors=!!t,t){let t,e=Math.floor;t=this.fromPathStart,(t<0||t>1)&&(this.fromPathStart=t-e(t)),t=this.fromPathEnd,(t<0||t>1)&&(this.fromPathEnd=t-e(t)),t=this.toPathStart,(t<0||t>1)&&(this.toPathStart=t-e(t)),t=this.toPathEnd,(t<0||t>1)&&(this.toPathEnd=t-e(t))}this.dirtyOutput=!0},$n.fromPathStart=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=Math.floor(t)),this.fromPathStart=t,this.synchronizePathCursors&&(this.toPathStart=t),this.dirtyPathData=!0},jn.fromPathStart=function(t){let e=this.fromPathStart+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=Math.floor(e)),this.fromPathStart=e,this.synchronizePathCursors&&(this.toPathStart=e),this.dirtyPathData=!0},$n.fromPathEnd=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=Math.floor(t)),this.fromPathEnd=t,this.synchronizePathCursors&&(this.toPathEnd=t),this.dirtyPathData=!0},jn.fromPathEnd=function(t){let e=this.fromPathEnd+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=Math.floor(e)),this.fromPathEnd=e,this.synchronizePathCursors&&(this.toPathEnd=e),this.dirtyPathData=!0},$n.toPathStart=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=Math.floor(t)),this.toPathStart=t,this.synchronizePathCursors&&(this.fromPathStart=t),this.dirtyPathData=!0},jn.toPathStart=function(t){let e=this.toPathStart+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=Math.floor(e)),this.toPathStart=e,this.synchronizePathCursors&&(this.fromPathStart=e),this.dirtyPathData=!0},$n.toPathEnd=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=Math.floor(t)),this.toPathEnd=t,this.synchronizePathCursors&&(this.fromPathEnd=t),this.dirtyPathData=!0},jn.toPathEnd=function(t){let e=this.toPathEnd+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=Math.floor(e)),this.toPathEnd=e,this.synchronizePathCursors&&(this.fromPathEnd=e),this.dirtyPathData=!0},Bn.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){let t=i[this.host];if(t)return this.currentHost=t,this.dirtyHost=!0,this.currentHost}return currentCorePosition},Bn.midInitActions=Y,Bn.update=function(){this.dirtyInput=!0,this.dirtyOutput=!0},Bn.prepareStamp=function(){let t=this.fromPath,e=this.toPath,[i,s,n,r]=this.getBoundingBox();if(!this.dirtyPathData){let{x:i,y:s}=t.getPathPositionData(0),{x:n,y:r}=t.getPathPositionData(1),{x:o,y:a}=e.getPathPositionData(0),{x:l,y:h}=e.getPathPositionData(1),c=[i,s,n,r,o,a,l,h];this.pathTests&&!this.pathTests.some(((t,e)=>t!==c[e]))||(this.pathTests=c,this.dirtyPathData=!0)}if(this.dirtyPathData||!this.fromPathData.length){this.dirtyPathData=!1,this.watchIndex=-1,this.engineInstructions.length=0,this.engineDeltaLengths.length=0;let n=Math.ceil,r=Math.max,o=Math.min,a=this.fromPathData;a.length=0;let l=this.toPathData;if(l.length=0,t&&e){let h,c,u,d,f=n(t.length),p=n(e.length);h=this.setSourceDimension(r(f,p));let m,g,y,b=this.fromPathStart,S=this.fromPathEnd,k=this.toPathStart,A=this.toPathEnd,w=this.constantPathSpeed;m=b<S?S-b:S+(1-b),m<.005&&(m=.005),g=k<A?A-k:A+(1-k),g<.005&&(g=.005),y=n(o(m,g)),c=1/(h*(1/y));for(let n=0;n<=1;n+=c)({x:u,y:d}=t.getPathPositionData(n,w)),a.push([u-i,d-s]),({x:u,y:d}=e.getPathPositionData(n,w)),l.push([u-i,d-s]);this.fromPathSteps=m/y,this.toPathSteps=g/y,this.watchFromPath=1===this.fromPathSteps,this.dirtyOutput=!0}else this.dirtyPathData=!0}this.sourceIsVideoOrSprite&&(this.dirtyInput=!0)},Bn.setSourceDimension=function(t){if(t)this.sourceDimension!==t&&(this.sourceDimension=t,this.dirtyInput=!0);else{let t=this.fromPath,e=this.toPath;if(t&&e){let i=Math.ceil,s=i(t.length),n=i(e.length),r=Math.max(s,n);this.sourceDimension!==r&&(this.sourceDimension=r)}else this.sourceDimension=0}return this.sourceDimension},Bn.simpleStamp=function(t,e){t&&"Cell"===t.type&&(this.currentHost=t,e&&(this.set(e),this.prepareStamp()),this.regularStamp())},Bn.stamp=function(t=!1,e,i){if(t)return e&&"Cell"===e.type&&(this.currentHost=e),i&&(this.set(i),this.prepareStamp()),this.regularStamp();if(this.visibility){let t=this.dirtyInput,e=this.dirtyOutput;t&&(this.sourceImageData=this.cleanInput()),e&&(this.output=this.cleanOutput()),this.regularStamp()}},Bn.cleanInput=function(){this.dirtyInput=!1,this.setSourceDimension();let t=this.sourceDimension;if(!t)return this.dirtyInput=!0,!1;let e=qe(),i=e.engine,s=e.element;return s.width=t,s.height=t,i.setTransform(1,0,0,1,0,0),this.source.stamp(!0,e,{startX:0,startY:0,handleX:0,handleY:0,offsetX:0,offsetY:0,roll:0,scale:1,width:t,height:t,method:"fill"}),i.getImageData(0,0,t,t)},Bn.cleanOutput=function(){this.dirtyOutput=!1,this.setSourceDimension();let t=this.sourceDimension,e=this.sourceImageData;if(t&&e){let i,s,n,r,o,a,l,h,c,u,d,f=Math.hypot,p=Math.floor,m=Math.ceil,g=Math.atan2,y=Math.cos,b=Math.sin,S=this.fromPathData,k=this.toPathData,A=S.length,w=this.fromPathStart*A,v=this.fromPathSteps||1,C=this.toPathStart*A,O=this.toPathSteps||1,P=.5*Math.PI,x=P-1.5708,D=this.isHorizontalCopy,R=this.loopPathCursors,F=this.watchFromPath,E=this.watchIndex,I=this.engineInstructions,M=this.engineDeltaLengths,[T,H,B,L]=this.getBoundingBox(),$=qe(),j=$.engine,Y=$.element;Y.width=t,Y.height=t,j.setTransform(1,0,0,1,0,0),j.putImageData(e,0,0);let X=qe(),N=X.engine,G=X.element;if(G.width=B,G.height=L,N.globalAlpha=this.state.globalAlpha,N.setTransform(1,0,0,1,0,0),!I.length){for(let e=0;e<t;e++)E<0&&(F&&w<1||!F&&C<1)&&(E=e),w<A&&C<A&&w>=0&&C>=0?([i,s]=S[p(w)],[n,r]=k[p(C)],o=n-i,a=r-s,l=f(o,a),D?(h=-g(o,a)+P,c=y(h),u=b(h),I.push([c,u,-u,c,i,s]),M.push(l)):(h=-g(o,a)+x,c=y(h),u=b(h),I.push([c,u,-u,c,i,s,l]),M.push(l))):(I.push(!1),M.push(!1)),w+=v,C+=O,R&&(w>=A&&(w-=A),C>=A&&(C-=A));E<0&&(E=0),this.watchIndex=E}if(D)for(let e=0;e<t;e++)d=I[E],d&&(N.setTransform(...d),N.drawImage(Y,0,E,t,1,0,0,M[E],1)),E++,E>=t&&(E=0);else for(let e=0;e<t;e++)d=I[E],d&&(N.setTransform(...d),N.drawImage(Y,E,0,1,t,0,0,1,M[E])),E++,E>=t&&(E=0);let z=this.interferenceFactor,W=this.interferenceLoops,V=m(B*z),Z=m(L*z);Y.width=V,Y.height=Z,N.setTransform(1,0,0,1,0,0),j.setTransform(1,0,0,1,0,0);for(let t=0;t<W;t++)j.drawImage(G,0,0,B,L,0,0,V,Z),N.drawImage(Y,0,0,V,Z,0,0,B,L);let U=N.getImageData(0,0,B,L);return Qe($),Qe(X),this.dirtyTargetImage=!0,U}return!1},Bn.regularStamp=function(){let t=this.currentHost;if(t){let e=t.engine;this.noCanvasEngineUpdates||t.setEngine(this),this[this.method](e)}},Bn.getBoundingBox=function(){let t=this.fromPath,e=this.toPath;if(t&&e){if(this.dirtyStart)if(t.getBoundingBox&&e.getBoundingBox){this.dirtyStart=!1;let[i,s,n,r,o,a]=t.getBoundingBox(),[l,h,c,u,d,f]=e.getBoundingBox();(isNaN(i)||isNaN(s)||isNaN(n)||isNaN(r)||isNaN(o)||isNaN(a)||isNaN(l)||isNaN(h)||isNaN(c)||isNaN(u)||isNaN(d)||isNaN(f))&&(this.dirtyStart=!0),i==l&&s==h&&n==c&&r==u&&o==d&&a==f&&(this.dirtyStart=!0),i+=o,s+=a,l+=d,h+=f;let p=Math.min(i,l),m=Math.max(i+n,l+c),g=Math.min(s,h),y=Math.max(s+r,h+u);this.boundingBox=[p,g,m-p,y-g],this.dirtyPathData=!0}else this.boundingBox=[0,0,0,0]}else this.boundingBox=[0,0,0,0];return this.boundingBox},Bn.fill=function(t){this.doFill(t),this.showBoundingBox&&this.drawBoundingBox(t)},Bn.draw=function(t){this.doStroke(t),this.showBoundingBox&&this.drawBoundingBox(t)},Bn.drawAndFill=function(t){this.doStroke(t),this.currentHost.clearShadow(),this.doFill(t),this.showBoundingBox&&this.drawBoundingBox(t)},Bn.fillAndDraw=function(t){this.doFill(t),this.currentHost.clearShadow(),this.doStroke(t),this.showBoundingBox&&this.drawBoundingBox(t)},Bn.drawThenFill=function(t){this.doStroke(t),this.doFill(t),this.showBoundingBox&&this.drawBoundingBox(t)},Bn.fillThenDraw=function(t){this.doFill(t),this.doStroke(t),this.showBoundingBox&&this.drawBoundingBox(t)},Bn.clear=function(t){let e=this.output,i=!!this.currentHost&&this.currentHost.element,s=t.globalCompositeOperation;if(e&&i){let i=qe(),n=i.engine,r=i.element,[o,a,l,h]=this.getBoundingBox();r.width=l,r.height=h,n.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.globalCompositeOperation="destination-out",t.drawImage(r,0,0,l,h,o,a,l,h),t.globalCompositeOperation=s,Qe(i),this.showBoundingBox&&this.drawBoundingBox(t)}},Bn.none=Y,Bn.clip=Y,Bn.doStroke=function(t){let e=this.fromPath,i=this.toPath;if(e&&e.getBoundingBox&&i&&i.getBoundingBox){let s=this.currentHost;if(s){let n=e.currentStampPosition,r=e.getPathPositionData(1),o=i.currentStampPosition,a=i.getPathPositionData(1);s.rotateDestination(t,n[0],n[1],e),t.stroke(e.pathObject),s.rotateDestination(t,o[0],o[1],e),t.stroke(i.pathObject),t.setTransform(1,0,0,1,0,0),t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(a.x,a.y),t.moveTo(...o),t.lineTo(...n),t.closePath(),t.stroke()}}},Bn.doFill=function(t){let e=this.output,i=!!this.currentHost&&this.currentHost.element;if(e&&i){let i=qe(),s=i.engine,n=i.element,[r,o,a,l]=this.getBoundingBox();n.width=a,n.height=l,s.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.drawImage(n,0,0,a,l,r,o,a,l),Qe(i)}},Bn.drawBoundingBox=function(t){this.dirtyStart&&this.getBoundingBox(),t.save();let e=t.getTransform();t.setTransform(1,0,0,1,0,0),t.strokeStyle=this.boundingBoxColor,t.lineWidth=1,t.globalCompositeOperation="source-over",t.globalAlpha=1,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.strokeRect(...this.boundingBox),t.restore(),t.setTransform(e)},Bn.checkHit=function(t=[]){if(this.noUserInteraction)return!1;let e,i,s,n,r,o=Array.isArray(t)?t:[t],a=!(!this.output||!this.output.data)&&this.output.data;if(a){let[t,l,h,c]=this.getBoundingBox();if(o.some((o=>{if(Array.isArray(o))e=o[0],i=o[1];else{if(!rt(o,o.x,o.y))return!1;e=o.x,i=o.y}return!(!e.toFixed||!i.toFixed||isNaN(e)||isNaN(i))&&(s=e-t,n=i-l,!(s<0||s>h||n<0||n>c)&&(r=4*(n*h+s)+3,!!a&&a[r]>0))}),this))return{x:e,y:i,artefact:this}}return!1};const Yn=function(t){return!!t&&new Loom(t)};v.Loom=Loom;const Mesh=function(t=z){return this.makeName(t.name),this.register(),this.set(this.defs),this.state=pe(),t.group||(t.group=qi),this.onEnter=Y,this.onLeave=Y,this.onDown=Y,this.onUp=Y,this.delta={},this.set(t),this.fromPathData=[],this.toPathData=[],this.watchFromPath=null,this.watchIndex=-1,this.engineInstructions=[],this.engineDeltaLengths=[],this};let Xn=Mesh.prototype=Object.create(Object.prototype);Xn.type="Mesh",Xn.lib="entity",Xn.isArtefact=!0,Xn.isAsset=!1,Xn=xt(Xn),Xn=Te(Xn),Xn=Ye(Xn);Xn.defs=tt(Xn.defs,{net:null,isHorizontalCopy:!0,source:null,sourceIsVideoOrSprite:!1,interferenceLoops:2,interferenceFactor:1.03,visibility:!0,order:0,delta:null,host:null,group:null,anchor:null,noCanvasEngineUpdates:!1,noDeltaUpdates:!1,onEnter:null,onLeave:null,onDown:null,onUp:null,noUserInteraction:!1,method:"fill"}),Xn.packetExclusions=it(Xn.packetExclusions,["pathObject","state"]),Xn.packetExclusionsByRegex=it(Xn.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),Xn.packetCoordinates=it(Xn.packetCoordinates,[]),Xn.packetObjects=it(Xn.packetObjects,["group","net","source"]),Xn.packetFunctions=it(Xn.packetFunctions,["onEnter","onLeave","onDown","onUp"]),Xn.processPacketOut=function(t,e,i){let s=!0;return i.indexOf(t)<0&&e===this.defs[t]&&(s=!1),s},Xn.finalizePacketOut=function(t,e){let i=JSON.parse(this.state.saveAsPacket(e))[3];return t=tt(t,i),t=this.handlePacketAnchor(t,e)},Xn.handlePacketAnchor=function(t,e){if(this.anchor){let i=JSON.parse(this.anchor.saveAsPacket(e))[3];t.anchor=i}return t},Xn.clone=N;let Nn=Xn.getters,Gn=Xn.setters;Xn.deltaSetters,Xn.get=function(t){const e=this.getters[t];if(e)return e.call(this);{let e,i=this.defs[t],s=this.state;return void 0!==i?(e=this[t],void 0!==e?e:i):(i=s.defs[t],void 0!==i?(e=s[t],void 0!==e?e:i):null)}},Xn.set=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.setters,n=this.defs,r=this.state,o=r?r.setters:z,a=r?r.defs:z;let l,h,c,u;for(h=0;h<i;h++)c=e[h],u=t[c],c&&"name"!=c&&null!=u&&(me.indexOf(c)<0?(l=s[c],l?l.call(this,u):void 0!==n[c]&&(this[c]=u,this.dirtyFilterIdentifier=!0)):(l=o[c],l?l.call(r,u):void 0!==a[c]&&(r[c]=u)))}return this},Xn.setDelta=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.deltaSetters,n=this.defs,r=this.state,o=r?r.deltaSetters:z,a=r?r.defs:z;let l,h,c,u;for(h=0;h<i;h++)c=e[h],u=t[c],c&&"name"!=c&&null!=u&&(me.indexOf(c)<0?(l=s[c],l?l.call(this,u):void 0!==n[c]&&(this[c]=addStrings(this[c],u),this.dirtyFilterIdentifier=!0)):(l=o[c],l?l.call(r,u):void 0!==a[c]&&(r[c]=addStrings(r[c],u))))}return this},Gn.host=function(t){if(t){let e=i[t];e&&e.here?this.host=e.name:this.host=t}else this.host="";this.dirtyFilterIdentifier=!0},Nn.group=function(){return this.group?this.group.name:""},Gn.group=function(t){let e;t&&(this.group&&"Group"===this.group.type&&this.group.removeArtefacts(this.name),t.substring?(e=group[t],this.group=e||t):this.group=t),this.group&&"Group"===this.group.type&&this.group.addArtefacts(this.name)},Xn.getHere=function(){return currentCorePosition},Gn.net=function(t){t&&((t=t.substring?i[t]:t)&&"Net"===t.type&&(this.net=t,this.dirtyStart=!0),this.dirtyFilterIdentifier=!0)},Gn.source=function(t){if((t=t.substring?i[t]:t)&&"Picture"===t.type){let e=this.source;e&&"Picture"===e.type&&e.imageUnsubscribe(this.name),this.source=t,t.imageSubscribe(this.name),this.dirtyInput=!0,this.dirtyFilterIdentifier=!0}},Gn.isHorizontalCopy=function(t){this.isHorizontalCopy=!!t,this.dirtyPathData=!0,this.dirtyFilterIdentifier=!0},Xn.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){let t=i[this.host];if(t)return this.currentHost=t,this.dirtyHost=!0,this.currentHost}return currentCorePosition},Xn.midInitActions=Y,Xn.prepareStamp=function(){this.badNet=!0,this.dirtyParticles=!1;let{net:t,particlePositions:e}=this;if(t&&t.particleStore&&t.particleStore.length>3){let{rows:i,columns:s,particleStore:n}=t;if(i&&s){this.badNet=!1,this.rows=i,this.columns=s,e||(e=[]);let t=[];n.forEach((e=>{let i=e.position,{x:s,y:n}=i;t.push([s,n])}));let r=t.join(",");e.join(",")!==r&&(this.particlePositions=t,this.dirtyInput=!0),this.sourceIsVideoOrSprite&&(this.dirtyInput=!0)}}},Xn.setSourceDimension=function(){if(!this.badNet){const{columns:t,rows:e,particlePositions:i}=this,s=[],n=[],r=[],o=[],a=[],l=[],h=[],c=[],u=[];let d,f,p,m,g,y,b,S,k,A,w,v,C,O,P,x,D,R;for(p=0;p<e;p++){for(m=0,C=n[p]=[],y=c[p]=[],d=0,f=t-1;d<f;d++)g=p*t+d,[b,k]=i[g],[S,A]=i[g+1],y.push([b,k,S,A]),0===d?l.push([b,k]):d===f-1?h.push([S,A]):0===p?(a.push([b,k]),d===f-2&&a.push([S,A])):p===e-1&&(u.push([b,k]),d===f-2&&u.push([S,A])),r.push(b,S),o.push(k,A),w=S-b,v=A-k,O=Math.sqrt(w*w+v*v),m+=O,C.push(O);s.push(m)}this.sourceDimension=Math.max(...s);let F=this.currentHost||this.getHost();if(F){let t=Math.max(...F.currentDimensions);this.sourceDimension>t&&(this.sourceDimension=t)}for(P=0,x=n.length;P<x;P++)for(O=s[P],C=n[P],y=c[P],D=0,R=C.length;D<R;D++)O&&(C[D]=C[D]/O),y[D].push(C[D]);this.struts=c;let E=Math.min(...r),I=Math.min(...o),M=Math.max(...r),T=Math.max(...o);this.boundingBox=[E,I,M-E,T-I],l.reverse(),u.reverse();let H=`M${a[0][0]},${a[0][1]}L`;for(P=1,x=a.length;P<x;P++)[d,p]=a[P],H+=`${d},${p} `;for(P=0,x=h.length;P<x;P++)[d,p]=h[P],H+=`${d},${p} `;for(P=0,x=u.length;P<x;P++)[d,p]=u[P],H+=`${d},${p} `;for(P=0,x=l.length;P<x;P++)[d,p]=l[P],H+=`${d},${p} `;H+="z",this.pathObject=new Path2D(H)}},Xn.simpleStamp=function(t,e){t&&"Cell"===t.type&&(this.currentHost=t,e&&(this.set(e),this.prepareStamp()),this.regularStamp())},Xn.stamp=function(t=!1,e,i){t&&(e&&"Cell"===e.type&&(this.currentHost=e),i&&(this.set(i),this.prepareStamp()),this.regularStamp()),this.visibility&&(this.dirtyInput&&(this.sourceImageData=this.cleanInput(),this.sourceImageData?this.output=this.cleanOutput():this.dirtyInput=!0),this.output&&this.regularStamp())},Xn.cleanInput=function(){this.dirtyInput=!1,this.setSourceDimension();let t=this.sourceDimension;if(!t)return this.dirtyInput=!0,!1;let e=qe(),i=e.engine,s=e.element;s.width=t,s.height=t,i.setTransform(1,0,0,1,0,0),this.source.stamp(!0,e,{startX:0,startY:0,handleX:0,handleY:0,offsetX:0,offsetY:0,roll:0,scale:1,width:t,height:t,method:"fill"});let n=i.getImageData(0,0,t,t);return Qe(e),n},Xn.cleanOutput=function(){const t=Math.PI/2;this.dirtyOutput=!1;let{sourceDimension:e,sourceImageData:i,columns:s,rows:n,struts:r,boundingBox:o}=this;if(e=Math.ceil(e),i&&n-1>0){let[a,l,h,c]=o;h+=a,c+=l;const u=qe(),d=u.engine,f=u.element;f.width=e,f.height=e,d.setTransform(1,0,0,1,0,0),d.putImageData(i,0,0);const p=qe(),m=p.engine,g=p.element;g.width=h,g.height=c,m.globalAlpha=this.state.globalAlpha,m.setTransform(1,0,0,1,0,0);const y=parseFloat((e/(n-1)).toFixed(4)),b=parseFloat((e/(s-1)).toFixed(4));let S,k,A,w,v,C,O,P,x,D,R,F,E,I,M,T,H,B,L,$,j,Y,X;for(j=0,Y=n-1;j<Y;j++)for(S=r[j],k=r[j+1],L=0,$=s-1;L<$;L++){let[i,s,n,r,o]=S[L],[a,l,h,c,u]=k[L];for(o*=e,u*=e,A=Math.max(o,u,b),w=b/A,v=(n-i)/A,C=(r-s)/A,O=(h-a)/A,P=(c-l)/A,X=0;X<A;X++){x=i+v*X,D=s+C*X,R=a+O*X,F=l+P*X,I=j*y,E=L*b+w*X,M=x-R,T=D-F,H=Math.sqrt(M*M+T*T),B=Math.atan2(T,M)+t,m.setTransform(1,0,0,1,x,D),m.rotate(B);let n=I+y>e?e-I:y;m.drawImage(f,E,I,1,n,0,0,1,H)}}let N=this.interferenceFactor,G=this.interferenceLoops,z=Math.ceil(h*N),W=Math.ceil(c*N);f.width=z,f.height=W,m.setTransform(1,0,0,1,0,0),d.setTransform(1,0,0,1,0,0);for(let t=0;t<G;t++)d.drawImage(g,0,0,h,c,0,0,z,W),m.drawImage(f,0,0,z,W,0,0,h,c);let V=m.getImageData(0,0,h,c);return Qe(u),Qe(p),this.dirtyTargetImage=!0,V}return!1},Xn.regularStamp=function(){let t=this.currentHost;if(t){let e=t.engine;this.noCanvasEngineUpdates||t.setEngine(this),this[this.method](e)}},Xn.fill=function(t){this.doFill(t)},Xn.draw=function(t){this.doStroke(t)},Xn.drawAndFill=function(t){this.doStroke(t),this.currentHost.clearShadow(),this.doFill(t)},Xn.fillAndDraw=function(t){this.doFill(t),this.currentHost.clearShadow(),this.doStroke(t)},Xn.drawThenFill=function(t){this.doStroke(t),this.doFill(t)},Xn.fillThenDraw=function(t){this.doFill(t),this.doStroke(t)},Xn.clear=function(t){let e=this.output,i=!!this.currentHost&&this.currentHost.element,s=t.globalCompositeOperation;if(e&&i){let n=qe(),r=n.engine,o=n.element,a=i.width,l=i.height;o.width=a,o.height=l,r.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.globalCompositeOperation="destination-out",t.drawImage(o,0,0),t.globalCompositeOperation=s,Qe(n)}},Xn.none=Y,Xn.clip=Y,Xn.doStroke=function(t){t.setTransform(1,0,0,1,0,0),t.stroke(this.pathObject)},Xn.doFill=function(t){let e=this.output,i=!!this.currentHost&&this.currentHost.element;if(e&&i){let s=qe(),n=s.engine,r=s.element,o=i.width,a=i.height;r.width=o,r.height=a,n.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.drawImage(r,0,0),Qe(s)}},Xn.checkHit=function(t=[],e){if(this.noUserInteraction)return!1;if(!this.pathObject)return!1;let i=Array.isArray(t)?t:[t],s=!1;e||(e=qe(),s=!0);let n,r,o=e.engine;if(i.some((t=>{if(Array.isArray(t))n=t[0],r=t[1];else{if(!rt(t,t.x,t.y))return!1;n=t.x,r=t.y}return!(!n.toFixed||!r.toFixed||isNaN(n)||isNaN(r))&&o.isPointInPath(this.pathObject,n,r,this.winding)}),this)){let t={x:n,y:r,artefact:this};return s&&Qe(e),t}return s&&Qe(e),!1};const zn=function(t){return!!t&&new Mesh(t)};v.Mesh=Mesh;const Spring=function(t=z){return this.makeName(t.name),this.register(),this.set(this.defs),this.set(t),this.action||(this.action=Y),this};let Wn=Spring.prototype=Object.create(Object.prototype);Wn.type="Spring",Wn.lib="spring",Wn.isArtefact=!1,Wn.isAsset=!1,Wn=xt(Wn);Wn.defs=tt(Wn.defs,{particleFrom:null,particleFromIsStatic:!1,particleTo:null,particleToIsStatic:!1,springConstant:50,damperConstant:10,restLength:1}),Wn.packetObjects=it(Wn.packetObjects,["particleFrom","particleTo"]),Wn.kill=function(){return this.deregister(),!0};let Vn=Wn.setters;Vn.particleFrom=function(t){t.substring&&(t=f[t]),t&&"Particle"===t.type&&(this.particleFrom=t)},Vn.particleTo=function(t){t.substring&&(t=f[t]),t&&"Particle"===t.type&&(this.particleTo=t)},Wn.applySpring=function(){let{particleFrom:t,particleTo:e,particleFromIsStatic:i,particleToIsStatic:s,springConstant:n,damperConstant:r,restLength:o}=this;if(t&&e){let{position:a,velocity:l,load:h}=t,{position:c,velocity:u,load:d}=e,f=gi(u).vectorSubtract(l),p=gi(c).vectorSubtract(a),m=gi(p).normalize(),g=gi(m);m.scalarMultiply(n*(p.getMagnitude()-o)),f.vectorMultiply(g).scalarMultiply(r).vectorMultiply(g);let y=gi(m).vectorAdd(f);i||h.vectorAdd(y),s||d.vectorSubtract(y),yi(f)}};const Zn=function(t){return!!t&&new Spring(t)};v.Spring=Spring;const Net=function(t=z){return this.makeName(t.name),this.register(),this.initializePositions(),this.set(this.defs),this.onEnter=Y,this.onLeave=Y,this.onDown=Y,this.onUp=Y,this.generate=Y,this.postGenerate=Y,this.stampAction=Y,this.particleStore=[],this.springs=[],t.group||(t.group=qi),this.set(t),this.purge&&this.purgeArtefact(this.purge),this};let Un=Net.prototype=Object.create(Object.prototype);Un.type="Net",Un.lib="entity",Un.isArtefact=!0,Un.isAsset=!1,Un=xt(Un),Un=Os(Un);Un.defs=tt(Un.defs,{world:null,artefact:null,historyLength:1,forces:null,mass:1,engine:"euler",springConstant:50,damperConstant:10,restLength:1,showSprings:!1,showSpringsColor:"#000000",rows:0,columns:0,rowDistance:0,columnDistance:0,shapeTemplate:null,precision:20,joinTemplateEnds:!1,particlesAreDraggable:!1,hitRadius:10,showHitRadius:!1,hitRadiusColor:"#000000",resetAfterBlur:3}),Un.packetExclusions=it(Un.packetExclusions,["forces","springs","particleStore"]),Un.packetExclusionsByRegex=it(Un.packetExclusionsByRegex,[]),Un.packetCoordinates=it(Un.packetCoordinates,[]),Un.packetObjects=it(Un.packetObjects,["world","artefact","shapeTemplate"]),Un.packetFunctions=it(Un.packetFunctions,["generate","postGenerate","stampAction"]),Un.finalizePacketOut=function(t,e){let i=e.forces||this.forces||!1;if(i){let e=[];i.forEach((t=>{t.substring?e.push(t):K(t)&&t.name&&e.push(t.name)})),t.forces=e}let s=[];return this.particleStore.forEach((t=>s.push(t.saveAsPacket()))),t.particleStore=s,t},Un.postCloneAction=function(t,e){return t},Un.factoryKill=function(t,e){this.isRunning=!1,t&&(this.artefact.kill(),this.shapeTemplate&&this.shapeTemplate.kill()),e&&this.world.kill(),this.purgeParticlesFromLibrary()},Un.purgeParticlesFromLibrary=function(){let{particleStore:t,springs:e}=this;s.forEach((t=>{let e=i[t];e&&(e.particle&&!e.particle.substring&&e.particle.name&&(e.particle=e.particle.name),"Polyline"===e.type&&e.useParticlesAsPins&&e.pins.forEach(((t,i)=>{K(t)&&"Particle"===t.type&&(e.pins[i]=t.name,e.dirtyPins=!0)})))})),t.forEach((t=>t.kill())),t.length=0,e.forEach((t=>t.kill())),e.length=0},Un.getters;let _n=Un.setters;Un.deltaSetters,_n.generate=function(t){q(t)?this.generate=t:t.substring&&qn[t]&&(this.generate=qn[t])},_n.postGenerate=function(t){q(t)&&(this.postGenerate=t)},_n.stampAction=function(t){q(t)&&(this.stampAction=t)},_n.world=function(t){let e;t.substring?e=y[t]:K(t)&&"World"===t.type&&(e=t),e&&(this.world=e)},_n.artefact=function(t){let e;t.substring?e=i[t]:K(t)&&t.isArtefact&&(e=t),e&&(this.artefact=e),this.dirtyFilterIdentifier=!0},_n.shapeTemplate=function(t){let e;t.substring?e=h[t]:K(t)&&t.isArtefact&&nt(t.species)&&(e=t),e&&(this.shapeTemplate=e),this.dirtyFilterIdentifier=!0},Un.regularStamp=function(){let{world:t,artefact:e,particleStore:i,springs:s,generate:n,postGenerate:r,stampAction:o,lastUpdated:a,resetAfterBlur:l,showSprings:h,showSpringsColor:c,showHitRadius:u,hitRadius:d,hitRadiusColor:f}=this,p=1,m="source-over";this.state&&(p=this.state.globalAlpha,m=this.state.globalCompositeOperation);let g=this.currentHost,y=.016,b=Date.now();if(a&&(y=(b-a)/1e3),y>l&&(this.purgeParticlesFromLibrary(),y=.016),i.length||(n.call(this,g),r.call(this)),i.forEach((e=>e.applyForces(t,g))),s.forEach((t=>t.applySpring())),i.forEach((e=>e.update(y,t))),h){let t=g.engine;t.save(),t.globalAlpha=p,t.globalCompositeOperation=m,t.strokeStyle=c,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor="rgba(0,0,0,0)",t.lineWidth=1,t.setTransform(1,0,0,1,0,0),t.beginPath(),s.forEach((e=>{let{particleFrom:i,particleTo:s}=e;t.moveTo(i.position.x,i.position.y),t.lineTo(s.position.x,s.position.y)})),t.stroke(),t.restore()}if(i.forEach((t=>{t.manageHistory(y,g),o.call(this,e,t,g)})),u){let t=g.engine;t.save(),t.globalAlpha=p,t.globalCompositeOperation=m,t.lineWidth=1,t.strokeStyle=f,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor="rgba(0,0,0,0)",t.setTransform(1,0,0,1,0,0),t.beginPath(),i.forEach((e=>{t.moveTo(e.position.x,e.position.y),t.arc(e.position.x,e.position.y,d,0,2*Math.PI)})),t.stroke(),t.restore()}this.lastUpdated=b},Un.restart=function(){return this.purgeParticlesFromLibrary(),this.lastUpdated=Date.now(),this},Un.checkHit=function(t=[],e){if(this.lastHitParticle=null,!this.particlesAreDraggable)return!1;if(this.noUserInteraction)return!1;let i,s,n,r,o,a=Array.isArray(t)?t:[t],l=this.particleStore,h=!1;if(a.some((t=>{if(Array.isArray(t))i=t[0],s=t[1];else{if(!rt(t,t.x,t.y))return!1;i=t.x,s=t.y}if(!i.toFixed||!s.toFixed||isNaN(i)||isNaN(s))return!1;let e=gi();for(n=0,r=l.length;n<r;n++)if(o=l[n],e.set(o.position).vectorSubtract(t),e.getMagnitude()<this.hitRadius){h=o;break}return yi(e),h}),this)){let t=this.checkHitReturn(i,s,e,h);return this.lastHitParticle=h,t}return!1},Un.checkHitReturn=function(t,e,i,s){return{x:t,y:e,artefact:this,particle:s}},Un.pickupArtefact=function(t){let e=this.lastHitParticle;return rt(t,e)&&(e.isBeingDragged=t,e.dragOffset=gi(e.position).vectorSubtract(t),this.lastHitParticle),this},Un.dropArtefact=function(){return this.lastHitParticle.isBeingDragged=null,yi(this.lastHitParticle.dragOffset),this.lastHitParticle.dragOffset=null,this.lastHitParticle=null,this};const qn={"weak-net":function(t){let{particleStore:e,artefact:i,historyLength:s,engine:n,forces:r,springs:o,mass:a,rows:l,columns:h,rowDistance:c,columnDistance:u,showSprings:d,showSpringsColor:p,name:m,springConstant:g,damperConstant:y,restLength:b}=this;if(t&&l>0&&h>0){let d,p,S,k,A,[w,v]=this.currentStampPosition,[C,O]=t.currentDimensions,P=c.substring?parseFloat(c)/100*O:c,x=u.substring?parseFloat(u)/100*O:u;for(k=0;k<l;k++)for(p=P*k+v,A=0;A<h;A++)d=x*A+w,S=cn({name:`${m}-${k}-${A}`,positionX:d,positionY:p,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:s,engine:n,forces:r,mass:a,fill:i.get("fillStyle"),stroke:i.get("strokeStyle")}),S.run(0,0,!1),e.push(S);const D=function(t,e,i){let s,n,r;s=gi(t.position).vectorSubtract(e.position),n=s.getMagnitude(),r=Zn({name:i,particleFrom:t,particleTo:e,springConstant:g,damperConstant:y,restLength:n*b}),o.push(r),yi(s)};let R,F;for(k=0;k<l;k++)for(A=0;A<h-1;A++)R=f[`${m}-${k}-${A}`],F=f[`${m}-${k}-${A+1}`],D(R,F,`${m}-${k}-${A}~${m}-${k}-${A+1}`);for(k=0;k<h;k++)for(A=0;A<l-1;A++)R=f[`${m}-${A}-${k}`],F=f[`${m}-${A+1}-${k}`],D(R,F,`${m}-${A}-${k}~${m}-${A+1}-${k}`)}},"strong-net":function(t){let{particleStore:e,artefact:i,historyLength:s,engine:n,forces:r,springs:o,mass:a,rows:l,columns:h,rowDistance:c,columnDistance:u,showSprings:d,showSpringsColor:p,name:m,springConstant:g,damperConstant:y,restLength:b}=this;if(t&&l>0&&h>0){let d,p,S,k,A,[w,v]=this.currentStampPosition,[C,O]=t.currentDimensions,P=c.substring?parseFloat(c)/100*O:c,x=u.substring?parseFloat(u)/100*O:u;for(k=0;k<l;k++)for(p=P*k+v,A=0;A<h;A++)d=x*A+w,S=cn({name:`${m}-${k}-${A}`,positionX:d,positionY:p,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:s,engine:n,forces:r,mass:a,fill:i.get("fillStyle"),stroke:i.get("strokeStyle")}),S.run(0,0,!1),e.push(S);const D=function(t,e,i){let s,n,r;s=gi(t.position).vectorSubtract(e.position),n=s.getMagnitude(),r=Zn({name:i,particleFrom:t,particleTo:e,springConstant:g,damperConstant:y,restLength:n*b}),o.push(r),yi(s)};let R,F;for(k=0;k<l;k++)for(A=0;A<h-1;A++)R=f[`${m}-${k}-${A}`],F=f[`${m}-${k}-${A+1}`],D(R,F,`${m}-${k}-${A}~${m}-${k}-${A+1}`);for(k=0;k<h;k++)for(A=0;A<l-1;A++)R=f[`${m}-${A}-${k}`],F=f[`${m}-${A+1}-${k}`],D(R,F,`${m}-${A}-${k}~${m}-${A+1}-${k}`);for(k=0;k<h-1;k++)for(A=0;A<l-1;A++)R=f[`${m}-${A}-${k}`],F=f[`${m}-${A+1}-${k+1}`],D(R,F,`${m}-${A}-${k}~${m}-${A+1}-${k+1}`);for(k=0;k<h-1;k++)for(A=l-1;A>0;A--)R=f[`${m}-${A}-${k}`],F=f[`${m}-${A-1}-${k+1}`],D(R,F,`${m}-${A}-${k}~${m}-${A-1}-${k+1}`)}},"weak-shape":function(t){let{particleStore:e,artefact:i,historyLength:s,engine:n,forces:r,springs:o,mass:a,showSprings:l,showSpringsColor:h,name:c,springConstant:u,damperConstant:d,restLength:p,shapeTemplate:m,precision:g,joinTemplateEnds:y}=this;const b=function(t,e,i){let s,n,r;s=gi(t.position).vectorSubtract(e.position),n=s.getMagnitude(),r=Zn({name:i,particleFrom:t,particleTo:e,springConstant:u,damperConstant:d,restLength:n*p}),o.push(r),yi(s)};let S,k,A,w;if(m&&g){for(S=0;S<g;S++){let t=m.getPathPositionData(S/g);k=cn({name:`${c}-${S}`,positionX:t.x,positionY:t.y,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:s,engine:n,forces:r,mass:a,fill:i.get("fillStyle"),stroke:i.get("strokeStyle")}),k.run(0,0,!1),e.push(k)}for(S=0;S<g-1;S++)A=f[`${c}-${S}`],w=f[`${c}-${S+1}`],b(A,w,`${c}-${S}~${c}-${S+1}`);for(y&&(A=f[`${c}-${g-1}`],w=f[`${c}-0`],b(A,w,`${c}-${g-1}~${c}-0`)),S=0;S<g-2;S++)A=f[`${c}-${S}`],w=f[`${c}-${S+2}`],b(A,w,`${c}-${S}~${c}-${S+2}`);for(y&&(A=f[`${c}-${g-2}`],w=f[`${c}-0`],b(A,w,`${c}-${g-2}~${c}-0`),A=f[`${c}-${g-1}`],w=f[`${c}-1`],b(A,w,`${c}-${g-1}~${c}-1`)),S=0;S<g-3;S++)A=f[`${c}-${S}`],w=f[`${c}-${S+3}`],b(A,w,`${c}-${S}~${c}-${S+3}`);y&&(A=f[`${c}-${g-3}`],w=f[`${c}-0`],b(A,w,`${c}-${g-3}~${c}-0`),A=f[`${c}-${g-2}`],w=f[`${c}-1`],b(A,w,`${c}-${g-2}~${c}-1`),A=f[`${c}-${g-1}`],w=f[`${c}-2`],b(A,w,`${c}-${g-1}~${c}-2`))}},"strong-shape":function(t){let{particleStore:e,artefact:i,historyLength:s,engine:n,forces:r,springs:o,mass:a,showSprings:l,showSpringsColor:h,name:c,springConstant:u,damperConstant:d,restLength:p,shapeTemplate:m,precision:g,joinTemplateEnds:y}=this;const b=function(t,e,i){let s,n,r;s=gi(t.position).vectorSubtract(e.position),n=s.getMagnitude(),r=Zn({name:i,particleFrom:t,particleTo:e,springConstant:u,damperConstant:d,restLength:n*p}),o.push(r),yi(s)};let S,k,A,w;if(m&&g){for(S=0;S<g;S++){let t=m.getPathPositionData(S/g);k=cn({name:`${c}-${S}`,positionX:t.x,positionY:t.y,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:s,engine:n,forces:r,mass:a,fill:i.get("fillStyle"),stroke:i.get("strokeStyle")}),k.run(0,0,!1),e.push(k)}for(S=0;S<g-1;S++)A=f[`${c}-${S}`],w=f[`${c}-${S+1}`],b(A,w,`${c}-${S}~${c}-${S+1}`);for(y&&(A=f[`${c}-${g-1}`],w=f[`${c}-0`],b(A,w,`${c}-${g-1}~${c}-0`)),S=0;S<g-2;S++)A=f[`${c}-${S}`],w=f[`${c}-${S+2}`],b(A,w,`${c}-${S}~${c}-${S+2}`);for(y&&(A=f[`${c}-${g-2}`],w=f[`${c}-0`],b(A,w,`${c}-${g-2}~${c}-0`),A=f[`${c}-${g-1}`],w=f[`${c}-1`],b(A,w,`${c}-${g-1}~${c}-1`)),S=0;S<g-3;S++)A=f[`${c}-${S}`],w=f[`${c}-${S+3}`],b(A,w,`${c}-${S}~${c}-${S+3}`);y&&(A=f[`${c}-${g-3}`],w=f[`${c}-0`],b(A,w,`${c}-${g-3}~${c}-0`),A=f[`${c}-${g-2}`],w=f[`${c}-1`],b(A,w,`${c}-${g-2}~${c}-1`),A=f[`${c}-${g-1}`],w=f[`${c}-2`],b(A,w,`${c}-${g-1}~${c}-2`));let t=Math.floor(g/2);for(S=0;S<g-t;S++)A=f[`${c}-${S}`],S+t<g-1&&(w=f[`${c}-${S+t}`],b(A,w,`${c}-${S}~${c}-${S+t}`))}},"hub-spoke":function(t){let{shapeTemplate:e,precision:i}=this;if(e&&e.type&&i){let{particleStore:s,artefact:n,historyLength:r,engine:o,forces:a,springs:l,mass:h,showSprings:c,showSpringsColor:u,name:d,springConstant:p,damperConstant:m,restLength:g,joinTemplateEnds:y}=this;const b=function(t,e,i){let s,n,r;s=gi(t.position).vectorSubtract(e.position),n=s.getMagnitude(),r=Zn({name:i,particleFrom:t,particleTo:e,springConstant:p,damperConstant:m,restLength:n*g}),l.push(r),yi(s)};let S,k,A,w,v;if(["Bezier","Line","Oval","Polygon","Polyline","Quadratic","Rectangle","Shape","Spiral","Star","Tetragon"].indexOf(e.type)>=0){for(S=0;S<i;S++){let t=e.getPathPositionData(S/i);k=cn({name:`${d}-${S}`,positionX:t.x,positionY:t.y,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:r,engine:o,forces:a,mass:h,fill:n.get("fillStyle"),stroke:n.get("strokeStyle")}),k.run(0,0,!1),s.push(k)}for(S=0;S<i-1;S++)A=f[`${d}-${S}`],w=f[`${d}-${S+1}`],b(A,w,`${d}-${S}-${S+1}`);for(y&&(A=f[`${d}-${i-1}`],w=f[`${d}-0`],b(A,w,`${d}-${i-1}-0`)),S=0;S<i-2;S++)A=f[`${d}-${S}`],w=f[`${d}-${S+2}`],b(A,w,`${d}-${S}~${d}-${S+2}`);y&&(A=f[`${d}-${i-2}`],w=f[`${d}-0`],b(A,w,`${d}-${i-2}~${d}-0`),A=f[`${d}-${i-1}`],w=f[`${d}-1`],b(A,w,`${d}-${i-1}~${d}-1`))}else["Block","Cell","Element","Grid","Phrase","Picture","Stack"].indexOf(t.type)>=0||t.type;let[C,O]=e.get("position");v=cn({name:`${d}-hub`,positionX:C,positionY:O,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:r,engine:o,forces:a,mass:h,fill:n.get("fillStyle"),stroke:n.get("strokeStyle")}),v.run(0,0,!1),s.forEach(((t,e)=>b(t,v,`${d}-${e}-hub`))),s.push(v)}}},Qn=function(t){return!!t&&new Net(t)};function Kn(t=z){t.defs=tt(t.defs,{choke:15});let e=t.setters,i=t.deltaSetters;return e.paletteStart=function(t){this.gradient&&this.gradient.set({paletteStart:t})},i.paletteStart=function(t){this.gradient&&this.gradient.setDelta({paletteStart:t})},e.paletteEnd=function(t){this.gradient&&this.gradient.set({paletteEnd:t})},i.paletteEnd=function(t){this.gradient&&this.gradient.setDelta({paletteEnd:t})},e.colors=function(t){this.gradient&&this.gradient.set({colors:t})},e.precision=function(t){this.gradient&&this.gradient.set({precision:t})},e.easing=function(t){this.gradient&&this.gradient.set({easing:t})},e.easingFunction=e.easing,e.colorSpace=function(t){this.gradient&&this.gradient.set({colorSpace:t})},e.returnColorAs=function(t){this.gradient&&this.gradient.set({returnColorAs:t})},e.cyclePalette=function(t){this.gradient&&this.gradient.set({cyclePalette:t})},e.delta=function(t=z){this.gradient&&this.gradient.set({delta:t})},t.installElement=function(t){let e=document.createElement("canvas");e.id=t,this.element=e,this.engine=this.element.getContext("2d");let i=document.createElement("canvas");return i.id=`${t}-color`,i.width=256,i.height=1,this.colorElement=i,this.colorEngine=this.colorElement.getContext("2d"),this.gradient=kn({name:`${t}-gradient`,endX:"100%",delta:{paletteStart:0,paletteEnd:0},cyclePalette:!1}),this.gradientLastUpdated=0,this},t.checkSource=function(t,e){this.notifySubscribers()},t.getData=function(t,e){return this.notifySubscribers(),this.buildStyle(e)},t.update=function(){this.dirtyOutput=!0},t.notifySubscribers=function(){this.dirtyOutput&&this.cleanOutput(),this.subscribers.forEach((t=>this.notifySubscriber(t)),this)},t.notifySubscriber=function(t){t.sourceNaturalWidth=this.width,t.sourceNaturalHeight=this.height,t.sourceLoaded=!0,t.source=this.element,t.dirtyImage=!0,t.dirtyCopyStart=!0,t.dirtyCopyDimensions=!0,t.dirtyImageSubscribers=!0},t.paintCanvas=function(){if(this.checkOutputValuesExist()&&this.dirtyOutput){this.dirtyOutput=!1;const{element:t,engine:e,width:i,height:s,colorElement:n,colorEngine:r,gradient:o,choke:a,gradientLastUpdated:l}=this,h=o.palette;t.width=i,t.height=s;let c,u,d,f=e.getImageData(0,0,i,s),p=f.data,m=i*s;const g=Date.now();l+a<g&&(o.updateByDelta(),this.gradientLastUpdated=g),h.dirtyPalette&&h.recalculate();let y=r.createLinearGradient(0,0,255,0);o.addStopsToGradient(y,o.paletteStart,o.paletteEnd,o.cyclePalette),r.fillStyle=y,r.fillRect(0,0,256,1);let b=r.getImageData(0,0,256,1).data;for(c=0;c<m;c++)u=4*Math.floor(255*this.getOutputValue(c,i)),d=4*c,p[d]=b[u],p[++d]=b[++u],p[++d]=b[++u],p[++d]=b[++u];e.putImageData(f,0,0)}},t}v.Net=Net;const NoiseAsset=function(t=z){return this.makeName(t.name),this.register(),this.installElement(this.name),this.perm=[],this.permMod8=[],this.values=[],this.grad=[],this.subscribers=[],this.set(this.defs),this.set(t),t.subscribe&&this.subscribers.push(t.subscribe),this.dirtyOutput=!0,this};let Jn=NoiseAsset.prototype=Object.create(Object.prototype);Jn.type="NoiseAsset",Jn.lib="asset",Jn.isArtefact=!1,Jn.isAsset=!0,Jn=xt(Jn),Jn=Ae(Jn),Jn=Kn(Jn),Jn=Ne(Jn);Jn.defs=tt(Jn.defs,{width:300,height:150,noiseEngine:"simplex",seed:"any_random_string_will_do",size:256,scale:50,octaves:1,octaveFunction:"none",persistence:.5,lacunarity:2,smoothing:"quintic",sumFunction:"none",sineFrequencyCoeff:1,sumAmplitude:5,worleyOutput:"X",worleyDepth:0}),delete Jn.defs.source,delete Jn.defs.sourceLoaded,Jn.stringifyFunction=Y,Jn.processPacketOut=Y,Jn.finalizePacketOut=Y,Jn.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Jn.clone=N,Jn.getters;let tr=Jn.setters;Jn.deltaSetters,tr.source=Y,tr.subscribers=Y,tr.octaveFunction=function(t){this.octaveFunction=null!=this.octaveFunctions[t]?this.octaveFunctions[t]:X,this.dirtyNoise=!0,this.dirtyOutput=!0},tr.sumFunction=function(t){this.sumFunction=null!=this.sumFunctions[t]?this.sumFunctions[t]:X,this.dirtyNoise=!0,this.dirtyOutput=!0},tr.smoothing=function(t){this.smoothing=null!=lt[t]?lt[t]:X,this.dirtyNoise=!0,this.dirtyOutput=!0},tr.noiseEngine=function(t){this.noiseEngine=null!=this.noiseEngines[t]?this.noiseEngines[t]:this.noiseEngines.simplex,this.dirtyNoise=!0,this.dirtyOutput=!0},tr.octaves=function(t){t.toFixed&&(this.octaves=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.seed=function(t){t.substring&&(this.seed=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.scale=function(t){t.toFixed&&(this.scale=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.size=function(t){t.toFixed&&(this.size=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.persistence=function(t){t.toFixed&&(this.persistence=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.lacunarity=function(t){t.toFixed&&(this.lacunarity=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.sineFrequencyCoeff=function(t){t.toFixed&&(this.sineFrequencyCoeff=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.modularAmplitude=function(t){t.toFixed&&(this.sumAmplitude=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.sumAmplitude=function(t){t.toFixed&&(this.sumAmplitude=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.width=function(t){t.toFixed&&(this.width=t,this.sourceNaturalWidth=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.height=function(t){t.toFixed&&(this.height=t,this.sourceNaturalHeight=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},tr.worleyDepth=function(t){t.toFixed&&(this.worleyDepth=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Jn.worleyOutputStrings=["X","Y","Z","XminusY","XminusZ","YminusX","YminusZ","ZminusX","ZminusY","XaddY","XaddZ","YaddZ","XaddYminusZ","XaddZminusY","YaddZminusX","XmultiplyY","XmultiplyZ","YmultiplyZ","XmultiplyYaddZ","XmultiplyZaddY","YmultiplyZaddX","XmultiplyYminusZ","XmultiplyZminusY","YmultiplyZminusX","sum"],tr.worleyOutput=function(t){t.substring&&this.worleyOutputStrings.indexOf(t)>=0&&(this.worleyOutput=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Jn.cleanOutput=function(){this.dirtyNoise&&this.cleanNoise(),this.dirtyOutput&&this.paintCanvas()},Jn.cleanNoise=function(){if(this.dirtyNoise){this.dirtyNoise=!1;let{noiseEngine:t,seed:e,width:i,height:s,element:n,engine:r,octaves:o,lacunarity:a,persistence:l,scale:h,octaveFunction:c,sumFunction:u}=this;if(t&&t.init){this.rndEngine=ue(e),this.generatePermutationTable(),t.init.call(this);let n,r,d,f,p,m,g,y,b=[];for(r=0;r<s;r++)for(b[r]=[],n=0;n<i;n++)b[r][n]=[];let S=Math.pow(i,-h/100),k=-1e3,A=1e3,w=t.name;if(["stripes","smoothed-stripes","worley-euclidean","worley-manhattan"].indexOf(w)>=0)for(r=0;r<s;r++)for(n=0;n<i;n++)f=n*S,p=r*S,m=t.getNoiseValue.call(this,f,p),b[r][n]=m,A=Math.min(A,m),k=Math.max(k,m);else for(r=0;r<s;r++)for(n=0;n<i;n++){for(f=n*S,p=r*S,m=0,g=1,y=1,d=0;d<o;d++){let e=t.getNoiseValue.call(this,f*y,p*y);e=c(e,f,p,d+1),e*=g,m+=e,y*=a,g*=l}b[r][n]=m,A=Math.min(A,m),k=Math.max(k,m)}let v=k-A;for(r=0;r<s;r++)for(n=0;n<i;n++){f=n*S,p=r*S;let t=(b[r][n]-A)/v;b[r][n]=u.call(this,t,n*S,r*S)}this.noiseValues=b}else this.dirtyNoise=!0}},Jn.checkOutputValuesExist=function(){return null!=this.noiseValues},Jn.getOutputValue=function(t,e){let i=Math.floor(t/e),s=t-i*e;return this.noiseValues[i][s]},Jn.simplexConstantF=.5*(Math.sqrt(3)-1),Jn.simplexConstantG=(3-Math.sqrt(3))/6,Jn.simplexConstantDoubleG=(3-Math.sqrt(3))/6*2,Jn.perlinGrad=[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[0,1],[0,-1]],Jn.noiseEngines={perlin:{name:"perlin",init:function(){const{grad:t,size:e,rndEngine:i}=this;let s;t.length=0;for(let n=0;n<e;n++)t[n]=[2*i.random()-1,2*i.random()-1],s=Math.sqrt(t[n][0]*t[n][0]+t[n][1]*t[n][1]),t[n][0]/=s,t[n][1]/=s},getNoiseValue:function(t,e){const{size:i,perm:s,grad:n,smoothing:r}=this;let o,a,l,h,c=Math.floor(t)%i,u=(c+1)%i,d=t-Math.floor(t),f=d-1,p=Math.floor(e)%i,m=(p+1)%i,g=e-Math.floor(e),y=g-1,b=s[c],S=s[u],k=s[b+p],A=s[S+p],w=s[b+m],v=s[S+m],C=r(d),O=r(g);return l=d*n[k][0]+g*n[k][1],h=f*n[A][0]+g*n[A][1],o=V(C,l,h),l=d*n[w][0]+y*n[w][1],h=f*n[v][0]+y*n[v][1],a=V(C,l,h),.5*(1+V(O,o,a))}},"improved-perlin":{name:"improved-perlin",init:Y,getNoiseValue:function(t,e){const{size:i,perm:s,permMod8:n,perlinGrad:r,smoothing:o}=this;let a,l,h,c,u=Math.floor(t)%i,d=(u+1)%i,f=t-Math.floor(t),p=f-1,m=Math.floor(e)%i,g=(m+1)%i,y=e-Math.floor(e),b=y-1,S=s[u],k=s[d],A=n[S+m],w=n[k+m],v=n[S+g],C=n[k+g],O=o(f),P=o(y);return h=f*r[A][0]+y*r[A][1],c=p*r[w][0]+y*r[w][1],a=V(O,h,c),h=f*r[v][0]+b*r[v][1],c=p*r[C][0]+b*r[C][1],l=V(O,h,c),.5*(1+V(P,a,l))}},simplex:{name:"simplex",init:Y,getNoiseValue:function(t,e){const i=function(t,e,i){let s=.5-t*t-e*e;if(s<0)return 0;let[n,r]=a[i];return s*s*(n*t+r*e)},{simplexConstantF:s,simplexConstantG:n,simplexConstantDoubleG:r,size:o,perlinGrad:a,perm:l,permMod8:h}=this;let c=(t+e)*s,u=Math.floor(t+c),d=Math.floor(e+c),f=(u+d)*n,p=t-(u-f),m=e-(d-f),g=u%o,y=d%o,b=h[g+l[y]],S=i(p,m,b);b=h[g+1+l[y+1]],S+=i(p-1+r,m-1+r,b);let k=0,A=1;return p>m&&(k=1,A=0),b=h[g+k+l[y+A]],S+=i(p-k+n,m-A+n,b),.5+35*S}},value:{name:"value",init:function(){const{values:t,size:e,rndEngine:i}=this;t.length=0;for(let s=0;s<e;s++)t[s]=t[s+e]=i.random()},getNoiseValue:function(t,e){const{values:i,size:s,perm:n,smoothing:r}=this;let o=Math.floor(t)%s,a=Math.floor(e)%s,l=(o+1)%s,h=(a+1)%s,c=t-Math.floor(t),u=e-Math.floor(e),d=r(c),f=r(u),p=n[o],m=n[l],g=n[p+a],y=n[m+a],b=n[p+h],S=n[m+h],k=V(d,i[g],i[y]),A=V(d,i[b],i[S]);return V(f,k,A)}},stripes:{name:"stripes",init:Y,getNoiseValue:function(t,e){return t/5+e/5}},"smoothed-stripes":{name:"smoothed-stripes",init:Y,getNoiseValue:function(t,e){const{smoothing:i}=this;return i(t)/5+i(e)/5}},"worley-euclidean":{name:"worley-euclidean",init:function(){this.worleySeed=Math.floor(1e6*this.rndEngine.random())},getNoiseValue:function(t,e){const{width:i,height:s,worleyDepth:n,worleyDistanceFunctions:r,worleyOutputFunctions:o,worleyOutput:a}=this,l=r["euclidian-distance"],h=o[a];return this.worleyNoise.call(this,{x:t,y:e,z:n},l,h)}},"worley-manhattan":{name:"worley-manhattan",init:function(){this.worleySeed=Math.floor(1e6*this.rndEngine.random())},getNoiseValue:function(t,e){const{width:i,height:s,worleyDepth:n,worleyDistanceFunctions:r,worleyOutputFunctions:o,worleyOutput:a}=this,l=r["manhattan-distance"],h=o[a];return this.worleyNoise.call(this,{x:t,y:e,z:n},l,h)}}},Jn.generatePermutationTable=function(){const{perm:t,permMod8:e,rndEngine:i,size:s}=this;let n,r,o;for(t.length=0,e.length=0,n=0;n<s;n++)t[n]=n;for(;--n;)r=Math.floor(i.random()*s),o=t[n],t[n]=t[r],t[r]=o;for(n=0;n<s;n++)t[n+s]=t[n],e[n]=e[n+s]=t[n]%8},Jn.octaveFunctions={none:X,absolute:function(t){return Math.abs(2*t-1)}},Jn.sumFunctions={none:X,"sine-x":function(t,e,i){return.5+Math.sin(e*this.sineFrequencyCoeff+t)/2},"sine-y":function(t,e,i){return.5+Math.sin(i*this.sineFrequencyCoeff+t)/2},sine:function(t,e,i){return.5+Math.sin(e*this.sineFrequencyCoeff+t)/4+Math.sin(i*this.sineFrequencyCoeff+t)/4},modular:function(t){let e=t*this.sumAmplitude;return e-Math.floor(e)},random:function(t){let e=this.sumAmplitude,i=t+(Math.random()/e-.5/e);return i>1?i=1:i<0&&(i=0),i}},Jn.wXorshift=function(t){let e=t^t>>12;return e^=e<<25,e^=e>>27,2*e},Jn.wHash=function(t,e,i){return 16777619*(16777619*(16777619*(2166136261^t)^e)^i)&4294967295},Jn.worleyDistanceFunctions={"euclidian-distance":function(t,e){return function(t,e){return[t.x-e.x,t.y-e.y,t.z-e.z]}(t,e).reduce(((t,e)=>t+e*e),0)},"manhattan-distance":function(t,e){return function(t,e){return[t.x-e.x,t.y-e.y,t.z-e.z]}(t,e).reduce(((t,e)=>t+Math.abs(e)),0)}},Jn.wProbLookup=function(t){return(t&=4294967295)<393325350?1:t<1022645910?2:t<1861739990?3:t<2700834071?4:t<3372109335?5:t<3819626178?6:t<4075350088?7:t<4203212043?8:9},Jn.wInsert=function(t,e){let i;for(let s=t.length-1;s>=0&&!(e>t[s]);s--)i=t[s],t[s]=e,s+1<t.length&&(t[s+1]=i)},Jn.worleyOutputFunctions={X:function(t){return t[0]},Y:function(t){return t[1]},Z:function(t){return t[2]},XminusY:function(t){return t[0]-t[1]},XminusZ:function(t){return t[0]-t[2]},YminusX:function(t){return t[1]-t[0]},YminusZ:function(t){return t[1]-t[2]},ZminusX:function(t){return t[2]-t[0]},ZminusY:function(t){return t[2]-t[1]},XaddY:function(t){return t[0]+t[1]},XaddZ:function(t){return t[0]+t[2]},YaddZ:function(t){return t[1]+t[2]},XaddYminusZ:function(t){return t[0]+t[1]-t[2]},XaddZminusY:function(t){return t[0]+t[2]-t[1]},YaddZminusX:function(t){return t[1]+t[2]-t[0]},XmultiplyY:function(t){return t[0]*t[1]},XmultiplyZ:function(t){return t[0]*t[2]},YmultiplyZ:function(t){return t[1]*t[2]},XmultiplyYaddZ:function(t){return t[0]*t[1]+t[2]},XmultiplyZaddY:function(t){return t[0]*t[2]+t[1]},YmultiplyZaddX:function(t){return t[1]*t[2]+t[0]},XmultiplyYminusZ:function(t){return t[0]*t[1]-t[2]},XmultiplyZminusY:function(t){return t[0]*t[2]-t[1]},YmultiplyZminusX:function(t){return t[1]*t[2]-t[0]},sum:function(t){return t[0]+t[1]+t[2]}},Jn.worleyNoise=function(t,e,i){let s,n,r,o,a,l={x:0,y:0,z:0},h={x:0,y:0,z:0},c=[9999999,9999999,9999999],{x:u,y:d,z:f}=t;u=Math.floor(u),d=Math.floor(d),f=Math.floor(f);for(let i=-1;i<2;++i)for(let p=-1;p<2;++p)for(let m=-1;m<2;++m){r=u+i,o=d+p,a=f+m,s=this.wXorshift(this.wHash(r+this.worleySeed&4294967295,4294967295&o,4294967295&a)),n=this.wProbLookup(s);for(let i=0;i<n;++i)s=this.wXorshift(s),l.X=s/4294967296,s=this.wXorshift(s),l.Y=s/4294967296,s=this.wXorshift(s),l.Z=s/4294967296,h={x:l.X+r,y:l.Y+o,z:l.Z+a},this.wInsert(c,e(t,h))}return i(c.map((t=>t<0?0:t>1?1:t)))};const er=function(t){return!!t&&new NoiseAsset(t)},ir=er;v.NoiseAsset=NoiseAsset;const Oval=function(t=z){return this.shapeInit(t),this};let sr=Oval.prototype=Object.create(Object.prototype);sr.type="Oval",sr.lib="entity",sr.isArtefact=!0,sr.isAsset=!1,sr=xt(sr),sr=Ms(sr);sr.defs=tt(sr.defs,{radiusX:5,radiusY:5,intersectX:.5,intersectY:.5,offshootA:.55,offshootB:0});let nr=sr.setters,rr=sr.deltaSetters;nr.radius=function(t){this.setRectHelper(t,["radiusX","radiusY"])},nr.radiusX=function(t){this.setRectHelper(t,["radiusX"])},nr.radiusY=function(t){this.setRectHelper(t,["radiusY"])},rr.radius=function(t){this.deltaRectHelper(t,["radiusX","radiusY"])},rr.radiusX=function(t){this.deltaRectHelper(t,["radiusX"])},rr.radiusY=function(t){this.deltaRectHelper(t,["radiusY"])},nr.offshootA=function(t){this.offshootA=t,this.updateDirty()},nr.offshootB=function(t){this.offshootB=t,this.updateDirty()},rr.offshootA=function(t){t.toFixed&&(this.offshootA+=t,this.updateDirty())},rr.offshootB=function(t){t.toFixed&&(this.offshootB+=t,this.updateDirty())},nr.intersectA=function(t){this.intersectA=t,this.updateDirty()},nr.intersectB=function(t){this.intersectB=t,this.updateDirty()},rr.intersectA=function(t){t.toFixed&&(this.intersectA+=t,this.updateDirty())},rr.intersectB=function(t){t.toFixed&&(this.intersectB+=t,this.updateDirty())},sr.setRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=t}),this)},sr.deltaRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=addStrings(this[e],t)}),this)},sr.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makeOvalPath(),this.pathDefinition=t},sr.makeOvalPath=function(){let t,e,i=parseFloat(this.offshootA.toFixed(6)),s=parseFloat(this.offshootB.toFixed(6)),n=this.radiusX,r=this.radiusY;if(n.substring||r.substring){let i=this.getHost();if(i){let[s,o]=i.currentDimensions;t=2*(n.substring?parseFloat(n)/100*s:n),e=2*(r.substring?parseFloat(r)/100*o:r)}}else t=2*n,e=2*r;let o=parseFloat((t*this.intersectX).toFixed(2)),a=parseFloat((t-o).toFixed(2)),l=parseFloat((e*this.intersectY).toFixed(2)),h=parseFloat((e-l).toFixed(2)),c="m0,0";return c+=`c${a*i},${l*s} ${a-a*s},${l-l*i}, ${a},${l} `,c+=`${-a*s},${h*i} ${a*i-a},${h-h*s} ${-a},${h} `,c+=`${-o*i},${-h*s} ${o*s-o},${h*i-h} ${-o},${-h} `,c+=`${o*s},${-l*i} ${o-o*i},${l*s-l} ${o},${-l}z`,c},sr.calculateLocalPathAdditionalActions=function(){let[t,e,i,s]=this.localBox;this.pathDefinition=this.pathDefinition.replace("m0,0",`m${-t},${-e}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const or=function(t){return!!t&&(t.species="oval",new Oval(t))};v.Oval=Oval;const VideoAsset=function(t=z){return this.assetConstructor(t)};let ar=VideoAsset.prototype=Object.create(Object.prototype);ar.type="Video",ar.lib="asset",ar.isArtefact=!1,ar.isAsset=!0,ar=xt(ar),ar=Ae(ar),ar.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},ar.stringifyFunction=Y,ar.processPacketOut=Y,ar.finalizePacketOut=Y,ar.clone=N,ar.getters;let lr=ar.setters;ar.deltaSetters,lr.source=function(t){t&&("VIDEO"===t.tagName.toUpperCase()&&(this.source=t,this.sourceNaturalWidth=t.videoWidth||0,this.sourceNaturalHeight=t.videoHeight||0,this.sourceLoaded=t.readyState>2),this.sourceLoaded&&this.notifySubscribers())},ar.checkSource=function(t,e){let i=this.source;i&&i.readyState>2?(this.sourceLoaded=!0,this.sourceNaturalWidth===i.videoWidth&&this.sourceNaturalHeight===i.videoHeight&&this.sourceNaturalWidth===t&&this.sourceNaturalHeight===e||(this.sourceNaturalWidth=i.videoWidth,this.sourceNaturalHeight=i.videoHeight,this.notifySubscribers())):this.sourceLoaded=!1},ar.addTextTrack=function(t,e,i){let s=this.source;s&&s.addTextTrack&&s.addTextTrack(t,e,i)},ar.captureStream=function(){let t=this.source;return!(!t||!t.captureStream)&&t.captureStream()},ar.canPlayType=function(t){let e=this.source;return e?e.canPlayType(t):"maybe"},ar.fastSeek=function(t){let e=this.source;e&&e.fastSeek&&e.fastSeek(t)},ar.load=function(){let t=this.source;t&&t.load()},ar.pause=function(){let t=this.source;t&&t.pause()},ar.play=function(){let t=this.source;return t?t.play().catch((t=>console.log(t.code,t.name,t.message))):Promise.reject("Source not defined")},ar.setMediaKeys=function(t){let e=this.source;return e?e.setMediaKeys?e.setMediaKeys(t):Promise.reject("setMediaKeys not supported"):Promise.reject("Source not defined")},ar.setSinkId=function(){let t=this.source;return t?t.setSinkId?t.setSinkId():Promise.reject("setSinkId not supported"):Promise.reject("Source not defined")};const hr=["video_audioTracks","video_autoPlay","video_buffered","video_controller","video_controls","video_controlsList","video_crossOrigin","video_currentSrc","video_currentTime","video_defaultMuted","video_defaultPlaybackRate","video_disableRemotePlayback","video_duration","video_ended","video_error","video_loop","video_mediaGroup","video_mediaKeys","video_muted","video_networkState","video_paused","video_playbackRate","video_readyState","video_seekable","video_seeking","video_sinkId","video_src","video_srcObject","video_textTracks","video_videoTracks","video_volume"],cr=["video_autoPlay","video_controller","video_controls","video_crossOrigin","video_currentTime","video_defaultMuted","video_defaultPlaybackRate","video_disableRemotePlayback","video_loop","video_mediaGroup","video_muted","video_playbackRate","video_src","video_srcObject","video_volume"],ur=function(t){let e=/.*\/(.*?)\./;document.querySelectorAll(t).forEach((t=>{let i;if("VIDEO"===t.tagName.toUpperCase()){if(t.id||t.name)i=t.id||t.name;else{let s=e.exec(t.src);i=s&&s[1]?s[1]:""}let s=pr({name:i,source:t});t.readyState<=2&&(t.oncanplay=()=>{s.set({source:t})})}}))},dr=function(t=z){let e={};e.audio=!nt(t.audio)||t.audio,e.video={};let i=e.video.width={};t.minWidth&&(i.min=t.minWidth),t.maxWidth&&(i.max=t.maxWidth),i.ideal=t.width?t.width:1280;let s=e.video.height={};t.minHeight&&(s.min=t.minHeight),t.maxHeight&&(s.max=t.maxHeight),s.ideal=t.height?t.height:720,t.facing&&(e.video.facingMode=t.facing);let n=t.name||W(),r=document.createElement("video"),o=pr({name:n,source:r});return new Promise(((t,i)=>{navigator&&navigator.mediaDevices?navigator.mediaDevices.getUserMedia(e).then((e=>{let i,s=e.getVideoTracks();Array.isArray(s)&&s[0]&&(i=s[0].getConstraints()),r.id=o.name,i&&(r.width=i.width,r.height=i.height),r.srcObject=e,r.onloadedmetadata=function(t){r.play()},t(o)})).catch((e=>{console.log(e.message),t(o)})):i("Navigator.mediaDevices object not found")}))},fr=function(...t){let e=/.*\/(.*?)\./,i="";if(t.length){let s,n,r,o,a,l,h=!1,c=t[0];if(c.substring){let i=e.exec(c);s=i&&i[1]?i[1]:"",a=[...t],n="",r=!1,o=null,l="auto",h=!0}else c&&c.src&&(s=c.name||"",a=[...c.src],n=c.className||"",r=c.visibility||!1,o=document.querySelector(o),l=c.preload||"auto",h=!0);let u=pr({name:s});if(h){let t=document.createElement("video");t.name=s,t.className=n,t.style.display=r?"block":"none",t.crossOrigin="anonymous",t.preload=l,a.forEach((e=>{let i=document.createElement("source");i.src=e,t.appendChild(i)})),t.onload=()=>{u.set({source:t}),o&&o.appendChild(t)},u.set({source:t}),i=s}}return i},pr=function(t){return!!t&&new VideoAsset(t)};v.VideoAsset=VideoAsset;const SpriteAsset=function(t=z){return this.assetConstructor(t),this};let mr=SpriteAsset.prototype=Object.create(Object.prototype);mr.type="Sprite",mr.lib="asset",mr.isArtefact=!1,mr.isAsset=!0,mr=xt(mr),mr=Ae(mr);mr.defs=tt(mr.defs,{manifest:null}),mr.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},mr.stringifyFunction=Y,mr.processPacketOut=Y,mr.finalizePacketOut=Y,mr.clone=N,mr.getters;let gr=mr.setters;mr.deltaSetters,gr.source=function(t=[]){if(t&&t[0]){this.sourceHold||(this.sourceHold={});let e=this.sourceHold;t.forEach((t=>{let i=t.id||t.name;i&&(e[i]=t)})),this.source=t[0],this.sourceNaturalWidth=t[0].naturalWidth,this.sourceNaturalHeight=t[0].naturalHeight,this.sourceLoaded=t[0].complete}},mr.checkSource=Y;const yr=function(...t){let e=/.*\/(.*?)\./,i=/\.(jpeg|jpg|png|gif|webp|svg|JPEG|JPG|PNG|GIF|WEBP|SVG)/,s=[];return t.forEach((t=>{let n,r,o,a,l,h=!1,c=!1;if(t.substring){let s=e.exec(t);n=s&&s[1]?s[1]:"",r=[t],o="",a=!1,l=t.replace(i,".json"),c=!0}else K(t)&&t.imageSrc&&t.manifestSrc?(n=t.name||"",r=Array.isArray(t.imageSrc)?t.imageSrc:[t.imageSrc],l=t.manifestSrc,o=t.className||"",a=t.visibility||!1,h=document.querySelector(t.parent),c=!0):s.push(!1);if(c){let t=br({name:n});K(l)?t.manifest=l:fetch(l).then((t=>{if(200!==t.status)throw new Error("Failed to load manifest");return t.json()})).then((e=>t.manifest=e)).catch((t=>console.log(t.message)));let c=[];r.forEach((t=>{let s,r,l=document.createElement("img");i.test(t)&&(r=e.exec(t),s=r&&r[1]?r[1]:""),l.name=s||n,l.className=o,l.crossorigin="anonymous",l.style.display=a?"block":"none",h&&h.appendChild(l),l.src=t,c.push(l)})),t.set({source:c}),s.push(n)}else s.push(!1)})),s},br=function(t){return!!t&&new SpriteAsset(t)};function Sr(t=z){t.defs=tt(t.defs,{asset:null,removeAssetOnKill:!1,spriteIsRunning:!1,spriteLastFrameChange:0,spriteCurrentFrame:0,spriteTrack:"default",spriteForward:!0,spriteFrameDuration:100,spriteWillLoop:!0});let e=t.getters,i=t.setters;return e.sourceDimensions=function(){return[this.sourceNaturalWidth,this.sourceNaturalHeight]},i.asset=function(t){let e=this.asset,i=t&&t.name?t.name:t;e&&!e.substring&&e.unsubscribe(this),this.asset=i,this.dirtyAsset=!0},i.imageSource=function(t){let e=xe(t);if(e){let t=n[e[0]];if(t){let e=this.asset;e&&e.unsubscribe&&e.unsubscribe(this),t.subscribe(this)}}},i.videoSource=function(t){let e=fr(t);if(e){let t=n[e];if(t){let e=this.asset;e&&e.unsubscribe&&e.unsubscribe(this),t.subscribe(this)}}},i.spriteSource=function(t){let e=yr(t);if(e){let t=n[e];if(t){let e=this.asset;e&&e.unsubscribe&&e.unsubscribe(this),t.subscribe(this)}}},t.cleanAsset=function(){let t=this.asset;if(t&&t.substring){let e=n[t];e&&(this.dirtyAsset=!1,e.subscribe(this))}},t.videoAction=function(t,...e){let i=this.asset;if(i&&"Video"===i.type)return i[t](...e)},t.videoPromiseAction=function(t,...e){let i=this.asset;return i&&"Video"===i.type?i[t](...e):Promise.reject("Asset not a video")},t.videoAddTextTrack=function(t,e,i){return this.videoAction("addTextTrack",t,e,i)},t.videoCaptureStream=function(){return this.videoAction("captureStream")},t.videoCanPlayType=function(t){return this.videoAction("canPlayType",t)},t.videoFastSeek=function(t){return this.videoAction("fastSeek",t)},t.videoLoad=function(){return this.videoAction("load")},t.videoPause=function(){return this.videoAction("pause")},t.videoPlay=function(){return this.videoPromiseAction("play")},t.videoSetMediaKeys=function(t){return this.videoPromiseAction("setMediaKeys",t)},t.videoSetSinkId=function(){return this.videoPromiseAction("setSinkId")},t.checkSpriteFrame=function(){let t=this.asset;if(t&&"Sprite"===t.type){let e=this.copyArray;if(this.spriteIsRunning){let i=this.spriteLastFrameChange,s=this.spriteFrameDuration,n=Date.now();if(n>i+s){let i=t.manifest;if(i){let s=i[this.spriteTrack],r=s.length,o=this.spriteCurrentFrame,a=this.spriteWillLoop;o=this.spriteForward?o+1:o-1,o<0&&(o=a?r-1:0),o>=r&&(o=a?0:r-1);let[l,h,c,u,d]=s[o];if(e.length=0,e.push(h,c,u,d),this.dirtyCopyStart=!1,this.dirtyCopyDimensions=!1,l!==(this.source.id||this.source.name)){let e=t.sourceHold[l];e&&(this.source=e)}this.spriteCurrentFrame=o,this.spriteLastFrameChange=n}}}else{let[i,s,n,r,o]=t.manifest[this.spriteTrack][this.spriteCurrentFrame],[a,l,h,c]=e;a===s&&l===n&&h===r&&c===o||(e.length=0,e.push(s,n,r,o),this.dirtyCopyStart=!1,this.dirtyCopyDimensions=!1)}}},t.playSprite=function(t,e,i,s,n){nt(t)&&(this.spriteFrameDuration=t),nt(e)&&(this.spriteWillLoop=e),nt(i)&&(this.spriteTrack=i),nt(s)&&(this.spriteForward=s),nt(n)&&(this.spriteCurrentFrame=n),this.spriteLastFrameChange=Date.now(),this.spriteIsRunning=!0},t.haltSprite=function(t,e,i,s,n){nt(t)&&(this.spriteFrameDuration=t),nt(e)&&(this.spriteWillLoop=e),nt(i)&&(this.spriteTrack=i),nt(s)&&(this.spriteForward=s),nt(n)&&(this.spriteCurrentFrame=n),this.spriteIsRunning=!1},t}v.SpriteAsset=SpriteAsset;const Pattern=function(t=z){return this.makeName(t.name),this.register(),this.set(this.defs),this.set(t),this};let kr=Pattern.prototype=Object.create(Object.prototype);kr.type="Pattern",kr.lib="styles",kr.isArtefact=!1,kr.isAsset=!1,kr=xt(kr),kr=Ne(kr),kr=Sr(kr);kr.defs=tt(kr.defs,{}),kr.packetObjects=it(kr.packetObjects,["asset"]),kr.finalizePacketOut=function(t,e){if(Array.isArray(e.patternMatrix))t.patternMatrix=e.patternMatrix;else{let e=this.patternMatrix;e&&(t.patternMatrix=[e.a,e.b,e.c,e.d,e.e,e.f])}return t},kr.kill=function(){let{name:t,asset:e,removeAssetOnKill:i}=this;return K(e)&&e.unsubscribe(this),Object.entries(h).forEach((([e,i])=>{let s=i.state;if(s){let e=s.fillStyle,i=s.strokeStyle;K(e)&&e.name===t&&(s.fillStyle=s.defs.fillStyle),K(i)&&i.name===t&&(s.strokeStyle=s.defs.strokeStyle)}})),i&&(i.substring?e.kill(!0):e.kill()),this.deregister(),this},kr.get=function(t){let e=this.source;if(0!==t.indexOf("video_")&&0!==t.indexOf("image_")||!e){let e=this.getters[t];if(e)return e.call(this);{let e,i=this.defs[t];return void 0!==i?(e=this[t],void 0!==e?e:i):undef}}return hr.indexOf(t)>=0||Oe.indexOf(t)>=0?e[t.substring(6)]:void 0},kr.set=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.setters,n=this.source,r=this.defs;let o,a,l,h;for(a=0;a<i;a++)l=e[a],h=t[l],0!==l.indexOf("video_")&&0!==l.indexOf("image_")||!n?l&&"name"!==l&&null!=h&&(o=s[l],o?o.call(this,h):void 0!==r[l]&&(this[l]=h)):(cr.indexOf(l)>=0||Pe.indexOf(l)>=0)&&(n[l.substring(6)]=h);this.dirtyFilterIdentifier=!0}return this},kr.getData=function(t,e){return this.dirtyAsset&&this.cleanAsset(),this.asset.checkSource(this.sourceNaturalWidth,this.sourceNaturalHeight),this.buildStyle(e)};const Ar=function(t){return!!t&&new Pattern(t)};v.Pattern=Pattern;const FontAttributes=function(t=z){return this.makeName(t.name),this.set(this.defs),this.set(t),this};let wr=FontAttributes.prototype=Object.create(Object.prototype);wr.type="FontAttributes",wr.lib="fontattribute",wr=xt(wr);wr.defs=tt(wr.defs,{style:"normal",variant:"normal",weight:"normal",stretch:"normal",sizeValue:12,sizeMetric:"px",family:"sans-serif"});let vr=wr.getters,Cr=wr.setters;wr.deltaSetters,vr.size=function(){return this.sizeValue?`${this.sizeValue}${this.sizeMetric}`:this.sizeMetric},Cr.size=function(t){if(nt(t)){let e,i,s,n=0,r="medium";t.indexOf("xx-small")>=0?r="xx-small":t.indexOf("x-small")>=0?r="x-small":t.indexOf("smaller")>=0?r="smaller":t.indexOf("small")>=0?r="small":t.indexOf("medium")>=0?r="medium":t.indexOf("xxx-large")>=0?r="xxx-large":t.indexOf("xx-large")>=0?r="xx-large":t.indexOf("x-large")>=0?r="x-large":t.indexOf("larger")>=0?r="larger":t.indexOf("large")>=0?r="large":(n=12,r="px");let o=t.match(/(\d+\.\d+|\d+|\.\d+)(rem|em|rlh|lh|ex|cap|ch|ic|%|vw|vh|vmax|vmin|vi|vb|in|cm|mm|Q|pc|pt|px)?/i);Array.isArray(o)?([e,i,s]=o,i&&s&&"."!=i&&(n=i,r=s)):(o=t.match(/\/(\d+\.\d+|\d+|\.\d+)(rem|em|rlh|lh|ex|cap|ch|ic|%|vw|vh|vmax|vmin|vi|vb|in|cm|mm|Q|pc|pt|px)?/i),Array.isArray(o)&&([e,i,s]=o,i&&s&&"."!=i&&(n=i,r=s))),n!==this.sizeValue&&(this.sizeValue=n,this.dirtyFont=!0),r!==this.sizeMetric&&(this.sizeMetric=r,this.dirtyFont=!0)}},Cr.sizeValue=function(t){nt(t)&&t!==this.sizeValue&&(this.sizeValue=t,this.dirtyFont=!0)},Cr.sizeMetric=function(t){nt(t)&&t!==this.sizeMetric&&(this.sizeMetric=t,this.dirtyFont=!0)},Cr.font=function(t){nt(t)&&(Cr.style.call(this,t),Cr.variant.call(this,t),Cr.weight.call(this,t),Cr.stretch.call(this,t),Cr.size.call(this,t),Cr.family.call(this,t))},Cr.style=function(t){if(nt(t)){let e="normal";e=t.indexOf("italic")>=0?"italic":e,e=t.indexOf("oblique")>=0?"oblique":e,e!==this.style&&(this.style=e,this.dirtyFont=!0)}},Cr.variant=function(t){if(nt(t)){let e="normal";e=t.indexOf("small-caps")>=0?"small-caps":e,e!==this.variant&&(this.variant=e,this.dirtyFont=!0)}},Cr.weight=function(t){if(nt(t)){let e="normal";t.toFixed?e=t:(e=t.indexOf("bold")>=0?"bold":e,e=t.indexOf("lighter")>=0?"lighter":e,e=t.indexOf("bolder")>=0?"bolder":e,e=t.indexOf(" 100 ")>=0?"100":e,e=t.indexOf(" 200 ")>=0?"200":e,e=t.indexOf(" 300 ")>=0?"300":e,e=t.indexOf(" 400 ")>=0?"400":e,e=t.indexOf(" 500 ")>=0?"500":e,e=t.indexOf(" 600 ")>=0?"600":e,e=t.indexOf(" 700 ")>=0?"700":e,e=t.indexOf(" 800 ")>=0?"800":e,e=t.indexOf(" 900 ")>=0?"900":e,e=/^\d00$/.test(t)?t:e),e!==this.weight&&(this.weight=e,this.dirtyFont=!0)}},Cr.stretch=function(t){if(nt(t)){let e="normal";e=t.indexOf("semi-condensed")>=0?"semi-condensed":e,e=t.indexOf("condensed")>=0?"condensed":e,e=t.indexOf("extra-condensed")>=0?"extra-condensed":e,e=t.indexOf("ultra-condensed")>=0?"ultra-condensed":e,e=t.indexOf("semi-expanded")>=0?"semi-expanded":e,e=t.indexOf("expanded")>=0?"expanded":e,e=t.indexOf("extra-expanded")>=0?"extra-expanded":e,e=t.indexOf("ultra-expanded")>=0?"ultra-expanded":e,e!==this.stretch&&(this.stretch=e,this.dirtyFont=!0)}},wr.rfsTestArray1=["italic","oblique","small-caps","normal","bold","lighter","bolder","ultra-condensed","extra-condensed","semi-condensed","condensed","ultra-expanded","extra-expanded","semi-expanded","expanded","xx-small","x-small","small","medium","xxx-large","xx-large","x-large","large"],wr.rfsTestArray2=["0","1","2","3","4","5","6","7","8","9"],Cr.family=function(t){if(nt(t)){let e="sans-serif",i=t.split(" "),s=i.length;1===s&&(e=t);let n=0,r=!0;for(;r;)if(n===s)r=!1;else{let t=i[n];t.length?this.rfsTestArray1.indexOf(t)>=0||this.rfsTestArray2.indexOf(t[0])>=0?n++:r=!1:n++}n<s&&(e=i.slice(n).join(" ")),e!==this.family&&(this.family=e,this.dirtyFont=!0)}},wr.getFontString=function(){return!this.dirtyFont&&this.temperedFontString?this.temperedFontString:this.buildFont()},wr.updateMetadata=function(t,e,i){t&&t.toFixed&&t>0&&t!==this.scale&&(this.scale=t,this.dirtyFont=!0),e&&e.toFixed&&e>0&&e!==this.lineHeight&&(this.lineHeight=e,this.dirtyFont=!0);let s=this.host&&this.host.type&&"Cell"===this.host.type?this.host.name:"";i&&i.type&&"Cell"===i.type&&i.name!==s&&(this.host=i,this.dirtyFont=!0)},wr.calculateSize=function(){if(this.host){let t,e,i,s,{scale:n,lineHeight:r,host:o,sizeValue:a,sizeMetric:l}=this;if(o.getComputedFontSizes())[t,e,i,s]=o.getComputedFontSizes();else if(["in","cm","mm","Q","pc","pt","px"].indexOf(l)<0)return this.dirtyFont=!0,"12px";isNaN(a)&&(a=12);let h=t;switch(l){case"rem":h=e*a;break;case"em":case"cap":case"ch":case"ic":h=t*a;break;case"rlh":h=e*r*a;break;case"lh":h=t*r*a;break;case"ex":h=t/2*a;break;case"%":h=t/100*a;break;case"vw":case"vi":h=i/100*a;break;case"vh":case"vb":h=s/100*a;break;case"vmax":h=Math.max(i,s)/100*a;break;case"vmin":h=Math.min(i,s)/100*a;break;case"in":h=96*a;break;case"cm":h=37.8*a;break;case"mm":h=3.78*a;break;case"Q":h=.95*a;break;case"pc":h=16*a;break;case"pt":h=1.33*a;break;case"px":h=a;break;case"xx-small":h=.6*t;break;case"x-small":h=.75*t;break;case"smaller":h=.8*t;break;case"small":h=.89*t;break;case"xxx-large":h=3*t;break;case"xx-large":h=2*t;break;case"x-large":h=1.5*t;break;case"larger":h=1.3*t;break;case"large":h=1.2*t}return h*n+"px"}return"12px"},wr.buildFont=function(){this.dirtyFont=!1;let t="";"normal"!==this.style&&(t+=`${this.style} `),"normal"!==this.variant&&(t+=`${this.variant} `),"normal"!==this.weight&&(t+=`${this.weight} `),"normal"!==this.stretch&&(t+=`${this.stretch} `),t+=`${this.calculateSize()} `,t+=`${this.family}`;let e=qe();return e.engine.font=t,t=e.engine.font,Qe(e),this.temperedFontString=t,t},wr.update=function(t){return t&&this.set(t),this.getFontString()};v.FontAttributes=FontAttributes;const Or=document.createElement("div");Or.style.padding=0,Or.style.border=0,Or.style.margin=0,Or.style.height="auto",Or.style.lineHeight=1,Or.style.boxSizing="border-box",Or.innerHTML="|/}ÁÅþ§¶¿∑ƒ⌈⌊qwertyd0123456789QWERTY",Or.setAttribute("aria-hidden","true"),cs.appendChild(Or);const Pr=document.createElement("textarea"),xr=(t,e)=>(t=parseFloat(t),Q(t)||(t=0),Q(e)||(e=0),parseFloat(t.toFixed(e))),Dr=(t,e)=>(t=parseFloat(t),Q(t)||(t=0),Q(e)||(e=0),Math.abs(parseFloat(t.toFixed(e)))),Phrase=function(t=z){return this.fontAttributes=function(t){return!!t&&new FontAttributes(t)}(z),this.entityInit(t),this.dirtyDimensions=!0,this.dirtyText=!0,this.dirtyFont=!0,this.dirtyPathObject=!0,this};let Rr=Phrase.prototype=Object.create(Object.prototype);Rr.type="Phrase",Rr.lib="entity",Rr.isArtefact=!0,Rr.isAsset=!1,Rr=xt(Rr),Rr=Os(Rr),Rr.midInitActions=function(t){this.sectionStyles=[],this.sectionClasses=b};Rr.defs=tt(Rr.defs,{text:"",width:"auto",exposeText:!0,lineHeight:1.15,letterSpacing:0,justify:"left",sectionClassMarker:"[§<>]",sectionClasses:null,overlinePosition:-.1,overlineStyle:"rgb(250,0,0)",overlineWidth:1,noOverlineGlyphs:"",underlinePosition:.6,underlineStyle:"rgb(250,0,0)",underlineWidth:1,noUnderlineGlyphs:"",highlightStyle:"rgba(250,218,94,0.4)",boundingBoxColor:"rgba(0,0,0,0.5)",showBoundingBox:!1,textPath:"",textPathPosition:0,textPathLoop:!0,addTextPathRoll:!0,textPathDirection:"ltr",treatWordAsGlyph:!1}),Rr.packetExclusions=it(Rr.packetExclusions,["textPositions","textLines","textLineWidths","textLineWords","textGlyphs","textGlyphWidths","fontAttributes"]),Rr.finalizePacketOut=function(t,e){let i=JSON.parse(this.state.saveAsPacket(e))[3];t=tt(t,i);let s=JSON.parse(this.fontAttributes.saveAsPacket(e))[3];return delete s.name,t=tt(t,s),t=this.handlePacketAnchor(t,e)},Rr.factoryKill=function(){this.exposedTextHold&&this.exposedTextHold.remove()};let Fr=Rr.getters,Er=Rr.setters,Ir=Rr.deltaSetters;Er.handleX=function(t){null!=t&&(this.handle[0]=t,this.dirtyHandle=!0,this.dirtyText=!0,this.dirtyPathObject=!0)},Er.handleY=function(t){null!=t&&(this.handle[1]=t,this.dirtyHandle=!0,this.dirtyText=!0,this.dirtyPathObject=!0)},Er.handle=function(t,e){this.setCoordinateHelper("handle",t,e),this.dirtyHandle=!0,this.dirtyText=!0,this.dirtyPathObject=!0},Ir.handleX=function(t){let e=this.handle;e[0]=addStrings(e[0],t),this.dirtyHandle=!0,this.dirtyText=!0,this.dirtyPathObject=!0},Ir.handleY=function(t){let e=this.handle;e[1]=addStrings(e[1],t),this.dirtyHandle=!0,this.dirtyText=!0,this.dirtyPathObject=!0},Ir.handle=function(t,e){this.setDeltaCoordinateHelper("handle",t,e),this.dirtyHandle=!0,this.dirtyText=!0,this.dirtyPathObject=!0},Fr.text=function(){return this.currentText||this.text||""},Er.text=function(t){var e;this.text=(e=t).substring?e:e.toString,this.dirtyText=!0,this.dirtyPathObject=!0,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},Rr.permittedJustifications=["left","right","center","full"],Er.justify=function(t){this.permittedJustifications.indexOf(t)>=0&&(this.justify=t),this.dirtyText=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Er.width=function(t){this.dimensions[0]=t,this.dirtyDimensions=!0,this.dirtyHandle=!0,this.dirtyPathObject=!0,this.dirtyText=!0},Ir.width=function(t){let e=this.dimensions;e[0]=addStrings(e[0],t),this.dirtyDimensions=!0,this.dirtyHandle=!0,this.dirtyPathObject=!0,this.dirtyText=!0},Er.scale=function(t){this.scale=t,this.dirtyDimensions=!0,this.dirtyHandle=!0,this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyScale=!0},Ir.scale=function(t){this.scale+=t,this.dirtyDimensions=!0,this.dirtyHandle=!0,this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyScale=!0},Er.lineHeight=function(t){this.lineHeight=Dr(t,3),this.lineHeight<.5&&(this.lineHeight=.5),this.dirtyPathObject=!0,this.dirtyText=!0,this.dirtyFilterIdentifier=!0},Ir.lineHeight=function(t){this.lineHeight+=xr(t,3),this.lineHeight<.5&&(this.lineHeight=.5),this.dirtyPathObject=!0,this.dirtyText=!0,this.dirtyFilterIdentifier=!0},Er.letterSpacing=function(t){this.letterSpacing=Dr(t,3),this.dirtyPathObject=!0,this.dirtyText=!0,this.dirtyFilterIdentifier=!0},Ir.letterSpacing=function(t){this.letterSpacing+=xr(t,3),this.letterSpacing<0&&(this.letterSpacing=0),this.dirtyPathObject=!0,this.dirtyText=!0,this.dirtyFilterIdentifier=!0},Er.overlinePosition=function(t){this.overlinePosition=xr(t,3),this.dirtyPathObject=!0,this.dirtyText=!0,this.dirtyFilterIdentifier=!0},Ir.overlinePosition=function(t){this.overlinePosition+=xr(t,3),this.dirtyPathObject=!0,this.dirtyText=!0,this.dirtyFilterIdentifier=!0},Er.noOverlineGlyphs=function(t){t.substring&&(this.noOverlineGlyphs=t)},Er.underlinePosition=function(t){this.underlinePosition=xr(t,3),this.dirtyPathObject=!0,this.dirtyText=!0,this.dirtyFilterIdentifier=!0},Ir.underlinePosition=function(t){this.underlinePosition+=xr(t,3),this.dirtyPathObject=!0,this.dirtyText=!0,this.dirtyFilterIdentifier=!0},Er.noUnderlineGlyphs=function(t){t.substring&&(this.noUnderlineGlyphs=t)},Er.textPath=function(t){this.textPath=t,this.dirtyHandle=!0,this.dirtyText=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Er.textPathPosition=function(t){this.textPathLoop?(t<0&&(t=Math.abs(t)),t>1&&(t%=1),this.textPathPosition=parseFloat(t.toFixed(6))):this.textPathPosition=t,this.dirtyFilterIdentifier=!0},Ir.textPathPosition=function(t){let e=this.textPathPosition+t;this.textPathLoop?(e<0&&(e+=1),e>1&&(e%=1),this.textPathPosition=parseFloat(e.toFixed(6))):this.textPathPosition=e,this.dirtyFilterIdentifier=!0},Fr.font=function(){return this.fontAttributes.getFontString()},Er.font=function(t){this.fontAttributes.set({font:t}),this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Fr.style=function(){return this.fontAttributes.get("style")},Er.style=function(t){this.fontAttributes.set({style:t}),this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Fr.variant=function(){return this.fontAttributes.get("variant")},Er.variant=function(t){this.fontAttributes.set({variant:t}),this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Fr.weight=function(){return this.fontAttributes.get("weight")},Er.weight=function(t){this.fontAttributes.set({weight:t}),this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Fr.stretch=function(){return this.fontAttributes.get("stretch")},Er.stretch=function(t){this.fontAttributes.set({stretch:t}),this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Fr.size=function(){return this.fontAttributes.get("size")},Er.size=function(t){this.fontAttributes.set({size:t}),this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Fr.sizeValue=function(){return this.fontAttributes.get("sizeValue")},Er.sizeValue=function(t){this.fontAttributes.set({sizeValue:t}),this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Ir.sizeValue=function(t){this.fontAttributes.deltaSet({sizeValue:t}),this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Fr.sizeMetric=function(){return this.fontAttributes.get("sizeMetric")},Er.sizeMetric=function(t){this.fontAttributes.set({sizeMetric:t}),this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Fr.family=function(){return this.fontAttributes.get("family")},Er.family=function(t){this.fontAttributes.set({family:t}),this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Rr.cleanDimensionsAdditionalActions=function(){if(this.fontAttributes.dirtyFont=!0,this.fontAttributes.updateMetadata(this.scale,this.lineHeight,this.getHost()),"auto"===this.dimensions[0]){this.buildText();let t=qe(),e=t.engine;e.font=this.fontAttributes.getFontString(),this.currentDimensions[0]=Math.ceil(e.measureText(this.currentText).width/this.scale),Qe(t)}this.textLines?this.currentDimensions[1]=Math.ceil(this.textHeight*this.textLines.length*this.lineHeight/this.scale):this.dirtyDimensions=!0},Rr.setSectionStyles=function(t){let e,i,s,n=new RegExp(this.sectionClassMarker),r=t.split(n),o=this.sectionStyles,a=this.sectionClasses,l="";return o.length=0,r.forEach((t=>{e=a[t],e?(i=l.length,s=o[i],s?Object.assign(s,e):o[i]=Object.assign({},e)):nt(t)&&(l+=t)})),l},Rr.addSectionClass=function(t,e){return rt(t,e)&&t.substring&&K(e)&&(this.sectionClasses[t]=e),this.dirtyText=!0,this.dirtyPathObject=!0,this},Rr.removeSectionClass=function(t){return delete this.sectionClasses[t],this.dirtyText=!0,this.dirtyPathObject=!0,this},Rr.getTextPath=function(){let t=this.textPath;return t&&t.substring&&(t=this.textPath=i[this.textPath],"Shape"===t.type&&t.useAsPath?t.pathed.push(this.name):t=this.path=!1),t},Rr.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){this.dirtyFont&&this.fontAttributes&&(this.dirtyFont=!1,this.dirtyText=!0,this.dirtyMimicDimensions=!0,this.dirtyPositionSubscribers=!0),this.dirtyText&&this.buildText(),this.dirtyHandle&&this.cleanHandle();let t=this.pathObject=new Path2D,e=this.currentHandle,i=this.currentDimensions,s=this.currentScale,n=-e[0]*s,r=-e[1]*s,o=i[0]*s,a=i[1]*s;this.boxStartValues=[n,r],t.rect(n,r,o,a)}},Rr.buildText=function(){this.dirtyText=!1;let t=this.convertTextEntityCharacters(this.text);if(t=this.setSectionStyles(t),this.currentText=t,isNaN(this.currentDimensions[0]))this.dirtyText=!0;else if(this.calculateTextPositions(t),this.exposeText){if(!this.exposedTextHold){let t=document.createElement("div");t.id=`${this.name}-text-hold`,t.setAttribute("aria-live","polite"),this.exposedTextHold=t,this.exposedTextHoldAttached=!1}if(this.exposedTextHold.textContent=t,!this.exposedTextHoldAttached&&this.currentHost){let t=this.getCanvasTextHold(this.currentHost);t&&t.textHold&&(t.textHold.appendChild(this.exposedTextHold),this.exposedTextHoldAttached=!0)}}},Rr.getCanvasTextHold=function(t){return t&&"Cell"===t.type&&t.controller&&"Canvas"===t.controller.type&&t.controller.textHold?t.controller:!(!t||"Cell"!==t.type||!t.currentHost)&&this.getCanvasTextHold(t.currentHost)},Rr.convertTextEntityCharacters=function(t){let e=t.trim();return e=e.replace(/[\s\uFEFF\xA0]+/g," "),Pr.innerHTML=e,Pr.value},Rr.calculateTextPositions=function(t){const e=function(t){if(!M)return I.dirtyPathObject=!0,I.dirtyText=!0,"black";if(t.substring){let e=!1;if(A.indexOf(t)>=0?e=k[t]:l.indexOf(t)>=0&&(e=a[t]),e)return e}return t};let i,s,n,r,o,h,c,u,d,f,p,m,g,y,b,S,w,v,C,O,P,x,D,R,F=qe(),E=F.engine,I=this,M=!(!this.group||!this.group.getHost)&&this.group.getHost(),T=[],H=[],B=[],L=[],$=[],j=[],Y=[],X=this.getTextPath(),N=this.fontAttributes,G=N.clone({}),z=this.sectionStyles,W=this.state,V={},Z=[],U=this.currentScale,_=this.currentDimensions,q=_[0]*U,Q=this.treatWordAsGlyph,K=this.lineHeight,J=this.justify;N.updateMetadata(U,K,M),G.updateMetadata(U,K,M);let tt=N.getFontString(),et=e(W.fillStyle),it=e(W.strokeStyle),st=this.letterSpacing*U,rt=tt,ot=et,at=it,lt=st;this.highlightStyle&&e(this.highlightStyle);let ht=!1;this.underlineStyle&&e(this.underlineStyle),this.underlinePosition;let ct=!1;this.overlineStyle&&e(this.overlineStyle),this.overlinePosition;let ut=!1,dt=0;for(i=Q?t.split(" "):t.split(""),Z.push(rt),f=0,p=i.length;f<p;f++)r=i[f],$[f]=[,,,,,,r,0,0,0];for(z[0]||(z[0]={family:G.family,size:G.sizeValue?`${G.sizeValue}${G.sizeMetric}`:G.sizeMetric,stretch:G.stretch,style:G.style,variant:G.variant,weight:G.weight}),f=0,p=z.length;f<p;f++)s=z[f],s&&(n=$[f],n&&(0===f&&(n[0]=rt,n[3]=ht,n[4]=ct,n[5]=ut),s.defaults&&(rt=G.update(N),at=it,ot=et,lt=st,n[0]=rt,n[1]=at,n[2]=ot,n[3]=ht,n[4]=ct,n[5]=ut),r=s.stroke,r&&r!==at&&(at="default"===r?it:e(s.stroke),n[1]=at),r=s.fill,r&&r!==ot&&(ot="default"===r?et:e(s.fill),n[2]=ot),r=s.space,nt(r)&&r!==lt&&(lt=r*U),r=s.highlight,nt(r)&&r!==ht&&(ht=r,n[3]=ht),r=s.underline,nt(r)&&r!==ct&&(ct=r,n[4]=ct),r=s.overline,nt(r)&&r!==ut&&(ut=r,n[5]=ut),0!==f&&(s.variant||s.weight||s.style||s.stretch||s.size||s.sizeValue||s.sizeMetric||s.family||s.font)&&(r=G.update(s),r!==rt&&(rt=r,n[0]=rt,Z.indexOf(rt)<0&&Z.push(rt))))),T[f]=lt;for(f=0,p=i.length;f<p;f++)nt(T[f])&&(lt=T[f]),T[f]=lt;for(E.save(),Z.forEach((t=>{E.font=t;let e=E.measureText("|/}ÁÅþ§¶¿∑ƒ⌈⌊qwertyd0123456789QWERTY");null!=e.actualBoundingBoxAscent&&null!=e.actualBoundingBoxDescent?V[t]=Math.ceil(e.actualBoundingBoxAscent+e.actualBoundingBoxDescent):(Or.style.font=t,r=Or.clientHeight,V[t]=r)})),E.restore(),dt=Math.max(...Object.values(V)),P=O=o=h=0,f=0,p=$.length;f<p;f++)S=$[f],w=S[6],S[0]&&(E.font=S[0]),j.push(E.measureText(w).width),v=$[f+1],v=!(Q||!v)&&v[6],b=!!v&&E.measureText(`${w}${v}`).width,Y.push(b);for(f=0,p=Y.length;f<p;f++)w=Y[f],w&&(b=j[f]+j[f+1],n=$[f+1],b>w&&!n[0]&&(j[f]-=b-w));for(f=0,p=$.length;f<p;f++)S=$[f],w=S[6],C=j[f]+T[f],T[f]=C,(Q||" "===w)&&(h=f),O+=C,P+=C,O>=q&&o<h&&(y=i.slice(o,h).join(""),H.push(y),b=Q?y.split(" ").length-1:y.split(" ").length,L.push(b),b=T.slice(o,h).reduce(((t,e)=>t+e),0),B.push(b),O-=b,o=h+1),f+1===p&&(O===P?(y=t,H.push(y),L.push(Q?y.split(" ").length-1:y.split(" ").length),B.push(P)):(y=i.slice(o).join(""),H.push(y),b=Q?y.split(" ").length-1:y.split(" ").length,L.push(b),b=T.slice(o).reduce(((t,e)=>t+e),0),B.push(b))),nt(S[3])&&(ht=S[3]),nt(S[4])&&(ct=S[4]),nt(S[5])&&(ut=S[5]),S[3]=ht,S[4]=ct,S[5]=ut;if(U<=0&&(U=1),_[1]=Math.ceil(dt*H.length*K/U),this.cleanHandle(),this.dirtyHandle=!1,x=this.currentHandle,D=-x[0]*U,R=-x[1]*U,!X)if("full"===J)for(c=0,u=R,f=0,p=B.length;f<p;f++){for(b=D,d=f<p-1&&L[f]>1?(q-B[f])/(L[f]-1):0,m=0,g=H[f].length;m<g;m++)r=$[c]," "===r[6]&&(T[c]+=d),r[7]=Math.floor(b),r[8]=Math.floor(u),r[9]=T[c],b+=T[c],c++;c++,u+=dt*K}else for(c=0,u=R,f=0,p=B.length;f<p;f++){for(b="right"===J?q-B[f]+D:"center"===J?(q-B[f])/2+D:D,m=0,g=H[f].length;m<g;m++)r=$[c],r&&(r[7]=Math.floor(b),r[8]=Math.floor(u),r[9]=T[c]),b+=T[c],c++;c++,u+=dt*K}this.textGlyphs=i,this.textGlyphWidths=T,this.textLines=H,this.textLineWidths=B,this.textLineWords=L,this.textPositions=$,this.textHeight=dt,this.textLength=P,this.fontLibrary=V,Qe(F)},Rr.regularStamp=function(){let t,e,i,s,n,r=this.currentHost,o=this.method,a=this.preStamper,l=this.stamper;if(r)if(t=r.engine,"none"===this.method)this.performRotation(t);else if("clip"===this.method)this.performRotation(t),t.clip(this.pathObject,this.winding);else if(this.textPath){this.noCanvasEngineUpdates||r.setEngine(this),t.textBaseline="top",t.textAlign="left",this.getTextPath(),this.calculateGlyphPathPositions(),s=this.textPositions;let h,c,u=this.addTextPathRoll,d=this.addPathRotation,f=this.currentRotation,p=this.currentHandle;for(this.addPathRotation=u,e=0,i=s.length;e<i;e++)h=s[e],c=h[10],c&&(this.currentPathData=c,u&&(this.currentRotation=c.angle),r.rotateDestination(t,c.x,c.y,this),t.translate(-p[0],-p[1]),n=a(r,t,this,h),l[o](t,this,n));this.addPathRotation=d,this.currentRotation=f}else{for(this.performRotation(t),this.noCanvasEngineUpdates||r.setEngine(this),t.textBaseline="top",t.textAlign="left",s=this.textPositions||[],e=0,i=s.length;e<i;e++)n=a(r,t,this,s[e]),l[o](t,this,n);this.showBoundingBox&&this.drawBoundingBox(t)}},Rr.calculateGlyphPathPositions=function(){let t,e,i,s,n,r=this.getTextPath(),o=r.length,a=this.textPositions,l=this.textGlyphWidths,h="ltr"===this.textPathDirection,c=this.textPathPosition,u=this.justify,d=this.textPathLoop,f=this.constantPathSpeed;for(e=0,i=a.length;e<i;e++){switch(t=a[e],s=l[e],u){case"center":n=c+s/2/o,t[7]=-s/2;break;case"right":n=c+s/o,t[7]=-s;break;default:n=c}d&&(n>1||n<0)&&(n=n>.5?n-1:n+1),t[10]=n<=1&&n>=0&&r.getPathPositionData(n,f),t[9]=s,h?c+=s/o:c-=s/o,d&&(c>1||c<0)&&(c=c>.5?c-1:c+1)}},Rr.preStamper=function(t,e,i,s){const n=function(e){return e.getData?e.getData(i,t):e};let[r,o,a,l,h,c,...u]=s;if(r&&(e.font=r),l||h||c){let{highlightStyle:t,textHeight:s,underlineStyle:r,underlineWidth:o,underlinePosition:a,noUnderlineGlyphs:d,overlineStyle:f,overlineWidth:p,overlinePosition:m,noOverlineGlyphs:g}=i;e.save(),l&&(e.fillStyle=n(t),e.fillRect(u[1],u[2],u[3],s)),h&&d.indexOf(u[0])<0&&(e.fillStyle=n(r),e.fillRect(u[1],u[2]+s*a,u[3],o)),c&&(e.fillStyle=n(f),e.fillRect(u[1],u[2]+s*m,u[3],p)),e.restore()}return o&&(e.strokeStyle=n(o)),a&&(e.fillStyle=n(a)),u},Rr.stamper={draw:function(t,e,i){t.strokeText(...i)},fill:function(t,e,i){t.fillText(...i)},drawAndFill:function(t,e,i){t.strokeText(...i),t.fillText(...i),e.currentHost.clearShadow(),t.strokeText(...i),t.fillText(...i),e.currentHost.restoreShadow(e)},fillAndDraw:function(t,e,i){t.fillText(...i),t.strokeText(...i),e.currentHost.clearShadow(),t.fillText(...i),t.strokeText(...i),e.currentHost.restoreShadow(e)},drawThenFill:function(t,e,i){t.strokeText(...i),t.fillText(...i)},fillThenDraw:function(t,e,i){t.fillText(...i),t.strokeText(...i)},clear:function(t,e,i){let s=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",t.fillText(...i),t.globalCompositeOperation=s}},Rr.drawBoundingBox=function(t){t.save(),t.strokeStyle=this.boundingBoxColor,t.lineWidth=1,t.globalCompositeOperation="source-over",t.globalAlpha=1,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.stroke(this.pathObject),t.restore()},Rr.performRotation=function(t){let e=this.currentHost;if(e){let[i,s]=this.currentStampPosition;e.rotateDestination(t,i,s,this)}};const Mr=function(t){return!!t&&new Phrase(t)};v.Phrase=Phrase;const Picture=function(t=z){return this.copyStart=ke(),this.currentCopyStart=ke(),this.copyDimensions=ke(),this.currentCopyDimensions=ke(),this.copyArray=[],this.pasteArray=[],this.entityInit(t),t.copyStart||(t.copyStartX||(this.copyStart[0]=0),t.copyStartY||(this.copyStart[1]=0)),t.copyDimensions||(t.copyWidth||(this.copyDimensions[0]=1),t.copyHeight||(this.copyDimensions[1]=1)),this.imageSubscribers=[],this.dirtyCopyStart=!0,this.dirtyCopyDimensions=!0,this.dirtyImage=!0,this};let Tr=Picture.prototype=Object.create(Object.prototype);Tr.type="Picture",Tr.lib="entity",Tr.isArtefact=!0,Tr.isAsset=!1,Tr=xt(Tr),Tr=Os(Tr),Tr=Sr(Tr);Tr.defs=tt(Tr.defs,{copyStart:null,copyDimensions:null,checkHitIgnoreTransparency:!1}),Tr.packetCoordinates=it(Tr.packetCoordinates,["copyStart","copyDimensions"]),Tr.packetObjects=it(Tr.packetObjects,["asset"]),Tr.factoryKill=function(t=!1){let{asset:e,removeAssetOnKill:i}=this;K(e)&&e.unsubscribe(this),i&&(i.substring?e.kill(!0):e.kill())};let Hr=Tr.getters,Br=Tr.setters,Lr=Tr.deltaSetters;Hr.copyStart=function(){return[].concat(this.currentCopyStart)},Hr.copyStartX=function(){return this.currentCopyStart[0]},Hr.copyStartY=function(){return this.currentCopyStart[1]},Br.copyStartX=function(t){null!=t&&(this.copyStart[0]=t,this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},Br.copyStartY=function(t){null!=t&&(this.copyStart[1]=t,this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},Br.copyStart=function(t,e){this.setCoordinateHelper("copyStart",t,e),this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},Lr.copyStartX=function(t){let e=this.copyStart;e[0]=B(e[0],t),this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},Lr.copyStartY=function(t){let e=this.copyStart;e[1]=B(e[1],t),this.dirtyCopyStart=!0,this.dirtyFilterIdentifier=!0},Lr.copyStart=function(t,e){this.setDeltaCoordinateHelper("copyStart",t,e),this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},Hr.copyWidth=function(){return this.currentCopyDimensions[0]},Hr.copyHeight=function(){return this.currentCopyDimensions[1]},Hr.copyDimensions=function(t,e){return[].concat(this.currentCopyDimensions)},Br.copyWidth=function(t){null!=t&&(this.copyDimensions[0]=t,this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},Br.copyHeight=function(t){null!=t&&(this.copyDimensions[1]=t,this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},Br.copyDimensions=function(t,e){this.setCoordinateHelper("copyDimensions",t,e),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},Lr.copyWidth=function(t){let e=this.copyDimensions;e[0]=B(e[0],t),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},Lr.copyHeight=function(t){let e=this.copyDimensions;e[1]=B(e[1],t),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},Lr.copyDimensions=function(t,e){this.setDeltaCoordinateHelper("copyDimensions",t,e),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},Br.checkHitIgnoreTransparency=function(t){this.checkHitIgnoreTransparency=t,t&&(this.stashOutput=!0)},Tr.get=function(t){let e=this.source;if(0!==t.indexOf("video_")&&0!==t.indexOf("image_")||!e){let e=this.getters[t];if(e)return e.call(this);{let e,i=this.defs[t],s=this.state;return void 0!==i?(e=this[t],void 0!==e?e:i):(i=s.defs[t],void 0!==i?(e=s[t],void 0!==e?e:i):undef)}}return hr.indexOf(t)>=0||Oe.indexOf(t)>=0?e[t.substring(6)]:void 0},Tr.set=function(t=z){const e=Object.keys(t),i=e.length;if(i){const s=this.setters,n=this.defs,r=this.source,o=this.state,a=o?o.setters:z,l=o?o.defs:z;let h,c,u,d;for(c=0;c<i;c++)u=e[c],d=t[u],0!==u.indexOf("video_")&&0!==u.indexOf("image_")||!r?u&&"name"!==u&&null!=d&&(me.indexOf(u)<0?(h=s[u],h?h.call(this,d):void 0!==n[u]&&(this[u]=d)):(h=a[u],h?h.call(o,d):void 0!==l[u]&&(o[u]=d))):(cr.indexOf(u)>=0||Pe.indexOf(u)>=0)&&(r[u.substring(6)]=d)}return this},Tr.updateImageSubscribers=function(){this.dirtyImageSubscribers=!1,this.imageSubscribers.length&&this.imageSubscribers.forEach((t=>{let e=i[t];e&&(e.dirtyInput=!0)}))},Tr.imageSubscribe=function(t){t&&t.substring&&it(this.imageSubscribers,t)},Tr.imageUnsubscribe=function(t){t&&t.substring&&st(this.imageSubscribers,t)},Tr.cleanImage=function(){let t=this.sourceNaturalWidth,e=this.sourceNaturalHeight;if(rt(t,e)&&t>0&&e>0){this.dirtyImage=!1;let i=this.currentCopyStart,s=i[0],n=i[1],r=this.currentCopyDimensions,o=r[0],a=r[1];s+o>t&&(i[0]=t-o),n+a>e&&(i[1]=e-a);let l=this.copyArray;l.length=0,l.push(i[0],i[1],o,a)}},Tr.cleanCopyStart=function(){let t=this.sourceNaturalWidth,e=this.sourceNaturalHeight;if(rt(t,e)&&t>0&&e>0){this.dirtyCopyStart=!1,this.cleanPosition(this.currentCopyStart,this.copyStart,[t,e]);let i=this.currentCopyStart,s=i[0],n=i[1];(s<0||s>t)&&(i[0]=s<0?0:t-1),(n<0||n>e)&&(i[1]=n<0?0:e-1),this.dirtyImage=!0}},Tr.cleanCopyDimensions=function(){let t=this.sourceNaturalWidth,e=this.sourceNaturalHeight;if(rt(t,e)&&t>0&&e>0){this.dirtyCopyDimensions=!1;let i=this.copyDimensions,s=this.currentCopyDimensions,n=i[0],r=i[1];n.substring?s[0]=parseFloat(n)/100*t:s[0]=n,r.substring?s[1]=parseFloat(r)/100*e:s[1]=r;let o=s[0],a=s[1];(o<=0||o>t)&&(s[0]=o<=0?1:t),(a<=0||a>e)&&(s[1]=a<=0?1:e),this.dirtyImage=!0}},Tr.prepareStamp=function(){this.dirtyAsset&&this.cleanAsset(),this.asset&&("Sprite"===this.asset.type?this.checkSpriteFrame(this):this.asset.checkSource?this.asset.checkSource(this.sourceNaturalWidth,this.sourceNaturalHeight):this.dirtyAsset=!0),(this.dirtyDimensions||this.dirtyHandle||this.dirtyScale)&&(this.dirtyPaste=!0),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.indexOf("mouse")>=0||this.lockTo.indexOf("particle")>=0)&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyCopyStart&&this.cleanCopyStart(),this.dirtyCopyDimensions&&this.cleanCopyDimensions(),this.dirtyImage&&this.cleanImage(),this.dirtyPaste&&this.preparePasteObject(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.dirtyImageSubscribers&&this.updateImageSubscribers()},Tr.preparePasteObject=function(){this.dirtyPaste=!1;let t=this.currentStampHandlePosition,e=this.currentDimensions,i=this.currentScale,s=-t[0]*i,n=-t[1]*i,r=e[0]*i,o=e[1]*i,a=this.pasteArray;a.length=0,a.push(s,n,r,o),this.dirtyPathObject=!0},Tr.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){this.pasteArray||this.preparePasteObject(),(this.pathObject=new Path2D).rect(...this.pasteArray)}},Tr.draw=function(t){t.stroke(this.pathObject)},Tr.fill=function(t){let[e,i,s,n]=this.copyArray;this.source&&s&&n&&t.drawImage(this.source,...this.copyArray,...this.pasteArray)},Tr.drawAndFill=function(t){let[e,i,s,n]=this.copyArray;this.source&&s&&n&&(t.stroke(this.pathObject),t.drawImage(this.source,...this.copyArray,...this.pasteArray),this.currentHost.clearShadow(),t.stroke(this.pathObject),t.drawImage(this.source,...this.copyArray,...this.pasteArray))},Tr.fillAndDraw=function(t){let[e,i,s,n]=this.copyArray;this.source&&s&&n&&(t.drawImage(this.source,...this.copyArray,...this.pasteArray),t.stroke(this.pathObject),this.currentHost.clearShadow(),t.drawImage(this.source,...this.copyArray,...this.pasteArray),t.stroke(this.pathObject)),t.stroke(this.pathObject)},Tr.drawThenFill=function(t){let[e,i,s,n]=this.copyArray;this.source&&s&&n&&(t.stroke(this.pathObject),t.drawImage(this.source,...this.copyArray,...this.pasteArray))},Tr.fillThenDraw=function(t){let[e,i,s,n]=this.copyArray;this.source&&s&&n&&(t.drawImage(this.source,...this.copyArray,...this.pasteArray),t.stroke(this.pathObject))},Tr.checkHitReturn=function(t,e,i){if(this.checkHitIgnoreTransparency&&i&&i.engine){let[s,n,r,o]=this.copyArray,[a,l,h,c]=this.pasteArray,[u,d]=this.currentStampPosition,f=4*((e-d)*h+(t-u))+3;return!!i.engine.getImageData(s,n,r,o).data[f]&&{x:t,y:e,artefact:this}}return{x:t,y:e,artefact:this}};const $r=function(t){return!!t&&new Picture(t)};v.Picture=Picture;const Polygon=function(t=z){return this.shapeInit(t),this};let jr=Polygon.prototype=Object.create(Object.prototype);jr.type="Polygon",jr.lib="entity",jr.isArtefact=!0,jr.isAsset=!1,jr=xt(jr),jr=Ms(jr);jr.defs=tt(jr.defs,{sides:0,sideLength:0,radius:0});let Yr=jr.setters,Xr=jr.deltaSetters;Yr.sides=function(t){this.sides=t,this.updateDirty()},Xr.sides=function(t){this.sides+=t,this.updateDirty()},Yr.sideLength=function(t){this.sideLength=t,this.updateDirty()},Xr.sideLength=function(t){this.sideLength+=t,this.updateDirty()},Yr.radius=function(t){this.radius=t,this.updateDirty()},Xr.radius=function(t){this.radius+=t,this.updateDirty()},jr.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makePolygonPath(),this.pathDefinition=t},jr.makePolygonPath=function(){let t,e,i,s=this.sideLength||this.radius,n=this.sides,r=360/n,o="",a=[],l=0,h=gi({x:0,y:-s});for(let t=0;t<n;t++)h.rotate(r),l+=h.y,a.push(l),o+=`${h.x.toFixed(1)},${h.y.toFixed(1)} `;return yi(h),e=Math.min(...a),t=Math.max(...a),i=((Math.abs(e)+Math.abs(t)-s)/2).toFixed(1),o=`m0,${i}l${o}z`,o};const Nr=function(t){return!!t&&(t.species="polygon",new Polygon(t))};v.Polygon=Polygon;const Polyline=function(t=z){return this.pins=[],this.currentPins=[],this.controlledLineOffset=ke(),this.shapeInit(t),this};let Gr=Polyline.prototype=Object.create(Object.prototype);Gr.type="Polyline",Gr.lib="entity",Gr.isArtefact=!0,Gr.isAsset=!1,Gr=xt(Gr),Gr=Ms(Gr);Gr.defs=tt(Gr.defs,{pins:null,tension:0,closed:!1,mapToPins:!1,useParticlesAsPins:!1}),Gr.packetExclusions=it(Gr.packetExclusions,["controlledLineOffset"]),Gr.packetExclusionsByRegex=it(Gr.packetExclusionsByRegex,[]),Gr.packetCoordinates=it(Gr.packetCoordinates,[]),Gr.packetObjects=it(Gr.packetObjects,[]),Gr.packetFunctions=it(Gr.packetFunctions,[]),Gr.finalizePacketOut=function(t,e){let i=JSON.parse(this.state.saveAsPacket(e))[3];return t=tt(t,i),t=this.handlePacketAnchor(t,e),Object.keys(t).forEach((e=>{if("pins"===e){let e=[];t.pins.forEach((t=>{K(t)?e.push(t.name):Array.isArray(t)?e.push([].concat(t)):e.push(t)})),t.pins=e}})),t};let zr=Gr.getters,Wr=Gr.setters,Vr=Gr.deltaSetters;zr.pins=function(t){return nt(t)?this.getPinAt(t):this.currentPins.concat()},Wr.pins=function(t){if(nt(t)){let e=this.pins;if(Array.isArray(t))e.forEach(((t,e)=>this.removePinAt(e))),e.length=0,e.push(...t),this.updateDirty();else if(K(t)&&nt(t.index)){let i=e[t.index];Array.isArray(i)&&(nt(t.x)&&(i[0]=t.x),nt(t.y)&&(i[1]=t.y),this.updateDirty())}}},Vr.pins=function(t){if(nt(t)){let e=this.pins;if(K(t)&&nt(t.index)){let i=e[t.index];Array.isArray(i)&&(nt(t.x)&&(i[0]=addStrings(i[0],t.x)),nt(t.y)&&(i[1]=addStrings(i[1],t.y)),this.updateDirty())}}},Wr.tension=function(t){t.toFixed&&(this.tension=t,this.updateDirty())},Vr.tension=function(t){t.toFixed&&(this.tension+=t,this.updateDirty())},Wr.closed=function(t){this.closed=t,this.updateDirty()},Wr.mapToPins=function(t){this.mapToPins=t,this.updateDirty()},Wr.flipUpend=function(t){this.flipUpend=t,this.updateDirty()},Wr.flipReverse=function(t){this.flipReverse=t,this.updateDirty()},Wr.useAsPath=function(t){this.useAsPath=t,this.updateDirty()},Wr.pivot=function(t){if(Z(t)&&!t)this.pivot=null,"pivot"===this.lockTo[0]&&(this.lockTo[0]="start"),"pivot"===this.lockTo[1]&&(this.lockTo[1]="start"),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{let e=this.pivot,s=t.substring?i[t]:t,n=this.name;s&&s.name&&(e&&e.name!==s.name&&st(e.pivoted,n),it(s.pivoted,n),this.pivot=s,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)}this.updateDirty()},Gr.updateDirty=function(){this.dirtySpecies=!0,this.dirtyPathObject=!0,this.dirtyPins=!0},Gr.getPinAt=function(t){let e=Math.floor(t);if(this.useAsPath){let t=this.getPathPositionData(this.unitPartials[e]);return[t.x,t.y]}{let t,i,s=this.currentPins,n=s[e],[r,o,a,l]=this.localBox,[h,c]=n,[u,d]=s[0],[f,p]=this.localOffset,[m,g]=this.currentStampPosition;return this.mapToPins?(t=h-u+r,i=c-u+o):(t=h-f,i=c-p),[m+t,g+i]}},Gr.updatePinAt=function(t,e){if(rt(t,e)){e=Math.floor(e);let i=this.pins;if(e<i.length&&e>=0){let s=i[e];K(s)&&s.pivoted&&st(s.pivoted,this.name),i[e]=t,this.updateDirty()}}},Gr.removePinAt=function(t){t=Math.floor(t);let e=this.pins;if(t<e.length&&t>=0){let i=e[t];K(i)&&i.pivoted&&st(i.pivoted,this.name),e[t]=null,this.updateDirty()}},Gr.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),this.useParticlesAsPins&&(this.dirtyPins=!0),(this.dirtyPins||this.dirtyLock)&&(this.dirtySpecies=!0),(this.dirtyScale||this.dirtySpecies||this.dirtyDimensions||this.dirtyStart||this.dirtyHandle)&&(this.dirtyPathObject=!0,(this.dirtyScale||this.dirtySpecies)&&(this.pathCalculatedOnce=!1)),(this.isBeingDragged||this.lockTo.indexOf("mouse")>=0||this.lockTo.indexOf("particle")>=0)&&(this.dirtyStampPositions=!0),this.dirtyScale&&this.cleanScale(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyRotation&&this.cleanRotation(),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtySpecies&&this.cleanSpecies(),this.dirtyPathObject&&(this.cleanPathObject(),this.updatePathSubscribers()),this.dirtyPositionSubscribers&&this.updatePositionSubscribers()},Gr.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makePolylinePath(),this.pathDefinition=t},Gr.getPathParts=function(t,e,i,s,n,r,o){let a=Math.sqrt,l=Math.pow,h=a(l(i-t,2)+l(s-e,2)),c=a(l(n-i,2)+l(r-s,2)),u=o*h/(h+c),d=o*c/(h+c);return[i-u*(n-t),s-u*(r-e),i,s,i+d*(n-t),s+d*(r-e)]},Gr.buildLine=function(t,e,i){let s="m0,0l";for(let n=2;n<i.length;n+=6)s+=`${j(i[n]-t)},${j(i[n+1]-e)} `,t=i[n],e=i[n+1];return s},Gr.buildCurve=function(t,e,i){let s="m0,0c",n=0;for(let r=0;r<i.length;r+=2)s+=`${j(i[r]-t)},${j(i[r+1]-e)} `,n++,n>2&&(t=i[r],e=i[r+1],n=0);return s},Gr.cleanCoordinate=function(t,e){return t.toFixed?t:"left"===t||"top"===t?0:"right"===t||"bottom"===t?e:"center"===t?e/2:parseFloat(t)/100*e},Gr.cleanPinsArray=function(){this.dirtyPins=!1;let t=this.pins,e=this.currentPins;if(e.length=0,this.useParticlesAsPins)t.forEach(((i,s)=>{let n;i&&i.substring?(n=f[i],n&&(t[s]=n)):n=i;let r=!(!n||!n.position)&&n.position;r&&e.push([r.x,r.y])})),e.length||(this.dirtyPins=!0);else{let s,n,r,o=1,a=1,l=this.getHost(),h=this.cleanCoordinate;l&&(r=l.currentDimensions,r&&([o,a]=r)),t.forEach(((r,l)=>{let c;if(r&&r.substring?(c=i[r],t[l]=c):c=r,c)if(Array.isArray(c))[s,n]=c,e.push([h(s,o),h(n,a)]);else if(K(c)&&c.currentStart){let t=this.name;c.pivoted.indexOf(t)<0&&it(c.pivoted,t),e.push([...c.currentStampPosition])}}))}if(e.length){let t=e[0][0],i=e[0][1];e.forEach((e=>{e[0]<t&&(t=e[0]),e[1]<i&&(i=e[1])})),this.localOffset=[t,i],this.updatePivotSubscribers()}},Gr.makePolylinePath=function(){let t=this.getPathParts,e=this.buildLine,i=this.buildCurve;this.pins;let s=this.currentPins,n=this.tension,r=this.closed;if(this.dirtyPins&&this.cleanPinsArray(),s.length){let o=s.length,a=s[0],l=s[o-1],h=[],c="m0,0";if(r){let r=[].concat(...t(...l,...a,...s[1],n));for(let e=0;e<o-2;e++)h=h.concat(...t(...s[e],...s[e+1],...s[e+2],n));h=h.concat(...t(...s[o-2],...l,...a,n)),h.unshift(r[4],r[5]),h.push(r[0],r[1],r[2],r[3]),c=n?i(a[0],a[1],h)+"z":e(a[0],a[1],h)+"z"}else{h.push(a[0],a[1]);for(let e=0;e<o-2;e++)h=h.concat(...t(...s[e],...s[e+1],...s[e+2],n));h.push(l[0],l[1],l[0],l[1]),c=n?i(a[0],a[1],h):e(a[0],a[1],h)}return c}return"m0,0"},Gr.calculateLocalPathAdditionalActions=function(){let[t,e,i,s]=this.localBox,n=this.pathDefinition;this.mapToPins?this.set({start:this.currentPins[0]}):this.pathDefinition=n.replace("m0,0",`m${-t},${-e}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)},Gr.updatePathSubscribers=function(){this.pathed.forEach((t=>{let e=i[t];e&&(e.dirtyStart=!0)}))};const Zr=function(t){return!!t&&(t.species="polyline",new Polyline(t))};v.Polyline=Polyline;const Quadratic=function(t=z){return this.control=ke(),this.currentControl=ke(),this.controlLockTo="coord",this.curveInit(t),this.shapeInit(t),this.dirtyControl=!0,this};let Ur=Quadratic.prototype=Object.create(Object.prototype);Ur.type="Quadratic",Ur.lib="entity",Ur.isArtefact=!0,Ur.isAsset=!1,Ur=xt(Ur),Ur=Ms(Ur),Ur=Hs(Ur);Ur.defs=tt(Ur.defs,{control:null,controlPivot:"",controlPivotCorner:"",addControlPivotHandle:!1,addControlPivotOffset:!1,controlPath:"",controlPathPosition:0,addControlPathHandle:!1,addControlPathOffset:!0,controlParticle:"",controlLockTo:""}),Ur.packetExclusions=it(Ur.packetExclusions,[]),Ur.packetExclusionsByRegex=it(Ur.packetExclusionsByRegex,[]),Ur.packetCoordinates=it(Ur.packetCoordinates,["control"]),Ur.packetObjects=it(Ur.packetObjects,["controlPivot","controlPath"]),Ur.packetFunctions=it(Ur.packetFunctions,[]);let _r=Ur.getters,qr=Ur.setters,Qr=Ur.deltaSetters;qr.controlPivot=function(t){this.setControlHelper(t,"controlPivot","control"),this.updateDirty(),this.dirtyControl=!0},qr.controlParticle=function(t){this.setControlHelper(t,"controlParticle","control"),this.updateDirty(),this.dirtyControl=!0},qr.controlPath=function(t){this.setControlHelper(t,"controlPath","control"),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},qr.controlPathPosition=function(t){this.controlPathPosition=t,this.dirtyControl=!0,this.currentControlPathData=!1,this.dirtyFilterIdentifier=!0},Qr.controlPathPosition=function(t){this.controlPathPosition+=t,this.dirtyControl=!0,this.currentControlPathData=!1,this.dirtyFilterIdentifier=!0},_r.controlPositionX=function(){return this.currentControl[0]},_r.controlPositionY=function(){return this.currentControl[1]},_r.controlPosition=function(){return[].concat(this.currentControl)},qr.controlX=function(t){null!=t&&(this.control[0]=t,this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1)},qr.controlY=function(t){null!=t&&(this.control[1]=t,this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1)},qr.control=function(t,e){this.setCoordinateHelper("control",t,e),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},Qr.controlX=function(t){let e=this.control;e[0]=B(e[0],t),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},Qr.controlY=function(t){let e=this.control;e[1]=B(e[1],t),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},Qr.control=function(t,e){this.setDeltaCoordinateHelper("control",t,e),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},qr.controlLockTo=function(t){this.controlLockTo=t,this.updateDirty(),this.dirtyControlLock=!0,this.currentControlPathData=!1},Ur.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makeQuadraticPath(),this.pathDefinition=t},Ur.makeQuadraticPath=function(){let[t,e]=this.currentStampPosition,[i,s]=this.currentControl,[n,r]=this.currentEnd;return`m0,0q${(i-t).toFixed(2)},${(s-e).toFixed(2)} ${(n-t).toFixed(2)},${(r-e).toFixed(2)}`},Ur.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyStart=!0,this.dirtyControl=!0,this.dirtyEnd=!0,this.dirtyFilterIdentifier=!0},Ur.preparePinsForStamp=function(){const t=this.dirtyPins,e=this.endPivot,i=this.endPath,s=this.controlPivot,n=this.controlPath;for(let r,o=0,a=t.length;o<a;o++)r=t[o],(s&&s.name===r||n&&n.name==r)&&(this.dirtyControl=!0,this.controlLockTo.includes("path")&&(this.currentControlPathData=!1)),(e&&e.name===r||i&&i.name==r)&&(this.dirtyEnd=!0,this.endLockTo.includes("path")&&(this.currentEndPathData=!1));t.length=0};const Kr=function(t=z){return!!t&&(t.species="quadratic",new Quadratic(t))};v.Quadratic=Quadratic;const RadialGradient=function(t=z){return this.stylesInit(t),this};let Jr=RadialGradient.prototype=Object.create(Object.prototype);Jr.type="RadialGradient",Jr.lib="styles",Jr.isArtefact=!1,Jr.isAsset=!1,Jr=xt(Jr),Jr=_s(Jr);Jr.defs=tt(Jr.defs,{startRadius:0,endRadius:0}),Jr.packetObjects=it(Jr.packetObjects,["palette"]);let to=Jr.getters,eo=Jr.setters,io=Jr.deltaSetters;to.startRadius=function(t){return this.currentStartRadius},to.endRadius=function(t){return this.currentEndRadius},eo.startRadius=function(t){this.startRadius=t,this.dirtyStyle=!0},eo.endRadius=function(t){this.endRadius=t,this.dirtyStyle=!0},io.startRadius=function(t){this.startRadius=B(this.startRadius,t),this.dirtyStyle=!0},io.endRadius=function(t){this.endRadius=B(this.endRadius,t),this.dirtyStyle=!0},Jr.cleanRadius=function(t){const e=(t,e)=>{if(Q(t))return t;switch(t){case"top":case"left":return 0;case"bottom":case"right":return e;case"center":return e/2;default:return t=parseFloat(t),Q(t)?t/100*e:0}};this.currentStartRadius=t?e(this.startRadius,t):this.defs.startRadius,this.currentEndRadius=t?e(this.endRadius,t):this.defs.endRadius},Jr.buildStyle=function(t){if(t){let e=t.engine;if(e){let t=e.createRadialGradient(...this.gradientArgs);return this.addStopsToGradient(t,this.paletteStart,this.paletteEnd,this.cyclePalette)}}return"rgba(0,0,0,0)"},Jr.updateGradientArgs=function(t,e){let i=this.gradientArgs,s=this.currentStart,n=this.currentEnd,r=this.currentStartRadius,o=this.currentEndRadius,a=s[0]+t,l=s[1]+e,h=n[0]+t,c=n[1]+e;a===h&&l===c&&r===o&&o++,i.length=0,i.push(a,l,r,h,c,o)};const so=function(t){return!!t&&new RadialGradient(t)};v.RadialGradient=RadialGradient;const RawAsset=function(t=z){this.makeName(t.name),this.register(),this.subscribers=[],this.set(this.defs),this.updateSource=Y;let e=t.keytypes||{};t.userAttributes&&t.userAttributes.forEach((t=>{this.addAttribute(t),t.type&&(e[t.key]=t.type)})),this.initializeAttributes(e),this.set(t);let i=document.createElement("canvas");return i.width=0,i.height=0,this.element=i,this.engine=i.getContext("2d",{willReadFrequently:!0}),t.subscribe&&this.subscribers.push(t.subscribe),this};let no=RawAsset.prototype=Object.create(Object.prototype);no.type="RawAsset",no.lib="asset",no.isArtefact=!1,no.isAsset=!0,no=xt(no),no=Ae(no);no.defs=tt(no.defs,{keytypes:null,data:null,updateSource:null}),no.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},no.stringifyFunction=Y,no.processPacketOut=Y,no.finalizePacketOut=Y,no.clone=N;let ro=no.getters,oo=no.setters,ao=no.deltaSetters;oo.source=Y,oo.element=Y,oo.engine=Y,oo.data=function(t){t&&(this.data=t,this.dirtyData=!0)},oo.updateSource=function(t){t&&q(t)&&(this.updateSource=t,this.dirtyData=!0)},no.checkSource=function(t,e){this.source||(this.source=this.element);let i=this.source;if(i){let s=!1;this.dirtyData&&(this.dirtyData=!1,this.updateSource(this),s=!0),this.sourceLoaded=!0,this.sourceNaturalWidth&&this.sourceNaturalHeight&&this.sourceNaturalWidth===t&&this.sourceNaturalHeight===e||(this.sourceNaturalWidth=i.width,this.sourceNaturalHeight=i.height,s=!0),s&&this.sourceNaturalWidth&&this.sourceNaturalHeight&&this.notifySubscribers()}else this.sourceLoaded=!1},no.subscribeAction=function(t={}){this.subscribers.push(t),t.asset=this,t.source=this.element,this.notifySubscriber(t)},no.addAttribute=function(t=z){let{key:e,defaultValue:i,setter:s,deltaSetter:n,getter:r}=t;return e&&e.substring&&(this.defs[e]=nt(i)?i:null,this[e]=nt(i)?i:null,q(s)&&(oo[e]=s),q(n)&&(ao[e]=n),q(r)&&(ro[e]=r)),this},no.removeAttribute=function(t){return t&&t.substring&&(delete this.defs[t],delete this[t],delete ro[t],delete oo[t],delete ao[t]),this},no.initializeAttributes=function(t){for(let[e,i]of Object.entries(t))switch(i){case"Quaternion":this[e]=makeQuaternion();break;case"Vector":this[e]=makeVector();break;case"Coordinate":this[e]=makeCoordinate()}};const lo=function(t){return!!t&&new RawAsset(t)};v.RawAsset=RawAsset;const RdAsset=function(t=z){return this.makeName(t.name),this.register(),this.installElement(this.name),this.subscribers=[],this.set(this.defs),this.set(t),t.subscribe&&this.subscribers.push(t.subscribe),this.currentGeneration=0,this.dataArrays=[],this.dirtyScene=!0,this.dirtyOutput=!0,this};let ho=RdAsset.prototype=Object.create(Object.prototype);ho.type="RdAsset",ho.lib="asset",ho.isArtefact=!1,ho.isAsset=!0,ho=xt(ho),ho=Ae(ho),ho=Kn(ho),ho=Ne(ho);ho.defs=tt(ho.defs,{width:300,height:150,diffusionRateA:.2097,diffusionRateB:.105,feedRate:.054,killRate:.062,initialSettingPreference:"random",randomEngineSeed:"some-random-string-or-other",initialRandomSeedLevel:.0045,initialSettingEntity:null,drawEvery:10,maxGenerations:4e3}),delete ho.defs.source,delete ho.defs.sourceLoaded,ho.stringifyFunction=Y,ho.processPacketOut=Y,ho.finalizePacketOut=Y,ho.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},ho.clone=N,ho.getters;let co=ho.setters;ho.deltaSetters,co.subscribers=Y,co.width=function(t){t.toFixed&&(this.width=t,this.sourceNaturalWidth=t,this.dirtyScene=!0)},co.height=function(t){t.toFixed&&(this.height=t,this.sourceNaturalHeight=t,this.dirtyScene=!0)},co.initialRandomSeedLevel=function(t){t.toFixed&&(this.initialRandomSeedLevel=t,this.dirtyScene=!0)},co.diffusionRateA=function(t){t.toFixed&&(this.diffusionRateA=t,this.dirtyScene=!0)},co.diffusionRateB=function(t){t.toFixed&&(this.diffusionRateB=t,this.dirtyScene=!0)},co.feedRate=function(t){t.toFixed&&(this.feedRate=t,this.dirtyScene=!0)},co.killRate=function(t){t.toFixed&&(this.killRate=t,this.dirtyScene=!0)},co.drawEvery=function(t){t.toFixed&&(this.drawEvery=t,this.dirtyScene=!0)},co.maxGenerations=function(t){t.toFixed&&(this.maxGenerations=t,this.dirtyScene=!0)},ho.initialSettingPreferenceValues=["random","entity"],co.initialSettingPreference=function(t){t.substring&&this.initialSettingPreferenceValues.indexOf(t)>=0&&(this.initialSettingPreference=t,this.dirtyScene=!0)},co.randomEngineSeed=function(t){t.substring&&(this.randomEngineSeed=t,this.dirtyScene=!0)},co.initialSettingEntity=function(t){t&&(t.substring||(t=t.name||""),t&&(this.initialSettingEntity=t,this.dirtyScene=!0))},co.preset=function(t){if(t.substring){switch(t){case"negativeBubbles":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.098,this.killRate=.0555,this.maxGenerations=4e3,this.initialRandomSeedLevel=.05;break;case"positiveBubbles":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.098,this.killRate=.057,this.maxGenerations=4e3,this.initialRandomSeedLevel=.1;break;case"precriticalBubbles":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.082,this.killRate=.059,this.maxGenerations=4e3,this.initialRandomSeedLevel=.08;break;case"wormsAndLoops":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.082,this.killRate=.06,this.maxGenerations=4e3,this.initialRandomSeedLevel=.08;break;case"stableSolitons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.074,this.killRate=.064,this.maxGenerations=4e3,this.initialRandomSeedLevel=.15;break;case"uSkateWorld":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.062,this.killRate=.0609,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"worms":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.058,this.killRate=.065,this.maxGenerations=4e3,this.initialRandomSeedLevel=.1;break;case"wormsJoinIntoMazes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.046,this.killRate=.063,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"negatons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.046,this.killRate=.0594,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"turingPatterns":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.042,this.killRate=.059,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"chaosToTuringNegatons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.039,this.killRate=.058,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"fingerprints":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.037,this.killRate=.06,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"chaosWithNegatons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.0353,this.killRate=.0566,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"spotsAndWorms":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.034,this.killRate=.0618,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"selfReplicatingSpots":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.03,this.killRate=.063,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"superResonantMazes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.03,this.killRate=.0565,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"mazes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.029,this.killRate=.057,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"mazesWithSomeChaos":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.026,this.killRate=.055,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"chaos":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.026,this.killRate=.051,this.maxGenerations=0,this.initialRandomSeedLevel=.009;break;case"warringMicrobes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.022,this.killRate=.059,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"spotsAndLoops":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.018,this.killRate=.051,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"movingSpots":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.014,this.killRate=.054,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"waves":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.014,this.killRate=.045,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;default:this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.054,this.killRate=.062,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045}this.dirtyScene=!0}},ho.update=function(){this.dirtyOutput=!0},ho.cleanOutput=function(t=0){if(this.dirtyScene&&this.cleanScene(),!this.dirtyScene){const{element:e,engine:i,dataArrays:s,diffusionRateA:n,diffusionRateB:r,feedRate:o,killRate:a,currentSource:l,drawEvery:h,maxGenerations:c,currentGeneration:u}=this;let d,f,p,m,g,y,b,S,k,A;if(!c||u<c)if(l?[f,d,m,p]=s:[d,f,p,m]=s,t<h){for(b=0,S=d.length;b<S;b++)g=d[b],y=p[b],k=g+n*this.calculateLaplacian(b,d)-g*y*y+o*(1-g),A=y+r*this.calculateLaplacian(b,p)+g*y*y-(a+o)*y,f[b]=this.constrain(k,0,1),m[b]=this.constrain(A,0,1);this.currentSource=l?0:1,this.currentGeneration=u+1,this.cleanOutput(t+1)}else this.paintCanvas();else this.dirtyOutput&&this.paintCanvas()}},ho.cleanScene=function(){const{element:t,width:e,height:i,dataArrays:s,initialRandomSeedLevel:n,initialSettingPreference:r,randomEngineSeed:o,initialSettingEntity:a}=this;if(e&&i&&this.dirtyScene){this.dirtyScene=!1,t.width=e,t.height=i;const l=e*i;s.length=0;for(let t=0;t<4;t++)s.push(new Float64Array(l));this.currentSource=0;let[c,u,d,f]=s;if(c.fill(1),u.fill(1),d.fill(0),f.fill(0),"entity"===r&&h[a]){const t=h[a],s=qe(),{engine:n,element:r}=s;r.width=e,r.height=i,t.simpleStamp(s,{fillStyle:"white",strokeStyle:"white"});const o=n.getImageData(0,0,e,i).data;let l=0;for(let t=3,e=o.length;t<e;t+=4)d[l]=o[t]/255,l++;Qe(s)}else{const t=ue(o);for(let e=0;e<l;e++)d[e]=t.random()<n?1:0}this.currentGeneration=0}},ho.constrain=function(t,e,i){return t<e?e:t>i?i:t},ho.calculateLaplacian=function(t,e){const i=this.width;let s,n=0,r=Math.floor(t/i),o=this.checkRow(r-1)*i,a=this.checkRow(r+1)*i,l=r*i,h=t-l,c=this.checkCol(h-1),u=this.checkCol(h+1);return n+=-1*e[t],s=o+c,n+=.05*e[s],s=o+u,n+=.05*e[s],s=a+c,n+=.05*e[s],s=a+u,n+=.05*e[s],s=o+h,n+=.2*e[s],s=l+u,n+=.2*e[s],s=l+c,n+=.2*e[s],s=a+h,n+=.2*e[s],n},ho.checkRow=function(t){const e=this.height;return t<0?e-1:t>=e?0:t},ho.checkCol=function(t){const e=this.width;return t<0?e-1:t>=e?0:t},ho.checkOutputValuesExist=function(){return!!this.dataArrays.length},ho.getOutputValue=function(t,e){let i,s,n,r;const{dataArrays:o,currentSource:a}=this;return a?[i,s,n,r]=o:[s,i,r,n]=o,(i[t]-n[t]+1)/2};const uo=function(t){return!!t&&new RdAsset(t)};v.RdAsset=RdAsset;const Rectangle=function(t=z){return this.shapeInit(t),this.currentRectangleWidth=1,this.currentRectangleHeight=1,this};let fo=Rectangle.prototype=Object.create(Object.prototype);fo.type="Rectangle",fo.lib="entity",fo.isArtefact=!0,fo.isAsset=!1,fo=xt(fo),fo=Ms(fo);fo.defs=tt(fo.defs,{rectangleWidth:10,rectangleHeight:10,radiusTLX:0,radiusTLY:0,radiusTRX:0,radiusTRY:0,radiusBRX:0,radiusBRY:0,radiusBLX:0,radiusBLY:0,offshootA:.55,offshootB:0});let po=fo.setters,mo=fo.deltaSetters;po.radius=function(t){this.setRectHelper(t,["radiusTLX","radiusTRX","radiusBRX","radiusBLX","radiusX","radiusTLY","radiusTRY","radiusBRY","radiusBLY","radiusY"])},po.radiusX=function(t){this.setRectHelper(t,["radiusTLX","radiusTRX","radiusBRX","radiusBLX","radiusX"])},po.radiusY=function(t){this.setRectHelper(t,["radiusTLY","radiusTRY","radiusBRY","radiusBLY","radiusY"])},po.radiusT=function(t){this.setRectHelper(t,["radiusTLX","radiusTLY","radiusTRX","radiusTRY"])},po.radiusB=function(t){this.setRectHelper(t,["radiusBRX","radiusBRY","radiusBLX","radiusBLY"])},po.radiusL=function(t){this.setRectHelper(t,["radiusTLX","radiusTLY","radiusBLX","radiusBLY"])},po.radiusR=function(t){this.setRectHelper(t,["radiusTRX","radiusTRY","radiusBRX","radiusBRY"])},po.radiusTX=function(t){this.setRectHelper(t,["radiusTLX","radiusTRX"])},po.radiusBX=function(t){this.setRectHelper(t,["radiusBRX","radiusBLX"])},po.radiusLX=function(t){this.setRectHelper(t,["radiusTLX","radiusBLX"])},po.radiusRX=function(t){this.setRectHelper(t,["radiusTRX","radiusBRX"])},po.radiusTY=function(t){this.setRectHelper(t,["radiusTLY","radiusTRY"])},po.radiusBY=function(t){this.setRectHelper(t,["radiusBRY","radiusBLY"])},po.radiusLY=function(t){this.setRectHelper(t,["radiusTLY","radiusBLY"])},po.radiusRY=function(t){this.setRectHelper(t,["radiusTRY","radiusBRY"])},po.radiusTL=function(t){this.setRectHelper(t,["radiusTLX","radiusTLY"])},po.radiusTR=function(t){this.setRectHelper(t,["radiusTRX","radiusTRY"])},po.radiusBL=function(t){this.setRectHelper(t,["radiusBLX","radiusBLY"])},po.radiusBR=function(t){this.setRectHelper(t,["radiusBRX","radiusBRY"])},po.radiusTLX=function(t){this.setRectHelper(t,["radiusTLX"])},po.radiusTLY=function(t){this.setRectHelper(t,["radiusTLY"])},po.radiusTRX=function(t){this.setRectHelper(t,["radiusTRX"])},po.radiusTRY=function(t){this.setRectHelper(t,["radiusTRY"])},po.radiusBRX=function(t){this.setRectHelper(t,["radiusBRX"])},po.radiusBRY=function(t){this.setRectHelper(t,["radiusBRY"])},po.radiusBLX=function(t){this.setRectHelper(t,["radiusBLX"])},po.radiusBLY=function(t){this.setRectHelper(t,["radiusBLY"])},mo.radius=function(t){this.deltaRectHelper(t,["radiusTLX","radiusTRX","radiusBRX","radiusBLX","radiusX","radiusTLY","radiusTRY","radiusBRY","radiusBLY","radiusY"])},mo.radiusX=function(t){this.deltaRectHelper(t,["radiusTLX","radiusTRX","radiusBRX","radiusBLX","radiusX"])},mo.radiusY=function(t){this.deltaRectHelper(t,["radiusTLY","radiusTRY","radiusBRY","radiusBLY","radiusY"])},mo.radiusT=function(t){this.deltaRectHelper(t,["radiusTLX","radiusTLY","radiusTRX","radiusTRY"])},mo.radiusB=function(t){this.deltaRectHelper(t,["radiusBRX","radiusBRY","radiusBLX","radiusBLY"])},mo.radiusL=function(t){this.deltaRectHelper(t,["radiusTLX","radiusTLY","radiusBLX","radiusBLY"])},mo.radiusR=function(t){this.deltaRectHelper(t,["radiusTRX","radiusTRY","radiusBRX","radiusBRY"])},mo.radiusTX=function(t){this.deltaRectHelper(t,["radiusTLX","radiusTRX"])},mo.radiusBX=function(t){this.deltaRectHelper(t,["radiusBRX","radiusBLX"])},mo.radiusLX=function(t){this.deltaRectHelper(t,["radiusTLX","radiusBLX"])},mo.radiusRX=function(t){this.deltaRectHelper(t,["radiusTRX","radiusBRX"])},mo.radiusTY=function(t){this.deltaRectHelper(t,["radiusTLY","radiusTRY"])},mo.radiusBY=function(t){this.deltaRectHelper(t,["radiusBRY","radiusBLY"])},mo.radiusLY=function(t){this.deltaRectHelper(t,["radiusTLY","radiusBLY"])},mo.radiusRY=function(t){this.deltaRectHelper(t,["radiusTRY","radiusBRY"])},mo.radiusTL=function(t){this.deltaRectHelper(t,["radiusTLX","radiusTLY"])},mo.radiusTR=function(t){this.deltaRectHelper(t,["radiusTRX","radiusTRY"])},mo.radiusBL=function(t){this.deltaRectHelper(t,["radiusBLX","radiusBLY"])},mo.radiusBR=function(t){this.deltaRectHelper(t,["radiusBRX","radiusBRY"])},mo.radiusTLX=function(t){this.deltaRectHelper(t,["radiusTLX"])},mo.radiusTLY=function(t){this.deltaRectHelper(t,["radiusTLY"])},mo.radiusTRX=function(t){this.deltaRectHelper(t,["radiusTRX"])},mo.radiusTRY=function(t){this.deltaRectHelper(t,["radiusTRY"])},mo.radiusBRX=function(t){this.deltaRectHelper(t,["radiusBRX"])},mo.radiusBRY=function(t){this.deltaRectHelper(t,["radiusBRY"])},mo.radiusBLX=function(t){this.deltaRectHelper(t,["radiusBLX"])},mo.radiusBLY=function(t){this.deltaRectHelper(t,["radiusBLY"])},po.offshootA=function(t){this.offshootA=t,this.updateDirty()},po.offshootB=function(t){this.offshootB=t,this.updateDirty()},mo.offshootA=function(t){t.toFixed&&(this.offshootA+=t,this.updateDirty())},mo.offshootB=function(t){t.toFixed&&(this.offshootB+=t,this.updateDirty())},po.rectangleWidth=function(t){null!=t&&(this.rectangleWidth=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},po.rectangleHeight=function(t){null!=t&&(this.rectangleHeight=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},mo.rectangleWidth=function(t){this.rectangleWidth=B(this.rectangleWidth,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},mo.rectangleHeight=function(t){this.rectangleHeight=B(this.rectangleHeight,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},fo.setRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=t}),this)},fo.deltaRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=B(this[e],t)}),this)},fo.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makeRectanglePath(),this.pathDefinition=t},fo.cleanDimensions=function(){this.dirtyDimensions=!1;let t=this.getHost();if(t){let e=t.currentDimensions?t.currentDimensions:[t.w,t.h],i=this.rectangleWidth,s=this.rectangleHeight,n=this.currentRectangleWidth||1,r=this.currentRectangleHeight||1;i.substring&&(i=parseFloat(i)/100*e[0]),s.substring&&(s=parseFloat(s)/100*e[1]);let o,a=this.mimic;a&&a.name&&this.useMimicDimensions&&(o=a.currentDimensions),o?(this.currentRectangleWidth=this.addOwnDimensionsToMimic?o[0]+i:o[0],this.currentRectangleHeight=this.addOwnDimensionsToMimic?o[1]+s:o[1]):(this.currentRectangleWidth=i,this.currentRectangleHeight=s),this.currentDimensions[0]=this.currentRectangleWidth,this.currentDimensions[1]=this.currentRectangleHeight,this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0,n===this.currentRectangleWidth&&r===this.currentRectangleHeight||(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicDimensions=!0)}else this.dirtyDimensions=!0},fo.makeRectanglePath=function(){this.dirtyDimensions&&this.cleanDimensions();let t=this.currentRectangleWidth,e=this.currentRectangleHeight,i=this.offshootA,s=this.offshootB,n=this.radiusTLX,r=this.radiusTLY,o=this.radiusTRX,a=this.radiusTRY,l=this.radiusBRX,h=this.radiusBRY,c=this.radiusBLX,u=this.radiusBLY;(n.substring||r.substring||o.substring||a.substring||l.substring||h.substring||c.substring||u.substring)&&(n=n.substring?parseFloat(n)/100*t:n,r=r.substring?parseFloat(r)/100*e:r,o=o.substring?parseFloat(o)/100*t:o,a=a.substring?parseFloat(a)/100*e:a,l=l.substring?parseFloat(l)/100*t:l,h=h.substring?parseFloat(h)/100*e:h,c=c.substring?parseFloat(c)/100*t:c,u=u.substring?parseFloat(u)/100*e:u);let d="m0,0";return t-n-o!=0&&(d+="h"+(t-n-o)),o+a!==0&&(d+=`c${o*i},${a*s} ${o-o*s},${a-a*i}, ${o},${a}`),e-a-h!=0&&(d+="v"+(e-a-h)),l+h!==0&&(d+=`c${-l*s},${h*i} ${l*i-l},${h-h*s} ${-l},${h}`),-t+c+l!==0&&(d+=`h${-t+c+l}`),c+u!==0&&(d+=`c${-c*i},${-u*s} ${c*s-c},${u*i-u} ${-c},${-u}`),-e+r+u!==0&&(d+=`v${-e+r+u}`),n+r!==0&&(d+=`c${n*s},${-r*i} ${n-n*i},${r*s-r} ${n},${-r}`),d+="z",d},fo.calculateLocalPathAdditionalActions=function(){let[t,e,i,s]=this.localBox;this.pathDefinition=this.pathDefinition.replace("m0,0",`m${-t},${-e}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const go=function(t){return!!t&&(t.species="rectangle",new Rectangle(t))};v.Rectangle=Rectangle;const Shape=function(t=z){return this.shapeInit(t),this};let yo=Shape.prototype=Object.create(Object.prototype);yo.type="Shape",yo.lib="entity",yo.isArtefact=!0,yo.isAsset=!1,yo=xt(yo),yo=Ms(yo);yo.defs=tt(yo.defs,{}),yo.cleanSpecies=function(){this.dirtySpecies=!1},yo.cleanStampHandlePositionsAdditionalActions=function(){let t=this.localBox,e=this.currentStampHandlePosition;e[0]+=t[0],e[1]+=t[1]};const bo=function(t){return!!t&&new Shape(t)};v.Shape=Shape;const Spiral=function(t=z){return this.shapeInit(t),this};let So=Spiral.prototype=Object.create(Object.prototype);So.type="Spiral",So.lib="entity",So.isArtefact=!0,So.isAsset=!1,So=xt(So),So=Ms(So);So.defs=tt(So.defs,{loops:1,loopIncrement:1,drawFromLoop:0});let ko=So.setters,Ao=So.deltaSetters;ko.loops=function(t){this.loops=t,this.updateDirty()},Ao.loops=function(t){this.loops+=t,this.updateDirty()},ko.loopIncrement=function(t){this.loopIncrement=t,this.updateDirty()},Ao.loopIncrement=function(t){this.loopIncrement+=t,this.updateDirty()},ko.drawFromLoop=function(t){this.drawFromLoop=Math.floor(t),this.updateDirty()},Ao.drawFromLoop=function(t){this.drawFromLoop=Math.floor(this.drawFromLoop+t),this.updateDirty()},So.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makeSpiralPath(),this.pathDefinition=t},So.firstTurn=[[.043,0,.082,-.035,.088,-.088],[.007,-.057,-.024,-.121,-.088,-.162],[-.07,-.045,-.169,-.054,-.265,-.015],[-.106,.043,-.194,.138,-.235,.265],[-.044,.139,-.026,.3,.058,.442],[.091,.153,.25,.267,.442,.308],[.206,.044,.431,-.001,.619,-.131],[.2,-.139,.34,-.361,.381,-.619]],So.subsequentTurns=[[0,-.27,-.11,-.52,-.29,-.71],[-.19,-.19,-.44,-.29,-.71,-.29],[-.27,0,-.52,.11,-.71,.29],[-.19,.19,-.29,.44,-.29,.71],[0,.27,.11,.52,.29,.71],[.19,.19,.44,.29,.71,.29],[.27,0,.52,-.11,.71,-.29],[.19,-.19,.29,-.44,.29,-.71]],So.makeSpiralPath=function(){let t,e,i,s,n,r,o,a,l,h,c,u,d=Math.floor(this.loops),f=this.loopIncrement,p=Math.floor(this.drawFromLoop),m=this.firstTurn,g=this.subsequentTurns,y=[];for(let o=0;o<m.length;o++)[t,e,i,s,n,r]=m[o],y.push([t*f,e*f,i*f,s*f,n*f,r*f]);let b="m0,0";for(let m=0;m<d;m++)for(let d=0;d<y.length;d++)[t,e,i,s,n,r]=y[d],m>=p&&(b+=`c${t},${e} ${i},${s} ${n},${r}`),[o,a,l,h,c,u]=g[d],y[d]=[t+o*f,e+a*f,i+l*f,s+h*f,n+c*f,r+u*f];return b},So.calculateLocalPathAdditionalActions=function(){let[t,e,i,s]=this.localBox,n=this.scale;this.pathDefinition=this.pathDefinition.replace("m0,0",`m${-t/n},${-e/n}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const wo=function(t){return!!t&&(t.species="spiral",new Spiral(t))};v.Spiral=Spiral;const Star=function(t=z){return this.shapeInit(t),this};let vo=Star.prototype=Object.create(Object.prototype);vo.type="Star",vo.lib="entity",vo.isArtefact=!0,vo.isAsset=!1,vo=xt(vo),vo=Ms(vo);vo.defs=tt(vo.defs,{radius1:0,radius2:0,points:0,twist:0});let Co=vo.setters,Oo=vo.deltaSetters;Co.radius1=function(t){this.radius1=t,this.updateDirty()},Oo.radius1=function(t){this.radius1+=t,this.updateDirty()},Co.radius2=function(t){this.radius2=t,this.updateDirty()},Oo.radius2=function(t){this.radius2+=t,this.updateDirty()},Co.points=function(t){this.points=t,this.updateDirty()},Oo.points=function(t){this.points+=t,this.updateDirty()},Co.twist=function(t){this.twist=t,this.updateDirty()},Oo.twist=function(t){this.twist+=t,this.updateDirty()},vo.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makeStarPath(),this.pathDefinition=t},vo.makeStarPath=function(){let t,e,i,s,n,r,o,a=this.points,l=this.twist,h=this.radius1,c=this.radius2,u=360/a,d=[],f="";if(h.substring||c.substring){let t=this.getHost();if(t){let[e,i]=t.currentDimensions;h=h.substring?parseFloat(h)/100*e:h,c=c.substring?parseFloat(c)/100*e:c}}let p=gi({x:0,y:-h}),m=gi({x:0,y:-c});for(t=p.x,e=p.y,d.push(t),m.rotate(-u/2),m.rotate(l),o=0;o<a;o++)m.rotate(u),i=parseFloat((m.x-t).toFixed(1)),t+=i,d.push(t),s=parseFloat((m.y-e).toFixed(1)),e+=s,f+=`${i},${s} `,p.rotate(u),i=parseFloat((p.x-t).toFixed(1)),t+=i,d.push(t),s=parseFloat((p.y-e).toFixed(1)),e+=s,f+=`${i},${s} `;return yi(p),yi(m),n=Math.min(...d),r=Math.abs(n).toFixed(1),f=`m${r},0l${f}z`,f};const Po=function(t){return!!t&&(t.species="star",new Star(t))};v.Star=Star;const Tetragon=function(t=z){return this.shapeInit(t),this};let xo=Tetragon.prototype=Object.create(Object.prototype);xo.type="Tetragon",xo.lib="entity",xo.isArtefact=!0,xo.isAsset=!1,xo=xt(xo),xo=Ms(xo);xo.defs=tt(xo.defs,{radiusX:5,radiusY:5,intersectX:.5,intersectY:.5});let Do=xo.setters,Ro=xo.deltaSetters;Do.radius=function(t){this.setRectHelper(t,["radiusX","radiusY"])},Do.radiusX=function(t){this.setRectHelper(t,["radiusX"])},Do.radiusY=function(t){this.setRectHelper(t,["radiusY"])},Ro.radius=function(t){this.deltaRectHelper(t,["radiusX","radiusY"])},Ro.radiusX=function(t){this.deltaRectHelper(t,["radiusX"])},Ro.radiusY=function(t){this.deltaRectHelper(t,["radiusY"])},Do.intersectA=function(t){this.intersectA=t,this.updateDirty()},Do.intersectB=function(t){this.intersectB=t,this.updateDirty()},Ro.intersectA=function(t){t.toFixed&&(this.intersectA+=t,this.updateDirty())},Ro.intersectB=function(t){t.toFixed&&(this.intersectB+=t,this.updateDirty())},xo.setRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=t}),this)},xo.deltaRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=addStrings(this[e],t)}),this)},xo.cleanSpecies=function(){this.dirtySpecies=!1;let t="M0,0";t=this.makeTetragonPath(),this.pathDefinition=t},xo.makeTetragonPath=function(){let t,e,i=this.radiusX,s=this.radiusY;if(i.substring||s.substring){let n=this.getHost();if(n){let[r,o]=n.currentDimensions;t=2*(i.substring?parseFloat(i)/100*r:i),e=2*(s.substring?parseFloat(s)/100*o:s)}}else t=2*i,e=2*s;let n=parseFloat((t*this.intersectX).toFixed(2)),r=parseFloat((t-n).toFixed(2)),o=parseFloat((e*this.intersectY).toFixed(2)),a=parseFloat((e-o).toFixed(2)),l="m0,0";return l+=`l${r},${o} ${-r},${a} ${-n},${-a} ${n},${-o}z`,l},xo.calculateLocalPathAdditionalActions=function(){let[t,e,i,s]=this.localBox;this.pathDefinition=this.pathDefinition.replace("m0,0",`m${-t},${-e}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Fo=function(t){return!!t&&(t.species="tetragon",new Tetragon(t))};v.Tetragon=Tetragon;const Ticker=function(t=z){return this.makeName(t.name),this.register(),this.subscribers=[],this.subscriberObjects=[],this.set(this.defs),this.set(t),this.cycleCount=0,this.active=!1,this.effectiveDuration=0,this.startTime=0,this.currentTime=0,this.tick=0,this.lastEvent=0,t.subscribers&&this.subscribe(t.subscribers),this.setEffectiveDuration(),this};let Eo=Ticker.prototype=Object.create(Object.prototype);Eo.type="Ticker",Eo.lib="animationtickers",Eo.isArtefact=!1,Eo.isAsset=!1,Eo=xt(Eo);Eo.defs=tt(Eo.defs,{order:1,duration:0,subscribers:null,killOnComplete:!1,cycles:1,eventChoke:0,onRun:null,onHalt:null,onReverse:null,onResume:null,onSeekTo:null,onSeekFor:null,onComplete:null,onReset:null}),Eo.packetExclusions=it(Eo.packetExclusions,["subscribers"]),Eo.packetFunctions=it(Eo.packetFunctions,["onRun","onHalt","onReverse","onResume","onSeekTo","onSeekFor","onComplete","onReset"]),Eo.kill=function(){return this.active&&this.halt(),st(To,this.name),Ho=!0,this.deregister(),!0},Eo.killTweens=function(t=!1){let e,i,s;for(e=0,i=this.subscribers.length;e<i;e++)s=S[this.subscribers[e]],s.completeAction(),s.kill();return t?(this.kill(),!0):this};let Io=Eo.getters,Mo=Eo.setters;Io.subscribers=function(){return[].concat(this.subscribers)},Mo.subscribers=function(t){this.subscribers=[],this.subscribe(t)},Mo.order=function(t){this.order=t,this.active&&(Ho=!0)},Mo.cycles=function(t){this.cycles=t,this.cycles||(this.cycleCount=0)},Mo.duration=function(t){let e,i,s,n=this.subscribers;if(this.duration=t,this.setEffectiveDuration(),nt(n))for(e=0,i=n.length;e<i;e++)s=S[n[e]],s&&(s.calculateEffectiveTime(),"Tween"===s.type&&s.calculateEffectiveDuration())},Eo.subscribe=function(t){let e,i,s,n,r=[].concat(t);for(e=0,i=r.length;e<i;e++)s=r[e],null!=s&&(n=s.substring?s:!(!K(s)||!s.name)&&s.name,n&&it(this.subscribers,n));return r.length&&(this.sortSubscribers(),this.recalculateEffectiveDuration()),this},Eo.unsubscribe=function(t){var e,i,s,n,r=[].concat(t);for(e=0,i=r.length;e<i;e++)(n=(s=t[e]).substring?s:!(!K(s)||!s.name)&&s.name)&&st(this.subscribers,n);return r.length&&(this.sortSubscribers(),this.recalculateEffectiveDuration()),this},Eo.repopulateSubscriberObjects=function(){let t,e=this.subscriberObjects,i=this.subscribers;e.length=0,i.forEach((i=>{t=S[i],t&&e.push(t)}))},Eo.getSubscriberObjects=function(){return this.subscribers.length&&!this.subscriberObjects.length&&this.repopulateSubscriberObjects(),this.subscriberObjects},Eo.sortSubscribers=function(){let t=this.subscribers;if(t.length>1){let e=[].concat(t),i=Math.floor,s=[];e.forEach((t=>{let e=i(t.effectiveTime)||0;s[e]||(s[e]=[]),s[e].push(t)})),this.subscribers=s.reduce(((t,e)=>t.concat(e)),[])}this.repopulateSubscriberObjects()},Eo.updateSubscribers=function(t,e){e=!!nt(e)&&e;let i,s,n=this.getSubscriberObjects();if(e)for(i=n.length-1;i>=0;i--)n[i].set(t);else for(i=0,s=n.length;i<s;i++)n[i].set(t);return this},Eo.changeSubscriberDirection=function(){return this.getSubscriberObjects().forEach((t=>t.reversed=!t.reversed)),this},Eo.makeTickerUpdateEvent=function(){return new CustomEvent("tickerupdate",{detail:{name:this.name,type:"Ticker",tick:this.tick,reverseTick:this.effectiveDuration-this.tick},bubbles:!0,cancelable:!0})},Eo.recalculateEffectiveDuration=function(){let t,e=this.getSubscriberObjects(),i=0;return this.duration?this.setEffectiveDuration():(e.forEach((e=>{t=e.getEndTime(),t>i&&(i=t)})),this.effectiveDuration=i),this},Eo.setEffectiveDuration=function(){let t;return this.duration&&(t=L(this.duration),"%"===t[0]?(this.duration=0,this.recalculateEffectiveDuration()):this.effectiveDuration=t[1]),this},Eo.fn=function(t){let e=Lo();t=!!nt(t)&&t;let i,s,n,r,o,a,l,h,c=this.active,u=this.startTime,d=this.cycles,f=this.cycleCount,p=this.effectiveDuration,m=this.eventChoke;if(c&&u&&(!d||f<d)){if(l=this.currentTime=Date.now(),h=this.tick=l-u,!d||f+1<d?(h>=p?(h=this.tick=0,this.startTime=this.currentTime,e.tick=p,e.reverseTick=0,e.willLoop=!0,d&&(f++,this.cycleCount=f)):(e.tick=h,e.reverseTick=p-h),e.next=!0):h>=p?(e.tick=p,e.reverseTick=0,c=this.active=!1,d&&(f++,this.cycleCount=f)):(e.tick=h,e.reverseTick=p-h,e.next=!0),n=this.getSubscriberObjects(),t)for(i=n.length-1;i>=0;i--)n[i].update(e);else for(i=0,s=n.length;i<s;i++)n[i].update(e);m&&(r=this.lastEvent+m,o=Date.now(),r<o&&(a=this.makeTickerUpdateEvent(),window.dispatchEvent(a),this.lastEvent=o)),c||this.halt(),this.killOnComplete&&f>=d&&this.killTweens(!0)}$o(e)},Eo.run=function(){return this.active||(this.startTime=this.currentTime=Date.now(),this.cycleCount=0,this.updateSubscribers({reversed:!1}),this.active=!0,it(To,this.name),Ho=!0,"function"==typeof this.onRun&&this.onRun()),this},Eo.isRunning=function(){return this.active},Eo.reset=function(){return this.active&&this.halt(),this.startTime=this.currentTime=Date.now(),this.cycleCount=0,this.updateSubscribers({reversed:!1}),this.active=!0,this.fn(!0),this.active=!1,"function"==typeof this.onReset&&this.onReset(),this},Eo.complete=function(){return this.active&&this.halt(),this.startTime=this.currentTime=Date.now(),this.cycleCount=0,this.updateSubscribers({reversed:!0}),this.active=!0,this.fn(),this.active=!1,"function"==typeof this.onComplete&&this.onComplete(),this},Eo.reverse=function(t=!1){let e;return t=ot(t,!1),this.active&&this.halt(),e=this.currentTime-this.startTime,this.startTime=this.currentTime-(this.effectiveDuration-e),this.changeSubscriberDirection(),this.active=!0,this.fn(),this.active=!1,"function"==typeof this.onReverse&&this.onReverse(),t&&this.resume(),this},Eo.halt=function(){return this.active=!1,it(To,this.name),Ho=!0,"function"==typeof this.onHalt&&this.onHalt(),this},Eo.resume=function(){let t,e,i;return this.active||(t=Date.now(),e=this.currentTime,i=this.startTime,this.startTime=t-(e-i),this.currentTime=t,this.active=!0,it(To,this.name),Ho=!0,"function"==typeof this.onResume&&this.onResume()),this},Eo.seekTo=function(t,e=!1){let i=!1;return t=ot(t,0),this.active&&this.halt(),this.cycles&&this.cycleCount>=this.cycles&&(this.cycleCount=this.cycles-1),t<this.tick&&(i=!0),this.currentTime=Date.now(),this.startTime=this.currentTime-t,this.active=!0,this.fn(i),this.active=!1,"function"==typeof this.onSeekTo&&this.onSeekTo(),e&&this.resume(),this},Eo.seekFor=function(t,e=!1){let i=!1;return t=__xtGet(t,0),this.active&&this.halt(),this.cycles&&this.cycleCount>=this.cycles&&(this.cycleCount=this.cycles-1),this.startTime-=t,t<0&&(i=!0),this.active=!0,this.fn(i),this.active=!1,"function"==typeof this.onSeekFor&&this.onSeekFor(),e&&this.resume(),this};let To=[],Ho=!0;Rt({name:"coreTickersAnimation",order:0,fn:function(){if(Ho){Ho=!1;let t=[].concat(To),i=Math.floor,s=[];t.forEach((t=>{let n=e[t];if(nt(n)){let t=i(n.order)||0;s[t]||(s[t]=[]),s[t].push(n.name)}})),To=s.reduce(((t,e)=>t.concat(e)),[])}for(let t,i,s=0,n=To.length;s<n;s++)t=To[s],i=e[t],i&&i.fn&&i.fn()}});const Bo=[],Lo=function(){return Bo.length||Bo.push({tick:0,reverseTick:0,willLoop:!1,next:!1}),Bo.shift()},$o=function(t){t&&(t.tick=0,t.reverseTick=0,t.willLoop=!1,t.next=!1,Bo.push(t))},jo=function(t){return!!t&&new Ticker(t)};v.Ticker=Ticker;const Tracer=function(t=z){return this.makeName(t.name),this.register(),this.initializePositions(),this.set(this.defs),this.onEnter=Y,this.onLeave=Y,this.onDown=Y,this.onUp=Y,this.stampAction=Y,this.trace=cn(t),t.group||(t.group=qi),this.set(t),this.purge&&this.purgeArtefact(this.purge),this};let Yo=Tracer.prototype=Object.create(Object.prototype);Yo.type="Tracer",Yo.lib="entity",Yo.isArtefact=!0,Yo.isAsset=!1,Yo=xt(Yo),Yo=Os(Yo);Yo.defs=tt(Yo.defs,{artefact:null,historyLength:1,hitRadius:10,showHitRadius:!1,hitRadiusColor:"#000000"}),Yo.packetExclusions=it(Yo.packetExclusions,[]),Yo.packetExclusionsByRegex=it(Yo.packetExclusionsByRegex,[]),Yo.packetCoordinates=it(Yo.packetCoordinates,[]),Yo.packetObjects=it(Yo.packetObjects,["artefact","particle"]),Yo.packetFunctions=it(Yo.packetFunctions,["stampAction"]),Yo.finalizePacketOut=function(t,e){return t},Yo.postCloneAction=function(t,e){return t.trace=cn({name:t.name,historyLength:e.historyLength||this.historyLength||1}),t},Yo.factoryKill=function(t){t&&this.artefact.kill(),this.trace.kill()},Yo.getters;let Xo=Yo.setters;Yo.deltaSetters,Xo.stampAction=function(t){q(t)&&(this.stampAction=t)},Xo.artefact=function(t){let e;t.substring?e=i[t]:K(t)&&t.isArtefact&&(e=t),e&&(this.artefact=e,this.dirtyFilterIdentifier=!0)},Yo.regularStamp=function(){let{artefact:t,trace:e,stampAction:i,showHitRadius:s,hitRadius:n,hitRadiusColor:r,currentStampPosition:o}=this,a=this.currentHost;if(e.set({position:o}),e.manageHistory(0,a),i.call(this,t,e,a),s){let t=a.engine;t.save(),t.lineWidth=1,t.strokeStyle=r,t.setTransform(1,0,0,1,0,0),t.beginPath(),t.arc(o[0],o[1],n,0,2*Math.PI),t.stroke(),t.restore()}},Yo.checkHit=function(t=[],e){if(this.noUserInteraction)return!1;let i,s,n=Array.isArray(t)?t:[t],r=this.currentStampPosition,o=!1;if(n.some((t=>{if(Array.isArray(t))i=t[0],s=t[1];else{if(!rt(t,t.x,t.y))return!1;i=t.x,s=t.y}if(!i.toFixed||!s.toFixed||isNaN(i)||isNaN(s))return!1;let e=gi(r).vectorSubtract(t);return e.getMagnitude()<this.hitRadius&&(o=!0),yi(e),o}),this)){return this.checkHitReturn(i,s,e)}return!1};const No=function(t){return!!t&&new Tracer(t)};v.Tracer=Tracer;const Tween=function(t=z){let i;return this.makeName(t.name),this.register(),this.set(this.defs),this.set(t),this.setDefinitionsValues(),this.status=-1,this.calculateEffectiveTime(),this.calculateEffectiveDuration(),e[t.ticker]?this.addToTicker(t.ticker):(i=`${this.name}_ticker`,jo({name:i,order:this.order,subscribers:this.name,duration:this.effectiveDuration,eventChoke:ot(t.eventChoke,0),cycles:ot(t.cycles,1),killOnComplete:ot(t.killOnComplete,!1)}),this.ticker=i,e[i].recalculateEffectiveDuration()),this};let Go=Tween.prototype=Object.create(Object.prototype);Go.type="Tween",Go.lib="tween",Go.isArtefact=!1,Go.isAsset=!1,Go=xt(Go),Go=As(Go);Go.defs=tt(Go.defs,{definitions:null,duration:0,killOnComplete:!1,commenceAction:null,onRun:null,onHalt:null,onResume:null,onReverse:null,onSeekTo:null,onSeekFor:null,completeAction:null}),Go.packetExclusions=it(Go.packetExclusions,["definitions","targets"]),Go.packetFunctions=it(Go.packetFunctions,["commenceAction","completeAction","onRun","onHalt","onResume","onReverse","onSeekTo","onSeekFor","action"]),Go.finalizePacketOut=function(t,e){return Array.isArray(this.targets)&&(t.targets=this.targets.map((t=>t.name))),Array.isArray(this.definitions)&&(t.definitions=this.definitions.map((t=>{let e={};if(e.attribute=t.attribute,e.start=t.start,e.end=t.end,t.engine&&t.engine.substring)e.engine=t.engine.substring;else if(nt(t.engine)&&null!==t.engine){let i=this.stringifyFunction(t.engine);i&&(e.engine=i,e.engineIsFunction=!0)}return e}))),t},Go.postCloneAction=function(t,i){if(i.useNewTicker){let s=e[this.ticker];nt(i.cycles)?t.cycles=i.cycles:t.cycles=s?s.cycles:1;let n=e[t.ticker];n.cycles=t.cycles,nt(i.duration)&&(t.duration=i.duration,t.calculateEffectiveDuration(),n&&n.recalculateEffectiveDuration())}return Array.isArray(t.definitions)&&t.definitions.forEach(((t,e)=>{t.engineIsFunction&&(t.engine=this.definitions[e].engine)})),t};let zo=Go.getters,Wo=Go.setters;zo.definitions=function(){return[].concat(this.definitions)},Wo.definitions=function(t){this.definitions=[].concat(t),this.setDefinitionsValues()},Wo.commenceAction=function(t){this.commenceAction=t,"function"!=typeof this.commenceAction&&(this.commenceAction=Y)},Wo.completeAction=function(t){this.completeAction=t,"function"!=typeof this.completeAction&&(this.completeAction=Y)},Go.set=function(t=z){let e,i,s,n,r=this.setters,o=Object.keys(t),a=this.defs,l=!!nt(t.ticker)&&this.ticker;for(i=0,s=o.length;i<s;i++)e=o[i],"name"!==e&&(n=r[e],n?n.call(this,t[e]):void 0!==a[e]&&(this[e]=t[e]));return l?(this.ticker=l,this.addToTicker(t.ticker)):at(t.time,t.duration)&&(this.calculateEffectiveTime(),this.calculateEffectiveDuration()),this},Go.getEndTime=function(){return this.effectiveTime+this.effectiveDuration},Go.calculateEffectiveDuration=function(t){let i,s=ot(t,this.duration),n=L(s),r=n[1],o=n[0],a=this.ticker,l=0;return this.effectiveDuration=0,"%"===o?a&&(i=e[a],i&&(l=i.effectiveDuration,this.effectiveDuration=l*(r/100))):this.effectiveDuration=r,this},Go.update=function(t=z){let e,i,s=t.tick||0,n=t.reverseTick||0,r=0,o=this.effectiveTime,a=this.effectiveDuration,l=this.reversed;l?(e=o+a,i=o,n>e?r=1:n<i&&(r=-1)):(e=o,i=o+a,s<e?r=-1:s>i&&(r=1)),a?r&&r==this.status||(this.status=r,this.doSimpleUpdate(t),t.next||(this.status=l?-1:1)):r!=this.status&&(this.status=r,this.doSimpleUpdate(t),t.next||(this.status=l?-1:1)),t.willLoop&&(this.reverseOnCycleEnd?this.reversed=!l:this.status=-1)},Go.doSimpleUpdate=function(t=z){let e,i,s,n,r,o,a,l,h,c,u,d,f,p,m=this.effectiveTime,g=this.engineActions,y=this.effectiveDuration,b=this.status,S=this.definitions,k=this.targets,A=this.action,w=this.setObj||{},v=Math.round;for(e=this.reversed?t.reverseTick-m:t.tick-m,o=y&&!b?e/y:b>0?1:0,i=0,s=S.length;i<s;i++)a=S[i],l=a.engine,c=a.effectiveStart,u=a.effectiveChange,d=a.integer,f=a.suffix,p=a.attribute,h=l.substring?g(l,c,u,o):l(c,u,o),d&&(h=v(h)),f&&(h+=f),w[p]=h;for(n=0,r=k.length;n<r;n++)k[n].set(w);this.setObj=w,A&&A()},Go.engineActions=function(t,e,i,s){const n=null!=lt[t]?t:"linear";return e+i*lt[n](s)},Go.setDefinitionsValues=function(){let t,e,i,s,n=this.parseDefinitionsValue,r=this.definitions;for(t=0,e=r.length;t<e;t++)s=r[t],s&&(i=n(s.start),s.effectiveStart=i[1],s.suffix=i[0],i=n(s.end),s.effectiveEnd=i[1],nt(s.engine)||(s.engine="linear"),s.effectiveChange=s.effectiveEnd-s.effectiveStart);return this},Go.parseDefinitionsValue=function(t){let e,i=["",0];return nt(t)&&(t.toFixed?i[1]=t:t.substring&&(e=t.match(/^-?\d+\.?\d*(\D*)/),nt(e[0])&&(i[1]=parseFloat(e)),nt(e[1])&&(i[0]=e[1]))),i},Go.run=function(){let t=e[this.ticker];return t&&(this.commenceAction(),t.run(),"function"==typeof this.onRun&&this.onRun()),this},Go.isRunning=function(){let t=e[this.ticker];return!!t&&t.isRunning()},Go.halt=function(){let t=e[this.ticker];return t&&(t.halt(),"function"==typeof this.onHalt&&this.onHalt()),this},Go.reverse=function(){let t=e[this.ticker];return t&&(t.reverse(),"function"==typeof this.onReverse&&this.onReverse()),this},Go.resume=function(){let t=e[this.ticker];return t&&(t.resume(),"function"==typeof this.onResume&&this.onResume()),this},Go.seekTo=function(t){let i=e[this.ticker];return i&&(i.seekTo(t),"function"==typeof this.onSeekTo&&this.onSeekTo()),this},Go.seekFor=function(t){let i=e[this.ticker];return i&&(i.seekFor(t),"function"==typeof this.onSeekFor&&this.onSeekFor()),this};const Vo=function(t){return!!t&&new Tween(t)};v.Tween=Tween;const Zo=(t,e)=>(t=parseFloat(t),Q(t)||(t=0),Q(e)||(e=0),parseFloat(t.toFixed(e))),Wheel=function(t=z){return at(t.dimensions,t.width,t.height,t.radius)||(t.radius=5),this.entityInit(t),this};let Uo=Wheel.prototype=Object.create(Object.prototype);Uo.type="Wheel",Uo.lib="entity",Uo.isArtefact=!0,Uo.isAsset=!1,Uo=xt(Uo),Uo=Os(Uo);Uo.defs=tt(Uo.defs,{radius:5,startAngle:0,endAngle:360,clockwise:!0,includeCenter:!1,closed:!0}),Uo.getters;let _o=Uo.setters,qo=Uo.deltaSetters;_o.width=function(t){if(null!=t){let e=this.dimensions;e[0]=e[1]=t,this.dimensionsHelper()}},qo.width=function(t){let e=this.dimensions;e[0]=e[1]=addStrings(e[0],t),this.dimensionsHelper()},_o.height=function(t){if(null!=t){let e=this.dimensions;e[0]=e[1]=t,this.dimensionsHelper()}},qo.height=function(t){let e=this.dimensions;e[0]=e[1]=addStrings(e[0],t),this.dimensionsHelper()},_o.dimensions=function(t,e){this.setCoordinateHelper("dimensions",t,e),this.dimensionsHelper()},qo.dimensions=function(t,e){this.setDeltaCoordinateHelper("dimensions",t,e),this.dimensionsHelper()},_o.radius=function(t){this.radius=t,this.radiusHelper()},qo.radius=function(t){this.radius=addStrings(this.radius,t),this.radiusHelper()},_o.startAngle=function(t){this.startAngle=Zo(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},qo.startAngle=function(t){this.startAngle+=Zo(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},_o.endAngle=function(t){this.endAngle=Zo(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},qo.endAngle=function(t){this.endAngle+=Zo(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},_o.closed=function(t){nt(t)&&(this.closed=!!t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0)},_o.includeCenter=function(t){nt(t)&&(this.includeCenter=!!t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0)},_o.clockwise=function(t){nt(t)&&(this.clockwise=!!t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0)},Uo.dimensionsHelper=function(){let t=this.dimensions[0];t.substring?this.radius=parseFloat(t)/2+"%":this.radius=t/2,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},Uo.radiusHelper=function(){let t=this.radius,e=this.dimensions;t.substring?e[0]=e[1]=2*parseFloat(t)+"%":e[0]=e[1]=2*t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},Uo.cleanDimensionsAdditionalActions=function(){let t=this.radius,e=this.currentDimensions,i=t.substring?parseFloat(t)/100*e[0]:t;e[0]!==2*i?(e[1]=e[0],this.currentRadius=e[0]/2):this.currentRadius=i},Uo.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){let t=this.pathObject=new Path2D,e=this.currentStampHandlePosition,i=this.currentScale,s=this.currentRadius*i,n=s-e[0]*i,r=s-e[1]*i,o=this.startAngle*C,a=this.endAngle*C;t.arc(n,r,s,o,a,!this.clockwise),this.includeCenter?(t.lineTo(n,r),t.closePath()):this.closed&&t.closePath()}};const Qo=function(t){return!!t&&new Wheel(t)};v.Wheel=Wheel;const World=function(t=z){this.makeName(t.name),this.register(),this.set(this.defs);let e=t.keytypes||{};return e.gravity||(e.gravity="Vector"),t.gravity||(t.gravity=[0,9.81,0]),t.userAttributes&&t.userAttributes.forEach((t=>{this.addAttribute(t),t.type&&(e[t.key]=t.type)})),this.initializeAttributes(e),this.set(t),this};let Ko=World.prototype=Object.create(Object.prototype);Ko.type="World",Ko.lib="world",Ko.isArtefact=!1,Ko.isAsset=!1,Ko=xt(Ko);Ko.defs=tt(Ko.defs,{gravity:null,tickMultiplier:1,keytypes:null}),Ko.kill=function(){return this.deregister(),!0};let Jo=Ko.getters,ta=Ko.setters,ea=Ko.deltaSetters;ta.gravityX=function(t){this.gravity&&nt(t)&&this.gravity.setX(t)},ta.gravityY=function(t){this.gravity&&nt(t)&&this.gravity.setY(t)},ta.gravityZ=function(t){this.gravity&&nt(t)&&this.gravity.setZ(t)},ta.gravity=function(t){this.gravity&&nt(t)&&this.gravity.set(t)},Ko.addAttribute=function(t=z){let{key:e,defaultValue:i,setter:s,deltaSetter:n,getter:r}=t;return e&&e.substring&&(this.defs[e]=nt(i)?i:null,this[e]=nt(i)?i:null,q(s)&&(ta[e]=s),q(n)&&(ea[e]=n),q(r)&&(Jo[e]=r)),this},Ko.removeAttribute=function(t){return t&&t.substring&&(delete this.defs[t],delete this[t],delete Jo[t],delete ta[t],delete ea[t]),this},Ko.initializeAttributes=function(t){for(let[e,i]of Object.entries(t))switch(i){case"Quaternion":this[e]=vi();break;case"Vector":this[e]=bi();break;case"Coordinate":this[e]=ke()}};const ia=function(t){return!!t&&new World(t)};v.World=World;const sa=ds;"undefined"!=typeof window&&ds();export{Ki as addCanvas,ct as addListener,mt as addNativeListener,Wi as addStack,Ji as clear,ts as compile,Re as createImageFromCell,Ee as createImageFromEntity,Fe as createImageFromGroup,jt as currentCorePosition,oe as forceUpdate,Zi as getCanvas,Ct as getIgnorePixelRatio,wt as getPixelRatio,Ui as getStack,qt as getTouchActionChoke,De as importDomImage,ur as importDomVideo,xe as importImage,dr as importMediaStream,yr as importSprite,fr as importVideo,sa as init,x as library,Cs as makeAction,Rt as makeAnimation,ht as makeAnimationObserver,Ys as makeBezier,xs as makeBlock,zs as makeCog,ni as makeColor,Qs as makeConicGradient,en as makeCrescent,le as makeDragZone,bn as makeEmitter,vn as makeFilter,On as makeForce,kn as makeGradient,Rn as makeGrid,fi as makeGroup,En as makeLine,Hn as makeLineSpiral,Yn as makeLoom,zn as makeMesh,Qn as makeNet,ir as makeNoise,er as makeNoiseAsset,or as makeOval,Ar as makePattern,Mr as makePhrase,$r as makePicture,Nr as makePolygon,Zr as makePolyline,Kr as makeQuadratic,so as makeRadialGradient,lo as makeRawAsset,uo as makeReactionDiffusionAsset,go as makeRectangle,ps as makeRender,bo as makeShape,gs as makeSnippet,wo as makeSpiral,Zn as makeSpring,Po as makeStar,Fo as makeTetragon,jo as makeTicker,No as makeTracer,Vo as makeTween,Qo as makeWheel,ia as makeWorld,ae as observeAndUpdate,Se as releaseCoordinate,wi as releaseQuaternion,yi as releaseVector,ut as removeListener,gt as removeNativeListener,is as render,be as requestCoordinate,Ai as requestQuaternion,gi as requestVector,ue as seededRandomNumberGenerator,Qi as setCurrentCanvas,li as setFilterMemoizationChoke,Ot as setIgnorePixelRatio,St as setPixelRatioChangeAction,Qt as setTouchActionChoke,es as show,T as startCoreAnimationLoop,ie as startCoreListeners,H as stopCoreAnimationLoop,se as stopCoreListeners};

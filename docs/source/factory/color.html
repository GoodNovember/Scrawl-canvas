<!DOCTYPE html>

<html>
<head>
  <title>Color factory</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="../core/animationloop.html">
                  ./source/core/animationloop.js
                </a>
              
                
                <a class="source" href="../core/document.html">
                  ./source/core/document.js
                </a>
              
                
                <a class="source" href="../core/events.html">
                  ./source/core/events.js
                </a>
              
                
                <a class="source" href="../core/init.html">
                  ./source/core/init.js
                </a>
              
                
                <a class="source" href="../core/library.html">
                  ./source/core/library.js
                </a>
              
                
                <a class="source" href="../core/random-seed.html">
                  ./source/core/random-seed.js
                </a>
              
                
                <a class="source" href="../core/snippets.html">
                  ./source/core/snippets.js
                </a>
              
                
                <a class="source" href="../core/userInteraction.html">
                  ./source/core/userInteraction.js
                </a>
              
                
                <a class="source" href="../core/utilities.html">
                  ./source/core/utilities.js
                </a>
              
                
                <a class="source" href="action.html">
                  ./source/factory/action.js
                </a>
              
                
                <a class="source" href="anchor.html">
                  ./source/factory/anchor.js
                </a>
              
                
                <a class="source" href="animation.html">
                  ./source/factory/animation.js
                </a>
              
                
                <a class="source" href="bezier.html">
                  ./source/factory/bezier.js
                </a>
              
                
                <a class="source" href="block.html">
                  ./source/factory/block.js
                </a>
              
                
                <a class="source" href="canvas.html">
                  ./source/factory/canvas.js
                </a>
              
                
                <a class="source" href="cell.html">
                  ./source/factory/cell.js
                </a>
              
                
                <a class="source" href="cog.html">
                  ./source/factory/cog.js
                </a>
              
                
                <a class="source" href="color.html">
                  ./source/factory/color.js
                </a>
              
                
                <a class="source" href="conicGradient.html">
                  ./source/factory/conicGradient.js
                </a>
              
                
                <a class="source" href="coordinate.html">
                  ./source/factory/coordinate.js
                </a>
              
                
                <a class="source" href="crescent.html">
                  ./source/factory/crescent.js
                </a>
              
                
                <a class="source" href="element.html">
                  ./source/factory/element.js
                </a>
              
                
                <a class="source" href="emitter.html">
                  ./source/factory/emitter.js
                </a>
              
                
                <a class="source" href="filter.html">
                  ./source/factory/filter.js
                </a>
              
                
                <a class="source" href="filterEngine-bluenoiseData.html">
                  ./source/factory/filterEngine-bluenoiseData.js
                </a>
              
                
                <a class="source" href="filterEngine.html">
                  ./source/factory/filterEngine.js
                </a>
              
                
                <a class="source" href="fontAttributes.html">
                  ./source/factory/fontAttributes.js
                </a>
              
                
                <a class="source" href="gradient.html">
                  ./source/factory/gradient.js
                </a>
              
                
                <a class="source" href="grid.html">
                  ./source/factory/grid.js
                </a>
              
                
                <a class="source" href="group.html">
                  ./source/factory/group.js
                </a>
              
                
                <a class="source" href="imageAsset.html">
                  ./source/factory/imageAsset.js
                </a>
              
                
                <a class="source" href="line.html">
                  ./source/factory/line.js
                </a>
              
                
                <a class="source" href="lineSpiral.html">
                  ./source/factory/lineSpiral.js
                </a>
              
                
                <a class="source" href="loom.html">
                  ./source/factory/loom.js
                </a>
              
                
                <a class="source" href="mesh.html">
                  ./source/factory/mesh.js
                </a>
              
                
                <a class="source" href="net.html">
                  ./source/factory/net.js
                </a>
              
                
                <a class="source" href="noiseAsset.html">
                  ./source/factory/noiseAsset.js
                </a>
              
                
                <a class="source" href="oval.html">
                  ./source/factory/oval.js
                </a>
              
                
                <a class="source" href="palette.html">
                  ./source/factory/palette.js
                </a>
              
                
                <a class="source" href="particle.html">
                  ./source/factory/particle.js
                </a>
              
                
                <a class="source" href="particleForce.html">
                  ./source/factory/particleForce.js
                </a>
              
                
                <a class="source" href="particleHistory.html">
                  ./source/factory/particleHistory.js
                </a>
              
                
                <a class="source" href="particleSpring.html">
                  ./source/factory/particleSpring.js
                </a>
              
                
                <a class="source" href="particleWorld.html">
                  ./source/factory/particleWorld.js
                </a>
              
                
                <a class="source" href="pattern.html">
                  ./source/factory/pattern.js
                </a>
              
                
                <a class="source" href="phrase.html">
                  ./source/factory/phrase.js
                </a>
              
                
                <a class="source" href="picture.html">
                  ./source/factory/picture.js
                </a>
              
                
                <a class="source" href="polygon.html">
                  ./source/factory/polygon.js
                </a>
              
                
                <a class="source" href="polyline.html">
                  ./source/factory/polyline.js
                </a>
              
                
                <a class="source" href="quadratic.html">
                  ./source/factory/quadratic.js
                </a>
              
                
                <a class="source" href="quaternion.html">
                  ./source/factory/quaternion.js
                </a>
              
                
                <a class="source" href="radialGradient.html">
                  ./source/factory/radialGradient.js
                </a>
              
                
                <a class="source" href="rawAsset.html">
                  ./source/factory/rawAsset.js
                </a>
              
                
                <a class="source" href="rdAsset.html">
                  ./source/factory/rdAsset.js
                </a>
              
                
                <a class="source" href="rectangle.html">
                  ./source/factory/rectangle.js
                </a>
              
                
                <a class="source" href="renderAnimation.html">
                  ./source/factory/renderAnimation.js
                </a>
              
                
                <a class="source" href="shape.html">
                  ./source/factory/shape.js
                </a>
              
                
                <a class="source" href="spiral.html">
                  ./source/factory/spiral.js
                </a>
              
                
                <a class="source" href="spriteAsset.html">
                  ./source/factory/spriteAsset.js
                </a>
              
                
                <a class="source" href="stack.html">
                  ./source/factory/stack.js
                </a>
              
                
                <a class="source" href="star.html">
                  ./source/factory/star.js
                </a>
              
                
                <a class="source" href="state.html">
                  ./source/factory/state.js
                </a>
              
                
                <a class="source" href="tetragon.html">
                  ./source/factory/tetragon.js
                </a>
              
                
                <a class="source" href="ticker.html">
                  ./source/factory/ticker.js
                </a>
              
                
                <a class="source" href="tracer.html">
                  ./source/factory/tracer.js
                </a>
              
                
                <a class="source" href="tween.html">
                  ./source/factory/tween.js
                </a>
              
                
                <a class="source" href="unstackedElement.html">
                  ./source/factory/unstackedElement.js
                </a>
              
                
                <a class="source" href="vector.html">
                  ./source/factory/vector.js
                </a>
              
                
                <a class="source" href="videoAsset.html">
                  ./source/factory/videoAsset.js
                </a>
              
                
                <a class="source" href="wheel.html">
                  ./source/factory/wheel.js
                </a>
              
                
                <a class="source" href="../mixin/anchor.html">
                  ./source/mixin/anchor.js
                </a>
              
                
                <a class="source" href="../mixin/asset.html">
                  ./source/mixin/asset.js
                </a>
              
                
                <a class="source" href="../mixin/assetAdvancedFunctionality.html">
                  ./source/mixin/assetAdvancedFunctionality.js
                </a>
              
                
                <a class="source" href="../mixin/assetConsumer.html">
                  ./source/mixin/assetConsumer.js
                </a>
              
                
                <a class="source" href="../mixin/base.html">
                  ./source/mixin/base.js
                </a>
              
                
                <a class="source" href="../mixin/cascade.html">
                  ./source/mixin/cascade.js
                </a>
              
                
                <a class="source" href="../mixin/delta.html">
                  ./source/mixin/delta.js
                </a>
              
                
                <a class="source" href="../mixin/displayShape.html">
                  ./source/mixin/displayShape.js
                </a>
              
                
                <a class="source" href="../mixin/dom.html">
                  ./source/mixin/dom.js
                </a>
              
                
                <a class="source" href="../mixin/entity.html">
                  ./source/mixin/entity.js
                </a>
              
                
                <a class="source" href="../mixin/filter.html">
                  ./source/mixin/filter.js
                </a>
              
                
                <a class="source" href="../mixin/mimic.html">
                  ./source/mixin/mimic.js
                </a>
              
                
                <a class="source" href="../mixin/path.html">
                  ./source/mixin/path.js
                </a>
              
                
                <a class="source" href="../mixin/pattern.html">
                  ./source/mixin/pattern.js
                </a>
              
                
                <a class="source" href="../mixin/pivot.html">
                  ./source/mixin/pivot.js
                </a>
              
                
                <a class="source" href="../mixin/position.html">
                  ./source/mixin/position.js
                </a>
              
                
                <a class="source" href="../mixin/shapeBasic.html">
                  ./source/mixin/shapeBasic.js
                </a>
              
                
                <a class="source" href="../mixin/shapeCurve.html">
                  ./source/mixin/shapeCurve.js
                </a>
              
                
                <a class="source" href="../mixin/shapePathCalculation.html">
                  ./source/mixin/shapePathCalculation.js
                </a>
              
                
                <a class="source" href="../mixin/styles.html">
                  ./source/mixin/styles.js
                </a>
              
                
                <a class="source" href="../mixin/tween.html">
                  ./source/mixin/tween.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-1">&#x00a7;</a>
              </div>
              <h1 id="color-factory">Color factory</h1>
<p>Color objects generate CSS rgb() or rgba() color strings, which can then be used to set an entity’s <a href="./state.html">State</a> object’s <strong>fillStyle</strong>, <strong>strokeStyle</strong> and <strong>shadowColor</strong> attributes.</p>
<ul>
<li>Factory can accept any legal CSS color keyword as an attribute, alongside ‘#nnn’ and ‘#nnnnnn’ hexadecimal Strings. It will accept ‘rgb()’ and ‘rgba()’ strings under certain conditions.</li>
<li>It can also accept <strong>r</strong>, <strong>g</strong>, <strong>b</strong> and <strong>a</strong> channel Number attributes (0-255 integers for r, g, b; 0-1 float Number for a), from which a color can be constructed.</li>
<li>It can be used to generate random colors, using channel <strong>max</strong> and <strong>min</strong> integer Number attributes to limit the range of the random colors.</li>
<li>It can be deltaAnimated by setting channel <strong>shift</strong> float Number attributes and setting the <strong>autoUpdate</strong> Boolean flag to true. Delta animations can run until values hit their set max/min values, or can bounce between min and max values, depending on the setting of the channel <strong>bounce</strong> Boolean flags.</li>
<li>It can also be animated directly, or using delta animation, or act as the target for <strong>Tween</strong> animations.</li>
<li>Colors can be cloned, and killed.</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-2">&#x00a7;</a>
              </div>
              <p>TODO: The color object does not yet handle the following color inputs:</p>
<ul>
<li><code>hsl[a](H, S, L[, A])</code> - color will be treated as transparent black</li>
<li><code>hsl[a](H S L[ / A])</code> - color will be treated as transparent black</li>
<li>for <code>rgb()</code> and <code>rgba()</code>, if any of the values (including alpha) is given as a %Number, all values will be treated as percentages (in the spec, rgb values all need to be either integer Number 0-255, or %Number 0%-100%, but channels cannot mix the two notations, whereas the alpha value format <em>can</em> differ from rgb value format)</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-3">&#x00a7;</a>
              </div>
              <h4 id="demos">Demos:</h4>
<ul>
<li><a href="../../demo/canvas-031.html">Canvas-031</a> - Cell generation and processing order - kaleidoscope clock</li>
<li><a href="../../demo/packets-002.html">Packets-002</a> - Scrawl-canvas packets; save and load a range of different entitys</li>
<li><a href="../../demo/dom-009.html">DOM-009</a> - Stop and restart the main animation loop; add and remove event listener; retrieve all artefacts at a given coordinate</li>
<li><a href="../../demo/dom-012.html">DOM-012</a> - Add and remove (kill) Scrawl-canvas canvas elements programmatically</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-4">&#x00a7;</a>
              </div>
              <h4 id="imports">Imports</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> { constructors, entity, radian } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../core/library.js&#x27;</span>;
<span class="hljs-keyword">import</span> { mergeOver, xt, xtGet, isa_obj, isa_fn, easeEngines, Ωempty, λfirstArg, pushUnique, interpolate, correctAngle } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../core/utilities.js&#x27;</span>;

<span class="hljs-keyword">import</span> { requestCell, releaseCell } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./cell.js&#x27;</span>;

<span class="hljs-keyword">import</span> baseMix <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../mixin/base.js&#x27;</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-5">&#x00a7;</a>
              </div>
              <h4 id="color-constructor">Color constructor</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> <span class="hljs-title class_">Color</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">items = Ωempty</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">makeName</span>(items.<span class="hljs-property">name</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">register</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">defs</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rgb</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rgb_max</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rgb_min</span> = [];

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hsl</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hsl_max</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hsl_min</span> = [];

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hwb</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hwb_max</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hwb_min</span> = [];

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">xyz</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">xyz_max</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">xyz_min</span> = [];

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lab</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lab_max</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lab_min</span> = [];

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lch</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lch_max</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lch_min</span> = [];

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">easingFunction</span> = λfirstArg;

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(<span class="hljs-string">&#x27;transparent&#x27;</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(<span class="hljs-string">&#x27;black&#x27;</span>, <span class="hljs-string">&#x27;_min&#x27;</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(<span class="hljs-string">&#x27;white&#x27;</span>, <span class="hljs-string">&#x27;_max&#x27;</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(items);

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-6">&#x00a7;</a>
              </div>
              <h4 id="color-prototype">Color prototype</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> P = <span class="hljs-title class_">Color</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
P.<span class="hljs-property">type</span> = <span class="hljs-string">&#x27;Color&#x27;</span>;
P.<span class="hljs-property">lib</span> = <span class="hljs-string">&#x27;styles&#x27;</span>;
P.<span class="hljs-property">isArtefact</span> = <span class="hljs-literal">false</span>;
P.<span class="hljs-property">isAsset</span> = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-7">&#x00a7;</a>
              </div>
              <h4 id="mixins">Mixins</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre>P = <span class="hljs-title function_">baseMix</span>(P);</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-8">&#x00a7;</a>
              </div>
              <h4 id="color-attributes">Color attributes</h4>
<ul>
<li>Attributes defined in the <a href="../mixin/base.html">base mixin</a>: <strong>name</strong>.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> defaultAttributes = {</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-9">&#x00a7;</a>
              </div>
              <p>A Color object can hold details of three colors</p>
<ul>
<li>The ‘current’, or last evaluated color</li>
<li>The ‘maximum’ range color; relevant attributes are suffixed with <code>_max</code></li>
<li>The ‘minimum’ range color; relevant attributes are suffixed with <code>_min</code></li>
</ul>
<p>On recieving a color to store or process, the Color object will calculate the color’s values in several different color spaces: <code>RGB</code>, <code>HSL</code>, <code>HWB</code>, <code>XYZ</code>, <code>LAB</code>, <code>LCH</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-attr">rgb</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">rgb_max</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">rgb_min</span>: <span class="hljs-literal">null</span>,

    <span class="hljs-attr">hsl</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">hsl_max</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">hsl_min</span>: <span class="hljs-literal">null</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-10">&#x00a7;</a>
              </div>
              <p>hwb() color Strings are not yet widely supported as valid input into browser canvas engines</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-attr">hwb</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">hwb_max</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">hwb_min</span>: <span class="hljs-literal">null</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-11">&#x00a7;</a>
              </div>
              <p>xyz() colors are not valid CSS color strings; they are an intermediary step on the way to converting rgb color values into lab notation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-attr">xyz</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">xyz_max</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">xyz_min</span>: <span class="hljs-literal">null</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-12">&#x00a7;</a>
              </div>
              <p>lab() color Strings are not yet widely supported as valid input into browser canvas engines</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-attr">lab</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">lab_max</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">lab_min</span>: <span class="hljs-literal">null</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-13">&#x00a7;</a>
              </div>
              <p>lch() color Strings are not yet widely supported as valid input into browser canvas engines</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-attr">lch</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">lch_max</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">lch_min</span>: <span class="hljs-literal">null</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-14">&#x00a7;</a>
              </div>
              <p>The <strong>easing</strong> and <strong>easingFunction</strong> attributes affect the <code>getRangeColor</code> function, applying an easing function to those requests. Value may be a predefined easing String name, or a function accepting a Number value and returning a Number value, both values to be positive floats in the range 0-1</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-attr">easing</span>: <span class="hljs-string">&#x27;linear&#x27;</span>,
    <span class="hljs-attr">easingFunction</span>: <span class="hljs-literal">null</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-15">&#x00a7;</a>
              </div>
              <p><strong>colorSpace</strong> - String value defining the color space to be used by the Color object for its internal calculations.</p>
<ul>
<li>Accepted values from: <code>&#39;RGB&#39;, &#39;HSL&#39;, &#39;HWB&#39;, &#39;XYZ&#39;, &#39;LAB&#39;, &#39;LCH&#39;</code></li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-attr">colorSpace</span>: <span class="hljs-string">&#x27;RGB&#x27;</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-16">&#x00a7;</a>
              </div>
              <p><strong>returnColorAs</strong> - String value defining the type of color String the Color object will return.</p>
<ul>
<li>This is a shorter list than the internal colorSpace attribute as we only return values for CSS specified color spaces. Note that some of these color spaces are not widely supported across browsers and will lead to errors in canvases displayed on non-supported browsers</li>
<li>Accepted values from: <code>&#39;RGB&#39;, &#39;HSL&#39;, &#39;HWB&#39;, &#39;LAB&#39;, &#39;LCH&#39;</code></li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-attr">returnColorAs</span>: <span class="hljs-string">&#x27;RGB&#x27;</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-17">&#x00a7;</a>
              </div>
              <h5 id="non-retained-argument-attributes-for-factory-clone-set-functions">Non-retained argument attributes (for factory, clone, set functions)</h5>
<p><strong>color</strong>, <strong>minimumColor</strong>, <strong>maximumColor</strong> - CSS color definition Strings which the Color object will attempt to convert into various color space values.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>};
P.<span class="hljs-property">defs</span> = <span class="hljs-title function_">mergeOver</span>(P.<span class="hljs-property">defs</span>, defaultAttributes);</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-18">&#x00a7;</a>
              </div>
              <h4 id="packet-management">Packet management</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">packetFunctions</span> = <span class="hljs-title function_">pushUnique</span>(P.<span class="hljs-property">packetFunctions</span>, [<span class="hljs-string">&#x27;easingFunction&#x27;</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-19">&#x00a7;</a>
              </div>
              <h4 id="clone-management">Clone management</h4>
<p>No additional clone functionality required</p>

            </div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-20">&#x00a7;</a>
              </div>
              <h4 id="kill-management">Kill management</h4>
<p>Overwrites ./mixin/base.js</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">kill</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

    <span class="hljs-keyword">let</span> myname = <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-21">&#x00a7;</a>
              </div>
              <p>Remove style from all entity state objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(entity).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[name, ent]</span>) =&gt;</span> {

        <span class="hljs-keyword">let</span> state = ent.<span class="hljs-property">state</span>;

        <span class="hljs-keyword">if</span> (state) {

            <span class="hljs-keyword">let</span> fill = state.<span class="hljs-property">fillStyle</span>,
                stroke = state.<span class="hljs-property">strokeStyle</span>,
                shadow = state.<span class="hljs-property">shadowColor</span>;

            <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isa_obj</span>(fill) &amp;&amp; fill.<span class="hljs-property">name</span> === myname) state.<span class="hljs-property">fillStyle</span> = state.<span class="hljs-property">defs</span>.<span class="hljs-property">fillStyle</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isa_obj</span>(stroke) &amp;&amp; stroke.<span class="hljs-property">name</span> === myname) state.<span class="hljs-property">strokeStyle</span> = state.<span class="hljs-property">defs</span>.<span class="hljs-property">strokeStyle</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isa_obj</span>(shadow) &amp;&amp; shadow.<span class="hljs-property">name</span> === myname) state.<span class="hljs-property">shadowColor</span> = state.<span class="hljs-property">defs</span>.<span class="hljs-property">shadowColor</span>;
        }
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-22">&#x00a7;</a>
              </div>
              <p>Remove style from the Scrawl-canvas library</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">deregister</span>();
    
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-23">&#x00a7;</a>
              </div>
              <h4 id="get-set-deltaset">Get, Set, deltaSet</h4>

            </div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-24">&#x00a7;</a>
              </div>
              <p><code>get</code> - overrides function in mixin/base.js</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">get</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">xt</span>(item)) {

        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCurrentColor</span>();
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item.<span class="hljs-property">toFixed</span>) {

        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getRangeColor</span>(item);
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item === <span class="hljs-string">&#x27;min&#x27;</span>) {

        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMinimumColor</span>();
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item === <span class="hljs-string">&#x27;max&#x27;</span>) {

        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMaximumColor</span>();
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item === <span class="hljs-string">&#x27;random&#x27;</span>) {

        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateRandomColor</span>();
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCurrentColor</span>();
    }
    <span class="hljs-keyword">else</span>{

        <span class="hljs-keyword">let</span> getter = <span class="hljs-variable language_">this</span>.<span class="hljs-property">getters</span>[item];

        <span class="hljs-keyword">if</span> (getter) <span class="hljs-keyword">return</span> getter.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);

        <span class="hljs-keyword">else</span> {

            <span class="hljs-keyword">let</span> def = <span class="hljs-variable language_">this</span>.<span class="hljs-property">defs</span>[item];

            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> def != <span class="hljs-string">&#x27;undefined&#x27;</span>) {

                <span class="hljs-keyword">let</span> val = <span class="hljs-variable language_">this</span>[item];
                <span class="hljs-keyword">return</span> (<span class="hljs-keyword">typeof</span> val != <span class="hljs-string">&#x27;undefined&#x27;</span>) ? val : def;
            }
            <span class="hljs-keyword">return</span> undef;
        }
    }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-25">&#x00a7;</a>
              </div>
              <p><code>set</code> - overrides function in mixin/base.js - see above for the additional attributes the set object argument can use.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">set</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">items = Ωempty</span>) {

    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(items),
        keysLen = keys.<span class="hljs-property">length</span>;

    <span class="hljs-keyword">if</span> (keysLen) {

        <span class="hljs-keyword">const</span> setters = <span class="hljs-variable language_">this</span>.<span class="hljs-property">setters</span>,
            defs = <span class="hljs-variable language_">this</span>.<span class="hljs-property">defs</span>;
        
        <span class="hljs-keyword">let</span> predefined, i, iz, key, value;

        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; keysLen; i++) {

            key = keys[i];
            value = items[key];

            <span class="hljs-keyword">if</span> (key &amp;&amp; key !== <span class="hljs-string">&#x27;name&#x27;</span> &amp;&amp; value != <span class="hljs-literal">null</span>) {

                predefined = setters[key];

                <span class="hljs-keyword">if</span> (predefined) predefined.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, value);
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> defs[key] !== <span class="hljs-string">&#x27;undefined&#x27;</span>) <span class="hljs-variable language_">this</span>[key] = value;
            }
        }
        <span class="hljs-keyword">if</span> (items.<span class="hljs-property">random</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateRandomColor</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-26">&#x00a7;</a>
              </div>
              <h4 id="get-set-deltaset">Get, Set, deltaSet</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> S = P.<span class="hljs-property">setters</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-27">&#x00a7;</a>
              </div>
              <p>The <code>color</code>, <code>minimumColor</code> and <code>maximumColor</code> functions take in a CSS color String and converts it into a set of arrays containing data relevant to various color spaces. <strong>Note that browsers vary in the range of color spaces they support.</strong></p>
<ul>
<li>Widely supported: various RGB space color Strings - keywords, hex values, <code>rgb()</code>, <code>rgba()</code></li>
<li>Widely supported: HSL space color Strings - <code>hsl()</code>, <code>hsla()</code></li>
<li>Valid, but poorly supported: HWB, LAB, LCH color spaces - <code>hwb()</code>, <code>lab()</code>, <code>lch()</code></li>
<li>Not valid or supported: XYZ color space - <code>xyz()</code> - used internally to convert between RGB and LAB spaces</li>
</ul>
<p>These setter functions have complementary Color object functions: <code>setColor</code>, <code>setMinimumColor</code>, <code>setMaximumColor</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>S.<span class="hljs-property">color</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(item);
};

P.<span class="hljs-property">setColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(item);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
};

S.<span class="hljs-property">minimumColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(item, <span class="hljs-string">&#x27;_min&#x27;</span>);
};
P.<span class="hljs-property">setMinimumColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(item, <span class="hljs-string">&#x27;_min&#x27;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
};

S.<span class="hljs-property">maximumColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(item, <span class="hljs-string">&#x27;_max&#x27;</span>);
};
P.<span class="hljs-property">setMaximumColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(item, <span class="hljs-string">&#x27;_max&#x27;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-28">&#x00a7;</a>
              </div>
              <p><code>easing</code> (and its complementary Color object functions: <code>setEasing</code>) - we can apply easing functions to colors, for instance when invoking the Color object’s <code>getRangeColor()</code> function to return the most appropriate color between the Color object’s minimum and maximum color values</p>
<ul>
<li>Can accept a String value identifying an SC pre-defined easing function (default: <code>linear</code>)</li>
<li>Can also accept a function accepting a single Number argument (a value between 0-1) and returning an eased Number (again, between 0-1)</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>S.<span class="hljs-property">easing</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setEasingHelper</span>(item);
};
S.<span class="hljs-property">easingFunction</span> = S.<span class="hljs-property">easing</span>;

P.<span class="hljs-property">setEasing</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setEasingHelper</span>(item);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
};
P.<span class="hljs-property">setEasingFunction</span> = P.<span class="hljs-property">setEasing</span>;
P.<span class="hljs-property">setEasingHelper</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isa_fn</span>(item)) {

        <span class="hljs-variable language_">this</span>.<span class="hljs-property">easing</span> = <span class="hljs-string">&#x27;function&#x27;</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">easingFunction</span> = item;
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item.<span class="hljs-property">substring</span> &amp;&amp; easeEngines[item]) {

        <span class="hljs-variable language_">this</span>.<span class="hljs-property">easing</span> = item; 
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">easingFunction</span> = λfirstArg;
    }
    <span class="hljs-keyword">else</span> {

        <span class="hljs-variable language_">this</span>.<span class="hljs-property">easing</span> = <span class="hljs-string">&#x27;linear&#x27;</span>; 
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">easingFunction</span> = λfirstArg;
    }
};

P.<span class="hljs-property">internalColorSpaces</span> = [<span class="hljs-string">&#x27;RGB&#x27;</span>, <span class="hljs-string">&#x27;HSL&#x27;</span>, <span class="hljs-string">&#x27;HWB&#x27;</span>, <span class="hljs-string">&#x27;XYZ&#x27;</span>, <span class="hljs-string">&#x27;LAB&#x27;</span>, <span class="hljs-string">&#x27;LCH&#x27;</span>];
S.<span class="hljs-property">colorSpace</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setColorSpaceHelper</span>(item);
};
P.<span class="hljs-property">setColorSpace</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setColorSpaceHelper</span>(item);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
};
P.<span class="hljs-property">setColorSpaceHelper</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-keyword">if</span> (item.<span class="hljs-property">substring</span>) {

        item = item.<span class="hljs-title function_">toUpperCase</span>();

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">internalColorSpaces</span>.<span class="hljs-title function_">includes</span>(item)) {

            <span class="hljs-keyword">const</span> current = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCurrentColor</span>(),
                min = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMinimumColor</span>(),
                max = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMaximumColor</span>();

            <span class="hljs-variable language_">this</span>.<span class="hljs-property">colorSpace</span> = item.<span class="hljs-title function_">toUpperCase</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateColorConversions</span>(current, min, max);
        }
    }
};

P.<span class="hljs-property">returnedColorSpaces</span> = [<span class="hljs-string">&#x27;RGB&#x27;</span>, <span class="hljs-string">&#x27;HSL&#x27;</span>, <span class="hljs-string">&#x27;HWB&#x27;</span>, <span class="hljs-string">&#x27;LAB&#x27;</span>, <span class="hljs-string">&#x27;LCH&#x27;</span>];
S.<span class="hljs-property">returnColorAs</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setReturnColorAsHelper</span>(item);
};
P.<span class="hljs-property">setReturnColorAs</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setReturnColorAsHelper</span>(item);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
};
P.<span class="hljs-property">setReturnColorAsHelper</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {
    
    <span class="hljs-keyword">if</span> (item.<span class="hljs-property">substring</span>) {

        item = item.<span class="hljs-title function_">toUpperCase</span>();

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">returnedColorSpaces</span>.<span class="hljs-title function_">includes</span>(item)) {

            <span class="hljs-keyword">const</span> current = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCurrentColor</span>(),
                min = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMinimumColor</span>(),
                max = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMaximumColor</span>();

            <span class="hljs-variable language_">this</span>.<span class="hljs-property">returnColorAs</span> = item.<span class="hljs-title function_">toUpperCase</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateColorConversions</span>(current, min, max);
        }
    }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-29">&#x00a7;</a>
              </div>
              <h4 id="prototype-functions">Prototype functions</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre>
P.<span class="hljs-property">updateColorConversions</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">current, min, max</span>) {

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(current);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(min, <span class="hljs-string">&#x27;_min&#x27;</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(max, <span class="hljs-string">&#x27;_max&#x27;</span>);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-30">&#x00a7;</a>
              </div>
              <p><code>getData</code> function called by Cell objects when calculating required updates to its CanvasRenderingContext2D engine, specifically for an entity’s <strong>fillStyle</strong>, <strong>strokeStyle</strong> and <strong>shadowColor</strong> attributes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">getData</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCurrentColor</span>();
};

P.<span class="hljs-property">getCurrentColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

    <span class="hljs-keyword">const</span> { rgb, hsl, hwb, lab, lch } = <span class="hljs-variable language_">this</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">returnColor</span>(rgb, hsl, hwb, lab, lch);
};

P.<span class="hljs-property">getMinimumColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

    <span class="hljs-keyword">const</span> { rgb_min, hsl_min, hwb_min, lab_min, lch_min } = <span class="hljs-variable language_">this</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">returnColor</span>(rgb_min, hsl_min, hwb_min, lab_min, lch_min);
};

P.<span class="hljs-property">getMaximumColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

    <span class="hljs-keyword">const</span> { rgb_max, hsl_max, hwb_max, lab_max, lch_max } = <span class="hljs-variable language_">this</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">returnColor</span>(rgb_max, hsl_max, hwb_max, lab_max, lch_max);
};

P.<span class="hljs-property">returnColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">rgb, hsl, hwb, lab, lch</span>) {

    <span class="hljs-keyword">if</span> (rgb == <span class="hljs-literal">null</span>) {

        ({rgb, hsl, hwb, lab, lch} = <span class="hljs-variable language_">this</span>);
    }

    <span class="hljs-keyword">const</span> { buildColorString, returnColorAs } = <span class="hljs-variable language_">this</span>;

    <span class="hljs-keyword">switch</span> (returnColorAs) {

        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;RGB&#x27;</span> : <span class="hljs-keyword">return</span> <span class="hljs-title function_">buildColorString</span>(...rgb, <span class="hljs-string">&#x27;RGB&#x27;</span>);

        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;HSL&#x27;</span> : <span class="hljs-keyword">return</span> <span class="hljs-title function_">buildColorString</span>(...hsl, <span class="hljs-string">&#x27;HSL&#x27;</span>);

        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;HWB&#x27;</span> :
            <span class="hljs-keyword">if</span> (!supportsHWB) <span class="hljs-keyword">return</span> <span class="hljs-title function_">buildColorString</span>(...rgb, <span class="hljs-string">&#x27;RGB&#x27;</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">buildColorString</span>(...hwb, <span class="hljs-string">&#x27;HWB&#x27;</span>);

        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;LAB&#x27;</span> :
            <span class="hljs-keyword">if</span> (!supportsLAB) <span class="hljs-keyword">return</span> <span class="hljs-title function_">buildColorString</span>(...rgb, <span class="hljs-string">&#x27;RGB&#x27;</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">buildColorString</span>(...lab, <span class="hljs-string">&#x27;LAB&#x27;</span>);

        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;LCH&#x27;</span> :
            <span class="hljs-keyword">if</span> (!supportsLCH) <span class="hljs-keyword">return</span> <span class="hljs-title function_">buildColorString</span>(...rgb, <span class="hljs-string">&#x27;RGB&#x27;</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">buildColorString</span>(...lch, <span class="hljs-string">&#x27;LCH&#x27;</span>);

        <span class="hljs-keyword">default</span> :
            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;rgba(0 0 0 / 0)&#x27;</span>;
    }
};

P.<span class="hljs-property">returnColorFromValues</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">b, c, d, a</span>) {

    <span class="hljs-keyword">const</span> { colorSpace, returnColorAs } = <span class="hljs-variable language_">this</span>;

    <span class="hljs-keyword">let</span> col = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildColorString</span>(b, c, d, a, colorSpace);

    <span class="hljs-keyword">let</span> flag = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;XYZ&#x27;</span> === colorSpace) flag = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (colorSpace !== returnColorAs) flag = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;HWB&#x27;</span> === returnColorAs &amp;&amp; !supportsHWB) flag = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;LAB&#x27;</span> === returnColorAs &amp;&amp; !supportsLAB) flag = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;LCH&#x27;</span> === returnColorAs &amp;&amp; !supportsLCH) flag = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">if</span> (flag) {

        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setColor</span>(col);
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">returnColor</span>();
    }
    <span class="hljs-keyword">return</span> col;
};

P.<span class="hljs-property">buildColorString</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b, c, d, req</span>) {

    <span class="hljs-keyword">if</span> (!req) req = <span class="hljs-variable language_">this</span>.<span class="hljs-property">returnColorAs</span>;

    <span class="hljs-keyword">switch</span> (req) {

        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;RGB&#x27;</span> : <span class="hljs-keyword">return</span> <span class="hljs-string">`rgba(<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.round(a)}</span> <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.round(b)}</span> <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.round(c)}</span> / <span class="hljs-subst">${d}</span>)`</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;HSL&#x27;</span> : <span class="hljs-keyword">return</span> <span class="hljs-string">`hsl(<span class="hljs-subst">${a}</span> <span class="hljs-subst">${b}</span>% <span class="hljs-subst">${c}</span>% / <span class="hljs-subst">${d}</span>)`</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;HWB&#x27;</span> : <span class="hljs-keyword">return</span> <span class="hljs-string">`hwb(<span class="hljs-subst">${a}</span> <span class="hljs-subst">${b}</span>% <span class="hljs-subst">${c}</span>% / <span class="hljs-subst">${d}</span>)`</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;LAB&#x27;</span> : <span class="hljs-keyword">return</span> <span class="hljs-string">`lab(<span class="hljs-subst">${a}</span>% <span class="hljs-subst">${b}</span> <span class="hljs-subst">${c}</span> / <span class="hljs-subst">${d}</span>)`</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;LCH&#x27;</span> : <span class="hljs-keyword">return</span> <span class="hljs-string">`lch(<span class="hljs-subst">${a}</span>% <span class="hljs-subst">${b}</span> <span class="hljs-subst">${c}</span> / <span class="hljs-subst">${d}</span>)`</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;XYZ&#x27;</span> : <span class="hljs-keyword">return</span> <span class="hljs-string">`xyz(<span class="hljs-subst">${a}</span>% <span class="hljs-subst">${b}</span> <span class="hljs-subst">${c}</span> / <span class="hljs-subst">${d}</span>)`</span>;
        <span class="hljs-keyword">default</span> : <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;rgba(0 0 0 / 0)&#x27;</span>;
    }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-31">&#x00a7;</a>
              </div>
              <p><code>generateRandomColor</code> - generate a random, fully opaque color</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">generateRandomColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

    <span class="hljs-keyword">let</span> r = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">256</span>),
        g = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">256</span>),
        b= <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">256</span>);

    <span class="hljs-keyword">if</span> (r &gt; <span class="hljs-number">255</span>) r = <span class="hljs-number">255</span>;
    <span class="hljs-keyword">if</span> (g &gt; <span class="hljs-number">255</span>) g = <span class="hljs-number">255</span>;
    <span class="hljs-keyword">if</span> (b &gt; <span class="hljs-number">255</span>) b = <span class="hljs-number">255</span>;

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setColor</span>(<span class="hljs-string">`rgb(<span class="hljs-subst">${r}</span> <span class="hljs-subst">${g}</span> <span class="hljs-subst">${b}</span>)`</span>);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-32">&#x00a7;</a>
              </div>
              <p><code>checkColor</code> - input is a CSS color string; output will be a color string which is displayable on the user’s device/browser</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">checkColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) {

    <span class="hljs-keyword">if</span> (item.<span class="hljs-property">substring</span>) {

        <span class="hljs-keyword">let</span> colSpace = <span class="hljs-string">&#x27;RGB&#x27;</span>;

        <span class="hljs-keyword">if</span> (item.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;hsl&#x27;</span>)) colSpace = <span class="hljs-string">&#x27;HSL&#x27;</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;hwb&#x27;</span>)) colSpace = <span class="hljs-string">&#x27;HWB&#x27;</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;lab&#x27;</span>)) colSpace = <span class="hljs-string">&#x27;LAB&#x27;</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;lch&#x27;</span>)) colSpace = <span class="hljs-string">&#x27;LCH&#x27;</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;xyz&#x27;</span>)) colSpace = <span class="hljs-string">&#x27;XYZ&#x27;</span>;

        <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;RGB&#x27;</span> === colSpace || <span class="hljs-string">&#x27;HSL&#x27;</span> === colSpace) <span class="hljs-keyword">return</span> item;

        <span class="hljs-variable language_">this</span>.<span class="hljs-property">colorSpace</span> = colSpace;

        <span class="hljs-keyword">let</span> colRet = colSpace;
        <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;XYZ&#x27;</span> === colSpace) colRet = <span class="hljs-string">&#x27;RGB&#x27;</span>;

        <span class="hljs-variable language_">this</span>.<span class="hljs-property">returnColorAs</span> = colSpace;

        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convert</span>(item);

        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">returnColor</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;rgba(0 0 0 / 0)&#x27;</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-33">&#x00a7;</a>
              </div>
              <p><code>getRangeColor</code> - function which generates a color in the range between the minimum and maximum colors. </p>
<ul>
<li>when the argument is <code>0</code> the minimum color is returned; values below 0 are rounded up to 0</li>
<li>when the argument is <code>1</code> the maximum color is returned; values above 1 are rounded down to 1</li>
<li>values between <code>0</code> and <code>1</code> will return a blended color between the minimum and maximum colors</li>
<li>non-Number arguments should return the Color’s current color value</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">getRangeColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item, internalGradientBuild = <span class="hljs-literal">false</span></span>) {

    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">xt</span>(item) &amp;&amp; item.<span class="hljs-property">toFixed</span>) {

        <span class="hljs-keyword">let</span> col = <span class="hljs-variable language_">this</span>.<span class="hljs-property">colorSpace</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-34">&#x00a7;</a>
              </div>
              <p>KNOWN issue with HSL/HWB/LCH gradients which this line attempts to fix</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (internalGradientBuild &amp;&amp; [<span class="hljs-string">&#x27;HSL&#x27;</span>, <span class="hljs-string">&#x27;HWB&#x27;</span>].<span class="hljs-title function_">includes</span>(col)) col = <span class="hljs-string">&#x27;RGB&#x27;</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (internalGradientBuild &amp;&amp; <span class="hljs-string">&#x27;LCH&#x27;</span> === col) col = <span class="hljs-string">&#x27;LAB&#x27;</span>;

        <span class="hljs-keyword">const</span> vals = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateRangeColorValues</span>(item, internalGradientBuild),
            res = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildColorString</span>(...vals, col);

        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setColor</span>(res);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCurrentColor</span>();
};</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-35">&#x00a7;</a>
              </div>
              <p><code>calculateRangeColorValues</code> - internal helper function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">calculateRangeColorValues</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">item, internalGradientBuild = <span class="hljs-literal">false</span></span>) {

    <span class="hljs-keyword">const</span> { colorSpace, easing, easingFunction } = <span class="hljs-variable language_">this</span>;

    <span class="hljs-keyword">let</span> a, b, c, d, test;

    <span class="hljs-keyword">let</span> col = colorSpace.<span class="hljs-title function_">toLowerCase</span>();</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-36">&#x00a7;</a>
              </div>
              <p>KNOWN issue with HSL/HWB/LCH gradients which this line attempts to fix</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (internalGradientBuild &amp;&amp; [<span class="hljs-string">&#x27;HSL&#x27;</span>, <span class="hljs-string">&#x27;HWB&#x27;</span>].<span class="hljs-title function_">includes</span>(colorSpace)) col = <span class="hljs-string">&#x27;rgb&#x27;</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (internalGradientBuild &amp;&amp; <span class="hljs-string">&#x27;LCH&#x27;</span> === colorSpace) col = <span class="hljs-string">&#x27;lab&#x27;</span>;

    <span class="hljs-keyword">const</span> [bMin, cMin, dMin, aMin] = <span class="hljs-variable language_">this</span>[<span class="hljs-string">`<span class="hljs-subst">${col}</span>_min`</span>];
    <span class="hljs-keyword">const</span> [bMax, cMax, dMax, aMax] = <span class="hljs-variable language_">this</span>[<span class="hljs-string">`<span class="hljs-subst">${col}</span>_max`</span>];

    <span class="hljs-keyword">let</span> engine = easingFunction;

    <span class="hljs-keyword">if</span> (!internalGradientBuild &amp;&amp; easing !== <span class="hljs-string">&#x27;function&#x27;</span> &amp;&amp; easeEngines[easing]) engine = easeEngines[easing];

    <span class="hljs-keyword">const</span> val = (internalGradientBuild) ? item : <span class="hljs-title function_">engine</span>(item);

    <span class="hljs-keyword">switch</span> (col) {</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-37">&#x00a7;</a>
              </div>
              <p>These aren’t producing colors like CSS gradients - something wierd about seeing bright violet between red/blue, instead of a more muddy purple (matching what gets presented in the RGB color space) which CSS gradients present.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hsl&#x27;</span> :
        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hwb&#x27;</span> :

            test = bMax - bMin;

            <span class="hljs-keyword">if</span> (bMin === bMax) b = bMin;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (test &gt; <span class="hljs-number">180</span> || test &lt; -<span class="hljs-number">180</span>) {

                b = (test &gt; <span class="hljs-number">0</span>) ? 
                    <span class="hljs-title function_">interpolate</span>(val, bMin + <span class="hljs-number">360</span>, bMax) :
                    <span class="hljs-title function_">interpolate</span>(val, bMin - <span class="hljs-number">360</span>, bMax);
            }
            <span class="hljs-keyword">else</span> {
                b = <span class="hljs-title function_">interpolate</span>(val, bMin, bMax);
            }

            <span class="hljs-keyword">if</span> (aMin === aMax) a = aMin;
            <span class="hljs-keyword">else</span> a = <span class="hljs-title function_">interpolate</span>(val, aMin, aMax);

            <span class="hljs-keyword">if</span> (cMin === cMax) c = cMin;
            <span class="hljs-keyword">else</span> c = <span class="hljs-title function_">interpolate</span>(val, cMin, cMax);

            <span class="hljs-keyword">if</span> (dMin === dMax) d = dMin;
            <span class="hljs-keyword">else</span> d = <span class="hljs-title function_">interpolate</span>(val, dMin, dMax);

            <span class="hljs-keyword">return</span> [b, c, d, a];</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-38">&#x00a7;</a>
              </div>
              <p>LCH also has the HSL/HWB issue, but not as pronounced</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;lch&#x27;</span> :

            test = dMax - dMin;

            <span class="hljs-keyword">if</span> (dMin === dMax) d = dMin;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (test &gt; <span class="hljs-number">180</span> || test &lt; -<span class="hljs-number">180</span>) {

                d = (test &gt; <span class="hljs-number">0</span>) ? 
                    <span class="hljs-title function_">interpolate</span>(val, dMin + <span class="hljs-number">360</span>, dMax) :
                    <span class="hljs-title function_">interpolate</span>(val, dMin - <span class="hljs-number">360</span>, dMax);
            }
            <span class="hljs-keyword">else</span> {
                d = <span class="hljs-title function_">interpolate</span>(val, dMin, dMax);
            }

            <span class="hljs-keyword">if</span> (aMin === aMax) a = aMin;
            <span class="hljs-keyword">else</span> a = <span class="hljs-title function_">interpolate</span>(val, aMin, aMax);

            <span class="hljs-keyword">if</span> (cMin === cMax) c = cMin;
            <span class="hljs-keyword">else</span> c = <span class="hljs-title function_">interpolate</span>(val, cMin, cMax);

            <span class="hljs-keyword">if</span> (bMin === bMax) b = bMin;
            <span class="hljs-keyword">else</span> b = <span class="hljs-title function_">interpolate</span>(val, bMin, bMax);

            <span class="hljs-keyword">return</span> [b, c, d, a];</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-39">&#x00a7;</a>
              </div>
              <p>RGB/LAB generate color gradients matching CSS. XYZ also looks good.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">default</span> : 

            <span class="hljs-keyword">if</span> (aMin === aMax) a = aMin;
            <span class="hljs-keyword">else</span> a = <span class="hljs-title function_">interpolate</span>(val, aMin, aMax);

            <span class="hljs-keyword">if</span> (bMin === bMax) b = bMin;
            <span class="hljs-keyword">else</span> b = <span class="hljs-title function_">interpolate</span>(val, bMin, bMax);

            <span class="hljs-keyword">if</span> (cMin === cMax) c = cMin;
            <span class="hljs-keyword">else</span> c = <span class="hljs-title function_">interpolate</span>(val, cMin, cMax);

            <span class="hljs-keyword">if</span> (dMin === dMax) d = dMin;
            <span class="hljs-keyword">else</span> d = <span class="hljs-title function_">interpolate</span>(val, dMin, dMax);

            <span class="hljs-keyword">return</span> [b, c, d, a];
    }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-40">&#x00a7;</a>
              </div>
              <p><code>convert</code> - internal function. Takes a color string and converts it into a variety of color space values. Makes use of the following functions:</p>
<ul>
<li><code>convertHSLtoRGB</code>, <code>convertRGBtoHSL</code></li>
<li><code>convertHWBtoRGB</code>, <code>convertRGBtoHWB</code>, <code>convertRGBHtoHWB</code></li>
<li><code>convertXYZtoRGB</code>, <code>convertRGBtoXYZ</code></li>
<li><code>convertXYZtoLAB</code>, <code>convertLABtoXYZ</code></li>
<li><code>convertLABtoLCH</code>, <code>convertLCHtoLAB</code></li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">convert</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">color, suffix = <span class="hljs-string">&#x27;&#x27;</span></span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-41">&#x00a7;</a>
              </div>
              <p>Currently converting to as many color spaces as possible - we can make this more sane by only converting for the colors we want to convert (RGB + the internal color space + the returned color space)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
    color = color.<span class="hljs-title function_">toLowerCase</span>();

    <span class="hljs-keyword">const</span> rgb = <span class="hljs-variable language_">this</span>[<span class="hljs-string">`rgb<span class="hljs-subst">${suffix}</span>`</span>];
    <span class="hljs-keyword">const</span> hsl = <span class="hljs-variable language_">this</span>[<span class="hljs-string">`hsl<span class="hljs-subst">${suffix}</span>`</span>];
    <span class="hljs-keyword">const</span> hwb = <span class="hljs-variable language_">this</span>[<span class="hljs-string">`hwb<span class="hljs-subst">${suffix}</span>`</span>];
    <span class="hljs-keyword">const</span> xyz = <span class="hljs-variable language_">this</span>[<span class="hljs-string">`xyz<span class="hljs-subst">${suffix}</span>`</span>];
    <span class="hljs-keyword">const</span> lab = <span class="hljs-variable language_">this</span>[<span class="hljs-string">`lab<span class="hljs-subst">${suffix}</span>`</span>];
    <span class="hljs-keyword">const</span> lch = <span class="hljs-variable language_">this</span>[<span class="hljs-string">`lch<span class="hljs-subst">${suffix}</span>`</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-42">&#x00a7;</a>
              </div>
              <p>Initializing defs in the constructor causes an error - this should avoid it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (!rgb) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;

    rgb.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;
    hsl.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;
    hwb.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;
    xyz.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;
    lab.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;
    lch.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">let</span> r = <span class="hljs-number">0</span>,
        g = <span class="hljs-number">0</span>,
        b = <span class="hljs-number">0</span>,
        a = <span class="hljs-number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-43">&#x00a7;</a>
              </div>
              <p>TODO: make this more efficient so we only convert to the color spaces we need (RGB, internal color space, return color space)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (color.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;hwb&#x27;</span>) &gt;= <span class="hljs-number">0</span> &amp;&amp; !supportsHWB) {</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-44">&#x00a7;</a>
              </div>
              <p>This could be handled better via a regex, but also need to deal with angle units</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;hwb&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);

        <span class="hljs-keyword">const</span> vals = color.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27; &#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e != <span class="hljs-literal">null</span> &amp;&amp; e !== <span class="hljs-string">&#x27;&#x27;</span>);

        <span class="hljs-keyword">let</span> hue = vals[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (hue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;deg&#x27;</span>) &gt;= <span class="hljs-number">0</span>) hue = <span class="hljs-built_in">parseFloat</span>(hue)
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;rad&#x27;</span>) &gt;= <span class="hljs-number">0</span>) hue = <span class="hljs-built_in">parseFloat</span>(hue) / radian;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;grad&#x27;</span>) &gt;= <span class="hljs-number">0</span>) hue = (<span class="hljs-built_in">parseFloat</span>(hue) / <span class="hljs-number">400</span>) * <span class="hljs-number">360</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;turn&#x27;</span>) &gt;= <span class="hljs-number">0</span>) hue = <span class="hljs-built_in">parseFloat</span>(hue) * <span class="hljs-number">360</span>;
        <span class="hljs-keyword">else</span> hue = <span class="hljs-built_in">parseFloat</span>(hue);

        hue = <span class="hljs-title function_">correctAngle</span>(hue);

       <span class="hljs-keyword">let</span> white = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">1</span>]),
           black = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">2</span>]),
           alpha = vals[<span class="hljs-number">3</span>];

        <span class="hljs-keyword">if</span> (alpha != <span class="hljs-literal">null</span>) {

            a = (alpha.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;%&#x27;</span>) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-built_in">parseFloat</span>(alpha) / <span class="hljs-number">100</span> : <span class="hljs-built_in">parseFloat</span>(alpha);
        }
        <span class="hljs-keyword">else</span> a = <span class="hljs-number">1</span>;

        <span class="hljs-keyword">let</span> [b, c, d] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertHWBtoRGB</span>(hue, white, black);

        b = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(b * <span class="hljs-number">255</span>);
        <span class="hljs-keyword">if</span> (b &gt; <span class="hljs-number">255</span>) b = <span class="hljs-number">255</span>;
        <span class="hljs-keyword">if</span> (b &lt; <span class="hljs-number">0</span>) b = <span class="hljs-number">0</span>;

        c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(c * <span class="hljs-number">255</span>);
        <span class="hljs-keyword">if</span> (c &gt; <span class="hljs-number">255</span>) c = <span class="hljs-number">255</span>;
        <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">0</span>) c = <span class="hljs-number">0</span>;

        d = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(d * <span class="hljs-number">255</span>);
        <span class="hljs-keyword">if</span> (d &gt; <span class="hljs-number">255</span>) d = <span class="hljs-number">255</span>;
        <span class="hljs-keyword">if</span> (d &lt; <span class="hljs-number">0</span>) d = <span class="hljs-number">0</span>;

        rgb.<span class="hljs-title function_">push</span>(b, c, d, a);
        hsl.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(b, c, d), a);
        hwb.<span class="hljs-title function_">push</span>(hue, white, black, a);
        xyz.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoXYZ</span>(b, c, d), a);
        lab.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertXYZtoLAB</span>(xyz[<span class="hljs-number">0</span>], xyz[<span class="hljs-number">1</span>], xyz[<span class="hljs-number">2</span>]), a);
        lch.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertLABtoLCH</span>(lab[<span class="hljs-number">0</span>], lab[<span class="hljs-number">1</span>], lab[<span class="hljs-number">2</span>]), a);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-45">&#x00a7;</a>
              </div>
              <p>The Color specification doesn’t define an XYZ standard input for CSS. So we have to make one up ourselves. SC expects to receive colors defined in the XYZ color space to be raw float Numbers separated by spaces and (if required) a slash followed by the alpha value</p>
<ul>
<li><code>xyz(x-value y-value z-value)</code> (with alpha = 1, opaque)</li>
<li><code>xyz(x-value y-value z-value / alpha-value)</code></li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (color.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;xyz&#x27;</span>) &gt;= <span class="hljs-number">0</span>) {
        
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;xyz&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);

        <span class="hljs-keyword">const</span> vals = color.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27; &#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e != <span class="hljs-literal">null</span> &amp;&amp; e !== <span class="hljs-string">&#x27;&#x27;</span>);

        <span class="hljs-keyword">const</span> x = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">0</span>]),
            y = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">1</span>]),
            z = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">2</span>]),
            alpha = vals[<span class="hljs-number">3</span>];

        a = (alpha != <span class="hljs-literal">null</span>) ? <span class="hljs-built_in">parseFloat</span>(alpha) : <span class="hljs-number">1</span>;

        rgb.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertXYZtoRGB</span>(x, y, z), a);
        hsl.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(rgb[<span class="hljs-number">0</span>], rgb[<span class="hljs-number">1</span>], rgb[<span class="hljs-number">2</span>]), a);
        hwb.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBHtoHWB</span>(rgb[<span class="hljs-number">0</span>], rgb[<span class="hljs-number">1</span>], rgb[<span class="hljs-number">2</span>], hsl[<span class="hljs-number">0</span>]), a);
        xyz.<span class="hljs-title function_">push</span>(x, y, z, a);
        lab.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertXYZtoLAB</span>(x, y, z), a);
        lch.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertLABtoLCH</span>(lab[<span class="hljs-number">0</span>], lab[<span class="hljs-number">1</span>], lab[<span class="hljs-number">2</span>]), a);
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (color.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;lab&#x27;</span>) &gt;= <span class="hljs-number">0</span> &amp;&amp; !supportsLAB) {

        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;lab&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);

        <span class="hljs-keyword">const</span> vals = color.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27; &#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e != <span class="hljs-literal">null</span> &amp;&amp; e !== <span class="hljs-string">&#x27;&#x27;</span>);

        <span class="hljs-keyword">const</span> b = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">0</span>]),
            c = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">1</span>]),
            d = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">2</span>]),
            alpha = vals[<span class="hljs-number">3</span>];

        a = (alpha != <span class="hljs-literal">null</span>) ? <span class="hljs-built_in">parseFloat</span>(alpha) : <span class="hljs-number">1</span>;

        lab.<span class="hljs-title function_">push</span>(b, c, d, a);
        xyz.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertLABtoXYZ</span>(b, c, d), a);
        rgb.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertXYZtoRGB</span>(xyz[<span class="hljs-number">0</span>], xyz[<span class="hljs-number">1</span>], xyz[<span class="hljs-number">2</span>]), a);
        hsl.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(rgb[<span class="hljs-number">0</span>], rgb[<span class="hljs-number">1</span>], rgb[<span class="hljs-number">2</span>]), a);
        hwb.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBHtoHWB</span>(rgb[<span class="hljs-number">0</span>], rgb[<span class="hljs-number">1</span>], rgb[<span class="hljs-number">2</span>], hsl[<span class="hljs-number">0</span>]), a);
        lch.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertLABtoLCH</span>(b, c, d), a);
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (color.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;lch&#x27;</span>) &gt;= <span class="hljs-number">0</span> &amp;&amp; !supportsLCH) {

        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;lch&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);

        <span class="hljs-keyword">const</span> vals = color.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27; &#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e != <span class="hljs-literal">null</span> &amp;&amp; e !== <span class="hljs-string">&#x27;&#x27;</span>);

        <span class="hljs-keyword">const</span> b = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">0</span>]),
            c = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">1</span>]),
            d = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">2</span>]),
            alpha = vals[<span class="hljs-number">3</span>];

        a = (alpha != <span class="hljs-literal">null</span>) ? <span class="hljs-built_in">parseFloat</span>(alpha) : <span class="hljs-number">1</span>;

        lch.<span class="hljs-title function_">push</span>(b, c, d, a);
        lab.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertLCHtoLAB</span>(b, c, d), a);
        xyz.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertLABtoXYZ</span>(lab[<span class="hljs-number">0</span>], lab[<span class="hljs-number">1</span>], lab[<span class="hljs-number">2</span>]), a);
        rgb.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertXYZtoRGB</span>(xyz[<span class="hljs-number">0</span>], xyz[<span class="hljs-number">1</span>], xyz[<span class="hljs-number">2</span>]), a);
        hsl.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(rgb[<span class="hljs-number">0</span>], rgb[<span class="hljs-number">1</span>], rgb[<span class="hljs-number">2</span>]), a);
        hwb.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBHtoHWB</span>(rgb[<span class="hljs-number">0</span>], rgb[<span class="hljs-number">1</span>], rgb[<span class="hljs-number">2</span>], hsl[<span class="hljs-number">0</span>]), a);
    }
    <span class="hljs-keyword">else</span> {

        [r, g, b, a] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getColorFromCanvas</span>(color);
        rgb.<span class="hljs-title function_">push</span>(r, g, b, a);
        hsl.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(r, g, b), a);
        hwb.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBHtoHWB</span>(r, g, b, hsl[<span class="hljs-number">0</span>]), a);
        xyz.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoXYZ</span>(r, g, b), a);
        lab.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertXYZtoLAB</span>(xyz[<span class="hljs-number">0</span>], xyz[<span class="hljs-number">1</span>], xyz[<span class="hljs-number">2</span>]), a);
        lch.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertLABtoLCH</span>(lab[<span class="hljs-number">0</span>], lab[<span class="hljs-number">1</span>], lab[<span class="hljs-number">2</span>]), a);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-46">&#x00a7;</a>
              </div>
              <p><code>extractRGBfromColor</code> - takes a color string and returns it’s RGB equivalent channel values:</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">extractRGBfromColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">color</span>) {

    color = color.<span class="hljs-title function_">toLowerCase</span>();

    <span class="hljs-keyword">let</span> b, c, d, a, vals, alpha, hue, white, black;</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-47">&#x00a7;</a>
              </div>
              <p>TODO: make this more efficient so we only convert to the color spaces we need (RGB, internal color space, return color space)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (color.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;hwb&#x27;</span>) &amp;&amp; !supportsHWB) {</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-48">&#x00a7;</a>
              </div>
              <p>This could be handled better via a regex, but also need to deal with angle units</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;hwb&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);

        <span class="hljs-keyword">const</span> vals = color.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27; &#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e != <span class="hljs-literal">null</span> &amp;&amp; e !== <span class="hljs-string">&#x27;&#x27;</span>);

        hue = vals[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (hue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;deg&#x27;</span>) &gt;= <span class="hljs-number">0</span>) hue = <span class="hljs-built_in">parseFloat</span>(hue)
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;rad&#x27;</span>) &gt;= <span class="hljs-number">0</span>) hue = <span class="hljs-built_in">parseFloat</span>(hue) / radian;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;grad&#x27;</span>) &gt;= <span class="hljs-number">0</span>) hue = (<span class="hljs-built_in">parseFloat</span>(hue) / <span class="hljs-number">400</span>) * <span class="hljs-number">360</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;turn&#x27;</span>) &gt;= <span class="hljs-number">0</span>) hue = <span class="hljs-built_in">parseFloat</span>(hue) * <span class="hljs-number">360</span>;
        <span class="hljs-keyword">else</span> hue = <span class="hljs-built_in">parseFloat</span>(hue);

        hue = <span class="hljs-title function_">correctAngle</span>(hue);

        white = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">1</span>]);
        black = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">2</span>]);
        alpha = vals[<span class="hljs-number">3</span>];

        <span class="hljs-keyword">if</span> (alpha != <span class="hljs-literal">null</span>) {

            a = (alpha.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;%&#x27;</span>) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-built_in">parseFloat</span>(alpha) / <span class="hljs-number">100</span> : <span class="hljs-built_in">parseFloat</span>(alpha);
        }
        <span class="hljs-keyword">else</span> a = <span class="hljs-number">1</span>;

        [b, c, d] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertHWBtoRGB</span>(hue, white, black);

        b = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(b * <span class="hljs-number">256</span>);
        <span class="hljs-keyword">if</span> (b &gt; <span class="hljs-number">255</span>) b = <span class="hljs-number">255</span>;
        <span class="hljs-keyword">if</span> (b &lt; <span class="hljs-number">0</span>) b = <span class="hljs-number">0</span>;

        c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(c * <span class="hljs-number">256</span>);
        <span class="hljs-keyword">if</span> (c &gt; <span class="hljs-number">255</span>) c = <span class="hljs-number">255</span>;
        <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">0</span>) c = <span class="hljs-number">0</span>;

        d = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(d * <span class="hljs-number">256</span>);
        <span class="hljs-keyword">if</span> (d &gt; <span class="hljs-number">255</span>) d = <span class="hljs-number">255</span>;
        <span class="hljs-keyword">if</span> (d &lt; <span class="hljs-number">0</span>) d = <span class="hljs-number">0</span>;

        <span class="hljs-keyword">return</span> [b, c, d, a];
    } 
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (color.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;xyz&#x27;</span>)) {
        
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;xyz&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);

        vals = color.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27; &#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e != <span class="hljs-literal">null</span> &amp;&amp; e !== <span class="hljs-string">&#x27;&#x27;</span>);

        b = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">0</span>]);
        c = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">1</span>]);
        d = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">2</span>]);
        alpha = vals[<span class="hljs-number">3</span>];

        a = (alpha != <span class="hljs-literal">null</span>) ? <span class="hljs-built_in">parseFloat</span>(alpha) : <span class="hljs-number">1</span>;

        <span class="hljs-keyword">return</span> [...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertXYZtoRGB</span>(b, c, d), a];
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (color.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;lab&#x27;</span>) &amp;&amp; !supportsLAB) {

        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;lab&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);

        vals = color.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27; &#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e != <span class="hljs-literal">null</span> &amp;&amp; e !== <span class="hljs-string">&#x27;&#x27;</span>);

        b = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">0</span>]);
        c = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">1</span>]);
        d = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">2</span>]);
        alpha = vals[<span class="hljs-number">3</span>];

        a = (alpha != <span class="hljs-literal">null</span>) ? <span class="hljs-built_in">parseFloat</span>(alpha) : <span class="hljs-number">1</span>;

        <span class="hljs-keyword">return</span> [...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertXYZtoRGB</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertLABtoXYZ</span>(b, c, d)), a]; 
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (color.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;lch&#x27;</span>) &gt;= <span class="hljs-number">0</span> &amp;&amp; !supportsLCH) {

        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;lch&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);
        color = color.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);

        vals = color.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27; &#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e != <span class="hljs-literal">null</span> &amp;&amp; e !== <span class="hljs-string">&#x27;&#x27;</span>);

        b = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">0</span>]);
        c = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">1</span>]);
        d = <span class="hljs-built_in">parseFloat</span>(vals[<span class="hljs-number">2</span>]);
        alpha = vals[<span class="hljs-number">3</span>];

        a = (alpha != <span class="hljs-literal">null</span>) ? <span class="hljs-built_in">parseFloat</span>(alpha) : <span class="hljs-number">1</span>;

        <span class="hljs-keyword">return</span> [...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertXYZtoRGB</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertLABtoXYZ</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertLCHtoLAB</span>(b, c, d))), a]; 
    }
    <span class="hljs-keyword">else</span> {

        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getColorFromCanvas</span>(color);
    }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-49">&#x00a7;</a>
              </div>
              <p><code>convertRGBtoHex</code> - takes 3 rgb color values (range 0-255) and returns a #hex string:</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">convertRGBtoHex</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">red, green, blue</span>) {

    <span class="hljs-keyword">if</span> (red.<span class="hljs-property">substring</span>) red = <span class="hljs-built_in">parseInt</span>(red, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">if</span> (green.<span class="hljs-property">substring</span>) green = <span class="hljs-built_in">parseInt</span>(green, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">if</span> (blue.<span class="hljs-property">substring</span>) blue = <span class="hljs-built_in">parseInt</span>(blue, <span class="hljs-number">10</span>);

    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isNaN</span>(red) &amp;&amp; !<span class="hljs-built_in">isNaN</span>(green) &amp;&amp; !<span class="hljs-built_in">isNaN</span>(blue)) {

        <span class="hljs-keyword">const</span> r = (<span class="hljs-string">&quot;0&quot;</span>+(red).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)).<span class="hljs-title function_">slice</span>(-<span class="hljs-number">2</span>),
            g = (<span class="hljs-string">&quot;0&quot;</span>+(green).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)).<span class="hljs-title function_">slice</span>(-<span class="hljs-number">2</span>),
            b = (<span class="hljs-string">&quot;0&quot;</span>+(blue).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)).<span class="hljs-title function_">slice</span>(-<span class="hljs-number">2</span>);

        <span class="hljs-keyword">return</span> <span class="hljs-string">`#<span class="hljs-subst">${r}</span><span class="hljs-subst">${g}</span><span class="hljs-subst">${b}</span>`</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;#000000&#x27;</span>;
};

P.<span class="hljs-property">getColorFromCanvas</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">color</span>) {

    <span class="hljs-keyword">let</span> r = <span class="hljs-number">0</span>,
        g = <span class="hljs-number">0</span>,
        b = <span class="hljs-number">0</span>,
        a = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">const</span> cell = <span class="hljs-title function_">requestCell</span>();

    <span class="hljs-keyword">const</span> { element, engine } = cell;

    element.<span class="hljs-property">width</span> = <span class="hljs-number">1</span>;
    element.<span class="hljs-property">height</span> = <span class="hljs-number">1</span>;

    engine.<span class="hljs-title function_">save</span>();
    engine.<span class="hljs-property">globalAlpha</span> = <span class="hljs-number">1</span>;
    engine.<span class="hljs-property">globalCompositeOperation</span> = <span class="hljs-string">&#x27;source-over&#x27;</span>;
    engine.<span class="hljs-property">fillStyle</span> = color;

    engine.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

    <span class="hljs-keyword">const</span> image = engine.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

    <span class="hljs-keyword">if</span> (image &amp;&amp; image.<span class="hljs-property">data</span>) {

        [r, g, b, a] = image.<span class="hljs-property">data</span>;

        a /= <span class="hljs-number">255</span>;
    }
    engine.<span class="hljs-title function_">restore</span>();
    <span class="hljs-title function_">releaseCell</span>(cell);

    <span class="hljs-keyword">return</span> [r, g, b, a];
};</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-50">&#x00a7;</a>
              </div>
              <p>From <a href="https://www.w3.org/TR/css-color-4/#rgb-to-hsl">CSS Color Module Level 4</a> - which is weird because when I checked it sets up the hue value as NaN (!!!?!). So instead I’ve gone with the suggested answer in <a href="https://css-tricks.com/converting-color-spaces-in-javascript/">this CSS-Tricks article</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">convertRGBtoHSL</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">red, green, blue</span>) {

    red /= <span class="hljs-number">256</span>;
    green /= <span class="hljs-number">256</span>;
    blue /= <span class="hljs-number">256</span>;

    <span class="hljs-keyword">let</span> max = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(red, green, blue);
    <span class="hljs-keyword">let</span> min = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(red, green, blue);
    <span class="hljs-keyword">let</span> [hue, sat, light] = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, (min + max)/<span class="hljs-number">2</span>];
    <span class="hljs-keyword">let</span> d = max - min;

    <span class="hljs-keyword">if</span> (d !== <span class="hljs-number">0</span>) {
        sat = (light === <span class="hljs-number">0</span> || light === <span class="hljs-number">1</span>)
            ? <span class="hljs-number">0</span>
            : (max - light) / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(light, <span class="hljs-number">1</span> - light);

        <span class="hljs-keyword">switch</span> (max) {
            <span class="hljs-keyword">case</span> <span class="hljs-attr">red</span>:   hue = (green - blue) / d + (green &lt; blue ? <span class="hljs-number">6</span> : <span class="hljs-number">0</span>); <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-attr">green</span>: hue = (blue - red) / d + <span class="hljs-number">2</span>; <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-attr">blue</span>:  hue = (red - green) / d + <span class="hljs-number">4</span>;
        }

        hue = hue * <span class="hljs-number">60</span>;
    }

    <span class="hljs-keyword">return</span> [hue, sat * <span class="hljs-number">100</span>, light * <span class="hljs-number">100</span>];
};</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-51">&#x00a7;</a>
              </div>
              <p>From <a href="https://www.w3.org/TR/css-color-4/#hsl-to-rgb">CSS Color Module Level 4</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">convertHSLtoRGB</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">hue, sat, light</span>) {
    
    hue = hue % <span class="hljs-number">360</span>;

    <span class="hljs-keyword">if</span> (hue &lt; <span class="hljs-number">0</span>) {
        hue += <span class="hljs-number">360</span>;
    }

    sat /= <span class="hljs-number">100</span>;
    light /= <span class="hljs-number">100</span>;

    <span class="hljs-keyword">const</span> f = <span class="hljs-keyword">function</span> (<span class="hljs-params">n</span>) {
        <span class="hljs-keyword">let</span> k = (n + hue/<span class="hljs-number">30</span>) % <span class="hljs-number">12</span>;
        <span class="hljs-keyword">let</span> a = sat * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(light, <span class="hljs-number">1</span> - light);
        <span class="hljs-keyword">return</span> light - a * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(-<span class="hljs-number">1</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(k - <span class="hljs-number">3</span>, <span class="hljs-number">9</span> - k, <span class="hljs-number">1</span>));
    }
    <span class="hljs-keyword">return</span> [<span class="hljs-title function_">f</span>(<span class="hljs-number">0</span>), <span class="hljs-title function_">f</span>(<span class="hljs-number">8</span>), <span class="hljs-title function_">f</span>(<span class="hljs-number">4</span>)];
};</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-52">&#x00a7;</a>
              </div>
              <p>From <a href="https://www.w3.org/TR/css-color-4/#rgb-to-hwb">CSS Color Module Level 4</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">convertRGBtoHWB</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">red, green, blue</span>) {

    <span class="hljs-keyword">let</span> hsl = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(red, green, blue, suffix);

    red /= <span class="hljs-number">256</span>;
    green /= <span class="hljs-number">256</span>;
    blue /= <span class="hljs-number">256</span>;

    <span class="hljs-keyword">let</span> white = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(red, green, blue);
    <span class="hljs-keyword">let</span> black = <span class="hljs-number">1</span> - <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(red, green, blue);

    <span class="hljs-keyword">return</span> [hsl[<span class="hljs-number">0</span>], white * <span class="hljs-number">100</span>, black * <span class="hljs-number">100</span>];
};</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-53">&#x00a7;</a>
              </div>
              <p>From <a href="https://www.w3.org/TR/css-color-4/#rgb-to-hwb">CSS Color Module Level 4</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">convertRGBHtoHWB</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">red, green, blue, hue</span>) {

    red /= <span class="hljs-number">256</span>;
    green /= <span class="hljs-number">256</span>;
    blue /= <span class="hljs-number">256</span>;

    <span class="hljs-keyword">let</span> white = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(red, green, blue);
    <span class="hljs-keyword">let</span> black = <span class="hljs-number">1</span> - <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(red, green, blue);

    <span class="hljs-keyword">return</span> [hue, white * <span class="hljs-number">100</span>, black * <span class="hljs-number">100</span>];
};</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-54">&#x00a7;</a>
              </div>
              <p>From <a href="https://www.w3.org/TR/css-color-4/#hwb-to-rgb">CSS Color Module Level 4</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">convertHWBtoRGB</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">hue, white, black</span>) {
    
    white /= <span class="hljs-number">100</span>;
    black /= <span class="hljs-number">100</span>;

    <span class="hljs-keyword">if</span> (white + black &gt;= <span class="hljs-number">1</span>) {
    
        <span class="hljs-keyword">let</span> gray = white / (white + black);
        <span class="hljs-keyword">return</span> [gray, gray, gray];
    }

    <span class="hljs-keyword">let</span> rgb = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertHSLtoRGB</span>(hue, <span class="hljs-number">100</span>, <span class="hljs-number">50</span>);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {

        rgb[i] *= (<span class="hljs-number">1</span> - white - black);
        rgb[i] += white;
    }
    <span class="hljs-keyword">return</span> rgb;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-55">&#x00a7;</a>
              </div>
              <p>Code relating to XYZ conversion taken and adapted from the <a href="https://github.com/vinaypillai/ac-colors/blob/master/index.js">vinaypillai/ac-colors repository</a> on GitHub</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">convertRGBtoXYZ</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">red, green, blue</span>) {

    <span class="hljs-keyword">const</span> invertGammaCorrection = <span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) {

        <span class="hljs-keyword">if</span> (val &lt;= <span class="hljs-number">0.04045</span>) <span class="hljs-keyword">return</span> val / <span class="hljs-number">12.92</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>((val + <span class="hljs-number">0.055</span>) / <span class="hljs-number">1.055</span>, <span class="hljs-number">2.4</span>);
    };

    red /= <span class="hljs-number">255</span>;
    green /= <span class="hljs-number">255</span>;
    blue /= <span class="hljs-number">255</span>;

    <span class="hljs-keyword">const</span> r = <span class="hljs-title function_">invertGammaCorrection</span>(red),
        g = <span class="hljs-title function_">invertGammaCorrection</span>(green),
        b = <span class="hljs-title function_">invertGammaCorrection</span>(blue);

    <span class="hljs-keyword">const</span> x = (<span class="hljs-number">0.4124</span> * r) + (<span class="hljs-number">0.3576</span> * g) + (<span class="hljs-number">0.1805</span> * b),
        y = (<span class="hljs-number">0.2126</span> * r) + (<span class="hljs-number">0.7152</span> * g) + (<span class="hljs-number">0.0722</span> * b),
        z = (<span class="hljs-number">0.0193</span> * r) + (<span class="hljs-number">0.1192</span> * g) + (<span class="hljs-number">0.9505</span> * b);

    <span class="hljs-keyword">return</span> [x * <span class="hljs-number">100</span> + <span class="hljs-number">0</span>, y * <span class="hljs-number">100</span> + <span class="hljs-number">0</span>, z * <span class="hljs-number">100</span> + <span class="hljs-number">0</span>];
};

P.<span class="hljs-property">convertXYZtoRGB</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">x, y, z</span>) {

    <span class="hljs-keyword">const</span> addGammaCorrection = <span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) {

        <span class="hljs-keyword">if</span> (val &lt;= <span class="hljs-number">0.0031308</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">12.92</span> * val;
        <span class="hljs-keyword">return</span> (<span class="hljs-number">1.055</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(val, <span class="hljs-number">1</span> / <span class="hljs-number">2.4</span>)) - <span class="hljs-number">0.055</span>;
    };

    x /= <span class="hljs-number">100</span>;
    y /= <span class="hljs-number">100</span>;
    z /= <span class="hljs-number">100</span>;

    <span class="hljs-keyword">const</span> r = (<span class="hljs-number">3.2406254773200533</span> * x) - (<span class="hljs-number">1.5372079722103187</span> * y) - (<span class="hljs-number">0.4986285986982479</span> * z),
      g = (-<span class="hljs-number">0.9689307147293197</span> * x) + (<span class="hljs-number">1.8757560608852415</span> * y) + (<span class="hljs-number">0.041517523842953964</span> * z),
      b = (<span class="hljs-number">0.055710120445510616</span> * x) + (-<span class="hljs-number">0.2040210505984867</span> * y) + (<span class="hljs-number">1.0569959422543882</span> * z);

    <span class="hljs-keyword">const</span> red = <span class="hljs-title function_">addGammaCorrection</span>(r),
        green = <span class="hljs-title function_">addGammaCorrection</span>(g),
        blue = <span class="hljs-title function_">addGammaCorrection</span>(b);

    <span class="hljs-keyword">return</span> [<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(red * <span class="hljs-number">255</span>) + <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(green * <span class="hljs-number">255</span>) + <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(blue * <span class="hljs-number">255</span>) + <span class="hljs-number">0</span>];
};

P.<span class="hljs-property">convertXYZtoLAB</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">x, y, z</span>) {

    <span class="hljs-keyword">const</span> iX = <span class="hljs-number">95.05</span>,
        iY = <span class="hljs-number">100</span>,
        iZ = <span class="hljs-number">108.9</span>,
        eps = <span class="hljs-number">216</span> / <span class="hljs-number">24389</span>,
        kap = <span class="hljs-number">24389</span> / <span class="hljs-number">27</span>;

    <span class="hljs-keyword">const</span> cbrt = (<span class="hljs-title class_">Math</span>.<span class="hljs-property">cbrt</span> != <span class="hljs-literal">null</span>) ? <span class="hljs-title class_">Math</span>.<span class="hljs-property">cbrt</span> : <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(val, <span class="hljs-number">1</span> / <span class="hljs-number">3</span>);

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">fwdTrans</span> = (<span class="hljs-params">val</span>) =&gt; (val &gt; eps) ? <span class="hljs-title function_">cbrt</span>(val) : ((kap * val) + <span class="hljs-number">16</span>) / <span class="hljs-number">116</span>;

    x /= iX;
    y /= iY;
    z /= iZ;

    <span class="hljs-keyword">const</span> fX = <span class="hljs-title function_">fwdTrans</span>(x),
        fY = <span class="hljs-title function_">fwdTrans</span>(y),
        fZ = <span class="hljs-title function_">fwdTrans</span>(z);

    <span class="hljs-keyword">const</span> l = <span class="hljs-number">116</span> * fY - <span class="hljs-number">16</span>,
        a = <span class="hljs-number">500</span> * (fX - fY),
        b = <span class="hljs-number">200</span> * (fY - fZ);

    <span class="hljs-keyword">return</span> [l + <span class="hljs-number">0</span>, a + <span class="hljs-number">0</span>, b + <span class="hljs-number">0</span>];
};

P.<span class="hljs-property">convertLABtoXYZ</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">l, a, b</span>) {

    <span class="hljs-keyword">const</span> iX = <span class="hljs-number">95.05</span>,
        iY = <span class="hljs-number">100</span>,
        iZ = <span class="hljs-number">108.9</span>,
        eps = <span class="hljs-number">216</span> / <span class="hljs-number">24389</span>,
        kap = <span class="hljs-number">24389</span> / <span class="hljs-number">27</span>;

    <span class="hljs-keyword">const</span> fY = (l + <span class="hljs-number">16</span>) / <span class="hljs-number">116</span>,
        fZ = (fY - b / <span class="hljs-number">200</span>),
        fX = a / <span class="hljs-number">500</span> + fY;

    <span class="hljs-keyword">const</span> xR = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(fX, <span class="hljs-number">3</span>) &gt; eps) ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(fX, <span class="hljs-number">3</span>) : (<span class="hljs-number">116</span> * fX - <span class="hljs-number">16</span>) / kap,
        yR = (l &gt; kap * eps) ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>((l + <span class="hljs-number">16</span>) / <span class="hljs-number">116</span>, <span class="hljs-number">3</span>) : l / kap,
        zR = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(fZ, <span class="hljs-number">3</span>) &gt; eps) ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(fZ, <span class="hljs-number">3</span>) : (<span class="hljs-number">116</span> * fZ - <span class="hljs-number">16</span>) / kap;

    <span class="hljs-keyword">return</span> [xR * iX + <span class="hljs-number">0</span>, yR * iY + <span class="hljs-number">0</span>, zR * iZ];
};

P.<span class="hljs-property">convertLABtoLCH</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">l, a, b</span>) {

    <span class="hljs-keyword">const</span> maxZeroTolerance = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">10</span>, -<span class="hljs-number">12</span>);

    b = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(b) &lt; <span class="hljs-title class_">Color</span>.<span class="hljs-property">maxZeroTolerance</span>) ? <span class="hljs-number">0</span> : b;

    <span class="hljs-keyword">const</span> c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(a * a + b * b);

    <span class="hljs-keyword">const</span> h = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>(b, a) &gt;= <span class="hljs-number">0</span>) ?
        <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>(b, a) / <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">180</span> :
        <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">atan2</span>(b, a) / <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">180</span> + <span class="hljs-number">360</span>;

    <span class="hljs-keyword">return</span> [l + <span class="hljs-number">0</span>, c + <span class="hljs-number">0</span>, h + <span class="hljs-number">0</span>];
};

P.<span class="hljs-property">convertLCHtoLAB</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">l, c, h</span>) {

    <span class="hljs-keyword">const</span> a = c * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(h / <span class="hljs-number">180</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>);
    <span class="hljs-keyword">const</span> b = c * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(h / <span class="hljs-number">180</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>);

    <span class="hljs-keyword">return</span> [l + <span class="hljs-number">0</span>, a + <span class="hljs-number">0</span>, b + <span class="hljs-number">0</span>];
};</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-56">&#x00a7;</a>
              </div>
              <p>The following functions are used by the Blend filter</p>
<ul>
<li>Input is the six RGB parts (Integers clamped to the 0-255 range) of the input and mix channels</li>
<li>Output is the RGB version of the mixed HSL colors generated from the RGB inputs</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.<span class="hljs-property">calculateColorBlend</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">iR, iG, iB, mR, mG, mB</span>) {

    <span class="hljs-keyword">const</span> [iH, iS, iL] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(iR, iG, iB);
    <span class="hljs-keyword">const</span> [mH, mS, mL] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(mR, mG, mB);

    <span class="hljs-keyword">const</span> [r, g, b] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertHSLtoRGB</span>(iH, iS, mL);

    <span class="hljs-keyword">return</span> [<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(r * <span class="hljs-number">255</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(g * <span class="hljs-number">255</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(b * <span class="hljs-number">255</span>)];
};
P.<span class="hljs-property">calculateHueBlend</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">iR, iG, iB, mR, mG, mB</span>) {

    <span class="hljs-keyword">const</span> [iH, iS, iL] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(iR, iG, iB);
    <span class="hljs-keyword">const</span> [mH, mS, mL] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(mR, mG, mB);

    <span class="hljs-keyword">const</span> [r, g, b] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertHSLtoRGB</span>(iH, mS, mL);

    <span class="hljs-keyword">return</span> [<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(r * <span class="hljs-number">255</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(g * <span class="hljs-number">255</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(b * <span class="hljs-number">255</span>)];
};
P.<span class="hljs-property">calculateSaturationBlend</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">iR, iG, iB, mR, mG, mB</span>) {

    <span class="hljs-keyword">const</span> [iH, iS, iL] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(iR, iG, iB);
    <span class="hljs-keyword">const</span> [mH, mS, mL] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(mR, mG, mB);

    <span class="hljs-keyword">const</span> [r, g, b] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertHSLtoRGB</span>(mH, iS, mL);

    <span class="hljs-keyword">return</span> [<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(r * <span class="hljs-number">255</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(g * <span class="hljs-number">255</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(b * <span class="hljs-number">255</span>)];
};
P.<span class="hljs-property">calculateLuminosityBlend</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">iR, iG, iB, mR, mG, mB</span>) {

    <span class="hljs-keyword">const</span> [iH, iS, iL] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(iR, iG, iB);
    <span class="hljs-keyword">const</span> [mH, mS, mL] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertRGBtoHSL</span>(mR, mG, mB);

    <span class="hljs-keyword">const</span> [r, g, b] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertHSLtoRGB</span>(mH, mS, iL);

    <span class="hljs-keyword">return</span> [<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(r * <span class="hljs-number">255</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(g * <span class="hljs-number">255</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(b * <span class="hljs-number">255</span>)];
};</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-57">&#x00a7;</a>
              </div>
              <p>We need to check whether the browser supports various color spaces. The simplest way to do that is to feed a color into a canvas element’s engine, stamp a pixel, then check to see if the pixel is black (space not supported)</p>
<ul>
<li>We check for HWB, LAB andf LCH color space support</li>
<li>We assume that the browser always supports RGB and HSL  color spaces</li>
<li>We don’t check for XYZ color space support because it is not part of the <a href="https://www.w3.org/TR/css-color-4/">CSS Color Module Level 4 specification</a></li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> supportsHWB = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">let</span> supportsLAB = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">let</span> supportsLCH = <span class="hljs-literal">false</span>;

<span class="hljs-keyword">const</span> browserChecker = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

    <span class="hljs-keyword">let</span> r = <span class="hljs-number">0</span>,
        g = <span class="hljs-number">0</span>,
        b = <span class="hljs-number">0</span>,
        a = <span class="hljs-number">0</span>,
        image,
        col = <span class="hljs-string">&#x27;#ffffff00&#x27;</span>;

    <span class="hljs-keyword">const</span> cell = <span class="hljs-title function_">requestCell</span>();

    <span class="hljs-keyword">const</span> { element, engine } = cell;

    element.<span class="hljs-property">width</span> = <span class="hljs-number">1</span>;
    element.<span class="hljs-property">height</span> = <span class="hljs-number">1</span>;

    engine.<span class="hljs-title function_">save</span>();
    engine.<span class="hljs-property">globalAlpha</span> = <span class="hljs-number">1</span>;
    engine.<span class="hljs-property">globalCompositeOperation</span> = <span class="hljs-string">&#x27;source-over&#x27;</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-58">&#x00a7;</a>
              </div>
              <p>Test for HWB support</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    engine.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;hwb(90 10% 10%)&#x27;</span>;
    engine.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

    image = engine.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

    <span class="hljs-keyword">if</span> (image &amp;&amp; image.<span class="hljs-property">data</span>) {

        [r, g, b, a] = image.<span class="hljs-property">data</span>;
    }
    <span class="hljs-keyword">if</span> (r || g || b) supportsHWB = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-59">&#x00a7;</a>
              </div>
              <p>Firefox (v96.0.1) fails silently when setting engine to unsupported color, leaving engine value unchanged, which in turn leaves our test rgb values unchanged, thus giving us a false positive for the test</p>
<ul>
<li>This additional safety net test identifies and corrects for that bug</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (supportsHWB &amp;&amp; col === engine.<span class="hljs-property">fillStyle</span>) supportsHWB = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">else</span> col = engine.<span class="hljs-property">fillStyle</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-60">&#x00a7;</a>
              </div>
              <p>Test for LAB support</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    engine.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;lab(29.2345% 39.3825 20.0664)&#x27;</span>;
    engine.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
    engine.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

    image = engine.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

    <span class="hljs-keyword">if</span> (image &amp;&amp; image.<span class="hljs-property">data</span>) {

        [r, g, b, a] = image.<span class="hljs-property">data</span>;
    }
    <span class="hljs-keyword">if</span> (r || g || b) supportsLAB = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-61">&#x00a7;</a>
              </div>
              <p>Firefox safety net</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (supportsLAB &amp;&amp; col === engine.<span class="hljs-property">fillStyle</span>) supportsLAB = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">else</span> col = engine.<span class="hljs-property">fillStyle</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-62">&#x00a7;</a>
              </div>
              <p>Test for LCH support</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    engine.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;lch(52.2345% 72.2 56.2)&#x27;</span>;
    engine.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
    engine.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

    image = engine.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

    <span class="hljs-keyword">if</span> (image &amp;&amp; image.<span class="hljs-property">data</span>) {

        [r, g, b, a] = image.<span class="hljs-property">data</span>;
    }
    <span class="hljs-keyword">if</span> (r || g || b) supportsLCH = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-63">&#x00a7;</a>
              </div>
              <p>Firefox safety net</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (supportsLCH &amp;&amp; col === engine.<span class="hljs-property">fillStyle</span>) supportsLCH = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">else</span> col = engine.<span class="hljs-property">fillStyle</span>;

    engine.<span class="hljs-title function_">restore</span>();
    <span class="hljs-title function_">releaseCell</span>(cell);
};
<span class="hljs-title function_">browserChecker</span>();</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-64">&#x00a7;</a>
              </div>
              <h4 id="factory">Factory</h4>
<pre><code>scrawl.<span class="hljs-title function_">makeColor</span>({

    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;myColorObject&#x27;</span>,

    <span class="hljs-attr">minimumColor</span>: <span class="hljs-string">&#x27;red&#x27;</span>,
    <span class="hljs-attr">maximumColor</span>: <span class="hljs-string">&#x27;green&#x27;</span>,
});

scrawl.<span class="hljs-title function_">makeBlock</span>({

    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;block-tester&#x27;</span>,

    <span class="hljs-attr">width</span>: <span class="hljs-number">120</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-number">40</span>,

    <span class="hljs-attr">startX</span>: <span class="hljs-number">60</span>,
    <span class="hljs-attr">startY</span>: <span class="hljs-number">60</span>,

    <span class="hljs-attr">fillStyle</span>: myColorObject.<span class="hljs-title function_">getRangeColor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()),
    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;fill&#x27;</span>,
});
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> makeColor = <span class="hljs-keyword">function</span> (<span class="hljs-params">items</span>) {

    <span class="hljs-keyword">if</span> (!items) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Color</span>(items);
};

constructors.<span class="hljs-property">Color</span> = <span class="hljs-title class_">Color</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-65">&#x00a7;</a>
              </div>
              <h4 id="exports">Exports</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">export</span> {
    makeColor,
};</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
